<\!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Amplituhedron Journey</title>
    <style>
@import"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap";:root{font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;line-height:1.5;font-weight:400;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;--bg-primary: #000000;--bg-secondary: #0a0a0a;--text-primary: rgba(255, 255, 255, .95);--text-secondary: rgba(255, 255, 255, .7);--text-tertiary: rgba(255, 255, 255, .5);--accent: #4a9eff;--accent-hover: #6bb0ff;--holographic-1: #ff006e;--holographic-2: #8338ec;--holographic-3: #3a86ff;--holographic-4: #06ffa5;--holographic-5: #ffbe0b;--nav-height: 80px}*{margin:0;padding:0;box-sizing:border-box}body{margin:0;background:var(--bg-primary);color:var(--text-primary);overflow-x:hidden}#root{min-height:100vh;width:100%}.app{position:relative;width:100%;min-height:100vh;background:radial-gradient(ellipse at center,#4a9eff0d,#000 70%)}h1,h2,h3,h4,h5,h6{font-weight:600;letter-spacing:-.02em;line-height:1.2}h1{font-size:clamp(2rem,5vw,3.5rem);font-weight:700}h2{font-size:clamp(1.5rem,4vw,2.5rem)}h3{font-size:clamp(1.2rem,3vw,1.8rem)}p{font-size:clamp(1rem,2vw,1.125rem);line-height:1.6;color:var(--text-secondary)}button{font-family:inherit;font-size:1rem;font-weight:500;padding:.75rem 1.5rem;border:1px solid rgba(255,255,255,.1);border-radius:8px;background:#ffffff0d;color:var(--text-primary);cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}button:hover{background:#ffffff1a;border-color:#fff3;transform:translateY(-1px)}button:active{transform:translateY(0)}button:disabled{opacity:.5;cursor:not-allowed}a{color:var(--accent);text-decoration:none;transition:color .2s ease}a:hover{color:var(--accent-hover)}.glass{background:#ffffff08;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.05);border-radius:12px}.holographic{background:linear-gradient(135deg,var(--holographic-1),var(--holographic-2),var(--holographic-3),var(--holographic-4),var(--holographic-5));background-size:400% 400%;animation:holographicShift 10s ease infinite;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}@keyframes holographicShift{0%,to{background-position:0% 50%}50%{background-position:100% 50%}}.glow{filter:drop-shadow(0 0 20px rgba(74,158,255,.5))}.fade-in{animation:fadeIn .6s ease forwards}@keyframes fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.canvas-container{position:relative;width:100%;height:100vh}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:#ffffff0d}::-webkit-scrollbar-thumb{background:#ffffff1a;border-radius:4px}::-webkit-scrollbar-thumb:hover{background:#ffffff26}@media(max-width:768px){:root{--nav-height: 60px}button{font-size:.9rem;padding:.625rem 1.25rem}}.navigation{position:fixed;top:0;left:0;right:0;height:var(--nav-height);background:#000c;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,.05);z-index:1000}.nav-content{max-width:1200px;margin:0 auto;padding:0 2rem;height:100%;display:flex;align-items:center;justify-content:space-between}.nav-title{font-size:1.5rem;font-weight:700;letter-spacing:-.02em}.chapter-nav{display:flex;gap:1rem}.chapter-btn{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:#ffffff05;border:1px solid rgba(255,255,255,.05);border-radius:8px;color:var(--text-secondary);font-size:.875rem;transition:all .3s ease}.chapter-btn:hover{background:#ffffff0d;border-color:#ffffff1a;color:var(--text-primary)}.chapter-btn.active{background:#4a9eff1a;border-color:#4a9eff4d;color:var(--text-primary)}.chapter-number{font-weight:600;opacity:.5;font-size:.8rem}.chapter-btn.active .chapter-number{opacity:1;color:var(--accent)}.chapter-title{display:none}@media(min-width:768px){.chapter-title{display:inline}}@media(max-width:768px){.nav-content{padding:0 1rem}.nav-title{font-size:1.2rem}.chapter-nav{gap:.5rem}.chapter-btn{padding:.5rem .75rem}}.chapter{position:relative;width:100%;min-height:100vh;padding-top:var(--nav-height)}.chapter-content{max-width:1200px;margin:0 auto;padding:4rem 2rem}.chapter-title{text-align:center;margin-bottom:2rem}.chapter-text{text-align:center;max-width:800px;margin:0 auto 3rem;font-size:1.2rem;line-height:1.6}.diagram-container{position:relative;margin:3rem 0}.particle-collision-demo{margin:2rem 0;padding:2rem;background:#ffffff05;border-radius:12px;border:1px solid rgba(255,255,255,.05)}.collision-explanation{display:flex;align-items:center;justify-content:center;gap:2rem;font-size:1.2rem}.particle{padding:1rem;background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);border-radius:50%;width:100px;height:100px;display:flex;align-items:center;justify-content:center;text-align:center;font-size:.9rem}.particle-left{animation:moveRight 2s ease-in-out infinite}.particle-right{animation:moveLeft 2s ease-in-out infinite}.collision-point{font-size:2rem}@keyframes moveRight{0%,to{transform:translate(0)}50%{transform:translate(20px)}}@keyframes moveLeft{0%,to{transform:translate(0)}50%{transform:translate(-20px)}}.diagram-intro{text-align:center;margin:2rem 0}.diagram-legend{display:flex;justify-content:center;gap:2rem;margin-top:1rem;flex-wrap:wrap}.legend-item{display:flex;align-items:center;gap:.5rem;font-size:.9rem;color:var(--text-secondary)}.legend-item span{font-size:1.2rem;font-weight:700}.click-prompt{padding:4rem;text-align:center;background:#4a9eff0d;border-radius:12px;border:2px dashed rgba(74,158,255,.3);cursor:pointer}.click-prompt p{font-size:1.2rem;color:var(--text-primary)}.diagram-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:1rem;padding:2rem;background:#ffffff05;border-radius:12px;border:1px solid rgba(255,255,255,.05);max-height:500px;overflow-y:auto}.diagram-item{display:flex;align-items:center;justify-content:center}.feynman-diagram-wrapper{width:100%;height:100%}.explanation-box{margin-top:1rem;padding:1.5rem;text-align:center;max-width:400px;margin-left:auto;margin-right:auto}.explanation-box p{margin:.5rem 0}.explanation-box .small{font-size:.9rem;color:var(--text-tertiary);font-style:italic}.diagram-counter{text-align:center;margin-top:2rem}.diagram-counter p{margin:.5rem 0}.diagram-counter .small{font-size:.9rem;color:var(--text-tertiary)}.overwhelm-message{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:3rem;text-align:center;max-width:600px;width:90%;z-index:100}.overwhelm-message h3{margin-bottom:1rem;color:var(--text-primary)}.overwhelm-message p{margin-bottom:2rem}.next-button{background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);padding:1rem 2rem;font-size:1.1rem;font-weight:500;transition:all .3s ease}.next-button:hover{background:#4a9eff33;border-color:#4a9eff80;transform:translateY(-2px)}.chapter-nav{display:flex;justify-content:space-between;margin-top:4rem}@media(max-width:768px){.chapter-content{padding:2rem 1rem}.diagram-grid{grid-template-columns:repeat(auto-fill,minmax(80px,1fr));gap:.5rem;padding:1rem}.overwhelm-message{padding:2rem}}.chapter2 .cancellation-container{width:100%;height:450px;margin:3rem 0;border:1px solid rgba(255,255,255,.05);border-radius:12px;overflow:hidden;background:radial-gradient(ellipse at center,#ff066e05,#06ffa505,#00000080)}.chapter2 .explanation-panel{margin:3rem 0;padding:2rem;max-width:800px;margin-left:auto;margin-right:auto}.chapter2 .math-explanation h3{color:var(--text-primary);margin-bottom:1rem;text-align:center}.chapter2 .math-explanation>p{text-align:center;margin-bottom:2rem;font-size:1.1rem}.chapter2 .equation-breakdown,.chapter2 .cancellation-explanation{margin:1.5rem 0;padding:1.5rem;background:#ffffff05;border-radius:8px;border-left:4px solid var(--accent)}.chapter2 .equation-breakdown p,.chapter2 .cancellation-explanation p{margin:.5rem 0;font-size:1rem}.chapter2 .equation-display{text-align:center;margin:2rem 0}.chapter2 .complex-equation,.chapter2 .simple-result{padding:1.5rem;border-radius:8px;background:#ffffff08;border:1px solid rgba(255,255,255,.1);margin:1rem 0}.chapter2 .small-note{font-size:.9rem;color:var(--text-tertiary);font-style:italic;margin-top:1rem}.chapter2 .equation-label{font-size:1rem;color:var(--text-secondary);margin-bottom:1rem;font-weight:300}.chapter2 .equation-text{font-size:1.5rem;font-family:Georgia,serif;color:var(--text-primary);font-style:italic;letter-spacing:.05em}.chapter2 .equation-text sub{font-size:.7em;vertical-align:sub}.chapter2 .simple-result .equation-text{font-size:2rem;font-weight:600;font-style:normal}.chapter2 .insight-button{display:block;margin:2rem auto;background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);padding:1rem 2rem;font-size:1rem;transition:all .3s ease}.chapter2 .insight-button:hover{background:#4a9eff33;border-color:#4a9eff80;transform:translateY(-2px)}.chapter2 .revelation{max-width:600px;margin:3rem auto;padding:2.5rem;text-align:center}.chapter2 .revelation h3{margin-bottom:1.5rem;font-size:1.8rem;color:var(--text-primary)}.chapter2 .revelation p{margin:1rem 0;font-size:1.1rem;line-height:1.6}.chapter2 .next-button{background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);transition:all .3s ease}.chapter2 .next-button:hover{background:#4a9eff33;border-color:#4a9eff80}@media(max-width:768px){.chapter2 .cancellation-container{height:350px}.chapter2 .equation-text{font-size:1.2rem}.chapter2 .simple-result .equation-text{font-size:1.5rem}}.chapter3 .polytope-container{width:100%;height:450px;margin:3rem 0;border:1px solid rgba(255,255,255,.05);border-radius:12px;overflow:hidden;background:radial-gradient(ellipse at center,#4a9eff08,#00000080)}.chapter3 .shape-selector{text-align:center;margin:2rem 0}.chapter3 .shape-selector p{color:var(--text-secondary);margin-bottom:1rem}.chapter3 .shape-buttons{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap}.chapter3 .shape-buttons button{padding:.75rem 1.5rem;background:#ffffff08;border:1px solid rgba(255,255,255,.1);color:var(--text-secondary);transition:all .3s ease}.chapter3 .shape-buttons button:hover{background:#ffffff0d;border-color:#fff3;color:var(--text-primary)}.chapter3 .shape-buttons button.active{background:#4a9eff1a;border-color:#4a9eff4d;color:var(--text-primary)}.chapter3 .insight-panel{max-width:500px;margin:2rem auto;padding:2rem;text-align:center}.chapter3 .insight-panel h3{font-size:1.3rem;margin-bottom:1rem;color:var(--accent)}.chapter3 .insight-panel p{font-size:1.2rem;margin-bottom:.5rem;font-weight:500}.chapter3 .insight-panel .detail{font-size:.9rem;color:var(--text-secondary);font-weight:400}.chapter3 .proceed-button{display:block;margin:2rem auto;background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);padding:1rem 2rem;font-size:1rem;transition:all .3s ease}.chapter3 .proceed-button:hover{background:#4a9eff33;border-color:#4a9eff80;transform:translateY(-2px)}.chapter3 .ready-panel{max-width:600px;margin:3rem auto;padding:3rem;text-align:center;background:linear-gradient(135deg,#4a9eff0d,#ffbe0b0d)}.chapter3 .ready-panel h3{font-size:2rem;margin-bottom:1.5rem;color:var(--text-primary);font-weight:600}.chapter3 .ready-panel p{font-size:1.2rem;line-height:1.6;color:var(--text-secondary)}.chapter3 .next-button{background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);transition:all .3s ease;font-weight:500}.chapter3 .next-button:hover{background:#4a9eff33;border-color:#4a9eff80}@media(max-width:768px){.chapter3 .polytope-container{height:350px}.chapter3 .shape-buttons{flex-direction:column;width:200px;margin:0 auto}.chapter3 .shape-buttons button{width:100%}}.chapter4 .amplituhedron-container{width:100%;height:500px;margin:3rem 0;border:1px solid rgba(255,255,255,.05);border-radius:12px;overflow:hidden;background:radial-gradient(ellipse at center,#4a9eff05,#00000080)}.chapter4 .controls{display:flex;gap:3rem;padding:2rem;margin:2rem 0;justify-content:center;flex-wrap:wrap}.chapter4 .slider-container{flex:1;min-width:250px}.chapter4 .slider-container label{display:flex;flex-direction:column;gap:1rem;font-size:1.1rem}.chapter4 .particle-slider{width:100%;height:6px;background:#ffffff1a;border-radius:3px;outline:none;-webkit-appearance:none;appearance:none}.chapter4 .particle-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;background:var(--accent);border-radius:50%;cursor:pointer;transition:all .2s ease}.chapter4 .particle-slider::-webkit-slider-thumb:hover{transform:scale(1.2);background:var(--accent-hover)}.chapter4 .particle-slider::-moz-range-thumb{width:20px;height:20px;background:var(--accent);border-radius:50%;cursor:pointer;border:none;transition:all .2s ease}.chapter4 .particle-slider::-moz-range-thumb:hover{transform:scale(1.2);background:var(--accent-hover)}.chapter4 .complexity-explanation{margin-top:1rem;padding:1rem;background:#ffffff05;border-radius:8px;border-left:3px solid var(--accent)}.chapter4 .complexity-explanation p{margin:.5rem 0;font-size:.95rem}.chapter4 .slider-hint{font-size:.9rem;color:var(--text-tertiary);margin-top:.5rem;font-style:italic}.chapter4 .interaction-guide{margin-top:1rem;padding:1rem;background:#4a9eff0d;border-radius:8px;border:1px solid rgba(74,158,255,.2)}.chapter4 .interaction-guide p{margin:0;font-size:.9rem;color:var(--text-primary)}.chapter4 .facet-info{flex:1;min-width:250px}.chapter4 .facet-info h3{font-size:1.2rem;margin-bottom:1rem;color:var(--text-primary)}.chapter4 .facet-info ul{list-style:none;padding:0}.chapter4 .facet-info li{padding:.5rem 0 .5rem 1.5rem;position:relative;color:var(--text-secondary)}.chapter4 .facet-info li:before{content:"â—†";position:absolute;left:0;color:var(--accent)}.chapter4 .insight-buttons{display:flex;justify-content:center;margin:2rem 0}.chapter4 .insight-button{background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);padding:.875rem 2rem;font-size:1rem;transition:all .3s ease}.chapter4 .insight-button:hover{background:#4a9eff33;border-color:#4a9eff80;transform:translateY(-2px)}.chapter4 .next-button{background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);transition:all .3s ease}.chapter4 .next-button:hover{background:#4a9eff33;border-color:#4a9eff80}@media(max-width:768px){.chapter4 .amplituhedron-container{height:400px}.chapter4 .controls{gap:2rem;padding:1.5rem}}.chapter5 .emergence-container{width:100%;height:500px;margin:3rem 0;border:1px solid rgba(255,255,255,.05);border-radius:12px;overflow:hidden;background:radial-gradient(ellipse at center,#8338ec0d,#000c)}.chapter5 .emergence-labels{display:flex;justify-content:center;gap:3rem;margin:2rem 0;flex-wrap:wrap}.chapter5 .label-item{display:flex;align-items:center;gap:.75rem;font-size:.9rem;color:var(--text-secondary)}.chapter5 .label-dot{width:12px;height:12px;border-radius:50%;position:relative}.chapter5 .label-dot:after{content:"";position:absolute;inset:-4px;border-radius:50%;border:1px solid currentColor;opacity:.3;animation:pulse 2s ease infinite}.chapter5 .label-dot.spacetime{background:#4a9eff;color:#4a9eff}.chapter5 .label-dot.particles{background:#06ffa5;color:#06ffa5}.chapter5 .label-dot.jewel{background:linear-gradient(45deg,#ff006e,#ffbe0b);color:#ff006e}.chapter5 .revelation-button,.chapter5 .final-revelation-button{display:block;margin:2rem auto;background:#8338ec1a;border:1px solid rgba(131,56,236,.3);padding:1rem 2rem;font-size:1rem;transition:all .3s ease}.chapter5 .revelation-button:hover,.chapter5 .final-revelation-button:hover{background:#8338ec33;border-color:#8338ec80;transform:translateY(-2px)}.chapter5 .final-revelation-button{background:linear-gradient(135deg,#ff006e1a,#8338ec1a,#4a9eff1a);border:1px solid rgba(255,190,11,.3);font-weight:600;font-size:1.1rem;letter-spacing:.05em}.chapter5 .final-message{max-width:700px;margin:3rem auto;padding:3rem;text-align:center;background:linear-gradient(135deg,#4a9eff08,#8338ec08,#ff006e08);border:1px solid rgba(255,255,255,.1)}.chapter5 .final-message h3{font-size:2.5rem;margin-bottom:2rem;font-weight:700;letter-spacing:-.02em}.chapter5 .final-message p{font-size:1.1rem;line-height:1.8;margin:1.5rem 0;color:var(--text-secondary)}.chapter5 .final-thought{margin:3rem 0;padding:2rem;border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(255,255,255,.1)}.chapter5 .quote{font-size:1.3rem;font-style:italic;color:var(--text-primary);font-weight:300;line-height:1.6}.chapter5 .attribution{margin-top:1rem;font-size:1rem;color:var(--text-tertiary)}.chapter5 .complete-button{margin-top:2rem;background:linear-gradient(135deg,var(--holographic-1),var(--holographic-3));border:none;padding:1rem 2.5rem;font-size:1.1rem;font-weight:600;color:#fff;letter-spacing:.05em;transition:all .3s ease}.chapter5 .complete-button:hover{transform:translateY(-2px);filter:brightness(1.1);box-shadow:0 10px 30px #4a9eff4d}@keyframes pulse{0%,to{transform:scale(1);opacity:.3}50%{transform:scale(1.5);opacity:.1}}@media(max-width:768px){.chapter5 .emergence-container{height:400px}.chapter5 .emergence-labels{gap:1.5rem}.chapter5 .final-message{padding:2rem 1.5rem}.chapter5 .final-message h3{font-size:2rem}.chapter5 .quote{font-size:1.1rem}}.intro-screen{position:relative;width:100%;height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden}.intro-content{position:relative;z-index:10;text-align:center;max-width:800px;padding:2rem}.intro-title{font-size:clamp(3rem,8vw,6rem);font-weight:700;margin-bottom:1rem;line-height:1}.intro-subtitle{font-size:clamp(1.2rem,3vw,1.5rem);color:var(--text-secondary);margin-bottom:3rem;font-weight:300}.intro-description{font-size:clamp(1.2rem,2.5vw,1.8rem);line-height:1.6;margin-bottom:3rem;min-height:4rem}.intro-word{display:inline-block;font-weight:300;color:var(--text-secondary)}.start-button{font-size:1.1rem;padding:1rem 2.5rem;background:#4a9eff1a;border:1px solid rgba(74,158,255,.3);color:var(--text-primary);font-weight:500;letter-spacing:.02em;position:relative;overflow:hidden}.start-button:before{content:"";position:absolute;inset:0;background:radial-gradient(circle at center,rgba(74,158,255,.3) 0%,transparent 70%);opacity:0;transition:opacity .3s ease}.start-button:hover:before{opacity:1}.particle-field{position:absolute;inset:0;pointer-events:none}.particle{position:absolute;width:2px;height:2px;background:#4a9eff99;border-radius:50%;animation:float linear infinite;filter:blur(.5px)}.particle:after{content:"";position:absolute;width:100%;height:100%;background:inherit;border-radius:inherit;animation:pulse 2s ease infinite}@keyframes float{0%{transform:translateY(100vh) rotate(0)}to{transform:translateY(-100vh) rotate(360deg)}}@keyframes pulse{0%,to{opacity:1;transform:scale(1)}50%{opacity:.3;transform:scale(2)}}@media(max-width:768px){.intro-content{padding:1rem}.intro-description{font-size:1.1rem}.start-button{font-size:1rem;padding:.875rem 2rem}}
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script>
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function Ww(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var fM={exports:{}},M0={};var ZC;function VF(){if(ZC)return M0;ZC=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var l in s)l!=="key"&&(r[l]=s[l])}else r=s;return s=r.ref,{$$typeof:i,type:n,key:o,ref:s!==void 0?s:null,props:r}}return M0.Fragment=e,M0.jsx=t,M0.jsxs=t,M0}var KC;function GF(){return KC||(KC=1,fM.exports=VF()),fM.exports}var ee=GF(),dM={exports:{}},an={};var QC;function HF(){if(QC)return an;QC=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),v=Symbol.iterator;function x(B){return B===null||typeof B!="object"?null:(B=v&&B[v]||B["@@iterator"],typeof B=="function"?B:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,M={};function S(B,Q,ae){this.props=B,this.context=Q,this.refs=M,this.updater=ae||b}S.prototype.isReactComponent={},S.prototype.setState=function(B,Q){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,Q,"setState")},S.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function C(){}C.prototype=S.prototype;function R(B,Q,ae){this.props=B,this.context=Q,this.refs=M,this.updater=ae||b}var I=R.prototype=new C;I.constructor=R,w(I,S.prototype),I.isPureReactComponent=!0;var D=Array.isArray;function O(){}var U={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function P(B,Q,ae){var fe=ae.ref;return{$$typeof:i,type:B,key:Q,ref:fe!==void 0?fe:null,props:ae}}function F(B,Q){return P(B.type,Q,B.props)}function H(B){return typeof B=="object"&&B!==null&&B.$$typeof===i}function G(B){var Q={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ae){return Q[ae]})}var j=/\/+/g;function K(B,Q){return typeof B=="object"&&B!==null&&B.key!=null?G(""+B.key):Q.toString(36)}function te(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(O,O):(B.status="pending",B.then(function(Q){B.status==="pending"&&(B.status="fulfilled",B.value=Q)},function(Q){B.status==="pending"&&(B.status="rejected",B.reason=Q)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function W(B,Q,ae,fe,de){var se=typeof B;(se==="undefined"||se==="boolean")&&(B=null);var ce=!1;if(B===null)ce=!0;else switch(se){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(B.$$typeof){case i:case e:ce=!0;break;case p:return ce=B._init,W(ce(B._payload),Q,ae,fe,de)}}if(ce)return de=de(B),ce=fe===""?"."+K(B,0):fe,D(de)?(ae="",ce!=null&&(ae=ce.replace(j,"$&/")+"/"),W(de,Q,ae,"",function(Ye){return Ye})):de!=null&&(H(de)&&(de=F(de,ae+(de.key==null||B&&B.key===de.key?"":(""+de.key).replace(j,"$&/")+"/")+ce)),Q.push(de)),1;ce=0;var pe=fe===""?".":fe+":";if(D(B))for(var Ie=0;Ie<B.length;Ie++)fe=B[Ie],se=pe+K(fe,Ie),ce+=W(fe,Q,ae,se,de);else if(Ie=x(B),typeof Ie=="function")for(B=Ie.call(B),Ie=0;!(fe=B.next()).done;)fe=fe.value,se=pe+K(fe,Ie++),ce+=W(fe,Q,ae,se,de);else if(se==="object"){if(typeof B.then=="function")return W(te(B),Q,ae,fe,de);throw Q=String(B),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return ce}function X(B,Q,ae){if(B==null)return B;var fe=[],de=0;return W(B,fe,"","",function(se){return Q.call(ae,se,de++)}),fe}function oe(B){if(B._status===-1){var Q=B._result;Q=Q(),Q.then(function(ae){(B._status===0||B._status===-1)&&(B._status=1,B._result=ae)},function(ae){(B._status===0||B._status===-1)&&(B._status=2,B._result=ae)}),B._status===-1&&(B._status=0,B._result=Q)}if(B._status===1)return B._result.default;throw B._result}var ne=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},ie={map:X,forEach:function(B,Q,ae){X(B,function(){Q.apply(this,arguments)},ae)},count:function(B){var Q=0;return X(B,function(){Q++}),Q},toArray:function(B){return X(B,function(Q){return Q})||[]},only:function(B){if(!H(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return an.Activity=g,an.Children=ie,an.Component=S,an.Fragment=t,an.Profiler=s,an.PureComponent=R,an.StrictMode=n,an.Suspense=u,an.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,an.__COMPILER_RUNTIME={__proto__:null,c:function(B){return U.H.useMemoCache(B)}},an.cache=function(B){return function(){return B.apply(null,arguments)}},an.cacheSignal=function(){return null},an.cloneElement=function(B,Q,ae){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var fe=w({},B.props),de=B.key;if(Q!=null)for(se in Q.key!==void 0&&(de=""+Q.key),Q)!k.call(Q,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&Q.ref===void 0||(fe[se]=Q[se]);var se=arguments.length-2;if(se===1)fe.children=ae;else if(1<se){for(var ce=Array(se),pe=0;pe<se;pe++)ce[pe]=arguments[pe+2];fe.children=ce}return P(B.type,de,fe)},an.createContext=function(B){return B={$$typeof:o,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:r,_context:B},B},an.createElement=function(B,Q,ae){var fe,de={},se=null;if(Q!=null)for(fe in Q.key!==void 0&&(se=""+Q.key),Q)k.call(Q,fe)&&fe!=="key"&&fe!=="__self"&&fe!=="__source"&&(de[fe]=Q[fe]);var ce=arguments.length-2;if(ce===1)de.children=ae;else if(1<ce){for(var pe=Array(ce),Ie=0;Ie<ce;Ie++)pe[Ie]=arguments[Ie+2];de.children=pe}if(B&&B.defaultProps)for(fe in ce=B.defaultProps,ce)de[fe]===void 0&&(de[fe]=ce[fe]);return P(B,se,de)},an.createRef=function(){return{current:null}},an.forwardRef=function(B){return{$$typeof:l,render:B}},an.isValidElement=H,an.lazy=function(B){return{$$typeof:p,_payload:{_status:-1,_result:B},_init:oe}},an.memo=function(B,Q){return{$$typeof:f,type:B,compare:Q===void 0?null:Q}},an.startTransition=function(B){var Q=U.T,ae={};U.T=ae;try{var fe=B(),de=U.S;de!==null&&de(ae,fe),typeof fe=="object"&&fe!==null&&typeof fe.then=="function"&&fe.then(O,ne)}catch(se){ne(se)}finally{Q!==null&&ae.types!==null&&(Q.types=ae.types),U.T=Q}},an.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},an.use=function(B){return U.H.use(B)},an.useActionState=function(B,Q,ae){return U.H.useActionState(B,Q,ae)},an.useCallback=function(B,Q){return U.H.useCallback(B,Q)},an.useContext=function(B){return U.H.useContext(B)},an.useDebugValue=function(){},an.useDeferredValue=function(B,Q){return U.H.useDeferredValue(B,Q)},an.useEffect=function(B,Q){return U.H.useEffect(B,Q)},an.useEffectEvent=function(B){return U.H.useEffectEvent(B)},an.useId=function(){return U.H.useId()},an.useImperativeHandle=function(B,Q,ae){return U.H.useImperativeHandle(B,Q,ae)},an.useInsertionEffect=function(B,Q){return U.H.useInsertionEffect(B,Q)},an.useLayoutEffect=function(B,Q){return U.H.useLayoutEffect(B,Q)},an.useMemo=function(B,Q){return U.H.useMemo(B,Q)},an.useOptimistic=function(B,Q){return U.H.useOptimistic(B,Q)},an.useReducer=function(B,Q,ae){return U.H.useReducer(B,Q,ae)},an.useRef=function(B){return U.H.useRef(B)},an.useState=function(B){return U.H.useState(B)},an.useSyncExternalStore=function(B,Q,ae){return U.H.useSyncExternalStore(B,Q,ae)},an.useTransition=function(){return U.H.useTransition()},an.version="19.2.3",an}var JC;function Lv(){return JC||(JC=1,dM.exports=HF()),dM.exports}var _e=Lv();const KN=Ww(_e);var pM={exports:{}},T0={},mM={exports:{}},gM={};var $C;function WF(){return $C||($C=1,(function(i){function e(W,X){var oe=W.length;W.push(X);e:for(;0<oe;){var ne=oe-1>>>1,ie=W[ne];if(0<s(ie,X))W[ne]=X,W[oe]=ie,oe=ne;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var X=W[0],oe=W.pop();if(oe!==X){W[0]=oe;e:for(var ne=0,ie=W.length,B=ie>>>1;ne<B;){var Q=2*(ne+1)-1,ae=W[Q],fe=Q+1,de=W[fe];if(0>s(ae,oe))fe<ie&&0>s(de,ae)?(W[ne]=de,W[fe]=oe,ne=fe):(W[ne]=ae,W[Q]=oe,ne=Q);else if(fe<ie&&0>s(de,oe))W[ne]=de,W[fe]=oe,ne=fe;else break e}}return X}function s(W,X){var oe=W.sortIndex-X.sortIndex;return oe!==0?oe:W.id-X.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();i.unstable_now=function(){return o.now()-l}}var u=[],f=[],p=1,g=null,v=3,x=!1,b=!1,w=!1,M=!1,S=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function I(W){for(var X=t(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=W)n(f),X.sortIndex=X.expirationTime,e(u,X);else break;X=t(f)}}function D(W){if(w=!1,I(W),!b)if(t(u)!==null)b=!0,O||(O=!0,G());else{var X=t(f);X!==null&&te(D,X.startTime-W)}}var O=!1,U=-1,k=5,P=-1;function F(){return M?!0:!(i.unstable_now()-P<k)}function H(){if(M=!1,O){var W=i.unstable_now();P=W;var X=!0;try{e:{b=!1,w&&(w=!1,C(U),U=-1),x=!0;var oe=v;try{t:{for(I(W),g=t(u);g!==null&&!(g.expirationTime>W&&F());){var ne=g.callback;if(typeof ne=="function"){g.callback=null,v=g.priorityLevel;var ie=ne(g.expirationTime<=W);if(W=i.unstable_now(),typeof ie=="function"){g.callback=ie,I(W),X=!0;break t}g===t(u)&&n(u),I(W)}else n(u);g=t(u)}if(g!==null)X=!0;else{var B=t(f);B!==null&&te(D,B.startTime-W),X=!1}}break e}finally{g=null,v=oe,x=!1}X=void 0}}finally{X?G():O=!1}}}var G;if(typeof R=="function")G=function(){R(H)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,K=j.port2;j.port1.onmessage=H,G=function(){K.postMessage(null)}}else G=function(){S(H,0)};function te(W,X){U=S(function(){W(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(W){W.callback=null},i.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<W?Math.floor(1e3/W):5},i.unstable_getCurrentPriorityLevel=function(){return v},i.unstable_next=function(W){switch(v){case 1:case 2:case 3:var X=3;break;default:X=v}var oe=v;v=X;try{return W()}finally{v=oe}},i.unstable_requestPaint=function(){M=!0},i.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var oe=v;v=W;try{return X()}finally{v=oe}},i.unstable_scheduleCallback=function(W,X,oe){var ne=i.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?ne+oe:ne):oe=ne,W){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=oe+ie,W={id:p++,callback:X,priorityLevel:W,startTime:oe,expirationTime:ie,sortIndex:-1},oe>ne?(W.sortIndex=oe,e(f,W),t(u)===null&&W===t(f)&&(w?(C(U),U=-1):w=!0,te(D,oe-ne))):(W.sortIndex=ie,e(u,W),b||x||(b=!0,O||(O=!0,G()))),W},i.unstable_shouldYield=F,i.unstable_wrapCallback=function(W){var X=v;return function(){var oe=v;v=X;try{return W.apply(this,arguments)}finally{v=oe}}}})(gM)),gM}var eR;function QN(){return eR||(eR=1,mM.exports=WF()),mM.exports}var vM={exports:{}},Cr={};var tR;function jF(){if(tR)return Cr;tR=1;var i=Lv();function e(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(u,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:u,containerInfo:f,implementation:p}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Cr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Cr.createPortal=function(u,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return r(u,f,null,p)},Cr.flushSync=function(u){var f=o.T,p=n.p;try{if(o.T=null,n.p=2,u)return u()}finally{o.T=f,n.p=p,n.d.f()}},Cr.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(u,f))},Cr.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},Cr.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var p=f.as,g=l(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,x=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?n.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:x}):p==="script"&&n.d.X(u,{crossOrigin:g,integrity:v,fetchPriority:x,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Cr.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=l(f.as,f.crossOrigin);n.d.M(u,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(u)},Cr.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=l(p,f.crossOrigin);n.d.L(u,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Cr.preloadModule=function(u,f){if(typeof u=="string")if(f){var p=l(f.as,f.crossOrigin);n.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(u)},Cr.requestFormReset=function(u){n.d.r(u)},Cr.unstable_batchedUpdates=function(u,f){return u(f)},Cr.useFormState=function(u,f,p){return o.H.useFormState(u,f,p)},Cr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Cr.version="19.2.3",Cr}var nR;function qF(){if(nR)return vM.exports;nR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),vM.exports=jF(),vM.exports}var iR;function XF(){if(iR)return T0;iR=1;var i=QN(),e=Lv(),t=qF();function n(a){var c="https://react.dev/errors/"+a;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function r(a){var c=a,m=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(m=c.return),a=c.return;while(a)}return c.tag===3?m:null}function o(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function l(a){if(a.tag===31){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function u(a){if(r(a)!==a)throw Error(n(188))}function f(a){var c=a.alternate;if(!c){if(c=r(a),c===null)throw Error(n(188));return c!==a?null:a}for(var m=a,y=c;;){var A=m.return;if(A===null)break;var E=A.alternate;if(E===null){if(y=A.return,y!==null){m=y;continue}break}if(A.child===E.child){for(E=A.child;E;){if(E===m)return u(A),a;if(E===y)return u(A),c;E=E.sibling}throw Error(n(188))}if(m.return!==y.return)m=A,y=E;else{for(var z=!1,$=A.child;$;){if($===m){z=!0,m=A,y=E;break}if($===y){z=!0,y=A,m=E;break}$=$.sibling}if(!z){for($=E.child;$;){if($===m){z=!0,m=E,y=A;break}if($===y){z=!0,y=E,m=A;break}$=$.sibling}if(!z)throw Error(n(189))}}if(m.alternate!==y)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?a:c}function p(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a;for(a=a.child;a!==null;){if(c=p(a),c!==null)return c;a=a.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),R=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function G(a){return a===null||typeof a!="object"?null:(a=H&&a[H]||a["@@iterator"],typeof a=="function"?a:null)}var j=Symbol.for("react.client.reference");function K(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===j?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case S:return"Profiler";case M:return"StrictMode";case D:return"Suspense";case O:return"SuspenseList";case P:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case b:return"Portal";case R:return a.displayName||"Context";case C:return(a._context.displayName||"Context")+".Consumer";case I:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case U:return c=a.displayName||null,c!==null?c:K(a.type)||"Memo";case k:c=a._payload,a=a._init;try{return K(a(c))}catch{}}return null}var te=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},ne=[],ie=-1;function B(a){return{current:a}}function Q(a){0>ie||(a.current=ne[ie],ne[ie]=null,ie--)}function ae(a,c){ie++,ne[ie]=a.current,a.current=c}var fe=B(null),de=B(null),se=B(null),ce=B(null);function pe(a,c){switch(ae(se,c),ae(de,a),ae(fe,null),c.nodeType){case 9:case 11:a=(a=c.documentElement)&&(a=a.namespaceURI)?yC(a):0;break;default:if(a=c.tagName,c=c.namespaceURI)c=yC(c),a=_C(c,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}Q(fe),ae(fe,a)}function Ie(){Q(fe),Q(de),Q(se)}function Ye(a){a.memoizedState!==null&&ae(ce,a);var c=fe.current,m=_C(c,a.type);c!==m&&(ae(de,a),ae(fe,m))}function et(a){de.current===a&&(Q(fe),Q(de)),ce.current===a&&(Q(ce),_0._currentValue=oe)}var qe,dt;function De(a){if(qe===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);qe=c&&c[1]||"",dt=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qe+a+dt}var ge=!1;function ye(a,c){if(!a||ge)return"";ge=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(c){var ot=function(){throw Error()};if(Object.defineProperty(ot.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ot,[])}catch(Ke){var Ve=Ke}Reflect.construct(a,[],ot)}else{try{ot.call()}catch(Ke){Ve=Ke}a.call(ot.prototype)}}else{try{throw Error()}catch(Ke){Ve=Ke}(ot=a())&&typeof ot.catch=="function"&&ot.catch(function(){})}}catch(Ke){if(Ke&&Ve&&typeof Ke.stack=="string")return[Ke.stack,Ve.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=y.DetermineComponentFrameRoot(),z=E[0],$=E[1];if(z&&$){var me=z.split(`
`),Fe=$.split(`
`);for(A=y=0;y<me.length&&!me[y].includes("DetermineComponentFrameRoot");)y++;for(;A<Fe.length&&!Fe[A].includes("DetermineComponentFrameRoot");)A++;if(y===me.length||A===Fe.length)for(y=me.length-1,A=Fe.length-1;1<=y&&0<=A&&me[y]!==Fe[A];)A--;for(;1<=y&&0<=A;y--,A--)if(me[y]!==Fe[A]){if(y!==1||A!==1)do if(y--,A--,0>A||me[y]!==Fe[A]){var nt=`
`+me[y].replace(" at new "," at ");return a.displayName&&nt.includes("<anonymous>")&&(nt=nt.replace("<anonymous>",a.displayName)),nt}while(1<=y&&0<=A);break}}}finally{ge=!1,Error.prepareStackTrace=m}return(m=a?a.displayName||a.name:"")?De(m):""}function Ge(a,c){switch(a.tag){case 26:case 27:case 5:return De(a.type);case 16:return De("Lazy");case 13:return a.child!==c&&c!==null?De("Suspense Fallback"):De("Suspense");case 19:return De("SuspenseList");case 0:case 15:return ye(a.type,!1);case 11:return ye(a.type.render,!1);case 1:return ye(a.type,!0);case 31:return De("Activity");default:return""}}function Y(a){try{var c="",m=null;do c+=Ge(a,m),m=a,a=a.return;while(a);return c}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}var Be=Object.prototype.hasOwnProperty,Ne=i.unstable_scheduleCallback,Me=i.unstable_cancelCallback,Oe=i.unstable_shouldYield,q=i.unstable_requestPaint,V=i.unstable_now,ue=i.unstable_getCurrentPriorityLevel,Re=i.unstable_ImmediatePriority,we=i.unstable_UserBlockingPriority,be=i.unstable_NormalPriority,it=i.unstable_LowPriority,tt=i.unstable_IdlePriority,ht=i.log,yt=i.unstable_setDisableYieldValue,He=null,Xe=null;function Qe(a){if(typeof ht=="function"&&yt(a),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(He,a)}catch{}}var le=Math.clz32?Math.clz32:he,Te=Math.log,ct=Math.LN2;function he(a){return a>>>=0,a===0?32:31-(Te(a)/ct|0)|0}var We=256,Je=262144,pt=4194304;function $e(a){var c=a&42;if(c!==0)return c;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Le(a,c,m){var y=a.pendingLanes;if(y===0)return 0;var A=0,E=a.suspendedLanes,z=a.pingedLanes;a=a.warmLanes;var $=y&134217727;return $!==0?(y=$&~E,y!==0?A=$e(y):(z&=$,z!==0?A=$e(z):m||(m=$&~a,m!==0&&(A=$e(m))))):($=y&~E,$!==0?A=$e($):z!==0?A=$e(z):m||(m=y&~a,m!==0&&(A=$e(m)))),A===0?0:c!==0&&c!==A&&(c&E)===0&&(E=A&-A,m=c&-c,E>=m||E===32&&(m&4194048)!==0)?c:A}function rt(a,c){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&c)===0}function xt(a,c){switch(a){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _t(){var a=pt;return pt<<=1,(pt&62914560)===0&&(pt=4194304),a}function Nt(a){for(var c=[],m=0;31>m;m++)c.push(a);return c}function pn(a,c){a.pendingLanes|=c,c!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Mn(a,c,m,y,A,E){var z=a.pendingLanes;a.pendingLanes=m,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=m,a.entangledLanes&=m,a.errorRecoveryDisabledLanes&=m,a.shellSuspendCounter=0;var $=a.entanglements,me=a.expirationTimes,Fe=a.hiddenUpdates;for(m=z&~m;0<m;){var nt=31-le(m),ot=1<<nt;$[nt]=0,me[nt]=-1;var Ve=Fe[nt];if(Ve!==null)for(Fe[nt]=null,nt=0;nt<Ve.length;nt++){var Ke=Ve[nt];Ke!==null&&(Ke.lane&=-536870913)}m&=~ot}y!==0&&Zn(a,y,0),E!==0&&A===0&&a.tag!==0&&(a.suspendedLanes|=E&~(z&~c))}function Zn(a,c,m){a.pendingLanes|=c,a.suspendedLanes&=~c;var y=31-le(c);a.entangledLanes|=c,a.entanglements[y]=a.entanglements[y]|1073741824|m&261930}function Ji(a,c){var m=a.entangledLanes|=c;for(a=a.entanglements;m;){var y=31-le(m),A=1<<y;A&c|a[y]&c&&(a[y]|=c),m&=~A}}function Gs(a,c){var m=c&-c;return m=(m&42)!==0?1:ys(m),(m&(a.suspendedLanes|c))!==0?0:m}function ys(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function _s(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function nr(){var a=X.p;return a!==0?a:(a=window.event,a===void 0?32:GC(a.type))}function ni(a,c){var m=X.p;try{return X.p=a,c()}finally{X.p=m}}var jn=Math.random().toString(36).slice(2),Fn="__reactFiber$"+jn,Ni="__reactProps$"+jn,Ns="__reactContainer$"+jn,ir="__reactEvents$"+jn,Hs="__reactListeners$"+jn,zr="__reactHandles$"+jn,Xa="__reactResources$"+jn,Vr="__reactMarker$"+jn;function fa(a){delete a[Fn],delete a[Ni],delete a[ir],delete a[Hs],delete a[zr]}function vr(a){var c=a[Fn];if(c)return c;for(var m=a.parentNode;m;){if(c=m[Ns]||m[Fn]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(a=AC(a);a!==null;){if(m=a[Fn])return m;a=AC(a)}return c}a=m,m=a.parentNode}return null}function Gr(a){if(a=a[Fn]||a[Ns]){var c=a.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return a}return null}function da(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a.stateNode;throw Error(n(33))}function Dt(a){var c=a[Xa];return c||(c=a[Xa]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function J(a){a[Vr]=!0}var Se=new Set,ze={};function Pe(a,c){Ae(a,c),Ae(a+"Capture",c)}function Ae(a,c){for(ze[a]=c,a=0;a<c.length;a++)Se.add(c[a])}var mt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mt={},ut={};function Et(a){return Be.call(ut,a)?!0:Be.call(Mt,a)?!1:mt.test(a)?ut[a]=!0:(Mt[a]=!0,!1)}function Ct(a,c,m){if(Et(c))if(m===null)a.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":a.removeAttribute(c);return;case"boolean":var y=c.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){a.removeAttribute(c);return}}a.setAttribute(c,""+m)}}function Ft(a,c,m){if(m===null)a.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttribute(c,""+m)}}function Rt(a,c,m,y){if(y===null)a.removeAttribute(m);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(m);return}a.setAttributeNS(c,m,""+y)}}function Bt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function mn(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Vn(a,c,m){var y=Object.getOwnPropertyDescriptor(a.constructor.prototype,c);if(!a.hasOwnProperty(c)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var A=y.get,E=y.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return A.call(this)},set:function(z){m=""+z,E.call(this,z)}}),Object.defineProperty(a,c,{enumerable:y.enumerable}),{getValue:function(){return m},setValue:function(z){m=""+z},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Cn(a){if(!a._valueTracker){var c=mn(a)?"checked":"value";a._valueTracker=Vn(a,c,""+a[c])}}function Xt(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var m=c.getValue(),y="";return a&&(y=mn(a)?a.checked?"true":"false":a.value),a=y,a!==m?(c.setValue(a),!0):!1}function bt(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var vn=/[\n"\\]/g;function Pt(a){return a.replace(vn,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Ii(a,c,m,y,A,E,z,$){a.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?a.type=z:a.removeAttribute("type"),c!=null?z==="number"?(c===0&&a.value===""||a.value!=c)&&(a.value=""+Bt(c)):a.value!==""+Bt(c)&&(a.value=""+Bt(c)):z!=="submit"&&z!=="reset"||a.removeAttribute("value"),c!=null?kn(a,z,Bt(c)):m!=null?kn(a,z,Bt(m)):y!=null&&a.removeAttribute("value"),A==null&&E!=null&&(a.defaultChecked=!!E),A!=null&&(a.checked=A&&typeof A!="function"&&typeof A!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?a.name=""+Bt($):a.removeAttribute("name")}function Ws(a,c,m,y,A,E,z,$){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(a.type=E),c!=null||m!=null){if(!(E!=="submit"&&E!=="reset"||c!=null)){Cn(a);return}m=m!=null?""+Bt(m):"",c=c!=null?""+Bt(c):m,$||c===a.value||(a.value=c),a.defaultValue=c}y=y??A,y=typeof y!="function"&&typeof y!="symbol"&&!!y,a.checked=$?a.checked:!!y,a.defaultChecked=!!y,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(a.name=z),Cn(a)}function kn(a,c,m){c==="number"&&bt(a.ownerDocument)===a||a.defaultValue===""+m||(a.defaultValue=""+m)}function xs(a,c,m,y){if(a=a.options,c){c={};for(var A=0;A<m.length;A++)c["$"+m[A]]=!0;for(m=0;m<a.length;m++)A=c.hasOwnProperty("$"+a[m].value),a[m].selected!==A&&(a[m].selected=A),A&&y&&(a[m].defaultSelected=!0)}else{for(m=""+Bt(m),c=null,A=0;A<a.length;A++){if(a[A].value===m){a[A].selected=!0,y&&(a[A].defaultSelected=!0);return}c!==null||a[A].disabled||(c=a[A])}c!==null&&(c.selected=!0)}}function Tn(a,c,m){if(c!=null&&(c=""+Bt(c),c!==a.value&&(a.value=c),m==null)){a.defaultValue!==c&&(a.defaultValue=c);return}a.defaultValue=m!=null?""+Bt(m):""}function mi(a,c,m,y){if(c==null){if(y!=null){if(m!=null)throw Error(n(92));if(te(y)){if(1<y.length)throw Error(n(93));y=y[0]}m=y}m==null&&(m=""),c=m}m=Bt(c),a.defaultValue=m,y=a.textContent,y===m&&y!==""&&y!==null&&(a.value=y),Cn(a)}function gi(a,c){if(c){var m=a.firstChild;if(m&&m===a.lastChild&&m.nodeType===3){m.nodeValue=c;return}}a.textContent=c}var Bi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zi(a,c,m){var y=c.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?y?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="":y?a.setProperty(c,m):typeof m!="number"||m===0||Bi.has(c)?c==="float"?a.cssFloat=m:a[c]=(""+m).trim():a[c]=m+"px"}function Ya(a,c,m){if(c!=null&&typeof c!="object")throw Error(n(62));if(a=a.style,m!=null){for(var y in m)!m.hasOwnProperty(y)||c!=null&&c.hasOwnProperty(y)||(y.indexOf("--")===0?a.setProperty(y,""):y==="float"?a.cssFloat="":a[y]="");for(var A in c)y=c[A],c.hasOwnProperty(A)&&m[A]!==y&&zi(a,A,y)}else for(var E in c)c.hasOwnProperty(E)&&zi(a,E,c[E])}function bs(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ef=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pa(a){return Pl.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function js(){}var fo=null;function Ic(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Hr=null,ma=null;function Oc(a){var c=Gr(a);if(c&&(a=c.stateNode)){var m=a[Ni]||null;e:switch(a=c.stateNode,c.type){case"input":if(Ii(a,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),c=m.name,m.type==="radio"&&c!=null){for(m=a;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Pt(""+c)+'"][type="radio"]'),c=0;c<m.length;c++){var y=m[c];if(y!==a&&y.form===a.form){var A=y[Ni]||null;if(!A)throw Error(n(90));Ii(y,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(c=0;c<m.length;c++)y=m[c],y.form===a.form&&Xt(y)}break e;case"textarea":Tn(a,m.value,m.defaultValue);break e;case"select":c=m.value,c!=null&&xs(a,!!m.multiple,c,!1)}}}var Pc=!1;function Ul(a,c,m){if(Pc)return a(c,m);Pc=!0;try{var y=a(c);return y}finally{if(Pc=!1,(Hr!==null||ma!==null)&&(no(),Hr&&(c=Hr,a=ma,ma=Hr=null,Oc(c),a)))for(c=0;c<a.length;c++)Oc(a[c])}}function po(a,c){var m=a.stateNode;if(m===null)return null;var y=m[Ni]||null;if(y===null)return null;m=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(m&&typeof m!="function")throw Error(n(231,c,typeof m));return m}var Wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sr=!1;if(Wr)try{var mo={};Object.defineProperty(mo,"passive",{get:function(){sr=!0}}),window.addEventListener("test",mo,mo),window.removeEventListener("test",mo,mo)}catch{sr=!1}var qs=null,Uc=null,Za=null;function Ll(){if(Za)return Za;var a,c=Uc,m=c.length,y,A="value"in qs?qs.value:qs.textContent,E=A.length;for(a=0;a<m&&c[a]===A[a];a++);var z=m-a;for(y=1;y<=z&&c[m-y]===A[E-y];y++);return Za=A.slice(a,1<y?1-y:void 0)}function Fl(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function ga(){return!0}function kl(){return!1}function vi(a){function c(m,y,A,E,z){this._reactName=m,this._targetInst=A,this.type=y,this.nativeEvent=E,this.target=z,this.currentTarget=null;for(var $ in a)a.hasOwnProperty($)&&(m=a[$],this[$]=m?m(E):E[$]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?ga:kl,this.isPropagationStopped=kl,this}return g(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=ga)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=ga)},persist:function(){},isPersistent:ga}),c}var Ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jo=vi(Ka),go=g({},Ka,{view:0,detail:0}),Bl=vi(go),zl,vo,yo,$i=g({},go,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==yo&&(yo&&a.type==="mousemove"?(zl=a.screenX-yo.screenX,vo=a.screenY-yo.screenY):vo=zl=0,yo=a),zl)},movementY:function(a){return"movementY"in a?a.movementY:vo}}),tf=vi($i),Lc=g({},$i,{dataTransfer:0}),Fc=vi(Lc),Fu=g({},go,{relatedTarget:0}),ku=vi(Fu),Is=g({},Ka,{animationName:0,elapsedTime:0,pseudoElement:0}),jr=vi(Is),Xs=g({},Ka,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Qa=vi(Xs),Vl=g({},Ka,{data:0}),kd=vi(Vl),Bd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rg(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=fy[a])?!!c[a]:!1}function zd(){return rg}var dy=g({},go,{key:function(a){if(a.key){var c=Bd[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Fl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?hy[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return a.type==="keypress"?Fl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Fl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),kc=vi(dy),Vd=g({},$i,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ag=vi(Vd),og=g({},go,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),py=vi(og),my=g({},Ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),PS=vi(my),Os=g({},$i,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),gy=vi(Os),vy=g({},Ka,{newState:0,oldState:0}),yy=vi(vy),_y=[9,13,27,32],Bc=Wr&&"CompositionEvent"in window,Bu=null;Wr&&"documentMode"in document&&(Bu=document.documentMode);var Gd=Wr&&"TextEvent"in window&&!Bu,lg=Wr&&(!Bc||Bu&&8<Bu&&11>=Bu),xy=" ",nf=!1;function Hd(a,c){switch(a){case"keyup":return _y.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cg(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var zc=!1;function by(a,c){switch(a){case"compositionend":return cg(c);case"keypress":return c.which!==32?null:(nf=!0,xy);case"textInput":return a=c.data,a===xy&&nf?null:a;default:return null}}function ug(a,c){if(zc)return a==="compositionend"||!Bc&&Hd(a,c)?(a=Ll(),Za=Uc=qs=null,zc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return lg&&c.locale!=="ko"?null:c.data;default:return null}}var hg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fg(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!hg[a.type]:c==="textarea"}function Wd(a,c,m,y){Hr?ma?ma.push(y):ma=[y]:Hr=y,c=A_(c,"onChange"),0<c.length&&(m=new Jo("onChange","change",null,m,y),a.push({event:m,listeners:c}))}var Gl=null,Vc=null;function Sy(a){fC(a,0)}function zu(a){var c=da(a);if(Xt(c))return a}function dg(a,c){if(a==="change")return c}var _o=!1;if(Wr){var sf;if(Wr){var pg="oninput"in document;if(!pg){var mg=document.createElement("div");mg.setAttribute("oninput","return;"),pg=typeof mg.oninput=="function"}sf=pg}else sf=!1;_o=sf&&(!document.documentMode||9<document.documentMode)}function va(){Gl&&(Gl.detachEvent("onpropertychange",rf),Vc=Gl=null)}function rf(a){if(a.propertyName==="value"&&zu(Vc)){var c=[];Wd(c,Vc,a,Ic(a)),Ul(Sy,c)}}function My(a,c,m){a==="focusin"?(va(),Gl=c,Vc=m,Gl.attachEvent("onpropertychange",rf)):a==="focusout"&&va()}function gg(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return zu(Vc)}function Ty(a,c){if(a==="click")return zu(c)}function wy(a,c){if(a==="input"||a==="change")return zu(c)}function vg(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var rr=typeof Object.is=="function"?Object.is:vg;function Vu(a,c){if(rr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var m=Object.keys(a),y=Object.keys(c);if(m.length!==y.length)return!1;for(y=0;y<m.length;y++){var A=m[y];if(!Be.call(c,A)||!rr(a[A],c[A]))return!1}return!0}function af(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Gu(a,c){var m=af(a);a=0;for(var y;m;){if(m.nodeType===3){if(y=a+m.textContent.length,a<=c&&y>=c)return{node:m,offset:c-a};a=y}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=af(m)}}function ii(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?ii(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function Ay(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var c=bt(a.document);c instanceof a.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)a=c.contentWindow;else break;c=bt(a.document)}return c}function yg(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}var Ey=Wr&&"documentMode"in document&&11>=document.documentMode,xo=null,bo=null,Hu=null,jd=!1;function Wu(a,c,m){var y=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;jd||xo==null||xo!==bt(y)||(y=xo,"selectionStart"in y&&yg(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Hu&&Vu(Hu,y)||(Hu=y,y=A_(bo,"onSelect"),0<y.length&&(c=new Jo("onSelect","select",null,c,m),a.push({event:c,listeners:y}),c.target=xo)))}function Ys(a,c){var m={};return m[a.toLowerCase()]=c.toLowerCase(),m["Webkit"+a]="webkit"+c,m["Moz"+a]="moz"+c,m}var Gc={animationend:Ys("Animation","AnimationEnd"),animationiteration:Ys("Animation","AnimationIteration"),animationstart:Ys("Animation","AnimationStart"),transitionrun:Ys("Transition","TransitionRun"),transitionstart:Ys("Transition","TransitionStart"),transitioncancel:Ys("Transition","TransitionCancel"),transitionend:Ys("Transition","TransitionEnd")},of={},_g={};Wr&&(_g=document.createElement("div").style,"AnimationEvent"in window||(delete Gc.animationend.animation,delete Gc.animationiteration.animation,delete Gc.animationstart.animation),"TransitionEvent"in window||delete Gc.transitionend.transition);function $o(a){if(of[a])return of[a];if(!Gc[a])return a;var c=Gc[a],m;for(m in c)if(c.hasOwnProperty(m)&&m in _g)return of[a]=c[m];return a}var qd=$o("animationend"),lf=$o("animationiteration"),xg=$o("animationstart"),Cy=$o("transitionrun"),US=$o("transitionstart"),Ry=$o("transitioncancel"),bg=$o("transitionend"),ya=new Map,cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cf.push("scrollEnd");function _a(a,c){ya.set(a,c),Pe(c,[a])}var uf=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},xa=[],el=0,Ss=0;function hf(){for(var a=el,c=Ss=el=0;c<a;){var m=xa[c];xa[c++]=null;var y=xa[c];xa[c++]=null;var A=xa[c];xa[c++]=null;var E=xa[c];if(xa[c++]=null,y!==null&&A!==null){var z=y.pending;z===null?A.next=A:(A.next=z.next,z.next=A),y.pending=A}E!==0&&Hl(m,A,E)}}function Ms(a,c,m,y){xa[el++]=a,xa[el++]=c,xa[el++]=m,xa[el++]=y,Ss|=y,a.lanes|=y,a=a.alternate,a!==null&&(a.lanes|=y)}function Xd(a,c,m,y){return Ms(a,c,m,y),ba(a)}function ar(a,c){return Ms(a,null,null,c),ba(a)}function Hl(a,c,m){a.lanes|=m;var y=a.alternate;y!==null&&(y.lanes|=m);for(var A=!1,E=a.return;E!==null;)E.childLanes|=m,y=E.alternate,y!==null&&(y.childLanes|=m),E.tag===22&&(a=E.stateNode,a===null||a._visibility&1||(A=!0)),a=E,E=E.return;return a.tag===3?(E=a.stateNode,A&&c!==null&&(A=31-le(m),a=E.hiddenUpdates,y=a[A],y===null?a[A]=[c]:y.push(c),c.lane=m|536870912),E):null}function ba(a){if(50<lc)throw lc=0,ou=null,Error(n(185));for(var c=a.return;c!==null;)a=c,c=a.return;return a.tag===3?a.stateNode:null}var Wl={};function Sg(a,c,m,y){this.tag=a,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mi(a,c,m,y){return new Sg(a,c,m,y)}function Yd(a){return a=a.prototype,!(!a||!a.isReactComponent)}function yr(a,c){var m=a.alternate;return m===null?(m=Mi(a.tag,c,a.key,a.mode),m.elementType=a.elementType,m.type=a.type,m.stateNode=a.stateNode,m.alternate=a,a.alternate=m):(m.pendingProps=c,m.type=a.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=a.flags&65011712,m.childLanes=a.childLanes,m.lanes=a.lanes,m.child=a.child,m.memoizedProps=a.memoizedProps,m.memoizedState=a.memoizedState,m.updateQueue=a.updateQueue,c=a.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=a.sibling,m.index=a.index,m.ref=a.ref,m.refCleanup=a.refCleanup,m}function ju(a,c){a.flags&=65011714;var m=a.alternate;return m===null?(a.childLanes=0,a.lanes=c,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=m.childLanes,a.lanes=m.lanes,a.child=m.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=m.memoizedProps,a.memoizedState=m.memoizedState,a.updateQueue=m.updateQueue,a.type=m.type,c=m.dependencies,a.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),a}function So(a,c,m,y,A,E){var z=0;if(y=a,typeof a=="function")Yd(a)&&(z=1);else if(typeof a=="string")z=RF(a,m,fe.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case P:return a=Mi(31,m,c,A),a.elementType=P,a.lanes=E,a;case w:return jl(m.children,A,E,c);case M:z=8,A|=24;break;case S:return a=Mi(12,m,c,A|2),a.elementType=S,a.lanes=E,a;case D:return a=Mi(13,m,c,A),a.elementType=D,a.lanes=E,a;case O:return a=Mi(19,m,c,A),a.elementType=O,a.lanes=E,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case R:z=10;break e;case C:z=9;break e;case I:z=11;break e;case U:z=14;break e;case k:z=16,y=null;break e}z=29,m=Error(n(130,a===null?"null":typeof a,"")),y=null}return c=Mi(z,m,c,A),c.elementType=a,c.type=y,c.lanes=E,c}function jl(a,c,m,y){return a=Mi(7,a,y,c),a.lanes=m,a}function Zd(a,c,m){return a=Mi(6,a,null,c),a.lanes=m,a}function qu(a){var c=Mi(18,null,null,0);return c.stateNode=a,c}function Kd(a,c,m){return c=Mi(4,a.children!==null?a.children:[],a.key,c),c.lanes=m,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}var ff=new WeakMap;function qr(a,c){if(typeof a=="object"&&a!==null){var m=ff.get(a);return m!==void 0?m:(c={value:a,source:c,stack:Y(c)},ff.set(a,c),c)}return{value:a,source:c,stack:Y(c)}}var ql=[],Xl=0,Xu=null,Yu=0,_r=[],yi=0,tl=null,Ti=1,Ja="";function Mo(a,c){ql[Xl++]=Yu,ql[Xl++]=Xu,Xu=a,Yu=c}function Dy(a,c,m){_r[yi++]=Ti,_r[yi++]=Ja,_r[yi++]=tl,tl=a;var y=Ti;a=Ja;var A=32-le(y)-1;y&=~(1<<A),m+=1;var E=32-le(c)+A;if(30<E){var z=A-A%5;E=(y&(1<<z)-1).toString(32),y>>=z,A-=z,Ti=1<<32-le(c)+A|m<<A|y,Ja=E+a}else Ti=1<<E|m<<A|y,Ja=a}function To(a){a.return!==null&&(Mo(a,1),Dy(a,1,0))}function Qd(a){for(;a===Xu;)Xu=ql[--Xl],ql[Xl]=null,Yu=ql[--Xl],ql[Xl]=null;for(;a===tl;)tl=_r[--yi],_r[yi]=null,Ja=_r[--yi],_r[yi]=null,Ti=_r[--yi],_r[yi]=null}function Jd(a,c){_r[yi++]=Ti,_r[yi++]=Ja,_r[yi++]=tl,Ti=c.id,Ja=c.overflow,tl=a}var Oi=null,si=null,wn=!1,nl=null,Xr=!1,Zu=Error(n(519));function wo(a){var c=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ao(qr(c,a)),Zu}function Ny(a){var c=a.stateNode,m=a.type,y=a.memoizedProps;switch(c[Fn]=a,c[Ni]=y,m){case"dialog":Dn("cancel",c),Dn("close",c);break;case"iframe":case"object":case"embed":Dn("load",c);break;case"video":case"audio":for(m=0;m<Pa.length;m++)Dn(Pa[m],c);break;case"source":Dn("error",c);break;case"img":case"image":case"link":Dn("error",c),Dn("load",c);break;case"details":Dn("toggle",c);break;case"input":Dn("invalid",c),Ws(c,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0);break;case"select":Dn("invalid",c);break;case"textarea":Dn("invalid",c),mi(c,y.value,y.defaultValue,y.children)}m=y.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||c.textContent===""+m||y.suppressHydrationWarning===!0||gC(c.textContent,m)?(y.popover!=null&&(Dn("beforetoggle",c),Dn("toggle",c)),y.onScroll!=null&&Dn("scroll",c),y.onScrollEnd!=null&&Dn("scrollend",c),y.onClick!=null&&(c.onclick=js),c=!0):c=!1,c||wo(a,!0)}function Iy(a){for(Oi=a.return;Oi;)switch(Oi.tag){case 5:case 31:case 13:Xr=!1;return;case 27:case 3:Xr=!0;return;default:Oi=Oi.return}}function Ku(a){if(a!==Oi)return!1;if(!wn)return Iy(a),wn=!0,!1;var c=a.tag,m;if((m=c!==3&&c!==27)&&((m=c===5)&&(m=a.type,m=!(m!=="form"&&m!=="button")||QS(a.type,a.memoizedProps)),m=!m),m&&si&&wo(a),Iy(a),c===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));si=wC(a)}else if(c===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));si=wC(a)}else c===27?(c=si,gh(a.type)?(a=nM,nM=null,si=a):si=c):si=Oi?zo(a.stateNode.nextSibling):null;return!0}function Yl(){si=Oi=null,wn=!1}function $d(){var a=nl;return a!==null&&(Ui===null?Ui=a:Ui.push.apply(Ui,a),nl=null),a}function Ao(a){nl===null?nl=[a]:nl.push(a)}var Qu=B(null),Zl=null,Eo=null;function il(a,c,m){ae(Qu,c._currentValue),c._currentValue=m}function Co(a){a._currentValue=Qu.current,Q(Qu)}function ep(a,c,m){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===m)break;a=a.return}}function tp(a,c,m,y){var A=a.child;for(A!==null&&(A.return=a);A!==null;){var E=A.dependencies;if(E!==null){var z=A.child;E=E.firstContext;e:for(;E!==null;){var $=E;E=A;for(var me=0;me<c.length;me++)if($.context===c[me]){E.lanes|=m,$=E.alternate,$!==null&&($.lanes|=m),ep(E.return,m,a),y||(z=null);break e}E=$.next}}else if(A.tag===18){if(z=A.return,z===null)throw Error(n(341));z.lanes|=m,E=z.alternate,E!==null&&(E.lanes|=m),ep(z,m,a),z=null}else z=A.child;if(z!==null)z.return=A;else for(z=A;z!==null;){if(z===a){z=null;break}if(A=z.sibling,A!==null){A.return=z.return,z=A;break}z=z.return}A=z}}function Ro(a,c,m,y){a=null;for(var A=c,E=!1;A!==null;){if(!E){if((A.flags&524288)!==0)E=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var z=A.alternate;if(z===null)throw Error(n(387));if(z=z.memoizedProps,z!==null){var $=A.type;rr(A.pendingProps.value,z.value)||(a!==null?a.push($):a=[$])}}else if(A===ce.current){if(z=A.alternate,z===null)throw Error(n(387));z.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(a!==null?a.push(_0):a=[_0])}A=A.return}a!==null&&tp(c,a,m,y),c.flags|=262144}function df(a){for(a=a.firstContext;a!==null;){if(!rr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Kl(a){Zl=a,Eo=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Yt(a){return Oy(Zl,a)}function Ju(a,c){return Zl===null&&Kl(a),Oy(a,c)}function Oy(a,c){var m=c._currentValue;if(c={context:c,memoizedValue:m,next:null},Eo===null){if(a===null)throw Error(n(308));Eo=c,a.dependencies={lanes:0,firstContext:c},a.flags|=524288}else Eo=Eo.next=c;return m}var Py=typeof AbortController<"u"?AbortController:function(){var a=[],c=this.signal={aborted:!1,addEventListener:function(m,y){a.push(y)}};this.abort=function(){c.aborted=!0,a.forEach(function(m){return m()})}},LS=i.unstable_scheduleCallback,FS=i.unstable_NormalPriority,es={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Mg(){return{controller:new Py,data:new Map,refCount:0}}function Hc(a){a.refCount--,a.refCount===0&&LS(FS,function(){a.controller.abort()})}var Yr=null,np=0,sl=0,Sa=null;function Tg(a,c){if(Yr===null){var m=Yr=[];np=0,sl=je(),Sa={status:"pending",value:void 0,then:function(y){m.push(y)}}}return np++,c.then(wg,wg),c}function wg(){if(--np===0&&Yr!==null){Sa!==null&&(Sa.status="fulfilled");var a=Yr;Yr=null,sl=0,Sa=null;for(var c=0;c<a.length;c++)(0,a[c])()}}function Ag(a,c){var m=[],y={status:"pending",value:null,reason:null,then:function(A){m.push(A)}};return a.then(function(){y.status="fulfilled",y.value=c;for(var A=0;A<m.length;A++)(0,m[A])(c)},function(A){for(y.status="rejected",y.reason=A,A=0;A<m.length;A++)(0,m[A])(void 0)}),y}var Uy=W.S;W.S=function(a,c){d0=V(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&Tg(a,c),Uy!==null&&Uy(a,c)};var Ql=B(null);function ip(){var a=Ql.current;return a!==null?a:Jt.pooledCache}function pf(a,c){c===null?ae(Ql,Ql.current):ae(Ql,c.pool)}function Eg(){var a=ip();return a===null?null:{parent:es._currentValue,pool:a}}var Wc=Error(n(460)),mf=Error(n(474)),cn=Error(n(542)),sp={then:function(){}};function xr(a){return a=a.status,a==="fulfilled"||a==="rejected"}function rp(a,c,m){switch(m=a[m],m===void 0?a.push(c):m!==c&&(c.then(js,js),c=m),c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,Xc(a),a;default:if(typeof c.status=="string")c.then(js,js);else{if(a=Jt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=c,a.status="pending",a.then(function(y){if(c.status==="pending"){var A=c;A.status="fulfilled",A.value=y}},function(y){if(c.status==="pending"){var A=c;A.status="rejected",A.reason=y}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,Xc(a),a}throw Do=c,Wc}}function jc(a){try{var c=a._init;return c(a._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(Do=m,Wc):m}}var Do=null;function qc(){if(Do===null)throw Error(n(459));var a=Do;return Do=null,a}function Xc(a){if(a===Wc||a===cn)throw Error(n(483))}var Yc=null,Zc=0;function gf(a){var c=Zc;return Zc+=1,Yc===null&&(Yc=[]),rp(Yc,a,c)}function Ma(a,c){c=c.props.ref,a.ref=c!==void 0?c:null}function $u(a,c){throw c.$$typeof===v?Error(n(525)):(a=Object.prototype.toString.call(c),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a)))}function ap(a){function c(Ee,xe){if(a){var Ue=Ee.deletions;Ue===null?(Ee.deletions=[xe],Ee.flags|=16):Ue.push(xe)}}function m(Ee,xe){if(!a)return null;for(;xe!==null;)c(Ee,xe),xe=xe.sibling;return null}function y(Ee){for(var xe=new Map;Ee!==null;)Ee.key!==null?xe.set(Ee.key,Ee):xe.set(Ee.index,Ee),Ee=Ee.sibling;return xe}function A(Ee,xe){return Ee=yr(Ee,xe),Ee.index=0,Ee.sibling=null,Ee}function E(Ee,xe,Ue){return Ee.index=Ue,a?(Ue=Ee.alternate,Ue!==null?(Ue=Ue.index,Ue<xe?(Ee.flags|=67108866,xe):Ue):(Ee.flags|=67108866,xe)):(Ee.flags|=1048576,xe)}function z(Ee){return a&&Ee.alternate===null&&(Ee.flags|=67108866),Ee}function $(Ee,xe,Ue,at){return xe===null||xe.tag!==6?(xe=Zd(Ue,Ee.mode,at),xe.return=Ee,xe):(xe=A(xe,Ue),xe.return=Ee,xe)}function me(Ee,xe,Ue,at){var Vt=Ue.type;return Vt===w?nt(Ee,xe,Ue.props.children,at,Ue.key):xe!==null&&(xe.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===k&&jc(Vt)===xe.type)?(xe=A(xe,Ue.props),Ma(xe,Ue),xe.return=Ee,xe):(xe=So(Ue.type,Ue.key,Ue.props,null,Ee.mode,at),Ma(xe,Ue),xe.return=Ee,xe)}function Fe(Ee,xe,Ue,at){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Ue.containerInfo||xe.stateNode.implementation!==Ue.implementation?(xe=Kd(Ue,Ee.mode,at),xe.return=Ee,xe):(xe=A(xe,Ue.children||[]),xe.return=Ee,xe)}function nt(Ee,xe,Ue,at,Vt){return xe===null||xe.tag!==7?(xe=jl(Ue,Ee.mode,at,Vt),xe.return=Ee,xe):(xe=A(xe,Ue),xe.return=Ee,xe)}function ot(Ee,xe,Ue){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return xe=Zd(""+xe,Ee.mode,Ue),xe.return=Ee,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case x:return Ue=So(xe.type,xe.key,xe.props,null,Ee.mode,Ue),Ma(Ue,xe),Ue.return=Ee,Ue;case b:return xe=Kd(xe,Ee.mode,Ue),xe.return=Ee,xe;case k:return xe=jc(xe),ot(Ee,xe,Ue)}if(te(xe)||G(xe))return xe=jl(xe,Ee.mode,Ue,null),xe.return=Ee,xe;if(typeof xe.then=="function")return ot(Ee,gf(xe),Ue);if(xe.$$typeof===R)return ot(Ee,Ju(Ee,xe),Ue);$u(Ee,xe)}return null}function Ve(Ee,xe,Ue,at){var Vt=xe!==null?xe.key:null;if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return Vt!==null?null:$(Ee,xe,""+Ue,at);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case x:return Ue.key===Vt?me(Ee,xe,Ue,at):null;case b:return Ue.key===Vt?Fe(Ee,xe,Ue,at):null;case k:return Ue=jc(Ue),Ve(Ee,xe,Ue,at)}if(te(Ue)||G(Ue))return Vt!==null?null:nt(Ee,xe,Ue,at,null);if(typeof Ue.then=="function")return Ve(Ee,xe,gf(Ue),at);if(Ue.$$typeof===R)return Ve(Ee,xe,Ju(Ee,Ue),at);$u(Ee,Ue)}return null}function Ke(Ee,xe,Ue,at,Vt){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Ee=Ee.get(Ue)||null,$(xe,Ee,""+at,Vt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case x:return Ee=Ee.get(at.key===null?Ue:at.key)||null,me(xe,Ee,at,Vt);case b:return Ee=Ee.get(at.key===null?Ue:at.key)||null,Fe(xe,Ee,at,Vt);case k:return at=jc(at),Ke(Ee,xe,Ue,at,Vt)}if(te(at)||G(at))return Ee=Ee.get(Ue)||null,nt(xe,Ee,at,Vt,null);if(typeof at.then=="function")return Ke(Ee,xe,Ue,gf(at),Vt);if(at.$$typeof===R)return Ke(Ee,xe,Ue,Ju(xe,at),Vt);$u(xe,at)}return null}function Ot(Ee,xe,Ue,at){for(var Vt=null,Gn=null,Ut=xe,gn=xe=0,In=null;Ut!==null&&gn<Ue.length;gn++){Ut.index>gn?(In=Ut,Ut=null):In=Ut.sibling;var Hn=Ve(Ee,Ut,Ue[gn],at);if(Hn===null){Ut===null&&(Ut=In);break}a&&Ut&&Hn.alternate===null&&c(Ee,Ut),xe=E(Hn,xe,gn),Gn===null?Vt=Hn:Gn.sibling=Hn,Gn=Hn,Ut=In}if(gn===Ue.length)return m(Ee,Ut),wn&&Mo(Ee,gn),Vt;if(Ut===null){for(;gn<Ue.length;gn++)Ut=ot(Ee,Ue[gn],at),Ut!==null&&(xe=E(Ut,xe,gn),Gn===null?Vt=Ut:Gn.sibling=Ut,Gn=Ut);return wn&&Mo(Ee,gn),Vt}for(Ut=y(Ut);gn<Ue.length;gn++)In=Ke(Ut,Ee,gn,Ue[gn],at),In!==null&&(a&&In.alternate!==null&&Ut.delete(In.key===null?gn:In.key),xe=E(In,xe,gn),Gn===null?Vt=In:Gn.sibling=In,Gn=In);return a&&Ut.forEach(function(bh){return c(Ee,bh)}),wn&&Mo(Ee,gn),Vt}function qt(Ee,xe,Ue,at){if(Ue==null)throw Error(n(151));for(var Vt=null,Gn=null,Ut=xe,gn=xe=0,In=null,Hn=Ue.next();Ut!==null&&!Hn.done;gn++,Hn=Ue.next()){Ut.index>gn?(In=Ut,Ut=null):In=Ut.sibling;var bh=Ve(Ee,Ut,Hn.value,at);if(bh===null){Ut===null&&(Ut=In);break}a&&Ut&&bh.alternate===null&&c(Ee,Ut),xe=E(bh,xe,gn),Gn===null?Vt=bh:Gn.sibling=bh,Gn=bh,Ut=In}if(Hn.done)return m(Ee,Ut),wn&&Mo(Ee,gn),Vt;if(Ut===null){for(;!Hn.done;gn++,Hn=Ue.next())Hn=ot(Ee,Hn.value,at),Hn!==null&&(xe=E(Hn,xe,gn),Gn===null?Vt=Hn:Gn.sibling=Hn,Gn=Hn);return wn&&Mo(Ee,gn),Vt}for(Ut=y(Ut);!Hn.done;gn++,Hn=Ue.next())Hn=Ke(Ut,Ee,gn,Hn.value,at),Hn!==null&&(a&&Hn.alternate!==null&&Ut.delete(Hn.key===null?gn:Hn.key),xe=E(Hn,xe,gn),Gn===null?Vt=Hn:Gn.sibling=Hn,Gn=Hn);return a&&Ut.forEach(function(zF){return c(Ee,zF)}),wn&&Mo(Ee,gn),Vt}function oi(Ee,xe,Ue,at){if(typeof Ue=="object"&&Ue!==null&&Ue.type===w&&Ue.key===null&&(Ue=Ue.props.children),typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case x:e:{for(var Vt=Ue.key;xe!==null;){if(xe.key===Vt){if(Vt=Ue.type,Vt===w){if(xe.tag===7){m(Ee,xe.sibling),at=A(xe,Ue.props.children),at.return=Ee,Ee=at;break e}}else if(xe.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===k&&jc(Vt)===xe.type){m(Ee,xe.sibling),at=A(xe,Ue.props),Ma(at,Ue),at.return=Ee,Ee=at;break e}m(Ee,xe);break}else c(Ee,xe);xe=xe.sibling}Ue.type===w?(at=jl(Ue.props.children,Ee.mode,at,Ue.key),at.return=Ee,Ee=at):(at=So(Ue.type,Ue.key,Ue.props,null,Ee.mode,at),Ma(at,Ue),at.return=Ee,Ee=at)}return z(Ee);case b:e:{for(Vt=Ue.key;xe!==null;){if(xe.key===Vt)if(xe.tag===4&&xe.stateNode.containerInfo===Ue.containerInfo&&xe.stateNode.implementation===Ue.implementation){m(Ee,xe.sibling),at=A(xe,Ue.children||[]),at.return=Ee,Ee=at;break e}else{m(Ee,xe);break}else c(Ee,xe);xe=xe.sibling}at=Kd(Ue,Ee.mode,at),at.return=Ee,Ee=at}return z(Ee);case k:return Ue=jc(Ue),oi(Ee,xe,Ue,at)}if(te(Ue))return Ot(Ee,xe,Ue,at);if(G(Ue)){if(Vt=G(Ue),typeof Vt!="function")throw Error(n(150));return Ue=Vt.call(Ue),qt(Ee,xe,Ue,at)}if(typeof Ue.then=="function")return oi(Ee,xe,gf(Ue),at);if(Ue.$$typeof===R)return oi(Ee,xe,Ju(Ee,Ue),at);$u(Ee,Ue)}return typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint"?(Ue=""+Ue,xe!==null&&xe.tag===6?(m(Ee,xe.sibling),at=A(xe,Ue),at.return=Ee,Ee=at):(m(Ee,xe),at=Zd(Ue,Ee.mode,at),at.return=Ee,Ee=at),z(Ee)):m(Ee,xe)}return function(Ee,xe,Ue,at){try{Zc=0;var Vt=oi(Ee,xe,Ue,at);return Yc=null,Vt}catch(Ut){if(Ut===Wc||Ut===cn)throw Ut;var Gn=Mi(29,Ut,null,Ee.mode);return Gn.lanes=at,Gn.return=Ee,Gn}}}var rl=ap(!0),op=ap(!1),or=!1;function vf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cg(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function al(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Jl(a,c,m){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,(Lt&2)!==0){var A=y.pending;return A===null?c.next=c:(c.next=A.next,A.next=c),y.pending=c,c=ba(a),Hl(a,null,m),c}return Ms(a,y,c,m),ba(a)}function $l(a,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194048)!==0)){var y=c.lanes;y&=a.pendingLanes,m|=y,c.lanes=m,Ji(a,m)}}function zt(a,c){var m=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,m===y)){var A=null,E=null;if(m=m.firstBaseUpdate,m!==null){do{var z={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};E===null?A=E=z:E=E.next=z,m=m.next}while(m!==null);E===null?A=E=c:E=E.next=c}else A=E=c;m={baseState:y.baseState,firstBaseUpdate:A,lastBaseUpdate:E,shared:y.shared,callbacks:y.callbacks},a.updateQueue=m;return}a=m.lastBaseUpdate,a===null?m.firstBaseUpdate=c:a.next=c,m.lastBaseUpdate=c}var Rg=!1;function yf(){if(Rg){var a=Sa;if(a!==null)throw a}}function eh(a,c,m,y){Rg=!1;var A=a.updateQueue;or=!1;var E=A.firstBaseUpdate,z=A.lastBaseUpdate,$=A.shared.pending;if($!==null){A.shared.pending=null;var me=$,Fe=me.next;me.next=null,z===null?E=Fe:z.next=Fe,z=me;var nt=a.alternate;nt!==null&&(nt=nt.updateQueue,$=nt.lastBaseUpdate,$!==z&&($===null?nt.firstBaseUpdate=Fe:$.next=Fe,nt.lastBaseUpdate=me))}if(E!==null){var ot=A.baseState;z=0,nt=Fe=me=null,$=E;do{var Ve=$.lane&-536870913,Ke=Ve!==$.lane;if(Ke?(ln&Ve)===Ve:(y&Ve)===Ve){Ve!==0&&Ve===sl&&(Rg=!0),nt!==null&&(nt=nt.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});e:{var Ot=a,qt=$;Ve=c;var oi=m;switch(qt.tag){case 1:if(Ot=qt.payload,typeof Ot=="function"){ot=Ot.call(oi,ot,Ve);break e}ot=Ot;break e;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=qt.payload,Ve=typeof Ot=="function"?Ot.call(oi,ot,Ve):Ot,Ve==null)break e;ot=g({},ot,Ve);break e;case 2:or=!0}}Ve=$.callback,Ve!==null&&(a.flags|=64,Ke&&(a.flags|=8192),Ke=A.callbacks,Ke===null?A.callbacks=[Ve]:Ke.push(Ve))}else Ke={lane:Ve,tag:$.tag,payload:$.payload,callback:$.callback,next:null},nt===null?(Fe=nt=Ke,me=ot):nt=nt.next=Ke,z|=Ve;if($=$.next,$===null){if($=A.shared.pending,$===null)break;Ke=$,$=Ke.next,Ke.next=null,A.lastBaseUpdate=Ke,A.shared.pending=null}}while(!0);nt===null&&(me=ot),A.baseState=me,A.firstBaseUpdate=Fe,A.lastBaseUpdate=nt,E===null&&(A.shared.lanes=0),Fo|=z,a.lanes=z,a.memoizedState=ot}}function th(a,c){if(typeof a!="function")throw Error(n(191,a));a.call(c)}function Ly(a,c){var m=a.callbacks;if(m!==null)for(a.callbacks=null,a=0;a<m.length;a++)th(m[a],c)}var nh=B(null),lp=B(0);function Fy(a,c){a=Jr,ae(lp,a),ae(nh,c),Jr=a|c.baseLanes}function Dg(){ae(lp,Jr),ae(nh,nh.current)}function _f(){Jr=lp.current,Q(nh),Q(lp)}var br=B(null),lr=null;function ol(a){var c=a.alternate;ae(An,An.current&1),ae(br,a),lr===null&&(c===null||nh.current!==null||c.memoizedState!==null)&&(lr=a)}function Ng(a){ae(An,An.current),ae(br,a),lr===null&&(lr=a)}function ky(a){a.tag===22?(ae(An,An.current),ae(br,a),lr===null&&(lr=a)):Sr()}function Sr(){ae(An,An.current),ae(br,br.current)}function Vi(a){Q(br),lr===a&&(lr=null),Q(An)}var An=B(0);function Zr(a){for(var c=a;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||eM(m)||tM(m)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var _i=0,sn=null,Kn=null,xn=null,Ta=!1,ih=!1,Kc=!1,cp=0,xf=0,sh=null,Ig=0;function wi(){throw Error(n(321))}function Og(a,c){if(c===null)return!1;for(var m=0;m<c.length&&m<a.length;m++)if(!rr(a[m],c[m]))return!1;return!0}function up(a,c,m,y,A,E){return _i=E,sn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,W.H=a===null||a.memoizedState===null?g_:$g,Kc=!1,E=m(y,A),Kc=!1,ih&&(E=Qc(c,m,y,A)),By(a),E}function By(a){W.H=rh;var c=Kn!==null&&Kn.next!==null;if(_i=0,xn=Kn=sn=null,Ta=!1,xf=0,sh=null,c)throw Error(n(300));a===null||ts||(a=a.dependencies,a!==null&&df(a)&&(ts=!0))}function Qc(a,c,m,y){sn=a;var A=0;do{if(ih&&(sh=null),xf=0,ih=!1,25<=A)throw Error(n(301));if(A+=1,xn=Kn=null,a.updateQueue!=null){var E=a.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}W.H=wa,E=c(m,y)}while(ih);return E}function Jc(){var a=W.H,c=a.useState()[0];return c=typeof c.then=="function"?bf(c):c,a=a.useState()[0],(Kn!==null?Kn.memoizedState:null)!==a&&(sn.flags|=1024),c}function Pg(){var a=cp!==0;return cp=0,a}function Ug(a,c,m){c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~m}function Lg(a){if(Ta){for(a=a.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Ta=!1}_i=0,xn=Kn=sn=null,ih=!1,xf=cp=0,sh=null}function ls(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?sn.memoizedState=xn=a:xn=xn.next=a,xn}function Gi(){if(Kn===null){var a=sn.alternate;a=a!==null?a.memoizedState:null}else a=Kn.next;var c=xn===null?sn.memoizedState:xn.next;if(c!==null)xn=c,Kn=a;else{if(a===null)throw sn.alternate===null?Error(n(467)):Error(n(310));Kn=a,a={memoizedState:Kn.memoizedState,baseState:Kn.baseState,baseQueue:Kn.baseQueue,queue:Kn.queue,next:null},xn===null?sn.memoizedState=xn=a:xn=xn.next=a}return xn}function hp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bf(a){var c=xf;return xf+=1,sh===null&&(sh=[]),a=rp(sh,a,c),c=sn,(xn===null?c.memoizedState:xn.next)===null&&(c=c.alternate,W.H=c===null||c.memoizedState===null?g_:$g),a}function ec(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return bf(a);if(a.$$typeof===R)return Yt(a)}throw Error(n(438,String(a)))}function Fg(a){var c=null,m=sn.updateQueue;if(m!==null&&(c=m.memoCache),c==null){var y=sn.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(c={data:y.data.map(function(A){return A.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),m===null&&(m=hp(),sn.updateQueue=m),m.memoCache=c,m=c.data[c.index],m===void 0)for(m=c.data[c.index]=Array(a),y=0;y<a;y++)m[y]=F;return c.index++,m}function ll(a,c){return typeof c=="function"?c(a):c}function fp(a){var c=Gi();return kg(c,Kn,a)}function kg(a,c,m){var y=a.queue;if(y===null)throw Error(n(311));y.lastRenderedReducer=m;var A=a.baseQueue,E=y.pending;if(E!==null){if(A!==null){var z=A.next;A.next=E.next,E.next=z}c.baseQueue=A=E,y.pending=null}if(E=a.baseState,A===null)a.memoizedState=E;else{c=A.next;var $=z=null,me=null,Fe=c,nt=!1;do{var ot=Fe.lane&-536870913;if(ot!==Fe.lane?(ln&ot)===ot:(_i&ot)===ot){var Ve=Fe.revertLane;if(Ve===0)me!==null&&(me=me.next={lane:0,revertLane:0,gesture:null,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null}),ot===sl&&(nt=!0);else if((_i&Ve)===Ve){Fe=Fe.next,Ve===sl&&(nt=!0);continue}else ot={lane:0,revertLane:Fe.revertLane,gesture:null,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null},me===null?($=me=ot,z=E):me=me.next=ot,sn.lanes|=Ve,Fo|=Ve;ot=Fe.action,Kc&&m(E,ot),E=Fe.hasEagerState?Fe.eagerState:m(E,ot)}else Ve={lane:ot,revertLane:Fe.revertLane,gesture:Fe.gesture,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null},me===null?($=me=Ve,z=E):me=me.next=Ve,sn.lanes|=ot,Fo|=ot;Fe=Fe.next}while(Fe!==null&&Fe!==c);if(me===null?z=E:me.next=$,!rr(E,a.memoizedState)&&(ts=!0,nt&&(m=Sa,m!==null)))throw m;a.memoizedState=E,a.baseState=z,a.baseQueue=me,y.lastRenderedState=E}return A===null&&(y.lanes=0),[a.memoizedState,y.dispatch]}function Bg(a){var c=Gi(),m=c.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=a;var y=m.dispatch,A=m.pending,E=c.memoizedState;if(A!==null){m.pending=null;var z=A=A.next;do E=a(E,z.action),z=z.next;while(z!==A);rr(E,c.memoizedState)||(ts=!0),c.memoizedState=E,c.baseQueue===null&&(c.baseState=E),m.lastRenderedState=E}return[E,y]}function zy(a,c,m){var y=sn,A=Gi(),E=wn;if(E){if(m===void 0)throw Error(n(407));m=m()}else m=c();var z=!rr((Kn||A).memoizedState,m);if(z&&(A.memoizedState=m,ts=!0),A=A.queue,Xg(Hy.bind(null,y,A,a),[a]),A.getSnapshot!==c||z||xn!==null&&xn.memoizedState.tag&1){if(y.flags|=2048,tc(9,{destroy:void 0},Gy.bind(null,y,A,m,c),null),Jt===null)throw Error(n(349));E||(_i&127)!==0||Vy(y,c,m)}return m}function Vy(a,c,m){a.flags|=16384,a={getSnapshot:c,value:m},c=sn.updateQueue,c===null?(c=hp(),sn.updateQueue=c,c.stores=[a]):(m=c.stores,m===null?c.stores=[a]:m.push(a))}function Gy(a,c,m,y){c.value=m,c.getSnapshot=y,Wy(c)&&jy(a)}function Hy(a,c,m){return m(function(){Wy(c)&&jy(a)})}function Wy(a){var c=a.getSnapshot;a=a.value;try{var m=c();return!rr(a,m)}catch{return!0}}function jy(a){var c=ar(a,2);c!==null&&hn(c,a,2)}function zg(a){var c=ls();if(typeof a=="function"){var m=a;if(a=m(),Kc){Qe(!0);try{m()}finally{Qe(!1)}}}return c.memoizedState=c.baseState=a,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:a},c}function Vg(a,c,m,y){return a.baseState=m,kg(a,Kn,typeof y=="function"?y:ll)}function kS(a,c,m,y,A){if(gp(a))throw Error(n(485));if(a=c.action,a!==null){var E={payload:A,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){E.listeners.push(z)}};W.T!==null?m(!0):E.isTransition=!1,y(E),m=c.pending,m===null?(E.next=c.pending=E,qy(c,E)):(E.next=m.next,c.pending=m.next=E)}}function qy(a,c){var m=c.action,y=c.payload,A=a.state;if(c.isTransition){var E=W.T,z={};W.T=z;try{var $=m(A,y),me=W.S;me!==null&&me(z,$),Xy(a,c,$)}catch(Fe){Gg(a,c,Fe)}finally{E!==null&&z.types!==null&&(E.types=z.types),W.T=E}}else try{E=m(A,y),Xy(a,c,E)}catch(Fe){Gg(a,c,Fe)}}function Xy(a,c,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(y){Yy(a,c,y)},function(y){return Gg(a,c,y)}):Yy(a,c,m)}function Yy(a,c,m){c.status="fulfilled",c.value=m,Zy(c),a.state=m,c=a.pending,c!==null&&(m=c.next,m===c?a.pending=null:(m=m.next,c.next=m,qy(a,m)))}function Gg(a,c,m){var y=a.pending;if(a.pending=null,y!==null){y=y.next;do c.status="rejected",c.reason=m,Zy(c),c=c.next;while(c!==y)}a.action=null}function Zy(a){a=a.listeners;for(var c=0;c<a.length;c++)(0,a[c])()}function Hg(a,c){return c}function Wg(a,c){if(wn){var m=Jt.formState;if(m!==null){e:{var y=sn;if(wn){if(si){t:{for(var A=si,E=Xr;A.nodeType!==8;){if(!E){A=null;break t}if(A=zo(A.nextSibling),A===null){A=null;break t}}E=A.data,A=E==="F!"||E==="F"?A:null}if(A){si=zo(A.nextSibling),y=A.data==="F!";break e}}wo(y)}y=!1}y&&(c=m[0])}}return m=ls(),m.memoizedState=m.baseState=c,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hg,lastRenderedState:c},m.queue=y,m=d_.bind(null,sn,y),y.dispatch=m,y=zg(!1),E=Jg.bind(null,sn,!1,y.queue),y=ls(),A={state:c,dispatch:null,action:a,pending:null},y.queue=A,m=kS.bind(null,sn,A,E,m),A.dispatch=m,y.memoizedState=a,[c,m,!1]}function Ky(a){var c=Gi();return jg(c,Kn,a)}function jg(a,c,m){if(c=kg(a,c,Hg)[0],a=fp(ll)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var y=bf(c)}catch(z){throw z===Wc?cn:z}else y=c;c=Gi();var A=c.queue,E=A.dispatch;return m!==c.memoizedState&&(sn.flags|=2048,tc(9,{destroy:void 0},Qy.bind(null,A,m),null)),[y,E,a]}function Qy(a,c){a.action=c}function qg(a){var c=Gi(),m=Kn;if(m!==null)return jg(c,m,a);Gi(),c=c.memoizedState,m=Gi();var y=m.queue.dispatch;return m.memoizedState=a,[c,y,!1]}function tc(a,c,m,y){return a={tag:a,create:m,deps:y,inst:c,next:null},c=sn.updateQueue,c===null&&(c=hp(),sn.updateQueue=c),m=c.lastEffect,m===null?c.lastEffect=a.next=a:(y=m.next,m.next=a,a.next=y,c.lastEffect=a),a}function dp(){return Gi().memoizedState}function pp(a,c,m,y){var A=ls();sn.flags|=a,A.memoizedState=tc(1|c,{destroy:void 0},m,y===void 0?null:y)}function mp(a,c,m,y){var A=Gi();y=y===void 0?null:y;var E=A.memoizedState.inst;Kn!==null&&y!==null&&Og(y,Kn.memoizedState.deps)?A.memoizedState=tc(c,E,m,y):(sn.flags|=a,A.memoizedState=tc(1|c,E,m,y))}function Jy(a,c){pp(8390656,8,a,c)}function Xg(a,c){mp(2048,8,a,c)}function $y(a){sn.flags|=4;var c=sn.updateQueue;if(c===null)c=hp(),sn.updateQueue=c,c.events=[a];else{var m=c.events;m===null?c.events=[a]:m.push(a)}}function e_(a){var c=Gi().memoizedState;return $y({ref:c,nextImpl:a}),function(){if((Lt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}function t_(a,c){return mp(4,2,a,c)}function n_(a,c){return mp(4,4,a,c)}function i_(a,c){if(typeof c=="function"){a=a();var m=c(a);return function(){typeof m=="function"?m():c(null)}}if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function s_(a,c,m){m=m!=null?m.concat([a]):null,mp(4,4,i_.bind(null,c,a),m)}function Yg(){}function r_(a,c){var m=Gi();c=c===void 0?null:c;var y=m.memoizedState;return c!==null&&Og(c,y[1])?y[0]:(m.memoizedState=[a,c],a)}function a_(a,c){var m=Gi();c=c===void 0?null:c;var y=m.memoizedState;if(c!==null&&Og(c,y[1]))return y[0];if(y=a(),Kc){Qe(!0);try{a()}finally{Qe(!1)}}return m.memoizedState=[y,c],y}function Zg(a,c,m){return m===void 0||(_i&1073741824)!==0&&(ln&261930)===0?a.memoizedState=c:(a.memoizedState=m,a=yn(),sn.lanes|=a,Fo|=a,m)}function o_(a,c,m,y){return rr(m,c)?m:nh.current!==null?(a=Zg(a,m,y),rr(a,c)||(ts=!0),a):(_i&42)===0||(_i&1073741824)!==0&&(ln&261930)===0?(ts=!0,a.memoizedState=m):(a=yn(),sn.lanes|=a,Fo|=a,c)}function l_(a,c,m,y,A){var E=X.p;X.p=E!==0&&8>E?E:8;var z=W.T,$={};W.T=$,Jg(a,!1,c,m);try{var me=A(),Fe=W.S;if(Fe!==null&&Fe($,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var nt=Ag(me,y);Sf(a,c,nt,ea(a))}else Sf(a,c,y,ea(a))}catch(ot){Sf(a,c,{then:function(){},status:"rejected",reason:ot},ea())}finally{X.p=E,z!==null&&$.types!==null&&(z.types=$.types),W.T=z}}function BS(){}function Kg(a,c,m,y){if(a.tag!==5)throw Error(n(476));var A=c_(a).queue;l_(a,A,c,oe,m===null?BS:function(){return u_(a),m(y)})}function c_(a){var c=a.memoizedState;if(c!==null)return c;c={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:oe},next:null};var m={};return c.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:m},next:null},a.memoizedState=c,a=a.alternate,a!==null&&(a.memoizedState=c),c}function u_(a){var c=c_(a);c.next===null&&(c=a.alternate.memoizedState),Sf(a,c.next.queue,{},ea())}function Qg(){return Yt(_0)}function h_(){return Gi().memoizedState}function f_(){return Gi().memoizedState}function zS(a){for(var c=a.return;c!==null;){switch(c.tag){case 24:case 3:var m=ea();a=al(m);var y=Jl(c,a,m);y!==null&&(hn(y,c,m),$l(y,c,m)),c={cache:Mg()},a.payload=c;return}c=c.return}}function VS(a,c,m){var y=ea();m={lane:y,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},gp(a)?p_(c,m):(m=Xd(a,c,m,y),m!==null&&(hn(m,a,y),m_(m,c,y)))}function d_(a,c,m){var y=ea();Sf(a,c,m,y)}function Sf(a,c,m,y){var A={lane:y,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(gp(a))p_(c,A);else{var E=a.alternate;if(a.lanes===0&&(E===null||E.lanes===0)&&(E=c.lastRenderedReducer,E!==null))try{var z=c.lastRenderedState,$=E(z,m);if(A.hasEagerState=!0,A.eagerState=$,rr($,z))return Ms(a,c,A,0),Jt===null&&hf(),!1}catch{}if(m=Xd(a,c,A,y),m!==null)return hn(m,a,y),m_(m,c,y),!0}return!1}function Jg(a,c,m,y){if(y={lane:2,revertLane:je(),gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},gp(a)){if(c)throw Error(n(479))}else c=Xd(a,m,y,2),c!==null&&hn(c,a,2)}function gp(a){var c=a.alternate;return a===sn||c!==null&&c===sn}function p_(a,c){ih=Ta=!0;var m=a.pending;m===null?c.next=c:(c.next=m.next,m.next=c),a.pending=c}function m_(a,c,m){if((m&4194048)!==0){var y=c.lanes;y&=a.pendingLanes,m|=y,c.lanes=m,Ji(a,m)}}var rh={readContext:Yt,use:ec,useCallback:wi,useContext:wi,useEffect:wi,useImperativeHandle:wi,useLayoutEffect:wi,useInsertionEffect:wi,useMemo:wi,useReducer:wi,useRef:wi,useState:wi,useDebugValue:wi,useDeferredValue:wi,useTransition:wi,useSyncExternalStore:wi,useId:wi,useHostTransitionStatus:wi,useFormState:wi,useActionState:wi,useOptimistic:wi,useMemoCache:wi,useCacheRefresh:wi};rh.useEffectEvent=wi;var g_={readContext:Yt,use:ec,useCallback:function(a,c){return ls().memoizedState=[a,c===void 0?null:c],a},useContext:Yt,useEffect:Jy,useImperativeHandle:function(a,c,m){m=m!=null?m.concat([a]):null,pp(4194308,4,i_.bind(null,c,a),m)},useLayoutEffect:function(a,c){return pp(4194308,4,a,c)},useInsertionEffect:function(a,c){pp(4,2,a,c)},useMemo:function(a,c){var m=ls();c=c===void 0?null:c;var y=a();if(Kc){Qe(!0);try{a()}finally{Qe(!1)}}return m.memoizedState=[y,c],y},useReducer:function(a,c,m){var y=ls();if(m!==void 0){var A=m(c);if(Kc){Qe(!0);try{m(c)}finally{Qe(!1)}}}else A=c;return y.memoizedState=y.baseState=A,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:A},y.queue=a,a=a.dispatch=VS.bind(null,sn,a),[y.memoizedState,a]},useRef:function(a){var c=ls();return a={current:a},c.memoizedState=a},useState:function(a){a=zg(a);var c=a.queue,m=d_.bind(null,sn,c);return c.dispatch=m,[a.memoizedState,m]},useDebugValue:Yg,useDeferredValue:function(a,c){var m=ls();return Zg(m,a,c)},useTransition:function(){var a=zg(!1);return a=l_.bind(null,sn,a.queue,!0,!1),ls().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,c,m){var y=sn,A=ls();if(wn){if(m===void 0)throw Error(n(407));m=m()}else{if(m=c(),Jt===null)throw Error(n(349));(ln&127)!==0||Vy(y,c,m)}A.memoizedState=m;var E={value:m,getSnapshot:c};return A.queue=E,Jy(Hy.bind(null,y,E,a),[a]),y.flags|=2048,tc(9,{destroy:void 0},Gy.bind(null,y,E,m,c),null),m},useId:function(){var a=ls(),c=Jt.identifierPrefix;if(wn){var m=Ja,y=Ti;m=(y&~(1<<32-le(y)-1)).toString(32)+m,c="_"+c+"R_"+m,m=cp++,0<m&&(c+="H"+m.toString(32)),c+="_"}else m=Ig++,c="_"+c+"r_"+m.toString(32)+"_";return a.memoizedState=c},useHostTransitionStatus:Qg,useFormState:Wg,useActionState:Wg,useOptimistic:function(a){var c=ls();c.memoizedState=c.baseState=a;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=m,c=Jg.bind(null,sn,!0,m),m.dispatch=c,[a,c]},useMemoCache:Fg,useCacheRefresh:function(){return ls().memoizedState=zS.bind(null,sn)},useEffectEvent:function(a){var c=ls(),m={impl:a};return c.memoizedState=m,function(){if((Lt&2)!==0)throw Error(n(440));return m.impl.apply(void 0,arguments)}}},$g={readContext:Yt,use:ec,useCallback:r_,useContext:Yt,useEffect:Xg,useImperativeHandle:s_,useInsertionEffect:t_,useLayoutEffect:n_,useMemo:a_,useReducer:fp,useRef:dp,useState:function(){return fp(ll)},useDebugValue:Yg,useDeferredValue:function(a,c){var m=Gi();return o_(m,Kn.memoizedState,a,c)},useTransition:function(){var a=fp(ll)[0],c=Gi().memoizedState;return[typeof a=="boolean"?a:bf(a),c]},useSyncExternalStore:zy,useId:h_,useHostTransitionStatus:Qg,useFormState:Ky,useActionState:Ky,useOptimistic:function(a,c){var m=Gi();return Vg(m,Kn,a,c)},useMemoCache:Fg,useCacheRefresh:f_};$g.useEffectEvent=e_;var wa={readContext:Yt,use:ec,useCallback:r_,useContext:Yt,useEffect:Xg,useImperativeHandle:s_,useInsertionEffect:t_,useLayoutEffect:n_,useMemo:a_,useReducer:Bg,useRef:dp,useState:function(){return Bg(ll)},useDebugValue:Yg,useDeferredValue:function(a,c){var m=Gi();return Kn===null?Zg(m,a,c):o_(m,Kn.memoizedState,a,c)},useTransition:function(){var a=Bg(ll)[0],c=Gi().memoizedState;return[typeof a=="boolean"?a:bf(a),c]},useSyncExternalStore:zy,useId:h_,useHostTransitionStatus:Qg,useFormState:qg,useActionState:qg,useOptimistic:function(a,c){var m=Gi();return Kn!==null?Vg(m,Kn,a,c):(m.baseState=a,[a,m.queue.dispatch])},useMemoCache:Fg,useCacheRefresh:f_};wa.useEffectEvent=e_;function vp(a,c,m,y){c=a.memoizedState,m=m(y,c),m=m==null?c:g({},c,m),a.memoizedState=m,a.lanes===0&&(a.updateQueue.baseState=m)}var Mf={enqueueSetState:function(a,c,m){a=a._reactInternals;var y=ea(),A=al(y);A.payload=c,m!=null&&(A.callback=m),c=Jl(a,A,y),c!==null&&(hn(c,a,y),$l(c,a,y))},enqueueReplaceState:function(a,c,m){a=a._reactInternals;var y=ea(),A=al(y);A.tag=1,A.payload=c,m!=null&&(A.callback=m),c=Jl(a,A,y),c!==null&&(hn(c,a,y),$l(c,a,y))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var m=ea(),y=al(m);y.tag=2,c!=null&&(y.callback=c),c=Jl(a,y,m),c!==null&&(hn(c,a,m),$l(c,a,m))}};function e0(a,c,m,y,A,E,z){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,E,z):c.prototype&&c.prototype.isPureReactComponent?!Vu(m,y)||!Vu(A,E):!0}function t0(a,c,m,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,y),c.state!==a&&Mf.enqueueReplaceState(c,c.state,null)}function nc(a,c){var m=c;if("ref"in c){m={};for(var y in c)y!=="ref"&&(m[y]=c[y])}if(a=a.defaultProps){m===c&&(m=g({},m));for(var A in a)m[A]===void 0&&(m[A]=a[A])}return m}function v_(a){uf(a)}function n0(a){console.error(a)}function i0(a){uf(a)}function yp(a,c){try{var m=a.onUncaughtError;m(c.value,{componentStack:c.stack})}catch(y){setTimeout(function(){throw y})}}function y_(a,c,m){try{var y=a.onCaughtError;y(m.value,{componentStack:m.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function s0(a,c,m){return m=al(m),m.tag=3,m.payload={element:null},m.callback=function(){yp(a,c)},m}function r0(a){return a=al(a),a.tag=3,a}function __(a,c,m,y){var A=m.type.getDerivedStateFromError;if(typeof A=="function"){var E=y.value;a.payload=function(){return A(E)},a.callback=function(){y_(c,m,y)}}var z=m.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(a.callback=function(){y_(c,m,y),typeof A!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var $=y.stack;this.componentDidCatch(y.value,{componentStack:$!==null?$:""})})}function cs(a,c,m,y,A){if(m.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(c=m.alternate,c!==null&&Ro(c,m,A,!0),m=br.current,m!==null){switch(m.tag){case 31:case 13:return lr===null?fh():m.alternate===null&&Ai===0&&(Ai=3),m.flags&=-257,m.flags|=65536,m.lanes=A,y===sp?m.flags|=16384:(c=m.updateQueue,c===null?m.updateQueue=new Set([y]):c.add(y),Uf(a,y,A)),!1;case 22:return m.flags|=65536,y===sp?m.flags|=16384:(c=m.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([y])},m.updateQueue=c):(m=c.retryQueue,m===null?c.retryQueue=new Set([y]):m.add(y)),Uf(a,y,A)),!1}throw Error(n(435,m.tag))}return Uf(a,y,A),fh(),!1}if(wn)return c=br.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=A,y!==Zu&&(a=Error(n(422),{cause:y}),Ao(qr(a,m)))):(y!==Zu&&(c=Error(n(423),{cause:y}),Ao(qr(c,m))),a=a.current.alternate,a.flags|=65536,A&=-A,a.lanes|=A,y=qr(y,m),A=s0(a.stateNode,y,A),zt(a,A),Ai!==4&&(Ai=2)),!1;var E=Error(n(520),{cause:y});if(E=qr(E,m),au===null?au=[E]:au.push(E),Ai!==4&&(Ai=2),c===null)return!0;y=qr(y,m),m=c;do{switch(m.tag){case 3:return m.flags|=65536,a=A&-A,m.lanes|=a,a=s0(m.stateNode,y,a),zt(m,a),!1;case 1:if(c=m.type,E=m.stateNode,(m.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(ji===null||!ji.has(E))))return m.flags|=65536,A&=-A,m.lanes|=A,A=r0(A),__(A,a,m,y),zt(m,A),!1}m=m.return}while(m!==null);return!1}var _p=Error(n(461)),ts=!1;function Ts(a,c,m,y){c.child=a===null?op(c,null,m,y):rl(c,a.child,m,y)}function a0(a,c,m,y,A){m=m.render;var E=c.ref;if("ref"in y){var z={};for(var $ in y)$!=="ref"&&(z[$]=y[$])}else z=y;return Kl(c),y=up(a,c,m,z,E,A),$=Pg(),a!==null&&!ts?(Ug(a,c,A),Hi(a,c,A)):(wn&&$&&To(c),c.flags|=1,Ts(a,c,y,A),c.child)}function $c(a,c,m,y,A){if(a===null){var E=m.type;return typeof E=="function"&&!Yd(E)&&E.defaultProps===void 0&&m.compare===null?(c.tag=15,c.type=E,xp(a,c,E,y,A)):(a=So(m.type,null,y,c,c.mode,A),a.ref=c.ref,a.return=c,c.child=a)}if(E=a.child,!Ap(a,A)){var z=E.memoizedProps;if(m=m.compare,m=m!==null?m:Vu,m(z,y)&&a.ref===c.ref)return Hi(a,c,A)}return c.flags|=1,a=yr(E,y),a.ref=c.ref,a.return=c,c.child=a}function xp(a,c,m,y,A){if(a!==null){var E=a.memoizedProps;if(Vu(E,y)&&a.ref===c.ref)if(ts=!1,c.pendingProps=y=E,Ap(a,A))(a.flags&131072)!==0&&(ts=!0);else return c.lanes=a.lanes,Hi(a,c,A)}return ah(a,c,m,y,A)}function eu(a,c,m,y){var A=y.children,E=a!==null?a.memoizedState:null;if(a===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.mode==="hidden"){if((c.flags&128)!==0){if(E=E!==null?E.baseLanes|m:m,a!==null){for(y=c.child=a.child,A=0;y!==null;)A=A|y.lanes|y.childLanes,y=y.sibling;y=A&~E}else y=0,c.child=null;return Mr(a,c,E,m,y)}if((m&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},a!==null&&pf(c,E!==null?E.cachePool:null),E!==null?Fy(c,E):Dg(),ky(c);else return y=c.lanes=536870912,Mr(a,c,E!==null?E.baseLanes|m:m,m,y)}else E!==null?(pf(c,E.cachePool),Fy(c,E),Sr(),c.memoizedState=null):(a!==null&&pf(c,null),Dg(),Sr());return Ts(a,c,A,m),c.child}function No(a,c){return a!==null&&a.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function Mr(a,c,m,y,A){var E=ip();return E=E===null?null:{parent:es._currentValue,pool:E},c.memoizedState={baseLanes:m,cachePool:E},a!==null&&pf(c,null),Dg(),ky(c),a!==null&&Ro(a,c,y,!0),c.childLanes=A,null}function bp(a,c){return c=wp({mode:c.mode,children:c.children},a.mode),c.ref=a.ref,a.child=c,c.return=a,c}function x_(a,c,m){return rl(c,a.child,null,m),a=bp(c,c.pendingProps),a.flags|=2,Vi(c),c.memoizedState=null,a}function Sp(a,c,m){var y=c.pendingProps,A=(c.flags&128)!==0;if(c.flags&=-129,a===null){if(wn){if(y.mode==="hidden")return a=bp(c,y),c.lanes=536870912,No(null,a);if(Ng(c),(a=si)?(a=TC(a,Xr),a=a!==null&&a.data==="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:tl!==null?{id:Ti,overflow:Ja}:null,retryLane:536870912,hydrationErrors:null},m=qu(a),m.return=c,c.child=m,Oi=c,si=null)):a=null,a===null)throw wo(c);return c.lanes=536870912,null}return bp(c,y)}var E=a.memoizedState;if(E!==null){var z=E.dehydrated;if(Ng(c),A)if(c.flags&256)c.flags&=-257,c=x_(a,c,m);else if(c.memoizedState!==null)c.child=a.child,c.flags|=128,c=null;else throw Error(n(558));else if(ts||Ro(a,c,m,!1),A=(m&a.childLanes)!==0,ts||A){if(y=Jt,y!==null&&(z=Gs(y,m),z!==0&&z!==E.retryLane))throw E.retryLane=z,ar(a,z),hn(y,a,z),_p;fh(),c=x_(a,c,m)}else a=E.treeContext,si=zo(z.nextSibling),Oi=c,wn=!0,nl=null,Xr=!1,a!==null&&Jd(c,a),c=bp(c,y),c.flags|=4096;return c}return a=yr(a.child,{mode:y.mode,children:y.children}),a.ref=c.ref,c.child=a,a.return=c,a}function tu(a,c){var m=c.ref;if(m===null)a!==null&&a.ref!==null&&(c.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(a===null||a.ref!==m)&&(c.flags|=4194816)}}function ah(a,c,m,y,A){return Kl(c),m=up(a,c,m,y,void 0,A),y=Pg(),a!==null&&!ts?(Ug(a,c,A),Hi(a,c,A)):(wn&&y&&To(c),c.flags|=1,Ts(a,c,m,A),c.child)}function Tf(a,c,m,y,A,E){return Kl(c),c.updateQueue=null,m=Qc(c,y,m,A),By(a),y=Pg(),a!==null&&!ts?(Ug(a,c,E),Hi(a,c,E)):(wn&&y&&To(c),c.flags|=1,Ts(a,c,m,E),c.child)}function Mp(a,c,m,y,A){if(Kl(c),c.stateNode===null){var E=Wl,z=m.contextType;typeof z=="object"&&z!==null&&(E=Yt(z)),E=new m(y,E),c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=Mf,c.stateNode=E,E._reactInternals=c,E=c.stateNode,E.props=y,E.state=c.memoizedState,E.refs={},vf(c),z=m.contextType,E.context=typeof z=="object"&&z!==null?Yt(z):Wl,E.state=c.memoizedState,z=m.getDerivedStateFromProps,typeof z=="function"&&(vp(c,m,z,y),E.state=c.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(z=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),z!==E.state&&Mf.enqueueReplaceState(E,E.state,null),eh(c,y,E,A),yf(),E.state=c.memoizedState),typeof E.componentDidMount=="function"&&(c.flags|=4194308),y=!0}else if(a===null){E=c.stateNode;var $=c.memoizedProps,me=nc(m,$);E.props=me;var Fe=E.context,nt=m.contextType;z=Wl,typeof nt=="object"&&nt!==null&&(z=Yt(nt));var ot=m.getDerivedStateFromProps;nt=typeof ot=="function"||typeof E.getSnapshotBeforeUpdate=="function",$=c.pendingProps!==$,nt||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||($||Fe!==z)&&t0(c,E,y,z),or=!1;var Ve=c.memoizedState;E.state=Ve,eh(c,y,E,A),yf(),Fe=c.memoizedState,$||Ve!==Fe||or?(typeof ot=="function"&&(vp(c,m,ot,y),Fe=c.memoizedState),(me=or||e0(c,m,me,y,Ve,Fe,z))?(nt||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(c.flags|=4194308)):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=Fe),E.props=y,E.state=Fe,E.context=z,y=me):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{E=c.stateNode,Cg(a,c),z=c.memoizedProps,nt=nc(m,z),E.props=nt,ot=c.pendingProps,Ve=E.context,Fe=m.contextType,me=Wl,typeof Fe=="object"&&Fe!==null&&(me=Yt(Fe)),$=m.getDerivedStateFromProps,(Fe=typeof $=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(z!==ot||Ve!==me)&&t0(c,E,y,me),or=!1,Ve=c.memoizedState,E.state=Ve,eh(c,y,E,A),yf();var Ke=c.memoizedState;z!==ot||Ve!==Ke||or||a!==null&&a.dependencies!==null&&df(a.dependencies)?(typeof $=="function"&&(vp(c,m,$,y),Ke=c.memoizedState),(nt=or||e0(c,m,nt,y,Ve,Ke,me)||a!==null&&a.dependencies!==null&&df(a.dependencies))?(Fe||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(y,Ke,me),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(y,Ke,me)),typeof E.componentDidUpdate=="function"&&(c.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof E.componentDidUpdate!="function"||z===a.memoizedProps&&Ve===a.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&Ve===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=Ke),E.props=y,E.state=Ke,E.context=me,y=nt):(typeof E.componentDidUpdate!="function"||z===a.memoizedProps&&Ve===a.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&Ve===a.memoizedState||(c.flags|=1024),y=!1)}return E=y,tu(a,c),y=(c.flags&128)!==0,E||y?(E=c.stateNode,m=y&&typeof m.getDerivedStateFromError!="function"?null:E.render(),c.flags|=1,a!==null&&y?(c.child=rl(c,a.child,null,A),c.child=rl(c,null,m,A)):Ts(a,c,m,A),c.memoizedState=E.state,a=c.child):a=Hi(a,c,A),a}function b_(a,c,m,y){return Yl(),c.flags|=256,Ts(a,c,m,y),c.child}var o0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zs(a){return{baseLanes:a,cachePool:Eg()}}function Tp(a,c,m){return a=a!==null?a.childLanes&~m:0,c&&(a|=hr),a}function S_(a,c,m){var y=c.pendingProps,A=!1,E=(c.flags&128)!==0,z;if((z=E)||(z=a!==null&&a.memoizedState===null?!1:(An.current&2)!==0),z&&(A=!0,c.flags&=-129),z=(c.flags&32)!==0,c.flags&=-33,a===null){if(wn){if(A?ol(c):Sr(),(a=si)?(a=TC(a,Xr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:tl!==null?{id:Ti,overflow:Ja}:null,retryLane:536870912,hydrationErrors:null},m=qu(a),m.return=c,c.child=m,Oi=c,si=null)):a=null,a===null)throw wo(c);return tM(a)?c.lanes=32:c.lanes=536870912,null}var $=y.children;return y=y.fallback,A?(Sr(),A=c.mode,$=wp({mode:"hidden",children:$},A),y=jl(y,A,m,null),$.return=c,y.return=c,$.sibling=y,c.child=$,y=c.child,y.memoizedState=Zs(m),y.childLanes=Tp(a,z,m),c.memoizedState=o0,No(null,y)):(ol(c),wf(c,$))}var me=a.memoizedState;if(me!==null&&($=me.dehydrated,$!==null)){if(E)c.flags&256?(ol(c),c.flags&=-257,c=l0(a,c,m)):c.memoizedState!==null?(Sr(),c.child=a.child,c.flags|=128,c=null):(Sr(),$=y.fallback,A=c.mode,y=wp({mode:"visible",children:y.children},A),$=jl($,A,m,null),$.flags|=2,y.return=c,$.return=c,y.sibling=$,c.child=y,rl(c,a.child,null,m),y=c.child,y.memoizedState=Zs(m),y.childLanes=Tp(a,z,m),c.memoizedState=o0,c=No(null,y));else if(ol(c),tM($)){if(z=$.nextSibling&&$.nextSibling.dataset,z)var Fe=z.dgst;z=Fe,y=Error(n(419)),y.stack="",y.digest=z,Ao({value:y,source:null,stack:null}),c=l0(a,c,m)}else if(ts||Ro(a,c,m,!1),z=(m&a.childLanes)!==0,ts||z){if(z=Jt,z!==null&&(y=Gs(z,m),y!==0&&y!==me.retryLane))throw me.retryLane=y,ar(a,y),hn(z,a,y),_p;eM($)||fh(),c=l0(a,c,m)}else eM($)?(c.flags|=192,c.child=a.child,c=null):(a=me.treeContext,si=zo($.nextSibling),Oi=c,wn=!0,nl=null,Xr=!1,a!==null&&Jd(c,a),c=wf(c,y.children),c.flags|=4096);return c}return A?(Sr(),$=y.fallback,A=c.mode,me=a.child,Fe=me.sibling,y=yr(me,{mode:"hidden",children:y.children}),y.subtreeFlags=me.subtreeFlags&65011712,Fe!==null?$=yr(Fe,$):($=jl($,A,m,null),$.flags|=2),$.return=c,y.return=c,y.sibling=$,c.child=y,No(null,y),y=c.child,$=a.child.memoizedState,$===null?$=Zs(m):(A=$.cachePool,A!==null?(me=es._currentValue,A=A.parent!==me?{parent:me,pool:me}:A):A=Eg(),$={baseLanes:$.baseLanes|m,cachePool:A}),y.memoizedState=$,y.childLanes=Tp(a,z,m),c.memoizedState=o0,No(a.child,y)):(ol(c),m=a.child,a=m.sibling,m=yr(m,{mode:"visible",children:y.children}),m.return=c,m.sibling=null,a!==null&&(z=c.deletions,z===null?(c.deletions=[a],c.flags|=16):z.push(a)),c.child=m,c.memoizedState=null,m)}function wf(a,c){return c=wp({mode:"visible",children:c},a.mode),c.return=a,a.child=c}function wp(a,c){return a=Mi(22,a,null,c),a.lanes=0,a}function l0(a,c,m){return rl(c,a.child,null,m),a=wf(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function M_(a,c,m){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),ep(a.return,c,m)}function nu(a,c,m,y,A,E){var z=a.memoizedState;z===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:m,tailMode:A,treeForkCount:E}:(z.isBackwards=c,z.rendering=null,z.renderingStartTime=0,z.last=y,z.tail=m,z.tailMode=A,z.treeForkCount=E)}function Tr(a,c,m){var y=c.pendingProps,A=y.revealOrder,E=y.tail;y=y.children;var z=An.current,$=(z&2)!==0;if($?(z=z&1|2,c.flags|=128):z&=1,ae(An,z),Ts(a,c,y,m),y=wn?Yu:0,!$&&a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&M_(a,m,c);else if(a.tag===19)M_(a,m,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(A){case"forwards":for(m=c.child,A=null;m!==null;)a=m.alternate,a!==null&&Zr(a)===null&&(A=m),m=m.sibling;m=A,m===null?(A=c.child,c.child=null):(A=m.sibling,m.sibling=null),nu(c,!1,A,m,E,y);break;case"backwards":case"unstable_legacy-backwards":for(m=null,A=c.child,c.child=null;A!==null;){if(a=A.alternate,a!==null&&Zr(a)===null){c.child=A;break}a=A.sibling,A.sibling=m,m=A,A=a}nu(c,!0,m,null,E,y);break;case"together":nu(c,!1,null,null,void 0,y);break;default:c.memoizedState=null}return c.child}function Hi(a,c,m){if(a!==null&&(c.dependencies=a.dependencies),Fo|=c.lanes,(m&c.childLanes)===0)if(a!==null){if(Ro(a,c,m,!1),(m&c.childLanes)===0)return null}else return null;if(a!==null&&c.child!==a.child)throw Error(n(153));if(c.child!==null){for(a=c.child,m=yr(a,a.pendingProps),c.child=m,m.return=c;a.sibling!==null;)a=a.sibling,m=m.sibling=yr(a,a.pendingProps),m.return=c;m.sibling=null}return c.child}function Ap(a,c){return(a.lanes&c)!==0?!0:(a=a.dependencies,!!(a!==null&&df(a)))}function GS(a,c,m){switch(c.tag){case 3:pe(c,c.stateNode.containerInfo),il(c,es,a.memoizedState.cache),Yl();break;case 27:case 5:Ye(c);break;case 4:pe(c,c.stateNode.containerInfo);break;case 10:il(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,Ng(c),null;break;case 13:var y=c.memoizedState;if(y!==null)return y.dehydrated!==null?(ol(c),c.flags|=128,null):(m&c.child.childLanes)!==0?S_(a,c,m):(ol(c),a=Hi(a,c,m),a!==null?a.sibling:null);ol(c);break;case 19:var A=(a.flags&128)!==0;if(y=(m&c.childLanes)!==0,y||(Ro(a,c,m,!1),y=(m&c.childLanes)!==0),A){if(y)return Tr(a,c,m);c.flags|=128}if(A=c.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),ae(An,An.current),y)break;return null;case 22:return c.lanes=0,eu(a,c,m,c.pendingProps);case 24:il(c,es,a.memoizedState.cache)}return Hi(a,c,m)}function Ep(a,c,m){if(a!==null)if(a.memoizedProps!==c.pendingProps)ts=!0;else{if(!Ap(a,m)&&(c.flags&128)===0)return ts=!1,GS(a,c,m);ts=(a.flags&131072)!==0}else ts=!1,wn&&(c.flags&1048576)!==0&&Dy(c,Yu,c.index);switch(c.lanes=0,c.tag){case 16:e:{var y=c.pendingProps;if(a=jc(c.elementType),c.type=a,typeof a=="function")Yd(a)?(y=nc(a,y),c.tag=1,c=Mp(null,c,a,y,m)):(c.tag=0,c=ah(null,c,a,y,m));else{if(a!=null){var A=a.$$typeof;if(A===I){c.tag=11,c=a0(null,c,a,y,m);break e}else if(A===U){c.tag=14,c=$c(null,c,a,y,m);break e}}throw c=K(a)||a,Error(n(306,c,""))}}return c;case 0:return ah(a,c,c.type,c.pendingProps,m);case 1:return y=c.type,A=nc(y,c.pendingProps),Mp(a,c,y,A,m);case 3:e:{if(pe(c,c.stateNode.containerInfo),a===null)throw Error(n(387));y=c.pendingProps;var E=c.memoizedState;A=E.element,Cg(a,c),eh(c,y,null,m);var z=c.memoizedState;if(y=z.cache,il(c,es,y),y!==E.cache&&tp(c,[es],m,!0),yf(),y=z.element,E.isDehydrated)if(E={element:y,isDehydrated:!1,cache:z.cache},c.updateQueue.baseState=E,c.memoizedState=E,c.flags&256){c=b_(a,c,y,m);break e}else if(y!==A){A=qr(Error(n(424)),c),Ao(A),c=b_(a,c,y,m);break e}else for(a=c.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,si=zo(a.firstChild),Oi=c,wn=!0,nl=null,Xr=!0,m=op(c,null,y,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Yl(),y===A){c=Hi(a,c,m);break e}Ts(a,c,y,m)}c=c.child}return c;case 26:return tu(a,c),a===null?(m=DC(c.type,null,c.pendingProps,null))?c.memoizedState=m:wn||(m=c.type,a=c.pendingProps,y=E_(se.current).createElement(m),y[Fn]=c,y[Ni]=a,dr(y,m,a),J(y),c.stateNode=y):c.memoizedState=DC(c.type,a.memoizedProps,c.pendingProps,a.memoizedState),null;case 27:return Ye(c),a===null&&wn&&(y=c.stateNode=EC(c.type,c.pendingProps,se.current),Oi=c,Xr=!0,A=si,gh(c.type)?(nM=A,si=zo(y.firstChild)):si=A),Ts(a,c,c.pendingProps.children,m),tu(a,c),a===null&&(c.flags|=4194304),c.child;case 5:return a===null&&wn&&((A=y=si)&&(y=gF(y,c.type,c.pendingProps,Xr),y!==null?(c.stateNode=y,Oi=c,si=zo(y.firstChild),Xr=!1,A=!0):A=!1),A||wo(c)),Ye(c),A=c.type,E=c.pendingProps,z=a!==null?a.memoizedProps:null,y=E.children,QS(A,E)?y=null:z!==null&&QS(A,z)&&(c.flags|=32),c.memoizedState!==null&&(A=up(a,c,Jc,null,null,m),_0._currentValue=A),tu(a,c),Ts(a,c,y,m),c.child;case 6:return a===null&&wn&&((a=m=si)&&(m=vF(m,c.pendingProps,Xr),m!==null?(c.stateNode=m,Oi=c,si=null,a=!0):a=!1),a||wo(c)),null;case 13:return S_(a,c,m);case 4:return pe(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=rl(c,null,y,m):Ts(a,c,y,m),c.child;case 11:return a0(a,c,c.type,c.pendingProps,m);case 7:return Ts(a,c,c.pendingProps,m),c.child;case 8:return Ts(a,c,c.pendingProps.children,m),c.child;case 12:return Ts(a,c,c.pendingProps.children,m),c.child;case 10:return y=c.pendingProps,il(c,c.type,y.value),Ts(a,c,y.children,m),c.child;case 9:return A=c.type._context,y=c.pendingProps.children,Kl(c),A=Yt(A),y=y(A),c.flags|=1,Ts(a,c,y,m),c.child;case 14:return $c(a,c,c.type,c.pendingProps,m);case 15:return xp(a,c,c.type,c.pendingProps,m);case 19:return Tr(a,c,m);case 31:return Sp(a,c,m);case 22:return eu(a,c,m,c.pendingProps);case 24:return Kl(c),y=Yt(es),a===null?(A=ip(),A===null&&(A=Jt,E=Mg(),A.pooledCache=E,E.refCount++,E!==null&&(A.pooledCacheLanes|=m),A=E),c.memoizedState={parent:y,cache:A},vf(c),il(c,es,A)):((a.lanes&m)!==0&&(Cg(a,c),eh(c,null,null,m),yf()),A=a.memoizedState,E=c.memoizedState,A.parent!==y?(A={parent:y,cache:y},c.memoizedState=A,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=A),il(c,es,y)):(y=E.cache,il(c,es,y),y!==A.cache&&tp(c,[es],m,!0))),Ts(a,c,c.pendingProps.children,m),c.child;case 29:throw c.pendingProps}throw Error(n(156,c.tag))}function Io(a){a.flags|=4}function Af(a,c,m,y,A){if((c=(a.mode&32)!==0)&&(c=!1),c){if(a.flags|=16777216,(A&335544128)===A)if(a.stateNode.complete)a.flags|=8192;else if(Ci())a.flags|=8192;else throw Do=sp,mf}else a.flags&=-16777217}function c0(a,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!UC(c))if(Ci())a.flags|=8192;else throw Do=sp,mf}function cl(a,c){c!==null&&(a.flags|=4),a.flags&16384&&(c=a.tag!==22?_t():536870912,a.lanes|=c,hi|=c)}function Oo(a,c){if(!wn)switch(a.tailMode){case"hidden":c=a.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?a.tail=null:m.sibling=null;break;case"collapsed":m=a.tail;for(var y=null;m!==null;)m.alternate!==null&&(y=m),m=m.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function Qn(a){var c=a.alternate!==null&&a.alternate.child===a.child,m=0,y=0;if(c)for(var A=a.child;A!==null;)m|=A.lanes|A.childLanes,y|=A.subtreeFlags&65011712,y|=A.flags&65011712,A.return=a,A=A.sibling;else for(A=a.child;A!==null;)m|=A.lanes|A.childLanes,y|=A.subtreeFlags,y|=A.flags,A.return=a,A=A.sibling;return a.subtreeFlags|=y,a.childLanes=m,c}function Ef(a,c,m){var y=c.pendingProps;switch(Qd(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qn(c),null;case 1:return Qn(c),null;case 3:return m=c.stateNode,y=null,a!==null&&(y=a.memoizedState.cache),c.memoizedState.cache!==y&&(c.flags|=2048),Co(es),Ie(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(Ku(c)?Io(c):a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,$d())),Qn(c),null;case 26:var A=c.type,E=c.memoizedState;return a===null?(Io(c),E!==null?(Qn(c),c0(c,E)):(Qn(c),Af(c,A,null,y,m))):E?E!==a.memoizedState?(Io(c),Qn(c),c0(c,E)):(Qn(c),c.flags&=-16777217):(a=a.memoizedProps,a!==y&&Io(c),Qn(c),Af(c,A,a,y,m)),null;case 27:if(et(c),m=se.current,A=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==y&&Io(c);else{if(!y){if(c.stateNode===null)throw Error(n(166));return Qn(c),null}a=fe.current,Ku(c)?Ny(c):(a=EC(A,y,m),c.stateNode=a,Io(c))}return Qn(c),null;case 5:if(et(c),A=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==y&&Io(c);else{if(!y){if(c.stateNode===null)throw Error(n(166));return Qn(c),null}if(E=fe.current,Ku(c))Ny(c);else{var z=E_(se.current);switch(E){case 1:E=z.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:E=z.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":E=z.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":E=z.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":E=z.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof y.is=="string"?z.createElement("select",{is:y.is}):z.createElement("select"),y.multiple?E.multiple=!0:y.size&&(E.size=y.size);break;default:E=typeof y.is=="string"?z.createElement(A,{is:y.is}):z.createElement(A)}}E[Fn]=c,E[Ni]=y;e:for(z=c.child;z!==null;){if(z.tag===5||z.tag===6)E.appendChild(z.stateNode);else if(z.tag!==4&&z.tag!==27&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===c)break e;for(;z.sibling===null;){if(z.return===null||z.return===c)break e;z=z.return}z.sibling.return=z.return,z=z.sibling}c.stateNode=E;e:switch(dr(E,A,y),A){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}y&&Io(c)}}return Qn(c),Af(c,c.type,a===null?null:a.memoizedProps,c.pendingProps,m),null;case 6:if(a&&c.stateNode!=null)a.memoizedProps!==y&&Io(c);else{if(typeof y!="string"&&c.stateNode===null)throw Error(n(166));if(a=se.current,Ku(c)){if(a=c.stateNode,m=c.memoizedProps,y=null,A=Oi,A!==null)switch(A.tag){case 27:case 5:y=A.memoizedProps}a[Fn]=c,a=!!(a.nodeValue===m||y!==null&&y.suppressHydrationWarning===!0||gC(a.nodeValue,m)),a||wo(c,!0)}else a=E_(a).createTextNode(y),a[Fn]=c,c.stateNode=a}return Qn(c),null;case 31:if(m=c.memoizedState,a===null||a.memoizedState!==null){if(y=Ku(c),m!==null){if(a===null){if(!y)throw Error(n(318));if(a=c.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[Fn]=c}else Yl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Qn(c),a=!1}else m=$d(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),a=!0;if(!a)return c.flags&256?(Vi(c),c):(Vi(c),null);if((c.flags&128)!==0)throw Error(n(558))}return Qn(c),null;case 13:if(y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(A=Ku(c),y!==null&&y.dehydrated!==null){if(a===null){if(!A)throw Error(n(318));if(A=c.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));A[Fn]=c}else Yl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Qn(c),A=!1}else A=$d(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=A),A=!0;if(!A)return c.flags&256?(Vi(c),c):(Vi(c),null)}return Vi(c),(c.flags&128)!==0?(c.lanes=m,c):(m=y!==null,a=a!==null&&a.memoizedState!==null,m&&(y=c.child,A=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(A=y.alternate.memoizedState.cachePool.pool),E=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(E=y.memoizedState.cachePool.pool),E!==A&&(y.flags|=2048)),m!==a&&m&&(c.child.flags|=8192),cl(c,c.updateQueue),Qn(c),null);case 4:return Ie(),a===null&&qS(c.stateNode.containerInfo),Qn(c),null;case 10:return Co(c.type),Qn(c),null;case 19:if(Q(An),y=c.memoizedState,y===null)return Qn(c),null;if(A=(c.flags&128)!==0,E=y.rendering,E===null)if(A)Oo(y,!1);else{if(Ai!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(E=Zr(a),E!==null){for(c.flags|=128,Oo(y,!1),a=E.updateQueue,c.updateQueue=a,cl(c,a),c.subtreeFlags=0,a=m,m=c.child;m!==null;)ju(m,a),m=m.sibling;return ae(An,An.current&1|2),wn&&Mo(c,y.treeForkCount),c.child}a=a.sibling}y.tail!==null&&V()>Wi&&(c.flags|=128,A=!0,Oo(y,!1),c.lanes=4194304)}else{if(!A)if(a=Zr(E),a!==null){if(c.flags|=128,A=!0,a=a.updateQueue,c.updateQueue=a,cl(c,a),Oo(y,!0),y.tail===null&&y.tailMode==="hidden"&&!E.alternate&&!wn)return Qn(c),null}else 2*V()-y.renderingStartTime>Wi&&m!==536870912&&(c.flags|=128,A=!0,Oo(y,!1),c.lanes=4194304);y.isBackwards?(E.sibling=c.child,c.child=E):(a=y.last,a!==null?a.sibling=E:c.child=E,y.last=E)}return y.tail!==null?(a=y.tail,y.rendering=a,y.tail=a.sibling,y.renderingStartTime=V(),a.sibling=null,m=An.current,ae(An,A?m&1|2:m&1),wn&&Mo(c,y.treeForkCount),a):(Qn(c),null);case 22:case 23:return Vi(c),_f(),y=c.memoizedState!==null,a!==null?a.memoizedState!==null!==y&&(c.flags|=8192):y&&(c.flags|=8192),y?(m&536870912)!==0&&(c.flags&128)===0&&(Qn(c),c.subtreeFlags&6&&(c.flags|=8192)):Qn(c),m=c.updateQueue,m!==null&&cl(c,m.retryQueue),m=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==m&&(c.flags|=2048),a!==null&&Q(Ql),null;case 24:return m=null,a!==null&&(m=a.memoizedState.cache),c.memoizedState.cache!==m&&(c.flags|=2048),Co(es),Qn(c),null;case 25:return null;case 30:return null}throw Error(n(156,c.tag))}function Aa(a,c){switch(Qd(c),c.tag){case 1:return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return Co(es),Ie(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 26:case 27:case 5:return et(c),null;case 31:if(c.memoizedState!==null){if(Vi(c),c.alternate===null)throw Error(n(340));Yl()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 13:if(Vi(c),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Yl()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Q(An),null;case 4:return Ie(),null;case 10:return Co(c.type),null;case 22:case 23:return Vi(c),_f(),a!==null&&Q(Ql),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 24:return Co(es),null;case 25:return null;default:return null}}function Kr(a,c){switch(Qd(c),c.tag){case 3:Co(es),Ie();break;case 26:case 27:case 5:et(c);break;case 4:Ie();break;case 31:c.memoizedState!==null&&Vi(c);break;case 13:Vi(c);break;case 19:Q(An);break;case 10:Co(c.type);break;case 22:case 23:Vi(c),_f(),a!==null&&Q(Ql);break;case 24:Co(es)}}function Ea(a,c){try{var m=c.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var A=y.next;m=A;do{if((m.tag&a)===a){y=void 0;var E=m.create,z=m.inst;y=E(),z.destroy=y}m=m.next}while(m!==A)}}catch($){Un(c,c.return,$)}}function Ps(a,c,m){try{var y=c.updateQueue,A=y!==null?y.lastEffect:null;if(A!==null){var E=A.next;y=E;do{if((y.tag&a)===a){var z=y.inst,$=z.destroy;if($!==void 0){z.destroy=void 0,A=c;var me=m,Fe=$;try{Fe()}catch(nt){Un(A,me,nt)}}}y=y.next}while(y!==E)}}catch(nt){Un(c,c.return,nt)}}function $a(a){var c=a.updateQueue;if(c!==null){var m=a.stateNode;try{Ly(c,m)}catch(y){Un(a,a.return,y)}}}function ws(a,c,m){m.props=nc(a.type,a.memoizedProps),m.state=a.memoizedState;try{m.componentWillUnmount()}catch(y){Un(a,c,y)}}function ul(a,c){try{var m=a.ref;if(m!==null){switch(a.tag){case 26:case 27:case 5:var y=a.stateNode;break;case 30:y=a.stateNode;break;default:y=a.stateNode}typeof m=="function"?a.refCleanup=m(y):m.current=y}}catch(A){Un(a,c,A)}}function Us(a,c){var m=a.ref,y=a.refCleanup;if(m!==null)if(typeof y=="function")try{y()}catch(A){Un(a,c,A)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(A){Un(a,c,A)}else m.current=null}function Cf(a){var c=a.type,m=a.memoizedProps,y=a.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":m.autoFocus&&y.focus();break e;case"img":m.src?y.src=m.src:m.srcSet&&(y.srcset=m.srcSet)}}catch(A){Un(a,a.return,A)}}function us(a,c,m){try{var y=a.stateNode;uF(y,a.type,m,c),y[Ni]=c}catch(A){Un(a,a.return,A)}}function xi(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&gh(a.type)||a.tag===4}function bn(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||xi(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&gh(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Po(a,c,m){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(a,c):(c=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,c.appendChild(a),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=js));else if(y!==4&&(y===27&&gh(a.type)&&(m=a.stateNode,c=null),a=a.child,a!==null))for(Po(a,c,m),a=a.sibling;a!==null;)Po(a,c,m),a=a.sibling}function cr(a,c,m){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?m.insertBefore(a,c):m.appendChild(a);else if(y!==4&&(y===27&&gh(a.type)&&(m=a.stateNode),a=a.child,a!==null))for(cr(a,c,m),a=a.sibling;a!==null;)cr(a,c,m),a=a.sibling}function Cp(a){var c=a.stateNode,m=a.memoizedProps;try{for(var y=a.type,A=c.attributes;A.length;)c.removeAttributeNode(A[0]);dr(c,y,m),c[Fn]=a,c[Ni]=m}catch(E){Un(a,a.return,E)}}var Ca=!1,ri=!1,eo=!1,T_=typeof WeakSet=="function"?WeakSet:Set,As=null;function HS(a,c){if(a=a.containerInfo,ZS=P_,a=Ay(a),yg(a)){if("selectionStart"in a)var m={start:a.selectionStart,end:a.selectionEnd};else e:{m=(m=a.ownerDocument)&&m.defaultView||window;var y=m.getSelection&&m.getSelection();if(y&&y.rangeCount!==0){m=y.anchorNode;var A=y.anchorOffset,E=y.focusNode;y=y.focusOffset;try{m.nodeType,E.nodeType}catch{m=null;break e}var z=0,$=-1,me=-1,Fe=0,nt=0,ot=a,Ve=null;t:for(;;){for(var Ke;ot!==m||A!==0&&ot.nodeType!==3||($=z+A),ot!==E||y!==0&&ot.nodeType!==3||(me=z+y),ot.nodeType===3&&(z+=ot.nodeValue.length),(Ke=ot.firstChild)!==null;)Ve=ot,ot=Ke;for(;;){if(ot===a)break t;if(Ve===m&&++Fe===A&&($=z),Ve===E&&++nt===y&&(me=z),(Ke=ot.nextSibling)!==null)break;ot=Ve,Ve=ot.parentNode}ot=Ke}m=$===-1||me===-1?null:{start:$,end:me}}else m=null}m=m||{start:0,end:0}}else m=null;for(KS={focusedElem:a,selectionRange:m},P_=!1,As=c;As!==null;)if(c=As,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,As=a;else for(;As!==null;){switch(c=As,E=c.alternate,a=c.flags,c.tag){case 0:if((a&4)!==0&&(a=c.updateQueue,a=a!==null?a.events:null,a!==null))for(m=0;m<a.length;m++)A=a[m],A.ref.impl=A.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&E!==null){a=void 0,m=c,A=E.memoizedProps,E=E.memoizedState,y=m.stateNode;try{var Ot=nc(m.type,A);a=y.getSnapshotBeforeUpdate(Ot,E),y.__reactInternalSnapshotBeforeUpdate=a}catch(qt){Un(m,m.return,qt)}}break;case 3:if((a&1024)!==0){if(a=c.stateNode.containerInfo,m=a.nodeType,m===9)$S(a);else if(m===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":$S(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=c.sibling,a!==null){a.return=c.return,As=a;break}As=c.return}}function bi(a,c,m){var y=m.flags;switch(m.tag){case 0:case 11:case 15:Na(a,m),y&4&&Ea(5,m);break;case 1:if(Na(a,m),y&4)if(a=m.stateNode,c===null)try{a.componentDidMount()}catch(z){Un(m,m.return,z)}else{var A=nc(m.type,c.memoizedProps);c=c.memoizedState;try{a.componentDidUpdate(A,c,a.__reactInternalSnapshotBeforeUpdate)}catch(z){Un(m,m.return,z)}}y&64&&$a(m),y&512&&ul(m,m.return);break;case 3:if(Na(a,m),y&64&&(a=m.updateQueue,a!==null)){if(c=null,m.child!==null)switch(m.child.tag){case 27:case 5:c=m.child.stateNode;break;case 1:c=m.child.stateNode}try{Ly(a,c)}catch(z){Un(m,m.return,z)}}break;case 27:c===null&&y&4&&Cp(m);case 26:case 5:Na(a,m),c===null&&y&4&&Cf(m),y&512&&ul(m,m.return);break;case 12:Na(a,m);break;case 31:Na(a,m),y&4&&ic(a,m);break;case 13:Na(a,m),y&4&&oh(a,m),y&64&&(a=m.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(m=_.bind(null,m),yF(a,m))));break;case 22:if(y=m.memoizedState!==null||Ca,!y){c=c!==null&&c.memoizedState!==null||ri,A=Ca;var E=ri;Ca=y,(ri=c)&&!E?ur(a,m,(m.subtreeFlags&8772)!==0):Na(a,m),Ca=A,ri=E}break;case 30:break;default:Na(a,m)}}function Rf(a){var c=a.alternate;c!==null&&(a.alternate=null,Rf(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&fa(c)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var qn=null,Ks=!1;function Ra(a,c,m){for(m=m.child;m!==null;)Rp(a,c,m),m=m.sibling}function Rp(a,c,m){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(He,m)}catch{}switch(m.tag){case 26:ri||Us(m,c),Ra(a,c,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:ri||Us(m,c);var y=qn,A=Ks;gh(m.type)&&(qn=m.stateNode,Ks=!1),Ra(a,c,m),g0(m.stateNode),qn=y,Ks=A;break;case 5:ri||Us(m,c);case 6:if(y=qn,A=Ks,qn=null,Ra(a,c,m),qn=y,Ks=A,qn!==null)if(Ks)try{(qn.nodeType===9?qn.body:qn.nodeName==="HTML"?qn.ownerDocument.body:qn).removeChild(m.stateNode)}catch(E){Un(m,c,E)}else try{qn.removeChild(m.stateNode)}catch(E){Un(m,c,E)}break;case 18:qn!==null&&(Ks?(a=qn,SC(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,m.stateNode),Fp(a)):SC(qn,m.stateNode));break;case 4:y=qn,A=Ks,qn=m.stateNode.containerInfo,Ks=!0,Ra(a,c,m),qn=y,Ks=A;break;case 0:case 11:case 14:case 15:Ps(2,m,c),ri||Ps(4,m,c),Ra(a,c,m);break;case 1:ri||(Us(m,c),y=m.stateNode,typeof y.componentWillUnmount=="function"&&ws(m,c,y)),Ra(a,c,m);break;case 21:Ra(a,c,m);break;case 22:ri=(y=ri)||m.memoizedState!==null,Ra(a,c,m),ri=y;break;default:Ra(a,c,m)}}function ic(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Fp(a)}catch(m){Un(c,c.return,m)}}}function oh(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Fp(a)}catch(m){Un(c,c.return,m)}}function u0(a){switch(a.tag){case 31:case 13:case 19:var c=a.stateNode;return c===null&&(c=a.stateNode=new T_),c;case 22:return a=a.stateNode,c=a._retryCache,c===null&&(c=a._retryCache=new T_),c;default:throw Error(n(435,a.tag))}}function hl(a,c){var m=u0(a);c.forEach(function(y){if(!m.has(y)){m.add(y);var A=T.bind(null,a,y);y.then(A,A)}})}function hs(a,c){var m=c.deletions;if(m!==null)for(var y=0;y<m.length;y++){var A=m[y],E=a,z=c,$=z;e:for(;$!==null;){switch($.tag){case 27:if(gh($.type)){qn=$.stateNode,Ks=!1;break e}break;case 5:qn=$.stateNode,Ks=!1;break e;case 3:case 4:qn=$.stateNode.containerInfo,Ks=!0;break e}$=$.return}if(qn===null)throw Error(n(160));Rp(E,z,A),qn=null,Ks=!1,E=A.alternate,E!==null&&(E.return=null),A.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)sc(c,a),c=c.sibling}var Da=null;function sc(a,c){var m=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:hs(c,a),fs(a),y&4&&(Ps(3,a,a.return),Ea(3,a),Ps(5,a,a.return));break;case 1:hs(c,a),fs(a),y&512&&(ri||m===null||Us(m,m.return)),y&64&&Ca&&(a=a.updateQueue,a!==null&&(y=a.callbacks,y!==null&&(m=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=m===null?y:m.concat(y))));break;case 26:var A=Da;if(hs(c,a),fs(a),y&512&&(ri||m===null||Us(m,m.return)),y&4){var E=m!==null?m.memoizedState:null;if(y=a.memoizedState,m===null)if(y===null)if(a.stateNode===null){e:{y=a.type,m=a.memoizedProps,A=A.ownerDocument||A;t:switch(y){case"title":E=A.getElementsByTagName("title")[0],(!E||E[Vr]||E[Fn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=A.createElement(y),A.head.insertBefore(E,A.querySelector("head > title"))),dr(E,y,m),E[Fn]=a,J(E),y=E;break e;case"link":var z=OC("link","href",A).get(y+(m.href||""));if(z){for(var $=0;$<z.length;$++)if(E=z[$],E.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&E.getAttribute("rel")===(m.rel==null?null:m.rel)&&E.getAttribute("title")===(m.title==null?null:m.title)&&E.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){z.splice($,1);break t}}E=A.createElement(y),dr(E,y,m),A.head.appendChild(E);break;case"meta":if(z=OC("meta","content",A).get(y+(m.content||""))){for($=0;$<z.length;$++)if(E=z[$],E.getAttribute("content")===(m.content==null?null:""+m.content)&&E.getAttribute("name")===(m.name==null?null:m.name)&&E.getAttribute("property")===(m.property==null?null:m.property)&&E.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&E.getAttribute("charset")===(m.charSet==null?null:m.charSet)){z.splice($,1);break t}}E=A.createElement(y),dr(E,y,m),A.head.appendChild(E);break;default:throw Error(n(468,y))}E[Fn]=a,J(E),y=E}a.stateNode=y}else PC(A,a.type,a.stateNode);else a.stateNode=IC(A,y,a.memoizedProps);else E!==y?(E===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):E.count--,y===null?PC(A,a.type,a.stateNode):IC(A,y,a.memoizedProps)):y===null&&a.stateNode!==null&&us(a,a.memoizedProps,m.memoizedProps)}break;case 27:hs(c,a),fs(a),y&512&&(ri||m===null||Us(m,m.return)),m!==null&&y&4&&us(a,a.memoizedProps,m.memoizedProps);break;case 5:if(hs(c,a),fs(a),y&512&&(ri||m===null||Us(m,m.return)),a.flags&32){A=a.stateNode;try{gi(A,"")}catch(Ot){Un(a,a.return,Ot)}}y&4&&a.stateNode!=null&&(A=a.memoizedProps,us(a,A,m!==null?m.memoizedProps:A)),y&1024&&(eo=!0);break;case 6:if(hs(c,a),fs(a),y&4){if(a.stateNode===null)throw Error(n(162));y=a.memoizedProps,m=a.stateNode;try{m.nodeValue=y}catch(Ot){Un(a,a.return,Ot)}}break;case 3:if(D_=null,A=Da,Da=C_(c.containerInfo),hs(c,a),Da=A,fs(a),y&4&&m!==null&&m.memoizedState.isDehydrated)try{Fp(c.containerInfo)}catch(Ot){Un(a,a.return,Ot)}eo&&(eo=!1,Dp(a));break;case 4:y=Da,Da=C_(a.stateNode.containerInfo),hs(c,a),fs(a),Da=y;break;case 12:hs(c,a),fs(a);break;case 31:hs(c,a),fs(a),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,hl(a,y)));break;case 13:hs(c,a),fs(a),a.child.flags&8192&&a.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(lh=V()),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,hl(a,y)));break;case 22:A=a.memoizedState!==null;var me=m!==null&&m.memoizedState!==null,Fe=Ca,nt=ri;if(Ca=Fe||A,ri=nt||me,hs(c,a),ri=nt,Ca=Fe,fs(a),y&8192)e:for(c=a.stateNode,c._visibility=A?c._visibility&-2:c._visibility|1,A&&(m===null||me||Ca||ri||Uo(a)),m=null,c=a;;){if(c.tag===5||c.tag===26){if(m===null){me=m=c;try{if(E=me.stateNode,A)z=E.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{$=me.stateNode;var ot=me.memoizedProps.style,Ve=ot!=null&&ot.hasOwnProperty("display")?ot.display:null;$.style.display=Ve==null||typeof Ve=="boolean"?"":(""+Ve).trim()}}catch(Ot){Un(me,me.return,Ot)}}}else if(c.tag===6){if(m===null){me=c;try{me.stateNode.nodeValue=A?"":me.memoizedProps}catch(Ot){Un(me,me.return,Ot)}}}else if(c.tag===18){if(m===null){me=c;try{var Ke=me.stateNode;A?MC(Ke,!0):MC(me.stateNode,!1)}catch(Ot){Un(me,me.return,Ot)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===a)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break e;for(;c.sibling===null;){if(c.return===null||c.return===a)break e;m===c&&(m=null),c=c.return}m===c&&(m=null),c.sibling.return=c.return,c=c.sibling}y&4&&(y=a.updateQueue,y!==null&&(m=y.retryQueue,m!==null&&(y.retryQueue=null,hl(a,m))));break;case 19:hs(c,a),fs(a),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,hl(a,y)));break;case 30:break;case 21:break;default:hs(c,a),fs(a)}}function fs(a){var c=a.flags;if(c&2){try{for(var m,y=a.return;y!==null;){if(xi(y)){m=y;break}y=y.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var A=m.stateNode,E=bn(a);cr(a,E,A);break;case 5:var z=m.stateNode;m.flags&32&&(gi(z,""),m.flags&=-33);var $=bn(a);cr(a,$,z);break;case 3:case 4:var me=m.stateNode.containerInfo,Fe=bn(a);Po(a,Fe,me);break;default:throw Error(n(161))}}catch(nt){Un(a,a.return,nt)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function Dp(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var c=a;Dp(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),a=a.sibling}}function Na(a,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)bi(a,c.alternate,c),c=c.sibling}function Uo(a){for(a=a.child;a!==null;){var c=a;switch(c.tag){case 0:case 11:case 14:case 15:Ps(4,c,c.return),Uo(c);break;case 1:Us(c,c.return);var m=c.stateNode;typeof m.componentWillUnmount=="function"&&ws(c,c.return,m),Uo(c);break;case 27:g0(c.stateNode);case 26:case 5:Us(c,c.return),Uo(c);break;case 22:c.memoizedState===null&&Uo(c);break;case 30:Uo(c);break;default:Uo(c)}a=a.sibling}}function ur(a,c,m){for(m=m&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var y=c.alternate,A=a,E=c,z=E.flags;switch(E.tag){case 0:case 11:case 15:ur(A,E,m),Ea(4,E);break;case 1:if(ur(A,E,m),y=E,A=y.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Fe){Un(y,y.return,Fe)}if(y=E,A=y.updateQueue,A!==null){var $=y.stateNode;try{var me=A.shared.hiddenCallbacks;if(me!==null)for(A.shared.hiddenCallbacks=null,A=0;A<me.length;A++)th(me[A],$)}catch(Fe){Un(y,y.return,Fe)}}m&&z&64&&$a(E),ul(E,E.return);break;case 27:Cp(E);case 26:case 5:ur(A,E,m),m&&y===null&&z&4&&Cf(E),ul(E,E.return);break;case 12:ur(A,E,m);break;case 31:ur(A,E,m),m&&z&4&&ic(A,E);break;case 13:ur(A,E,m),m&&z&4&&oh(A,E);break;case 22:E.memoizedState===null&&ur(A,E,m),ul(E,E.return);break;case 30:break;default:ur(A,E,m)}c=c.sibling}}function rc(a,c){var m=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),a=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(a=c.memoizedState.cachePool.pool),a!==m&&(a!=null&&a.refCount++,m!=null&&Hc(m))}function iu(a,c){a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&Hc(a))}function Ls(a,c,m,y){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)h0(a,c,m,y),c=c.sibling}function h0(a,c,m,y){var A=c.flags;switch(c.tag){case 0:case 11:case 15:Ls(a,c,m,y),A&2048&&Ea(9,c);break;case 1:Ls(a,c,m,y);break;case 3:Ls(a,c,m,y),A&2048&&(a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&Hc(a)));break;case 12:if(A&2048){Ls(a,c,m,y),a=c.stateNode;try{var E=c.memoizedProps,z=E.id,$=E.onPostCommit;typeof $=="function"&&$(z,c.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(me){Un(c,c.return,me)}}else Ls(a,c,m,y);break;case 31:Ls(a,c,m,y);break;case 13:Ls(a,c,m,y);break;case 23:break;case 22:E=c.stateNode,z=c.alternate,c.memoizedState!==null?E._visibility&2?Ls(a,c,m,y):Lo(a,c):E._visibility&2?Ls(a,c,m,y):(E._visibility|=2,Fs(a,c,m,y,(c.subtreeFlags&10256)!==0||!1)),A&2048&&rc(z,c);break;case 24:Ls(a,c,m,y),A&2048&&iu(c.alternate,c);break;default:Ls(a,c,m,y)}}function Fs(a,c,m,y,A){for(A=A&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var E=a,z=c,$=m,me=y,Fe=z.flags;switch(z.tag){case 0:case 11:case 15:Fs(E,z,$,me,A),Ea(8,z);break;case 23:break;case 22:var nt=z.stateNode;z.memoizedState!==null?nt._visibility&2?Fs(E,z,$,me,A):Lo(E,z):(nt._visibility|=2,Fs(E,z,$,me,A)),A&&Fe&2048&&rc(z.alternate,z);break;case 24:Fs(E,z,$,me,A),A&&Fe&2048&&iu(z.alternate,z);break;default:Fs(E,z,$,me,A)}c=c.sibling}}function Lo(a,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var m=a,y=c,A=y.flags;switch(y.tag){case 22:Lo(m,y),A&2048&&rc(y.alternate,y);break;case 24:Lo(m,y),A&2048&&iu(y.alternate,y);break;default:Lo(m,y)}c=c.sibling}}var su=8192;function Qr(a,c,m){if(a.subtreeFlags&su)for(a=a.child;a!==null;)Np(a,c,m),a=a.sibling}function Np(a,c,m){switch(a.tag){case 26:Qr(a,c,m),a.flags&su&&a.memoizedState!==null&&DF(m,Da,a.memoizedState,a.memoizedProps);break;case 5:Qr(a,c,m);break;case 3:case 4:var y=Da;Da=C_(a.stateNode.containerInfo),Qr(a,c,m),Da=y;break;case 22:a.memoizedState===null&&(y=a.alternate,y!==null&&y.memoizedState!==null?(y=su,su=16777216,Qr(a,c,m),su=y):Qr(a,c,m));break;default:Qr(a,c,m)}}function ru(a){var c=a.alternate;if(c!==null&&(a=c.child,a!==null)){c.child=null;do c=a.sibling,a.sibling=null,a=c;while(a!==null)}}function ac(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var m=0;m<c.length;m++){var y=c[m];As=y,Pi(y,a)}ru(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)wr(a),a=a.sibling}function wr(a){switch(a.tag){case 0:case 11:case 15:ac(a),a.flags&2048&&Ps(9,a,a.return);break;case 3:ac(a);break;case 12:ac(a);break;case 22:var c=a.stateNode;a.memoizedState!==null&&c._visibility&2&&(a.return===null||a.return.tag!==13)?(c._visibility&=-3,Ar(a)):ac(a);break;default:ac(a)}}function Ar(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var m=0;m<c.length;m++){var y=c[m];As=y,Pi(y,a)}ru(a)}for(a=a.child;a!==null;){switch(c=a,c.tag){case 0:case 11:case 15:Ps(8,c,c.return),Ar(c);break;case 22:m=c.stateNode,m._visibility&2&&(m._visibility&=-3,Ar(c));break;default:Ar(c)}a=a.sibling}}function Pi(a,c){for(;As!==null;){var m=As;switch(m.tag){case 0:case 11:case 15:Ps(8,m,c);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var y=m.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:Hc(m.memoizedState.cache)}if(y=m.child,y!==null)y.return=m,As=y;else e:for(m=a;As!==null;){y=As;var A=y.sibling,E=y.return;if(Rf(y),y===m){As=null;break e}if(A!==null){A.return=E,As=A;break e}As=E}}}var fl={getCacheForType:function(a){var c=Yt(es),m=c.data.get(a);return m===void 0&&(m=a(),c.data.set(a,m)),m},cacheSignal:function(){return Yt(es).controller.signal}},rn=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Jt=null,un=null,ln=0,Rn=0,Qs=null,Ia=!1,to=!1,f0=!1,Jr=0,Ai=0,Fo=0,oc=0,Df=0,hr=0,hi=0,au=null,Ui=null,Li=!1,lh=0,d0=0,Wi=1/0,Ei=null,ji=null,Xn=0,$r=null,ch=null,Oa=0,uh=0,hh=null,Nf=null,lc=0,ou=null;function ea(){return(Lt&2)!==0&&ln!==0?ln&-ln:W.T!==null?je():nr()}function yn(){if(hr===0)if((ln&536870912)===0||wn){var a=Je;Je<<=1,(Je&3932160)===0&&(Je=262144),hr=a}else hr=536870912;return a=br.current,a!==null&&(a.flags|=32),hr}function hn(a,c,m){(a===Jt&&(Rn===2||Rn===9)||a.cancelPendingCommit!==null)&&(uc(a,0),ns(a,ln,hr,!1)),pn(a,m),((Lt&2)===0||a!==Jt)&&(a===Jt&&((Lt&2)===0&&(oc|=m),Ai===4&&ns(a,ln,hr,!1)),ft(a))}function _n(a,c,m){if((Lt&6)!==0)throw Error(n(327));var y=!m&&(c&127)===0&&(c&a.expiredLanes)===0||rt(a,c),A=y?If(a,c):fr(a,c,!0),E=y;do{if(A===0){to&&!y&&ns(a,c,0,!1);break}else{if(m=a.current.alternate,E&&!Yn(m)){A=fr(a,c,!1),E=!1;continue}if(A===2){if(E=c,a.errorRecoveryDisabledLanes&E)var z=0;else z=a.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){c=z;e:{var $=a;A=au;var me=$.current.memoizedState.isDehydrated;if(me&&(uc($,z).flags|=256),z=fr($,z,!1),z!==2){if(f0&&!me){$.errorRecoveryDisabledLanes|=E,oc|=E,A=4;break e}E=Ui,Ui=A,E!==null&&(Ui===null?Ui=E:Ui.push.apply(Ui,E))}A=z}if(E=!1,A!==2)continue}}if(A===1){uc(a,0),ns(a,c,0,!0);break}e:{switch(y=a,E=A,E){case 0:case 1:throw Error(n(345));case 4:if((c&4194048)!==c)break;case 6:ns(y,c,hr,!Ia);break e;case 2:Ui=null;break;case 3:case 5:break;default:throw Error(n(329))}if((c&62914560)===c&&(A=lh+300-V(),10<A)){if(ns(y,c,hr,!Ia),Le(y,0,!0)!==0)break e;Oa=c,y.timeoutHandle=xC(Sn.bind(null,y,m,Ui,Ei,Li,c,hr,oc,hi,Ia,E,"Throttled",-0,0),A);break e}Sn(y,m,Ui,Ei,Li,c,hr,oc,hi,Ia,E,null,-0,0)}}break}while(!0);ft(a)}function Sn(a,c,m,y,A,E,z,$,me,Fe,nt,ot,Ve,Ke){if(a.timeoutHandle=-1,ot=c.subtreeFlags,ot&8192||(ot&16785408)===16785408){ot={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:js},Np(c,E,ot);var Ot=(E&62914560)===E?lh-V():(E&4194048)===E?d0-V():0;if(Ot=NF(ot,Ot),Ot!==null){Oa=E,a.cancelPendingCommit=Ot(pl.bind(null,a,c,E,m,y,A,z,$,me,nt,ot,null,Ve,Ke)),ns(a,E,z,!Fe);return}}pl(a,c,E,m,y,A,z,$,me)}function Yn(a){for(var c=a;;){var m=c.tag;if((m===0||m===11||m===15)&&c.flags&16384&&(m=c.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var y=0;y<m.length;y++){var A=m[y],E=A.getSnapshot;A=A.value;try{if(!rr(E(),A))return!1}catch{return!1}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ns(a,c,m,y){c&=~Df,c&=~oc,a.suspendedLanes|=c,a.pingedLanes&=~c,y&&(a.warmLanes|=c),y=a.expirationTimes;for(var A=c;0<A;){var E=31-le(A),z=1<<E;y[E]=-1,A&=~z}m!==0&&Zn(a,m,c)}function no(){return(Lt&6)===0?(At(0),!1):!0}function cc(){if(un!==null){if(Rn===0)var a=un.return;else a=un,Eo=Zl=null,Lg(a),Yc=null,Zc=0,a=un;for(;a!==null;)Kr(a.alternate,a),a=a.return;un=null}}function uc(a,c){var m=a.timeoutHandle;m!==-1&&(a.timeoutHandle=-1,dF(m)),m=a.cancelPendingCommit,m!==null&&(a.cancelPendingCommit=null,m()),Oa=0,cc(),Jt=a,un=m=yr(a.current,null),ln=c,Rn=0,Qs=null,Ia=!1,to=rt(a,c),f0=!1,hi=hr=Df=oc=Fo=Ai=0,Ui=au=null,Li=!1,(c&8)!==0&&(c|=c&32);var y=a.entangledLanes;if(y!==0)for(a=a.entanglements,y&=c;0<y;){var A=31-le(y),E=1<<A;c|=a[A],y&=~E}return Jr=c,hf(),m}function ko(a,c){sn=null,W.H=rh,c===Wc||c===cn?(c=qc(),Rn=3):c===mf?(c=qc(),Rn=4):Rn=c===_p?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Qs=c,un===null&&(Ai=1,yp(a,qr(c,a.current)))}function Ci(){var a=br.current;return a===null?!0:(ln&4194048)===ln?lr===null:(ln&62914560)===ln||(ln&536870912)!==0?a===lr:!1}function dl(){var a=W.H;return W.H=rh,a===null?rh:a}function hc(){var a=W.A;return W.A=fl,a}function fh(){Ai=4,Ia||(ln&4194048)!==ln&&br.current!==null||(to=!0),(Fo&134217727)===0&&(oc&134217727)===0||Jt===null||ns(Jt,ln,hr,!1)}function fr(a,c,m){var y=Lt;Lt|=2;var A=dl(),E=hc();(Jt!==a||ln!==c)&&(Ei=null,uc(a,c)),c=!1;var z=Ai;e:do try{if(Rn!==0&&un!==null){var $=un,me=Qs;switch(Rn){case 8:cc(),z=6;break e;case 3:case 2:case 9:case 6:br.current===null&&(c=!0);var Fe=Rn;if(Rn=0,Qs=null,lu(a,$,me,Fe),m&&to){z=0;break e}break;default:Fe=Rn,Rn=0,Qs=null,lu(a,$,me,Fe)}}dh(),z=Ai;break}catch(nt){ko(a,nt)}while(!0);return c&&a.shellSuspendCounter++,Eo=Zl=null,Lt=y,W.H=A,W.A=E,un===null&&(Jt=null,ln=0,hf()),z}function dh(){for(;un!==null;)Ip(un)}function If(a,c){var m=Lt;Lt|=2;var y=dl(),A=hc();Jt!==a||ln!==c?(Ei=null,Wi=V()+500,uc(a,c)):to=rt(a,c);e:do try{if(Rn!==0&&un!==null){c=un;var E=Qs;t:switch(Rn){case 1:Rn=0,Qs=null,lu(a,c,E,1);break;case 2:case 9:if(xr(E)){Rn=0,Qs=null,Of(c);break}c=function(){Rn!==2&&Rn!==9||Jt!==a||(Rn=7),ft(a)},E.then(c,c);break e;case 3:Rn=7;break e;case 4:Rn=5;break e;case 7:xr(E)?(Rn=0,Qs=null,Of(c)):(Rn=0,Qs=null,lu(a,c,E,7));break;case 5:var z=null;switch(un.tag){case 26:z=un.memoizedState;case 5:case 27:var $=un;if(z?UC(z):$.stateNode.complete){Rn=0,Qs=null;var me=$.sibling;if(me!==null)un=me;else{var Fe=$.return;Fe!==null?(un=Fe,fc(Fe)):un=null}break t}}Rn=0,Qs=null,lu(a,c,E,5);break;case 6:Rn=0,Qs=null,lu(a,c,E,6);break;case 8:cc(),Ai=6;break e;default:throw Error(n(462))}}Er();break}catch(nt){ko(a,nt)}while(!0);return Eo=Zl=null,W.H=y,W.A=A,Lt=m,un!==null?0:(Jt=null,ln=0,hf(),Ai)}function Er(){for(;un!==null&&!Oe();)Ip(un)}function Ip(a){var c=Ep(a.alternate,a,Jr);a.memoizedProps=a.pendingProps,c===null?fc(a):un=c}function Of(a){var c=a,m=c.alternate;switch(c.tag){case 15:case 0:c=Tf(m,c,c.pendingProps,c.type,void 0,ln);break;case 11:c=Tf(m,c,c.pendingProps,c.type.render,c.ref,ln);break;case 5:Lg(c);default:Kr(m,c),c=un=ju(c,Jr),c=Ep(m,c,Jr)}a.memoizedProps=a.pendingProps,c===null?fc(a):un=c}function lu(a,c,m,y){Eo=Zl=null,Lg(c),Yc=null,Zc=0;var A=c.return;try{if(cs(a,A,c,m,ln)){Ai=1,yp(a,qr(m,a.current)),un=null;return}}catch(E){if(A!==null)throw un=A,E;Ai=1,yp(a,qr(m,a.current)),un=null;return}c.flags&32768?(wn||y===1?a=!0:to||(ln&536870912)!==0?a=!1:(Ia=a=!0,(y===2||y===9||y===3||y===6)&&(y=br.current,y!==null&&y.tag===13&&(y.flags|=16384))),Pf(c,a)):fc(c)}function fc(a){var c=a;do{if((c.flags&32768)!==0){Pf(c,Ia);return}a=c.return;var m=Ef(c.alternate,c,Jr);if(m!==null){un=m;return}if(c=c.sibling,c!==null){un=c;return}un=c=a}while(c!==null);Ai===0&&(Ai=5)}function Pf(a,c){do{var m=Aa(a.alternate,a);if(m!==null){m.flags&=32767,un=m;return}if(m=a.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!c&&(a=a.sibling,a!==null)){un=a;return}un=a=m}while(a!==null);Ai=6,un=null}function pl(a,c,m,y,A,E,z,$,me){a.cancelPendingCommit=null;do ph();while(Xn!==0);if((Lt&6)!==0)throw Error(n(327));if(c!==null){if(c===a.current)throw Error(n(177));if(E=c.lanes|c.childLanes,E|=Ss,Mn(a,m,E,z,$,me),a===Jt&&(un=Jt=null,ln=0),ch=c,$r=a,Oa=m,uh=E,hh=A,Nf=y,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,N(be,function(){return Op(),null})):(a.callbackNode=null,a.callbackPriority=0),y=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||y){y=W.T,W.T=null,A=X.p,X.p=2,z=Lt,Lt|=4;try{HS(a,c,m)}finally{Lt=z,X.p=A,W.T=y}}Xn=1,is(),ml(),cu()}}function is(){if(Xn===1){Xn=0;var a=$r,c=ch,m=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||m){m=W.T,W.T=null;var y=X.p;X.p=2;var A=Lt;Lt|=4;try{sc(c,a);var E=KS,z=Ay(a.containerInfo),$=E.focusedElem,me=E.selectionRange;if(z!==$&&$&&$.ownerDocument&&ii($.ownerDocument.documentElement,$)){if(me!==null&&yg($)){var Fe=me.start,nt=me.end;if(nt===void 0&&(nt=Fe),"selectionStart"in $)$.selectionStart=Fe,$.selectionEnd=Math.min(nt,$.value.length);else{var ot=$.ownerDocument||document,Ve=ot&&ot.defaultView||window;if(Ve.getSelection){var Ke=Ve.getSelection(),Ot=$.textContent.length,qt=Math.min(me.start,Ot),oi=me.end===void 0?qt:Math.min(me.end,Ot);!Ke.extend&&qt>oi&&(z=oi,oi=qt,qt=z);var Ee=Gu($,qt),xe=Gu($,oi);if(Ee&&xe&&(Ke.rangeCount!==1||Ke.anchorNode!==Ee.node||Ke.anchorOffset!==Ee.offset||Ke.focusNode!==xe.node||Ke.focusOffset!==xe.offset)){var Ue=ot.createRange();Ue.setStart(Ee.node,Ee.offset),Ke.removeAllRanges(),qt>oi?(Ke.addRange(Ue),Ke.extend(xe.node,xe.offset)):(Ue.setEnd(xe.node,xe.offset),Ke.addRange(Ue))}}}}for(ot=[],Ke=$;Ke=Ke.parentNode;)Ke.nodeType===1&&ot.push({element:Ke,left:Ke.scrollLeft,top:Ke.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<ot.length;$++){var at=ot[$];at.element.scrollLeft=at.left,at.element.scrollTop=at.top}}P_=!!ZS,KS=ZS=null}finally{Lt=A,X.p=y,W.T=m}}a.current=c,Xn=2}}function ml(){if(Xn===2){Xn=0;var a=$r,c=ch,m=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||m){m=W.T,W.T=null;var y=X.p;X.p=2;var A=Lt;Lt|=4;try{bi(a,c.alternate,c)}finally{Lt=A,X.p=y,W.T=m}}Xn=3}}function cu(){if(Xn===4||Xn===3){Xn=0,q();var a=$r,c=ch,m=Oa,y=Nf;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Xn=5:(Xn=0,ch=$r=null,Bo(a,a.pendingLanes));var A=a.pendingLanes;if(A===0&&(ji=null),_s(m),c=c.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(He,c,void 0,(c.current.flags&128)===128)}catch{}if(y!==null){c=W.T,A=X.p,X.p=2,W.T=null;try{for(var E=a.onRecoverableError,z=0;z<y.length;z++){var $=y[z];E($.value,{componentStack:$.stack})}}finally{W.T=c,X.p=A}}(Oa&3)!==0&&ph(),ft(a),A=a.pendingLanes,(m&261930)!==0&&(A&42)!==0?a===ou?lc++:(lc=0,ou=a):lc=0,At(0)}}function Bo(a,c){(a.pooledCacheLanes&=c)===0&&(c=a.pooledCache,c!=null&&(a.pooledCache=null,Hc(c)))}function ph(){return is(),ml(),cu(),Op()}function Op(){if(Xn!==5)return!1;var a=$r,c=uh;uh=0;var m=_s(Oa),y=W.T,A=X.p;try{X.p=32>m?32:m,W.T=null,m=hh,hh=null;var E=$r,z=Oa;if(Xn=0,ch=$r=null,Oa=0,(Lt&6)!==0)throw Error(n(331));var $=Lt;if(Lt|=4,wr(E.current),h0(E,E.current,z,m),Lt=$,At(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(He,E)}catch{}return!0}finally{X.p=A,W.T=y,Bo(a,c)}}function p0(a,c,m){c=qr(m,c),c=s0(a.stateNode,c,2),a=Jl(a,c,2),a!==null&&(pn(a,2),ft(a))}function Un(a,c,m){if(a.tag===3)p0(a,a,m);else for(;c!==null;){if(c.tag===3){p0(c,a,m);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(ji===null||!ji.has(y))){a=qr(m,a),m=r0(2),y=Jl(c,m,2),y!==null&&(__(m,y,c,a),pn(y,2),ft(y));break}}c=c.return}}function Uf(a,c,m){var y=a.pingCache;if(y===null){y=a.pingCache=new rn;var A=new Set;y.set(c,A)}else A=y.get(c),A===void 0&&(A=new Set,y.set(c,A));A.has(m)||(f0=!0,A.add(m),a=h.bind(null,a,c,m),c.then(a,a))}function h(a,c,m){var y=a.pingCache;y!==null&&y.delete(c),a.pingedLanes|=a.suspendedLanes&m,a.warmLanes&=~m,Jt===a&&(ln&m)===m&&(Ai===4||Ai===3&&(ln&62914560)===ln&&300>V()-lh?(Lt&2)===0&&uc(a,0):Df|=m,hi===ln&&(hi=0)),ft(a)}function d(a,c){c===0&&(c=_t()),a=ar(a,c),a!==null&&(pn(a,c),ft(a))}function _(a){var c=a.memoizedState,m=0;c!==null&&(m=c.retryLane),d(a,m)}function T(a,c){var m=0;switch(a.tag){case 31:case 13:var y=a.stateNode,A=a.memoizedState;A!==null&&(m=A.retryLane);break;case 19:y=a.stateNode;break;case 22:y=a.stateNode._retryCache;break;default:throw Error(n(314))}y!==null&&y.delete(c),d(a,m)}function N(a,c){return Ne(a,c)}var L=null,Z=null,ve=!1,Ze=!1,lt=!1,vt=0;function ft(a){a!==Z&&a.next===null&&(Z===null?L=Z=a:Z=Z.next=a),Ze=!0,ve||(ve=!0,Ce())}function At(a,c){if(!lt&&Ze){lt=!0;do for(var m=!1,y=L;y!==null;){if(a!==0){var A=y.pendingLanes;if(A===0)var E=0;else{var z=y.suspendedLanes,$=y.pingedLanes;E=(1<<31-le(42|a)+1)-1,E&=A&~(z&~$),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(m=!0,ke(y,E))}else E=ln,E=Le(y,y===Jt?E:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(E&3)===0||rt(y,E)||(m=!0,ke(y,E));y=y.next}while(m);lt=!1}}function tn(){qi()}function qi(){Ze=ve=!1;var a=0;vt!==0&&fF()&&(a=vt);for(var c=V(),m=null,y=L;y!==null;){var A=y.next,E=mh(y,c);E===0?(y.next=null,m===null?L=A:m.next=A,A===null&&(Z=m)):(m=y,(a!==0||(E&3)!==0)&&(Ze=!0)),y=A}Xn!==0&&Xn!==5||At(a),vt!==0&&(vt=0)}function mh(a,c){for(var m=a.suspendedLanes,y=a.pingedLanes,A=a.expirationTimes,E=a.pendingLanes&-62914561;0<E;){var z=31-le(E),$=1<<z,me=A[z];me===-1?(($&m)===0||($&y)!==0)&&(A[z]=xt($,c)):me<=c&&(a.expiredLanes|=$),E&=~$}if(c=Jt,m=ln,m=Le(a,a===c?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),y=a.callbackNode,m===0||a===c&&(Rn===2||Rn===9)||a.cancelPendingCommit!==null)return y!==null&&y!==null&&Me(y),a.callbackNode=null,a.callbackPriority=0;if((m&3)===0||rt(a,m)){if(c=m&-m,c===a.callbackPriority)return c;switch(y!==null&&Me(y),_s(m)){case 2:case 8:m=we;break;case 32:m=be;break;case 268435456:m=tt;break;default:m=be}return y=dc.bind(null,a),m=Ne(m,y),a.callbackPriority=c,a.callbackNode=m,c}return y!==null&&y!==null&&Me(y),a.callbackPriority=2,a.callbackNode=null,2}function dc(a,c){if(Xn!==0&&Xn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var m=a.callbackNode;if(ph()&&a.callbackNode!==m)return null;var y=ln;return y=Le(a,a===Jt?y:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),y===0?null:(_n(a,y,c),mh(a,V()),a.callbackNode!=null&&a.callbackNode===m?dc.bind(null,a):null)}function ke(a,c){if(ph())return null;_n(a,c,!0)}function Ce(){pF(function(){(Lt&6)!==0?Ne(Re,tn):qi()})}function je(){if(vt===0){var a=sl;a===0&&(a=We,We<<=1,(We&261888)===0&&(We=256)),vt=a}return vt}function gt(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:pa(""+a)}function Gt(a,c){var m=c.ownerDocument.createElement("input");return m.name=c.name,m.value=c.value,a.id&&m.setAttribute("form",a.id),c.parentNode.insertBefore(m,c),a=new FormData(a),m.parentNode.removeChild(m),a}function Ri(a,c,m,y,A){if(c==="submit"&&m&&m.stateNode===A){var E=gt((A[Ni]||null).action),z=y.submitter;z&&(c=(c=z[Ni]||null)?gt(c.formAction):z.getAttribute("formAction"),c!==null&&(E=c,z=null));var $=new Jo("action","action",null,y,A);a.push({event:$,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(vt!==0){var me=z?Gt(A,z):new FormData(A);Kg(m,{pending:!0,data:me,method:A.method,action:E},null,me)}}else typeof E=="function"&&($.preventDefault(),me=z?Gt(A,z):new FormData(A),Kg(m,{pending:!0,data:me,method:A.method,action:E},E,me))},currentTarget:A}]})}}for(var Wt=0;Wt<cf.length;Wt++){var Nn=cf[Wt],Es=Nn.toLowerCase(),Ln=Nn[0].toUpperCase()+Nn.slice(1);_a(Es,"on"+Ln)}_a(qd,"onAnimationEnd"),_a(lf,"onAnimationIteration"),_a(xg,"onAnimationStart"),_a("dblclick","onDoubleClick"),_a("focusin","onFocus"),_a("focusout","onBlur"),_a(Cy,"onTransitionRun"),_a(US,"onTransitionStart"),_a(Ry,"onTransitionCancel"),_a(bg,"onTransitionEnd"),Ae("onMouseEnter",["mouseout","mouseover"]),Ae("onMouseLeave",["mouseout","mouseover"]),Ae("onPointerEnter",["pointerout","pointerover"]),Ae("onPointerLeave",["pointerout","pointerover"]),Pe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pa));function fC(a,c){c=(c&4)!==0;for(var m=0;m<a.length;m++){var y=a[m],A=y.event;y=y.listeners;e:{var E=void 0;if(c)for(var z=y.length-1;0<=z;z--){var $=y[z],me=$.instance,Fe=$.currentTarget;if($=$.listener,me!==E&&A.isPropagationStopped())break e;E=$,A.currentTarget=Fe;try{E(A)}catch(nt){uf(nt)}A.currentTarget=null,E=me}else for(z=0;z<y.length;z++){if($=y[z],me=$.instance,Fe=$.currentTarget,$=$.listener,me!==E&&A.isPropagationStopped())break e;E=$,A.currentTarget=Fe;try{E(A)}catch(nt){uf(nt)}A.currentTarget=null,E=me}}}}function Dn(a,c){var m=c[ir];m===void 0&&(m=c[ir]=new Set);var y=a+"__bubble";m.has(y)||(dC(c,a,2,!1),m.add(y))}function jS(a,c,m){var y=0;c&&(y|=4),dC(m,a,y,c)}var w_="_reactListening"+Math.random().toString(36).slice(2);function qS(a){if(!a[w_]){a[w_]=!0,Se.forEach(function(m){m!=="selectionchange"&&(WS.has(m)||jS(m,!1,a),jS(m,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[w_]||(c[w_]=!0,jS("selectionchange",!1,c))}}function dC(a,c,m,y){switch(GC(c)){case 2:var A=PF;break;case 8:A=UF;break;default:A=oM}m=A.bind(null,c,m,a),A=void 0,!sr||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(A=!0),y?A!==void 0?a.addEventListener(c,m,{capture:!0,passive:A}):a.addEventListener(c,m,!0):A!==void 0?a.addEventListener(c,m,{passive:A}):a.addEventListener(c,m,!1)}function XS(a,c,m,y,A){var E=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var z=y.tag;if(z===3||z===4){var $=y.stateNode.containerInfo;if($===A)break;if(z===4)for(z=y.return;z!==null;){var me=z.tag;if((me===3||me===4)&&z.stateNode.containerInfo===A)return;z=z.return}for(;$!==null;){if(z=vr($),z===null)return;if(me=z.tag,me===5||me===6||me===26||me===27){y=E=z;continue e}$=$.parentNode}}y=y.return}Ul(function(){var Fe=E,nt=Ic(m),ot=[];e:{var Ve=ya.get(a);if(Ve!==void 0){var Ke=Jo,Ot=a;switch(a){case"keypress":if(Fl(m)===0)break e;case"keydown":case"keyup":Ke=kc;break;case"focusin":Ot="focus",Ke=ku;break;case"focusout":Ot="blur",Ke=ku;break;case"beforeblur":case"afterblur":Ke=ku;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=tf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=Fc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=py;break;case qd:case lf:case xg:Ke=jr;break;case bg:Ke=PS;break;case"scroll":case"scrollend":Ke=Bl;break;case"wheel":Ke=gy;break;case"copy":case"cut":case"paste":Ke=Qa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=ag;break;case"toggle":case"beforetoggle":Ke=yy}var qt=(c&4)!==0,oi=!qt&&(a==="scroll"||a==="scrollend"),Ee=qt?Ve!==null?Ve+"Capture":null:Ve;qt=[];for(var xe=Fe,Ue;xe!==null;){var at=xe;if(Ue=at.stateNode,at=at.tag,at!==5&&at!==26&&at!==27||Ue===null||Ee===null||(at=po(xe,Ee),at!=null&&qt.push(m0(xe,at,Ue))),oi)break;xe=xe.return}0<qt.length&&(Ve=new Ke(Ve,Ot,null,m,nt),ot.push({event:Ve,listeners:qt}))}}if((c&7)===0){e:{if(Ve=a==="mouseover"||a==="pointerover",Ke=a==="mouseout"||a==="pointerout",Ve&&m!==fo&&(Ot=m.relatedTarget||m.fromElement)&&(vr(Ot)||Ot[Ns]))break e;if((Ke||Ve)&&(Ve=nt.window===nt?nt:(Ve=nt.ownerDocument)?Ve.defaultView||Ve.parentWindow:window,Ke?(Ot=m.relatedTarget||m.toElement,Ke=Fe,Ot=Ot?vr(Ot):null,Ot!==null&&(oi=r(Ot),qt=Ot.tag,Ot!==oi||qt!==5&&qt!==27&&qt!==6)&&(Ot=null)):(Ke=null,Ot=Fe),Ke!==Ot)){if(qt=tf,at="onMouseLeave",Ee="onMouseEnter",xe="mouse",(a==="pointerout"||a==="pointerover")&&(qt=ag,at="onPointerLeave",Ee="onPointerEnter",xe="pointer"),oi=Ke==null?Ve:da(Ke),Ue=Ot==null?Ve:da(Ot),Ve=new qt(at,xe+"leave",Ke,m,nt),Ve.target=oi,Ve.relatedTarget=Ue,at=null,vr(nt)===Fe&&(qt=new qt(Ee,xe+"enter",Ot,m,nt),qt.target=Ue,qt.relatedTarget=oi,at=qt),oi=at,Ke&&Ot)t:{for(qt=oF,Ee=Ke,xe=Ot,Ue=0,at=Ee;at;at=qt(at))Ue++;at=0;for(var Vt=xe;Vt;Vt=qt(Vt))at++;for(;0<Ue-at;)Ee=qt(Ee),Ue--;for(;0<at-Ue;)xe=qt(xe),at--;for(;Ue--;){if(Ee===xe||xe!==null&&Ee===xe.alternate){qt=Ee;break t}Ee=qt(Ee),xe=qt(xe)}qt=null}else qt=null;Ke!==null&&pC(ot,Ve,Ke,qt,!1),Ot!==null&&oi!==null&&pC(ot,oi,Ot,qt,!0)}}e:{if(Ve=Fe?da(Fe):window,Ke=Ve.nodeName&&Ve.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&Ve.type==="file")var Gn=dg;else if(fg(Ve))if(_o)Gn=wy;else{Gn=gg;var Ut=My}else Ke=Ve.nodeName,!Ke||Ke.toLowerCase()!=="input"||Ve.type!=="checkbox"&&Ve.type!=="radio"?Fe&&bs(Fe.elementType)&&(Gn=dg):Gn=Ty;if(Gn&&(Gn=Gn(a,Fe))){Wd(ot,Gn,m,nt);break e}Ut&&Ut(a,Ve,Fe),a==="focusout"&&Fe&&Ve.type==="number"&&Fe.memoizedProps.value!=null&&kn(Ve,"number",Ve.value)}switch(Ut=Fe?da(Fe):window,a){case"focusin":(fg(Ut)||Ut.contentEditable==="true")&&(xo=Ut,bo=Fe,Hu=null);break;case"focusout":Hu=bo=xo=null;break;case"mousedown":jd=!0;break;case"contextmenu":case"mouseup":case"dragend":jd=!1,Wu(ot,m,nt);break;case"selectionchange":if(Ey)break;case"keydown":case"keyup":Wu(ot,m,nt)}var gn;if(Bc)e:{switch(a){case"compositionstart":var In="onCompositionStart";break e;case"compositionend":In="onCompositionEnd";break e;case"compositionupdate":In="onCompositionUpdate";break e}In=void 0}else zc?Hd(a,m)&&(In="onCompositionEnd"):a==="keydown"&&m.keyCode===229&&(In="onCompositionStart");In&&(lg&&m.locale!=="ko"&&(zc||In!=="onCompositionStart"?In==="onCompositionEnd"&&zc&&(gn=Ll()):(qs=nt,Uc="value"in qs?qs.value:qs.textContent,zc=!0)),Ut=A_(Fe,In),0<Ut.length&&(In=new kd(In,a,null,m,nt),ot.push({event:In,listeners:Ut}),gn?In.data=gn:(gn=cg(m),gn!==null&&(In.data=gn)))),(gn=Gd?by(a,m):ug(a,m))&&(In=A_(Fe,"onBeforeInput"),0<In.length&&(Ut=new kd("onBeforeInput","beforeinput",null,m,nt),ot.push({event:Ut,listeners:In}),Ut.data=gn)),Ri(ot,a,Fe,m,nt)}fC(ot,c)})}function m0(a,c,m){return{instance:a,listener:c,currentTarget:m}}function A_(a,c){for(var m=c+"Capture",y=[];a!==null;){var A=a,E=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||E===null||(A=po(a,m),A!=null&&y.unshift(m0(a,A,E)),A=po(a,c),A!=null&&y.push(m0(a,A,E))),a.tag===3)return y;a=a.return}return[]}function oF(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function pC(a,c,m,y,A){for(var E=c._reactName,z=[];m!==null&&m!==y;){var $=m,me=$.alternate,Fe=$.stateNode;if($=$.tag,me!==null&&me===y)break;$!==5&&$!==26&&$!==27||Fe===null||(me=Fe,A?(Fe=po(m,E),Fe!=null&&z.unshift(m0(m,Fe,me))):A||(Fe=po(m,E),Fe!=null&&z.push(m0(m,Fe,me)))),m=m.return}z.length!==0&&a.push({event:c,listeners:z})}var lF=/\r\n?/g,cF=/\u0000|\uFFFD/g;function mC(a){return(typeof a=="string"?a:""+a).replace(lF,`
`).replace(cF,"")}function gC(a,c){return c=mC(c),mC(a)===c}function ai(a,c,m,y,A,E){switch(m){case"children":typeof y=="string"?c==="body"||c==="textarea"&&y===""||gi(a,y):(typeof y=="number"||typeof y=="bigint")&&c!=="body"&&gi(a,""+y);break;case"className":Ft(a,"class",y);break;case"tabIndex":Ft(a,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Ft(a,m,y);break;case"style":Ya(a,y,E);break;case"data":if(c!=="object"){Ft(a,"data",y);break}case"src":case"href":if(y===""&&(c!=="a"||m!=="href")){a.removeAttribute(m);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){a.removeAttribute(m);break}y=pa(""+y),a.setAttribute(m,y);break;case"action":case"formAction":if(typeof y=="function"){a.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(m==="formAction"?(c!=="input"&&ai(a,c,"name",A.name,A,null),ai(a,c,"formEncType",A.formEncType,A,null),ai(a,c,"formMethod",A.formMethod,A,null),ai(a,c,"formTarget",A.formTarget,A,null)):(ai(a,c,"encType",A.encType,A,null),ai(a,c,"method",A.method,A,null),ai(a,c,"target",A.target,A,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){a.removeAttribute(m);break}y=pa(""+y),a.setAttribute(m,y);break;case"onClick":y!=null&&(a.onclick=js);break;case"onScroll":y!=null&&Dn("scroll",a);break;case"onScrollEnd":y!=null&&Dn("scrollend",a);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(n(61));if(m=y.__html,m!=null){if(A.children!=null)throw Error(n(60));a.innerHTML=m}}break;case"multiple":a.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":a.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){a.removeAttribute("xlink:href");break}m=pa(""+y),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(m,""+y):a.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(m,""):a.removeAttribute(m);break;case"capture":case"download":y===!0?a.setAttribute(m,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(m,y):a.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?a.setAttribute(m,y):a.removeAttribute(m);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?a.removeAttribute(m):a.setAttribute(m,y);break;case"popover":Dn("beforetoggle",a),Dn("toggle",a),Ct(a,"popover",y);break;case"xlinkActuate":Rt(a,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Rt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Rt(a,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Rt(a,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Rt(a,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Rt(a,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Rt(a,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Rt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Rt(a,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Ct(a,"is",y);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=ef.get(m)||m,Ct(a,m,y))}}function YS(a,c,m,y,A,E){switch(m){case"style":Ya(a,y,E);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(n(61));if(m=y.__html,m!=null){if(A.children!=null)throw Error(n(60));a.innerHTML=m}}break;case"children":typeof y=="string"?gi(a,y):(typeof y=="number"||typeof y=="bigint")&&gi(a,""+y);break;case"onScroll":y!=null&&Dn("scroll",a);break;case"onScrollEnd":y!=null&&Dn("scrollend",a);break;case"onClick":y!=null&&(a.onclick=js);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ze.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(A=m.endsWith("Capture"),c=m.slice(2,A?m.length-7:void 0),E=a[Ni]||null,E=E!=null?E[m]:null,typeof E=="function"&&a.removeEventListener(c,E,A),typeof y=="function")){typeof E!="function"&&E!==null&&(m in a?a[m]=null:a.hasAttribute(m)&&a.removeAttribute(m)),a.addEventListener(c,y,A);break e}m in a?a[m]=y:y===!0?a.setAttribute(m,""):Ct(a,m,y)}}}function dr(a,c,m){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Dn("error",a),Dn("load",a);var y=!1,A=!1,E;for(E in m)if(m.hasOwnProperty(E)){var z=m[E];if(z!=null)switch(E){case"src":y=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:ai(a,c,E,z,m,null)}}A&&ai(a,c,"srcSet",m.srcSet,m,null),y&&ai(a,c,"src",m.src,m,null);return;case"input":Dn("invalid",a);var $=E=z=A=null,me=null,Fe=null;for(y in m)if(m.hasOwnProperty(y)){var nt=m[y];if(nt!=null)switch(y){case"name":A=nt;break;case"type":z=nt;break;case"checked":me=nt;break;case"defaultChecked":Fe=nt;break;case"value":E=nt;break;case"defaultValue":$=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(n(137,c));break;default:ai(a,c,y,nt,m,null)}}Ws(a,E,$,me,Fe,z,A,!1);return;case"select":Dn("invalid",a),y=z=E=null;for(A in m)if(m.hasOwnProperty(A)&&($=m[A],$!=null))switch(A){case"value":E=$;break;case"defaultValue":z=$;break;case"multiple":y=$;default:ai(a,c,A,$,m,null)}c=E,m=z,a.multiple=!!y,c!=null?xs(a,!!y,c,!1):m!=null&&xs(a,!!y,m,!0);return;case"textarea":Dn("invalid",a),E=A=y=null;for(z in m)if(m.hasOwnProperty(z)&&($=m[z],$!=null))switch(z){case"value":y=$;break;case"defaultValue":A=$;break;case"children":E=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(n(91));break;default:ai(a,c,z,$,m,null)}mi(a,y,A,E);return;case"option":for(me in m)m.hasOwnProperty(me)&&(y=m[me],y!=null)&&(me==="selected"?a.selected=y&&typeof y!="function"&&typeof y!="symbol":ai(a,c,me,y,m,null));return;case"dialog":Dn("beforetoggle",a),Dn("toggle",a),Dn("cancel",a),Dn("close",a);break;case"iframe":case"object":Dn("load",a);break;case"video":case"audio":for(y=0;y<Pa.length;y++)Dn(Pa[y],a);break;case"image":Dn("error",a),Dn("load",a);break;case"details":Dn("toggle",a);break;case"embed":case"source":case"link":Dn("error",a),Dn("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Fe in m)if(m.hasOwnProperty(Fe)&&(y=m[Fe],y!=null))switch(Fe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:ai(a,c,Fe,y,m,null)}return;default:if(bs(c)){for(nt in m)m.hasOwnProperty(nt)&&(y=m[nt],y!==void 0&&YS(a,c,nt,y,m,void 0));return}}for($ in m)m.hasOwnProperty($)&&(y=m[$],y!=null&&ai(a,c,$,y,m,null))}function uF(a,c,m,y){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,E=null,z=null,$=null,me=null,Fe=null,nt=null;for(Ke in m){var ot=m[Ke];if(m.hasOwnProperty(Ke)&&ot!=null)switch(Ke){case"checked":break;case"value":break;case"defaultValue":me=ot;default:y.hasOwnProperty(Ke)||ai(a,c,Ke,null,y,ot)}}for(var Ve in y){var Ke=y[Ve];if(ot=m[Ve],y.hasOwnProperty(Ve)&&(Ke!=null||ot!=null))switch(Ve){case"type":E=Ke;break;case"name":A=Ke;break;case"checked":Fe=Ke;break;case"defaultChecked":nt=Ke;break;case"value":z=Ke;break;case"defaultValue":$=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(n(137,c));break;default:Ke!==ot&&ai(a,c,Ve,Ke,y,ot)}}Ii(a,z,$,me,Fe,nt,E,A);return;case"select":Ke=z=$=Ve=null;for(E in m)if(me=m[E],m.hasOwnProperty(E)&&me!=null)switch(E){case"value":break;case"multiple":Ke=me;default:y.hasOwnProperty(E)||ai(a,c,E,null,y,me)}for(A in y)if(E=y[A],me=m[A],y.hasOwnProperty(A)&&(E!=null||me!=null))switch(A){case"value":Ve=E;break;case"defaultValue":$=E;break;case"multiple":z=E;default:E!==me&&ai(a,c,A,E,y,me)}c=$,m=z,y=Ke,Ve!=null?xs(a,!!m,Ve,!1):!!y!=!!m&&(c!=null?xs(a,!!m,c,!0):xs(a,!!m,m?[]:"",!1));return;case"textarea":Ke=Ve=null;for($ in m)if(A=m[$],m.hasOwnProperty($)&&A!=null&&!y.hasOwnProperty($))switch($){case"value":break;case"children":break;default:ai(a,c,$,null,y,A)}for(z in y)if(A=y[z],E=m[z],y.hasOwnProperty(z)&&(A!=null||E!=null))switch(z){case"value":Ve=A;break;case"defaultValue":Ke=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:A!==E&&ai(a,c,z,A,y,E)}Tn(a,Ve,Ke);return;case"option":for(var Ot in m)Ve=m[Ot],m.hasOwnProperty(Ot)&&Ve!=null&&!y.hasOwnProperty(Ot)&&(Ot==="selected"?a.selected=!1:ai(a,c,Ot,null,y,Ve));for(me in y)Ve=y[me],Ke=m[me],y.hasOwnProperty(me)&&Ve!==Ke&&(Ve!=null||Ke!=null)&&(me==="selected"?a.selected=Ve&&typeof Ve!="function"&&typeof Ve!="symbol":ai(a,c,me,Ve,y,Ke));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qt in m)Ve=m[qt],m.hasOwnProperty(qt)&&Ve!=null&&!y.hasOwnProperty(qt)&&ai(a,c,qt,null,y,Ve);for(Fe in y)if(Ve=y[Fe],Ke=m[Fe],y.hasOwnProperty(Fe)&&Ve!==Ke&&(Ve!=null||Ke!=null))switch(Fe){case"children":case"dangerouslySetInnerHTML":if(Ve!=null)throw Error(n(137,c));break;default:ai(a,c,Fe,Ve,y,Ke)}return;default:if(bs(c)){for(var oi in m)Ve=m[oi],m.hasOwnProperty(oi)&&Ve!==void 0&&!y.hasOwnProperty(oi)&&YS(a,c,oi,void 0,y,Ve);for(nt in y)Ve=y[nt],Ke=m[nt],!y.hasOwnProperty(nt)||Ve===Ke||Ve===void 0&&Ke===void 0||YS(a,c,nt,Ve,y,Ke);return}}for(var Ee in m)Ve=m[Ee],m.hasOwnProperty(Ee)&&Ve!=null&&!y.hasOwnProperty(Ee)&&ai(a,c,Ee,null,y,Ve);for(ot in y)Ve=y[ot],Ke=m[ot],!y.hasOwnProperty(ot)||Ve===Ke||Ve==null&&Ke==null||ai(a,c,ot,Ve,y,Ke)}function vC(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function hF(){if(typeof performance.getEntriesByType=="function"){for(var a=0,c=0,m=performance.getEntriesByType("resource"),y=0;y<m.length;y++){var A=m[y],E=A.transferSize,z=A.initiatorType,$=A.duration;if(E&&$&&vC(z)){for(z=0,$=A.responseEnd,y+=1;y<m.length;y++){var me=m[y],Fe=me.startTime;if(Fe>$)break;var nt=me.transferSize,ot=me.initiatorType;nt&&vC(ot)&&(me=me.responseEnd,z+=nt*(me<$?1:($-Fe)/(me-Fe)))}if(--y,c+=8*(E+z)/(A.duration/1e3),a++,10<a)break}}if(0<a)return c/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var ZS=null,KS=null;function E_(a){return a.nodeType===9?a:a.ownerDocument}function yC(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _C(a,c){if(a===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&c==="foreignObject"?0:a}function QS(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var JS=null;function fF(){var a=window.event;return a&&a.type==="popstate"?a===JS?!1:(JS=a,!0):(JS=null,!1)}var xC=typeof setTimeout=="function"?setTimeout:void 0,dF=typeof clearTimeout=="function"?clearTimeout:void 0,bC=typeof Promise=="function"?Promise:void 0,pF=typeof queueMicrotask=="function"?queueMicrotask:typeof bC<"u"?function(a){return bC.resolve(null).then(a).catch(mF)}:xC;function mF(a){setTimeout(function(){throw a})}function gh(a){return a==="head"}function SC(a,c){var m=c,y=0;do{var A=m.nextSibling;if(a.removeChild(m),A&&A.nodeType===8)if(m=A.data,m==="/$"||m==="/&"){if(y===0){a.removeChild(A),Fp(c);return}y--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")y++;else if(m==="html")g0(a.ownerDocument.documentElement);else if(m==="head"){m=a.ownerDocument.head,g0(m);for(var E=m.firstChild;E;){var z=E.nextSibling,$=E.nodeName;E[Vr]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&E.rel.toLowerCase()==="stylesheet"||m.removeChild(E),E=z}}else m==="body"&&g0(a.ownerDocument.body);m=A}while(m);Fp(c)}function MC(a,c){var m=a;a=0;do{var y=m.nextSibling;if(m.nodeType===1?c?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(c?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),y&&y.nodeType===8)if(m=y.data,m==="/$"){if(a===0)break;a--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||a++;m=y}while(m)}function $S(a){var c=a.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var m=c;switch(c=c.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":$S(m),fa(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}a.removeChild(m)}}function gF(a,c,m,y){for(;a.nodeType===1;){var A=m;if(a.nodeName.toLowerCase()!==c.toLowerCase()){if(!y&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(y){if(!a[Vr])switch(c){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(E=a.getAttribute("rel"),E==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(E!==A.rel||a.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||a.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||a.getAttribute("title")!==(A.title==null?null:A.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(E=a.getAttribute("src"),(E!==(A.src==null?null:A.src)||a.getAttribute("type")!==(A.type==null?null:A.type)||a.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&E&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(c==="input"&&a.type==="hidden"){var E=A.name==null?null:""+A.name;if(A.type==="hidden"&&a.getAttribute("name")===E)return a}else return a;if(a=zo(a.nextSibling),a===null)break}return null}function vF(a,c,m){if(c==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!m||(a=zo(a.nextSibling),a===null))return null;return a}function TC(a,c){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=zo(a.nextSibling),a===null))return null;return a}function eM(a){return a.data==="$?"||a.data==="$~"}function tM(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function yF(a,c){var m=a.ownerDocument;if(a.data==="$~")a._reactRetry=c;else if(a.data!=="$?"||m.readyState!=="loading")c();else{var y=function(){c(),m.removeEventListener("DOMContentLoaded",y)};m.addEventListener("DOMContentLoaded",y),a._reactRetry=y}}function zo(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return a}var nM=null;function wC(a){a=a.nextSibling;for(var c=0;a;){if(a.nodeType===8){var m=a.data;if(m==="/$"||m==="/&"){if(c===0)return zo(a.nextSibling);c--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||c++}a=a.nextSibling}return null}function AC(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var m=a.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(c===0)return a;c--}else m!=="/$"&&m!=="/&"||c++}a=a.previousSibling}return null}function EC(a,c,m){switch(c=E_(m),a){case"html":if(a=c.documentElement,!a)throw Error(n(452));return a;case"head":if(a=c.head,!a)throw Error(n(453));return a;case"body":if(a=c.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function g0(a){for(var c=a.attributes;c.length;)a.removeAttributeNode(c[0]);fa(a)}var Vo=new Map,CC=new Set;function C_(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var uu=X.d;X.d={f:_F,r:xF,D:bF,C:SF,L:MF,m:TF,X:AF,S:wF,M:EF};function _F(){var a=uu.f(),c=no();return a||c}function xF(a){var c=Gr(a);c!==null&&c.tag===5&&c.type==="form"?u_(c):uu.r(a)}var Pp=typeof document>"u"?null:document;function RC(a,c,m){var y=Pp;if(y&&typeof c=="string"&&c){var A=Pt(c);A='link[rel="'+a+'"][href="'+A+'"]',typeof m=="string"&&(A+='[crossorigin="'+m+'"]'),CC.has(A)||(CC.add(A),a={rel:a,crossOrigin:m,href:c},y.querySelector(A)===null&&(c=y.createElement("link"),dr(c,"link",a),J(c),y.head.appendChild(c)))}}function bF(a){uu.D(a),RC("dns-prefetch",a,null)}function SF(a,c){uu.C(a,c),RC("preconnect",a,c)}function MF(a,c,m){uu.L(a,c,m);var y=Pp;if(y&&a&&c){var A='link[rel="preload"][as="'+Pt(c)+'"]';c==="image"&&m&&m.imageSrcSet?(A+='[imagesrcset="'+Pt(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(A+='[imagesizes="'+Pt(m.imageSizes)+'"]')):A+='[href="'+Pt(a)+'"]';var E=A;switch(c){case"style":E=Up(a);break;case"script":E=Lp(a)}Vo.has(E)||(a=g({rel:"preload",href:c==="image"&&m&&m.imageSrcSet?void 0:a,as:c},m),Vo.set(E,a),y.querySelector(A)!==null||c==="style"&&y.querySelector(v0(E))||c==="script"&&y.querySelector(y0(E))||(c=y.createElement("link"),dr(c,"link",a),J(c),y.head.appendChild(c)))}}function TF(a,c){uu.m(a,c);var m=Pp;if(m&&a){var y=c&&typeof c.as=="string"?c.as:"script",A='link[rel="modulepreload"][as="'+Pt(y)+'"][href="'+Pt(a)+'"]',E=A;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Lp(a)}if(!Vo.has(E)&&(a=g({rel:"modulepreload",href:a},c),Vo.set(E,a),m.querySelector(A)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(y0(E)))return}y=m.createElement("link"),dr(y,"link",a),J(y),m.head.appendChild(y)}}}function wF(a,c,m){uu.S(a,c,m);var y=Pp;if(y&&a){var A=Dt(y).hoistableStyles,E=Up(a);c=c||"default";var z=A.get(E);if(!z){var $={loading:0,preload:null};if(z=y.querySelector(v0(E)))$.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":c},m),(m=Vo.get(E))&&iM(a,m);var me=z=y.createElement("link");J(me),dr(me,"link",a),me._p=new Promise(function(Fe,nt){me.onload=Fe,me.onerror=nt}),me.addEventListener("load",function(){$.loading|=1}),me.addEventListener("error",function(){$.loading|=2}),$.loading|=4,R_(z,c,y)}z={type:"stylesheet",instance:z,count:1,state:$},A.set(E,z)}}}function AF(a,c){uu.X(a,c);var m=Pp;if(m&&a){var y=Dt(m).hoistableScripts,A=Lp(a),E=y.get(A);E||(E=m.querySelector(y0(A)),E||(a=g({src:a,async:!0},c),(c=Vo.get(A))&&sM(a,c),E=m.createElement("script"),J(E),dr(E,"link",a),m.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},y.set(A,E))}}function EF(a,c){uu.M(a,c);var m=Pp;if(m&&a){var y=Dt(m).hoistableScripts,A=Lp(a),E=y.get(A);E||(E=m.querySelector(y0(A)),E||(a=g({src:a,async:!0,type:"module"},c),(c=Vo.get(A))&&sM(a,c),E=m.createElement("script"),J(E),dr(E,"link",a),m.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},y.set(A,E))}}function DC(a,c,m,y){var A=(A=se.current)?C_(A):null;if(!A)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(c=Up(m.href),m=Dt(A).hoistableStyles,y=m.get(c),y||(y={type:"style",instance:null,count:0,state:null},m.set(c,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){a=Up(m.href);var E=Dt(A).hoistableStyles,z=E.get(a);if(z||(A=A.ownerDocument||A,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(a,z),(E=A.querySelector(v0(a)))&&!E._p&&(z.instance=E,z.state.loading=5),Vo.has(a)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Vo.set(a,m),E||CF(A,a,m,z.state))),c&&y===null)throw Error(n(528,""));return z}if(c&&y!==null)throw Error(n(529,""));return null;case"script":return c=m.async,m=m.src,typeof m=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Lp(m),m=Dt(A).hoistableScripts,y=m.get(c),y||(y={type:"script",instance:null,count:0,state:null},m.set(c,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function Up(a){return'href="'+Pt(a)+'"'}function v0(a){return'link[rel="stylesheet"]['+a+"]"}function NC(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function CF(a,c,m,y){a.querySelector('link[rel="preload"][as="style"]['+c+"]")?y.loading=1:(c=a.createElement("link"),y.preload=c,c.addEventListener("load",function(){return y.loading|=1}),c.addEventListener("error",function(){return y.loading|=2}),dr(c,"link",m),J(c),a.head.appendChild(c))}function Lp(a){return'[src="'+Pt(a)+'"]'}function y0(a){return"script[async]"+a}function IC(a,c,m){if(c.count++,c.instance===null)switch(c.type){case"style":var y=a.querySelector('style[data-href~="'+Pt(m.href)+'"]');if(y)return c.instance=y,J(y),y;var A=g({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return y=(a.ownerDocument||a).createElement("style"),J(y),dr(y,"style",A),R_(y,m.precedence,a),c.instance=y;case"stylesheet":A=Up(m.href);var E=a.querySelector(v0(A));if(E)return c.state.loading|=4,c.instance=E,J(E),E;y=NC(m),(A=Vo.get(A))&&iM(y,A),E=(a.ownerDocument||a).createElement("link"),J(E);var z=E;return z._p=new Promise(function($,me){z.onload=$,z.onerror=me}),dr(E,"link",y),c.state.loading|=4,R_(E,m.precedence,a),c.instance=E;case"script":return E=Lp(m.src),(A=a.querySelector(y0(E)))?(c.instance=A,J(A),A):(y=m,(A=Vo.get(E))&&(y=g({},m),sM(y,A)),a=a.ownerDocument||a,A=a.createElement("script"),J(A),dr(A,"link",y),a.head.appendChild(A),c.instance=A);case"void":return null;default:throw Error(n(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(y=c.instance,c.state.loading|=4,R_(y,m.precedence,a));return c.instance}function R_(a,c,m){for(var y=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=y.length?y[y.length-1]:null,E=A,z=0;z<y.length;z++){var $=y[z];if($.dataset.precedence===c)E=$;else if(E!==A)break}E?E.parentNode.insertBefore(a,E.nextSibling):(c=m.nodeType===9?m.head:m,c.insertBefore(a,c.firstChild))}function iM(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.title==null&&(a.title=c.title)}function sM(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.integrity==null&&(a.integrity=c.integrity)}var D_=null;function OC(a,c,m){if(D_===null){var y=new Map,A=D_=new Map;A.set(m,y)}else A=D_,y=A.get(m),y||(y=new Map,A.set(m,y));if(y.has(a))return y;for(y.set(a,null),m=m.getElementsByTagName(a),A=0;A<m.length;A++){var E=m[A];if(!(E[Vr]||E[Fn]||a==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var z=E.getAttribute(c)||"";z=a+z;var $=y.get(z);$?$.push(E):y.set(z,[E])}}return y}function PC(a,c,m){a=a.ownerDocument||a,a.head.insertBefore(m,c==="title"?a.querySelector("head > title"):null)}function RF(a,c,m){if(m===1||c.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(a=c.disabled,typeof c.precedence=="string"&&a==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function UC(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function DF(a,c,m,y){if(m.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var A=Up(y.href),E=c.querySelector(v0(A));if(E){c=E._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(a.count++,a=N_.bind(a),c.then(a,a)),m.state.loading|=4,m.instance=E,J(E);return}E=c.ownerDocument||c,y=NC(y),(A=Vo.get(A))&&iM(y,A),E=E.createElement("link"),J(E);var z=E;z._p=new Promise(function($,me){z.onload=$,z.onerror=me}),dr(E,"link",y),m.instance=E}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(m,c),(c=m.state.preload)&&(m.state.loading&3)===0&&(a.count++,m=N_.bind(a),c.addEventListener("load",m),c.addEventListener("error",m))}}var rM=0;function NF(a,c){return a.stylesheets&&a.count===0&&O_(a,a.stylesheets),0<a.count||0<a.imgCount?function(m){var y=setTimeout(function(){if(a.stylesheets&&O_(a,a.stylesheets),a.unsuspend){var E=a.unsuspend;a.unsuspend=null,E()}},6e4+c);0<a.imgBytes&&rM===0&&(rM=62500*hF());var A=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&O_(a,a.stylesheets),a.unsuspend)){var E=a.unsuspend;a.unsuspend=null,E()}},(a.imgBytes>rM?50:800)+c);return a.unsuspend=m,function(){a.unsuspend=null,clearTimeout(y),clearTimeout(A)}}:null}function N_(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)O_(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var I_=null;function O_(a,c){a.stylesheets=null,a.unsuspend!==null&&(a.count++,I_=new Map,c.forEach(IF,a),I_=null,N_.call(a))}function IF(a,c){if(!(c.state.loading&4)){var m=I_.get(a);if(m)var y=m.get(null);else{m=new Map,I_.set(a,m);for(var A=a.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<A.length;E++){var z=A[E];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(m.set(z.dataset.precedence,z),y=z)}y&&m.set(null,y)}A=c.instance,z=A.getAttribute("data-precedence"),E=m.get(z)||y,E===y&&m.set(null,A),m.set(z,A),this.count++,y=N_.bind(this),A.addEventListener("load",y),A.addEventListener("error",y),E?E.parentNode.insertBefore(A,E.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(A,a.firstChild)),c.state.loading|=4}}var _0={$$typeof:R,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function OF(a,c,m,y,A,E,z,$,me){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nt(0),this.hiddenUpdates=Nt(null),this.identifierPrefix=y,this.onUncaughtError=A,this.onCaughtError=E,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function LC(a,c,m,y,A,E,z,$,me,Fe,nt,ot){return a=new OF(a,c,m,z,me,Fe,nt,ot,$),c=1,E===!0&&(c|=24),E=Mi(3,null,null,c),a.current=E,E.stateNode=a,c=Mg(),c.refCount++,a.pooledCache=c,c.refCount++,E.memoizedState={element:y,isDehydrated:m,cache:c},vf(E),a}function FC(a){return a?(a=Wl,a):Wl}function kC(a,c,m,y,A,E){A=FC(A),y.context===null?y.context=A:y.pendingContext=A,y=al(c),y.payload={element:m},E=E===void 0?null:E,E!==null&&(y.callback=E),m=Jl(a,y,c),m!==null&&(hn(m,a,c),$l(m,a,c))}function BC(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var m=a.retryLane;a.retryLane=m!==0&&m<c?m:c}}function aM(a,c){BC(a,c),(a=a.alternate)&&BC(a,c)}function zC(a){if(a.tag===13||a.tag===31){var c=ar(a,67108864);c!==null&&hn(c,a,67108864),aM(a,67108864)}}function VC(a){if(a.tag===13||a.tag===31){var c=ea();c=ys(c);var m=ar(a,c);m!==null&&hn(m,a,c),aM(a,c)}}var P_=!0;function PF(a,c,m,y){var A=W.T;W.T=null;var E=X.p;try{X.p=2,oM(a,c,m,y)}finally{X.p=E,W.T=A}}function UF(a,c,m,y){var A=W.T;W.T=null;var E=X.p;try{X.p=8,oM(a,c,m,y)}finally{X.p=E,W.T=A}}function oM(a,c,m,y){if(P_){var A=lM(y);if(A===null)XS(a,c,y,U_,m),HC(a,y);else if(FF(A,a,c,m,y))y.stopPropagation();else if(HC(a,y),c&4&&-1<LF.indexOf(a)){for(;A!==null;){var E=Gr(A);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var z=$e(E.pendingLanes);if(z!==0){var $=E;for($.pendingLanes|=2,$.entangledLanes|=2;z;){var me=1<<31-le(z);$.entanglements[1]|=me,z&=~me}ft(E),(Lt&6)===0&&(Wi=V()+500,At(0))}}break;case 31:case 13:$=ar(E,2),$!==null&&hn($,E,2),no(),aM(E,2)}if(E=lM(y),E===null&&XS(a,c,y,U_,m),E===A)break;A=E}A!==null&&y.stopPropagation()}else XS(a,c,y,null,m)}}function lM(a){return a=Ic(a),cM(a)}var U_=null;function cM(a){if(U_=null,a=vr(a),a!==null){var c=r(a);if(c===null)a=null;else{var m=c.tag;if(m===13){if(a=o(c),a!==null)return a;a=null}else if(m===31){if(a=l(c),a!==null)return a;a=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null)}}return U_=a,null}function GC(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case Re:return 2;case we:return 8;case be:case it:return 32;case tt:return 268435456;default:return 32}default:return 32}}var uM=!1,vh=null,yh=null,_h=null,x0=new Map,b0=new Map,xh=[],LF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function HC(a,c){switch(a){case"focusin":case"focusout":vh=null;break;case"dragenter":case"dragleave":yh=null;break;case"mouseover":case"mouseout":_h=null;break;case"pointerover":case"pointerout":x0.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":b0.delete(c.pointerId)}}function S0(a,c,m,y,A,E){return a===null||a.nativeEvent!==E?(a={blockedOn:c,domEventName:m,eventSystemFlags:y,nativeEvent:E,targetContainers:[A]},c!==null&&(c=Gr(c),c!==null&&zC(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,A!==null&&c.indexOf(A)===-1&&c.push(A),a)}function FF(a,c,m,y,A){switch(c){case"focusin":return vh=S0(vh,a,c,m,y,A),!0;case"dragenter":return yh=S0(yh,a,c,m,y,A),!0;case"mouseover":return _h=S0(_h,a,c,m,y,A),!0;case"pointerover":var E=A.pointerId;return x0.set(E,S0(x0.get(E)||null,a,c,m,y,A)),!0;case"gotpointercapture":return E=A.pointerId,b0.set(E,S0(b0.get(E)||null,a,c,m,y,A)),!0}return!1}function WC(a){var c=vr(a.target);if(c!==null){var m=r(c);if(m!==null){if(c=m.tag,c===13){if(c=o(m),c!==null){a.blockedOn=c,ni(a.priority,function(){VC(m)});return}}else if(c===31){if(c=l(m),c!==null){a.blockedOn=c,ni(a.priority,function(){VC(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){a.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}a.blockedOn=null}function L_(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var m=lM(a.nativeEvent);if(m===null){m=a.nativeEvent;var y=new m.constructor(m.type,m);fo=y,m.target.dispatchEvent(y),fo=null}else return c=Gr(m),c!==null&&zC(c),a.blockedOn=m,!1;c.shift()}return!0}function jC(a,c,m){L_(a)&&m.delete(c)}function kF(){uM=!1,vh!==null&&L_(vh)&&(vh=null),yh!==null&&L_(yh)&&(yh=null),_h!==null&&L_(_h)&&(_h=null),x0.forEach(jC),b0.forEach(jC)}function F_(a,c){a.blockedOn===c&&(a.blockedOn=null,uM||(uM=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,kF)))}var k_=null;function qC(a){k_!==a&&(k_=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){k_===a&&(k_=null);for(var c=0;c<a.length;c+=3){var m=a[c],y=a[c+1],A=a[c+2];if(typeof y!="function"){if(cM(y||m)===null)continue;break}var E=Gr(m);E!==null&&(a.splice(c,3),c-=3,Kg(E,{pending:!0,data:A,method:m.method,action:y},y,A))}}))}function Fp(a){function c(me){return F_(me,a)}vh!==null&&F_(vh,a),yh!==null&&F_(yh,a),_h!==null&&F_(_h,a),x0.forEach(c),b0.forEach(c);for(var m=0;m<xh.length;m++){var y=xh[m];y.blockedOn===a&&(y.blockedOn=null)}for(;0<xh.length&&(m=xh[0],m.blockedOn===null);)WC(m),m.blockedOn===null&&xh.shift();if(m=(a.ownerDocument||a).$$reactFormReplay,m!=null)for(y=0;y<m.length;y+=3){var A=m[y],E=m[y+1],z=A[Ni]||null;if(typeof E=="function")z||qC(m);else if(z){var $=null;if(E&&E.hasAttribute("formAction")){if(A=E,z=E[Ni]||null)$=z.formAction;else if(cM(A)!==null)continue}else $=z.action;typeof $=="function"?m[y+1]=$:(m.splice(y,3),y-=3),qC(m)}}}function XC(){function a(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(z){return A=z})},focusReset:"manual",scroll:"manual"})}function c(){A!==null&&(A(),A=null),y||setTimeout(m,20)}function m(){if(!y&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var y=!1,A=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(m,100),function(){y=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),A!==null&&(A(),A=null)}}}function hM(a){this._internalRoot=a}B_.prototype.render=hM.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(n(409));var m=c.current,y=ea();kC(m,y,a,c,null,null)},B_.prototype.unmount=hM.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;kC(a.current,2,null,a,null,null),no(),c[Ns]=null}};function B_(a){this._internalRoot=a}B_.prototype.unstable_scheduleHydration=function(a){if(a){var c=nr();a={blockedOn:null,target:a,priority:c};for(var m=0;m<xh.length&&c!==0&&c<xh[m].priority;m++);xh.splice(m,0,a),m===0&&WC(a)}};var YC=e.version;if(YC!=="19.2.3")throw Error(n(527,YC,"19.2.3"));X.findDOMNode=function(a){var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=f(c),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var BF={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var z_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!z_.isDisabled&&z_.supportsFiber)try{He=z_.inject(BF),Xe=z_}catch{}}return T0.createRoot=function(a,c){if(!s(a))throw Error(n(299));var m=!1,y="",A=v_,E=n0,z=i0;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(A=c.onUncaughtError),c.onCaughtError!==void 0&&(E=c.onCaughtError),c.onRecoverableError!==void 0&&(z=c.onRecoverableError)),c=LC(a,1,!1,null,null,m,y,null,A,E,z,XC),a[Ns]=c.current,qS(a),new hM(c)},T0.hydrateRoot=function(a,c,m){if(!s(a))throw Error(n(299));var y=!1,A="",E=v_,z=n0,$=i0,me=null;return m!=null&&(m.unstable_strictMode===!0&&(y=!0),m.identifierPrefix!==void 0&&(A=m.identifierPrefix),m.onUncaughtError!==void 0&&(E=m.onUncaughtError),m.onCaughtError!==void 0&&(z=m.onCaughtError),m.onRecoverableError!==void 0&&($=m.onRecoverableError),m.formState!==void 0&&(me=m.formState)),c=LC(a,1,!0,c,m??null,y,A,me,E,z,$,XC),c.context=FC(null),m=c.current,y=ea(),y=ys(y),A=al(y),A.callback=null,Jl(m,A,y),m=y,c.current.lanes=m,pn(c,m),ft(c),a[Ns]=c.current,qS(a),new B_(c)},T0.version="19.2.3",T0}var sR;function YF(){if(sR)return pM.exports;sR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),pM.exports=XF(),pM.exports}var ZF=YF();const jw=_e.createContext({});function qw(i){const e=_e.useRef(null);return e.current===null&&(e.current=i()),e.current}const Xw=typeof window<"u",JN=Xw?_e.useLayoutEffect:_e.useEffect,M1=_e.createContext(null);function Yw(i,e){i.indexOf(e)===-1&&i.push(e)}function Zw(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}const wu=(i,e,t)=>t>e?e:t<i?i:t;let Kw=()=>{};const Au={},$N=i=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(i);function eI(i){return typeof i=="object"&&i!==null}const tI=i=>/^0[^.\s]+$/u.test(i);function Qw(i){let e;return()=>(e===void 0&&(e=i()),e)}const qo=i=>i,KF=(i,e)=>t=>e(i(t)),Fv=(...i)=>i.reduce(KF),cv=(i,e,t)=>{const n=e-i;return n===0?1:(t-i)/n};class Jw{constructor(){this.subscriptions=[]}add(e){return Yw(this.subscriptions,e),()=>Zw(this.subscriptions,e)}notify(e,t,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,t,n);else for(let r=0;r<s;r++){const o=this.subscriptions[r];o&&o(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const _c=i=>i*1e3,Wo=i=>i/1e3;function nI(i,e){return e?i*(1e3/e):0}const iI=(i,e,t)=>(((1-3*t+3*e)*i+(3*t-6*e))*i+3*e)*i,QF=1e-7,JF=12;function $F(i,e,t,n,s){let r,o,l=0;do o=e+(t-e)/2,r=iI(o,n,s)-i,r>0?t=o:e=o;while(Math.abs(r)>QF&&++l<JF);return o}function kv(i,e,t,n){if(i===e&&t===n)return qo;const s=r=>$F(r,0,1,i,t);return r=>r===0||r===1?r:iI(s(r),e,n)}const sI=i=>e=>e<=.5?i(2*e)/2:(2-i(2*(1-e)))/2,rI=i=>e=>1-i(1-e),aI=kv(.33,1.53,.69,.99),$w=rI(aI),oI=sI($w),lI=i=>(i*=2)<1?.5*$w(i):.5*(2-Math.pow(2,-10*(i-1))),eA=i=>1-Math.sin(Math.acos(i)),cI=rI(eA),uI=sI(eA),ek=kv(.42,0,1,1),tk=kv(0,0,.58,1),hI=kv(.42,0,.58,1),nk=i=>Array.isArray(i)&&typeof i[0]!="number",fI=i=>Array.isArray(i)&&typeof i[0]=="number",ik={linear:qo,easeIn:ek,easeInOut:hI,easeOut:tk,circIn:eA,circInOut:uI,circOut:cI,backIn:$w,backInOut:oI,backOut:aI,anticipate:lI},sk=i=>typeof i=="string",rR=i=>{if(fI(i)){Kw(i.length===4);const[e,t,n,s]=i;return kv(e,t,n,s)}else if(sk(i))return ik[i];return i},V_=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function rk(i,e){let t=new Set,n=new Set,s=!1,r=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function u(p){o.has(p)&&(f.schedule(p),i()),p(l)}const f={schedule:(p,g=!1,v=!1)=>{const b=v&&s?t:n;return g&&o.add(p),b.has(p)||b.add(p),p},cancel:p=>{n.delete(p),o.delete(p)},process:p=>{if(l=p,s){r=!0;return}s=!0,[t,n]=[n,t],t.forEach(u),t.clear(),s=!1,r&&(r=!1,f.process(p))}};return f}const ak=40;function dI(i,e){let t=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},r=()=>t=!0,o=V_.reduce((R,I)=>(R[I]=rk(r),R),{}),{setup:l,read:u,resolveKeyframes:f,preUpdate:p,update:g,preRender:v,render:x,postRender:b}=o,w=()=>{const R=Au.useManualTiming?s.timestamp:performance.now();t=!1,Au.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(R-s.timestamp,ak),1)),s.timestamp=R,s.isProcessing=!0,l.process(s),u.process(s),f.process(s),p.process(s),g.process(s),v.process(s),x.process(s),b.process(s),s.isProcessing=!1,t&&e&&(n=!1,i(w))},M=()=>{t=!0,n=!0,s.isProcessing||i(w)};return{schedule:V_.reduce((R,I)=>{const D=o[I];return R[I]=(O,U=!1,k=!1)=>(t||M(),D.schedule(O,U,k)),R},{}),cancel:R=>{for(let I=0;I<V_.length;I++)o[V_[I]].cancel(R)},state:s,steps:o}}const{schedule:ki,cancel:Bh,state:mr,steps:yM}=dI(typeof requestAnimationFrame<"u"?requestAnimationFrame:qo,!0);let jx;function ok(){jx=void 0}const Va={now:()=>(jx===void 0&&Va.set(mr.isProcessing||Au.useManualTiming?mr.timestamp:performance.now()),jx),set:i=>{jx=i,queueMicrotask(ok)}},pI=i=>e=>typeof e=="string"&&e.startsWith(i),mI=pI("--"),lk=pI("var(--"),tA=i=>lk(i)?ck.test(i.split("/*")[0].trim()):!1,ck=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Gm={test:i=>typeof i=="number",parse:parseFloat,transform:i=>i},uv={...Gm,transform:i=>wu(0,1,i)},G_={...Gm,default:1},q0=i=>Math.round(i*1e5)/1e5,nA=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function uk(i){return i==null}const hk=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,iA=(i,e)=>t=>!!(typeof t=="string"&&hk.test(t)&&t.startsWith(i)||e&&!uk(t)&&Object.prototype.hasOwnProperty.call(t,e)),gI=(i,e,t)=>n=>{if(typeof n!="string")return n;const[s,r,o,l]=n.match(nA);return{[i]:parseFloat(s),[e]:parseFloat(r),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},fk=i=>wu(0,255,i),_M={...Gm,transform:i=>Math.round(fk(i))},sd={test:iA("rgb","red"),parse:gI("red","green","blue"),transform:({red:i,green:e,blue:t,alpha:n=1})=>"rgba("+_M.transform(i)+", "+_M.transform(e)+", "+_M.transform(t)+", "+q0(uv.transform(n))+")"};function dk(i){let e="",t="",n="",s="";return i.length>5?(e=i.substring(1,3),t=i.substring(3,5),n=i.substring(5,7),s=i.substring(7,9)):(e=i.substring(1,2),t=i.substring(2,3),n=i.substring(3,4),s=i.substring(4,5),e+=e,t+=t,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const BT={test:iA("#"),parse:dk,transform:sd.transform},Bv=i=>({test:e=>typeof e=="string"&&e.endsWith(i)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${i}`}),Dh=Bv("deg"),xc=Bv("%"),$t=Bv("px"),pk=Bv("vh"),mk=Bv("vw"),aR={...xc,parse:i=>xc.parse(i)/100,transform:i=>xc.transform(i*100)},hm={test:iA("hsl","hue"),parse:gI("hue","saturation","lightness"),transform:({hue:i,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(i)+", "+xc.transform(q0(e))+", "+xc.transform(q0(t))+", "+q0(uv.transform(n))+")"},Ds={test:i=>sd.test(i)||BT.test(i)||hm.test(i),parse:i=>sd.test(i)?sd.parse(i):hm.test(i)?hm.parse(i):BT.parse(i),transform:i=>typeof i=="string"?i:i.hasOwnProperty("red")?sd.transform(i):hm.transform(i),getAnimatableNone:i=>{const e=Ds.parse(i);return e.alpha=0,Ds.transform(e)}},gk=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function vk(i){return isNaN(i)&&typeof i=="string"&&(i.match(nA)?.length||0)+(i.match(gk)?.length||0)>0}const vI="number",yI="color",yk="var",_k="var(",oR="${}",xk=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function hv(i){const e=i.toString(),t=[],n={color:[],number:[],var:[]},s=[];let r=0;const l=e.replace(xk,u=>(Ds.test(u)?(n.color.push(r),s.push(yI),t.push(Ds.parse(u))):u.startsWith(_k)?(n.var.push(r),s.push(yk),t.push(u)):(n.number.push(r),s.push(vI),t.push(parseFloat(u))),++r,oR)).split(oR);return{values:t,split:l,indexes:n,types:s}}function _I(i){return hv(i).values}function xI(i){const{split:e,types:t}=hv(i),n=e.length;return s=>{let r="";for(let o=0;o<n;o++)if(r+=e[o],s[o]!==void 0){const l=t[o];l===vI?r+=q0(s[o]):l===yI?r+=Ds.transform(s[o]):r+=s[o]}return r}}const bk=i=>typeof i=="number"?0:Ds.test(i)?Ds.getAnimatableNone(i):i;function Sk(i){const e=_I(i);return xI(i)(e.map(bk))}const zh={test:vk,parse:_I,createTransformer:xI,getAnimatableNone:Sk};function xM(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*(2/3-t)*6:i}function Mk({hue:i,saturation:e,lightness:t,alpha:n}){i/=360,e/=100,t/=100;let s=0,r=0,o=0;if(!e)s=r=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;s=xM(u,l,i+1/3),r=xM(u,l,i),o=xM(u,l,i-1/3)}return{red:Math.round(s*255),green:Math.round(r*255),blue:Math.round(o*255),alpha:n}}function ib(i,e){return t=>t>0?e:i}const Yi=(i,e,t)=>i+(e-i)*t,bM=(i,e,t)=>{const n=i*i,s=t*(e*e-n)+n;return s<0?0:Math.sqrt(s)},Tk=[BT,sd,hm],wk=i=>Tk.find(e=>e.test(i));function lR(i){const e=wk(i);if(!e)return!1;let t=e.parse(i);return e===hm&&(t=Mk(t)),t}const cR=(i,e)=>{const t=lR(i),n=lR(e);if(!t||!n)return ib(i,e);const s={...t};return r=>(s.red=bM(t.red,n.red,r),s.green=bM(t.green,n.green,r),s.blue=bM(t.blue,n.blue,r),s.alpha=Yi(t.alpha,n.alpha,r),sd.transform(s))},zT=new Set(["none","hidden"]);function Ak(i,e){return zT.has(i)?t=>t<=0?i:e:t=>t>=1?e:i}function Ek(i,e){return t=>Yi(i,e,t)}function sA(i){return typeof i=="number"?Ek:typeof i=="string"?tA(i)?ib:Ds.test(i)?cR:Dk:Array.isArray(i)?bI:typeof i=="object"?Ds.test(i)?cR:Ck:ib}function bI(i,e){const t=[...i],n=t.length,s=i.map((r,o)=>sA(r)(r,e[o]));return r=>{for(let o=0;o<n;o++)t[o]=s[o](r);return t}}function Ck(i,e){const t={...i,...e},n={};for(const s in t)i[s]!==void 0&&e[s]!==void 0&&(n[s]=sA(i[s])(i[s],e[s]));return s=>{for(const r in n)t[r]=n[r](s);return t}}function Rk(i,e){const t=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const r=e.types[s],o=i.indexes[r][n[r]],l=i.values[o]??0;t[s]=l,n[r]++}return t}const Dk=(i,e)=>{const t=zh.createTransformer(e),n=hv(i),s=hv(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?zT.has(i)&&!s.values.length||zT.has(e)&&!n.values.length?Ak(i,e):Fv(bI(Rk(n,s),s.values),t):ib(i,e)};function SI(i,e,t){return typeof i=="number"&&typeof e=="number"&&typeof t=="number"?Yi(i,e,t):sA(i)(i,e)}const Nk=i=>{const e=({timestamp:t})=>i(t);return{start:(t=!0)=>ki.update(e,t),stop:()=>Bh(e),now:()=>mr.isProcessing?mr.timestamp:Va.now()}},MI=(i,e,t=10)=>{let n="";const s=Math.max(Math.round(e/t),2);for(let r=0;r<s;r++)n+=Math.round(i(r/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},sb=2e4;function rA(i){let e=0;const t=50;let n=i.next(e);for(;!n.done&&e<sb;)e+=t,n=i.next(e);return e>=sb?1/0:e}function Ik(i,e=100,t){const n=t({...i,keyframes:[0,e]}),s=Math.min(rA(n),sb);return{type:"keyframes",ease:r=>n.next(s*r).value/e,duration:Wo(s)}}const Ok=5;function TI(i,e,t){const n=Math.max(e-Ok,0);return nI(t-i(n),e-n)}const rs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},SM=.001;function Pk({duration:i=rs.duration,bounce:e=rs.bounce,velocity:t=rs.velocity,mass:n=rs.mass}){let s,r,o=1-e;o=wu(rs.minDamping,rs.maxDamping,o),i=wu(rs.minDuration,rs.maxDuration,Wo(i)),o<1?(s=f=>{const p=f*o,g=p*i,v=p-t,x=VT(f,o),b=Math.exp(-g);return SM-v/x*b},r=f=>{const g=f*o*i,v=g*t+t,x=Math.pow(o,2)*Math.pow(f,2)*i,b=Math.exp(-g),w=VT(Math.pow(f,2),o);return(-s(f)+SM>0?-1:1)*((v-x)*b)/w}):(s=f=>{const p=Math.exp(-f*i),g=(f-t)*i+1;return-SM+p*g},r=f=>{const p=Math.exp(-f*i),g=(t-f)*(i*i);return p*g});const l=5/i,u=Lk(s,r,l);if(i=_c(i),isNaN(u))return{stiffness:rs.stiffness,damping:rs.damping,duration:i};{const f=Math.pow(u,2)*n;return{stiffness:f,damping:o*2*Math.sqrt(n*f),duration:i}}}const Uk=12;function Lk(i,e,t){let n=t;for(let s=1;s<Uk;s++)n=n-i(n)/e(n);return n}function VT(i,e){return i*Math.sqrt(1-e*e)}const Fk=["duration","bounce"],kk=["stiffness","damping","mass"];function uR(i,e){return e.some(t=>i[t]!==void 0)}function Bk(i){let e={velocity:rs.velocity,stiffness:rs.stiffness,damping:rs.damping,mass:rs.mass,isResolvedFromDuration:!1,...i};if(!uR(i,kk)&&uR(i,Fk))if(i.visualDuration){const t=i.visualDuration,n=2*Math.PI/(t*1.2),s=n*n,r=2*wu(.05,1,1-(i.bounce||0))*Math.sqrt(s);e={...e,mass:rs.mass,stiffness:s,damping:r}}else{const t=Pk(i);e={...e,...t,mass:rs.mass},e.isResolvedFromDuration=!0}return e}function rb(i=rs.visualDuration,e=rs.bounce){const t=typeof i!="object"?{visualDuration:i,keyframes:[0,1],bounce:e}:i;let{restSpeed:n,restDelta:s}=t;const r=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:r},{stiffness:u,damping:f,mass:p,duration:g,velocity:v,isResolvedFromDuration:x}=Bk({...t,velocity:-Wo(t.velocity||0)}),b=v||0,w=f/(2*Math.sqrt(u*p)),M=o-r,S=Wo(Math.sqrt(u/p)),C=Math.abs(M)<5;n||(n=C?rs.restSpeed.granular:rs.restSpeed.default),s||(s=C?rs.restDelta.granular:rs.restDelta.default);let R;if(w<1){const D=VT(S,w);R=O=>{const U=Math.exp(-w*S*O);return o-U*((b+w*S*M)/D*Math.sin(D*O)+M*Math.cos(D*O))}}else if(w===1)R=D=>o-Math.exp(-S*D)*(M+(b+S*M)*D);else{const D=S*Math.sqrt(w*w-1);R=O=>{const U=Math.exp(-w*S*O),k=Math.min(D*O,300);return o-U*((b+w*S*M)*Math.sinh(k)+D*M*Math.cosh(k))/D}}const I={calculatedDuration:x&&g||null,next:D=>{const O=R(D);if(x)l.done=D>=g;else{let U=D===0?b:0;w<1&&(U=D===0?_c(b):TI(R,D,O));const k=Math.abs(U)<=n,P=Math.abs(o-O)<=s;l.done=k&&P}return l.value=l.done?o:O,l},toString:()=>{const D=Math.min(rA(I),sb),O=MI(U=>I.next(D*U).value,D,30);return D+"ms "+O},toTransition:()=>{}};return I}rb.applyToOptions=i=>{const e=Ik(i,100,rb);return i.ease=e.ease,i.duration=_c(e.duration),i.type="keyframes",i};function GT({keyframes:i,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:r=500,modifyTarget:o,min:l,max:u,restDelta:f=.5,restSpeed:p}){const g=i[0],v={done:!1,value:g},x=k=>l!==void 0&&k<l||u!==void 0&&k>u,b=k=>l===void 0?u:u===void 0||Math.abs(l-k)<Math.abs(u-k)?l:u;let w=t*e;const M=g+w,S=o===void 0?M:o(M);S!==M&&(w=S-g);const C=k=>-w*Math.exp(-k/n),R=k=>S+C(k),I=k=>{const P=C(k),F=R(k);v.done=Math.abs(P)<=f,v.value=v.done?S:F};let D,O;const U=k=>{x(v.value)&&(D=k,O=rb({keyframes:[v.value,b(v.value)],velocity:TI(R,k,v.value),damping:s,stiffness:r,restDelta:f,restSpeed:p}))};return U(0),{calculatedDuration:null,next:k=>{let P=!1;return!O&&D===void 0&&(P=!0,I(k),U(k)),D!==void 0&&k>=D?O.next(k-D):(!P&&I(k),v)}}}function zk(i,e,t){const n=[],s=t||Au.mix||SI,r=i.length-1;for(let o=0;o<r;o++){let l=s(i[o],i[o+1]);if(e){const u=Array.isArray(e)?e[o]||qo:e;l=Fv(u,l)}n.push(l)}return n}function Vk(i,e,{clamp:t=!0,ease:n,mixer:s}={}){const r=i.length;if(Kw(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const o=i[0]===i[1];i[0]>i[r-1]&&(i=[...i].reverse(),e=[...e].reverse());const l=zk(e,n,s),u=l.length,f=p=>{if(o&&p<i[0])return e[0];let g=0;if(u>1)for(;g<i.length-2&&!(p<i[g+1]);g++);const v=cv(i[g],i[g+1],p);return l[g](v)};return t?p=>f(wu(i[0],i[r-1],p)):f}function Gk(i,e){const t=i[i.length-1];for(let n=1;n<=e;n++){const s=cv(0,e,n);i.push(Yi(t,1,s))}}function Hk(i){const e=[0];return Gk(e,i.length-1),e}function Wk(i,e){return i.map(t=>t*e)}function jk(i,e){return i.map(()=>e||hI).splice(0,i.length-1)}function X0({duration:i=300,keyframes:e,times:t,ease:n="easeInOut"}){const s=nk(n)?n.map(rR):rR(n),r={done:!1,value:e[0]},o=Wk(t&&t.length===e.length?t:Hk(e),i),l=Vk(o,e,{ease:Array.isArray(s)?s:jk(e,s)});return{calculatedDuration:i,next:u=>(r.value=l(u),r.done=u>=i,r)}}const qk=i=>i!==null;function aA(i,{repeat:e,repeatType:t="loop"},n,s=1){const r=i.filter(qk),l=s<0||e&&t!=="loop"&&e%2===1?0:r.length-1;return!l||n===void 0?r[l]:n}const Xk={decay:GT,inertia:GT,tween:X0,keyframes:X0,spring:rb};function wI(i){typeof i.type=="string"&&(i.type=Xk[i.type])}class oA{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const Yk=i=>i/100;class lA extends oA{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==Va.now()&&this.tick(Va.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;wI(e);const{type:t=X0,repeat:n=0,repeatDelay:s=0,repeatType:r,velocity:o=0}=e;let{keyframes:l}=e;const u=t||X0;u!==X0&&typeof l[0]!="number"&&(this.mixKeyframes=Fv(Yk,SI(l[0],l[1])),l=[0,100]);const f=u({...e,keyframes:l});r==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...l].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=rA(f));const{calculatedDuration:p}=f;this.calculatedDuration=p,this.resolvedDuration=p+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=f}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:n,totalDuration:s,mixKeyframes:r,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:u}=this;if(this.startTime===null)return n.next(0);const{delay:f=0,keyframes:p,repeat:g,repeatType:v,repeatDelay:x,type:b,onUpdate:w,finalKeyframe:M}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const S=this.currentTime-f*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?S<0:S>s;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let R=this.currentTime,I=n;if(g){const k=Math.min(this.currentTime,s)/l;let P=Math.floor(k),F=k%1;!F&&k>=1&&(F=1),F===1&&P--,P=Math.min(P,g+1),P%2&&(v==="reverse"?(F=1-F,x&&(F-=x/l)):v==="mirror"&&(I=o)),R=wu(0,1,F)*l}const D=C?{done:!1,value:p[0]}:I.next(R);r&&(D.value=r(D.value));let{done:O}=D;!C&&u!==null&&(O=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const U=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&O);return U&&b!==GT&&(D.value=aA(p,this.options,M,this.speed)),w&&w(D.value),U&&this.finish(),D}then(e,t){return this.finished.then(e,t)}get duration(){return Wo(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Wo(e)}get time(){return Wo(this.currentTime)}set time(e){e=_c(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Va.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Wo(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=Nk,startTime:t}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=t??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Va.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function Zk(i){for(let e=1;e<i.length;e++)i[e]??(i[e]=i[e-1])}const rd=i=>i*180/Math.PI,HT=i=>{const e=rd(Math.atan2(i[1],i[0]));return WT(e)},Kk={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:i=>(Math.abs(i[0])+Math.abs(i[3]))/2,rotate:HT,rotateZ:HT,skewX:i=>rd(Math.atan(i[1])),skewY:i=>rd(Math.atan(i[2])),skew:i=>(Math.abs(i[1])+Math.abs(i[2]))/2},WT=i=>(i=i%360,i<0&&(i+=360),i),hR=HT,fR=i=>Math.sqrt(i[0]*i[0]+i[1]*i[1]),dR=i=>Math.sqrt(i[4]*i[4]+i[5]*i[5]),Qk={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:fR,scaleY:dR,scale:i=>(fR(i)+dR(i))/2,rotateX:i=>WT(rd(Math.atan2(i[6],i[5]))),rotateY:i=>WT(rd(Math.atan2(-i[2],i[0]))),rotateZ:hR,rotate:hR,skewX:i=>rd(Math.atan(i[4])),skewY:i=>rd(Math.atan(i[1])),skew:i=>(Math.abs(i[1])+Math.abs(i[4]))/2};function jT(i){return i.includes("scale")?1:0}function qT(i,e){if(!i||i==="none")return jT(e);const t=i.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(t)n=Qk,s=t;else{const l=i.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Kk,s=l}if(!s)return jT(e);const r=n[e],o=s[1].split(",").map($k);return typeof r=="function"?r(o):o[r]}const Jk=(i,e)=>{const{transform:t="none"}=getComputedStyle(i);return qT(t,e)};function $k(i){return parseFloat(i.trim())}const Hm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Wm=new Set(Hm),pR=i=>i===Gm||i===$t,e4=new Set(["x","y","z"]),t4=Hm.filter(i=>!e4.has(i));function n4(i){const e=[];return t4.forEach(t=>{const n=i.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const fd={width:({x:i},{paddingLeft:e="0",paddingRight:t="0"})=>i.max-i.min-parseFloat(e)-parseFloat(t),height:({y:i},{paddingTop:e="0",paddingBottom:t="0"})=>i.max-i.min-parseFloat(e)-parseFloat(t),top:(i,{top:e})=>parseFloat(e),left:(i,{left:e})=>parseFloat(e),bottom:({y:i},{top:e})=>parseFloat(e)+(i.max-i.min),right:({x:i},{left:e})=>parseFloat(e)+(i.max-i.min),x:(i,{transform:e})=>qT(e,"x"),y:(i,{transform:e})=>qT(e,"y")};fd.translateX=fd.x;fd.translateY=fd.y;const dd=new Set;let XT=!1,YT=!1,ZT=!1;function AI(){if(YT){const i=Array.from(dd).filter(n=>n.needsMeasurement),e=new Set(i.map(n=>n.element)),t=new Map;e.forEach(n=>{const s=n4(n);s.length&&(t.set(n,s),n.render())}),i.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=t.get(n);s&&s.forEach(([r,o])=>{n.getValue(r)?.set(o)})}),i.forEach(n=>n.measureEndState()),i.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}YT=!1,XT=!1,dd.forEach(i=>i.complete(ZT)),dd.clear()}function EI(){dd.forEach(i=>{i.readKeyframes(),i.needsMeasurement&&(YT=!0)})}function i4(){ZT=!0,EI(),AI(),ZT=!1}class cA{constructor(e,t,n,s,r,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=s,this.element=r,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(dd.add(this),XT||(XT=!0,ki.read(EI),ki.resolveKeyframes(AI))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:s}=this;if(e[0]===null){const r=s?.get(),o=e[e.length-1];if(r!==void 0)e[0]=r;else if(n&&t){const l=n.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),s&&r===void 0&&s.set(e[0])}Zk(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),dd.delete(this)}cancel(){this.state==="scheduled"&&(dd.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const s4=i=>i.startsWith("--");function r4(i,e,t){s4(e)?i.style.setProperty(e,t):i.style[e]=t}const a4=Qw(()=>window.ScrollTimeline!==void 0),o4={};function l4(i,e){const t=Qw(i);return()=>o4[e]??t()}const CI=l4(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),V0=([i,e,t,n])=>`cubic-bezier(${i}, ${e}, ${t}, ${n})`,mR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:V0([0,.65,.55,1]),circOut:V0([.55,0,1,.45]),backIn:V0([.31,.01,.66,-.59]),backOut:V0([.33,1.53,.69,.99])};function RI(i,e){if(i)return typeof i=="function"?CI()?MI(i,e):"ease-out":fI(i)?V0(i):Array.isArray(i)?i.map(t=>RI(t,e)||mR.easeOut):mR[i]}function c4(i,e,t,{delay:n=0,duration:s=300,repeat:r=0,repeatType:o="loop",ease:l="easeOut",times:u}={},f=void 0){const p={[e]:t};u&&(p.offset=u);const g=RI(l,s);Array.isArray(g)&&(p.easing=g);const v={delay:n,duration:s,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:r+1,direction:o==="reverse"?"alternate":"normal"};return f&&(v.pseudoElement=f),i.animate(p,v)}function DI(i){return typeof i=="function"&&"applyToOptions"in i}function u4({type:i,...e}){return DI(i)&&CI()?i.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class h4 extends oA{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:s,pseudoElement:r,allowFlatten:o=!1,finalKeyframe:l,onComplete:u}=e;this.isPseudoElement=!!r,this.allowFlatten=o,this.options=e,Kw(typeof e.type!="string");const f=u4(e);this.animation=c4(t,n,s,f,r),f.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){const p=aA(s,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(p):r4(t,n,p),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Wo(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Wo(e)}get time(){return Wo(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=_c(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&a4()?(this.animation.timeline=e,qo):t(this)}}const NI={anticipate:lI,backInOut:oI,circInOut:uI};function f4(i){return i in NI}function d4(i){typeof i.ease=="string"&&f4(i.ease)&&(i.ease=NI[i.ease])}const gR=10;class p4 extends h4{constructor(e){d4(e),wI(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:n,onComplete:s,element:r,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const l=new lA({...o,autoplay:!1}),u=_c(this.finishedTime??this.time);t.setWithVelocity(l.sample(u-gR).value,l.sample(u).value,gR),l.stop()}}const vR=(i,e)=>e==="zIndex"?!1:!!(typeof i=="number"||Array.isArray(i)||typeof i=="string"&&(zh.test(i)||i==="0")&&!i.startsWith("url("));function m4(i){const e=i[0];if(i.length===1)return!0;for(let t=0;t<i.length;t++)if(i[t]!==e)return!0}function g4(i,e,t,n){const s=i[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const r=i[i.length-1],o=vR(s,e),l=vR(r,e);return!o||!l?!1:m4(i)||(t==="spring"||DI(t))&&n}function KT(i){i.duration=0,i.type="keyframes"}const v4=new Set(["opacity","clipPath","filter","transform"]),y4=Qw(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function _4(i){const{motionValue:e,name:t,repeatDelay:n,repeatType:s,damping:r,type:o}=i;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:f}=e.owner.getProps();return y4()&&t&&v4.has(t)&&(t!=="transform"||!f)&&!u&&!n&&s!=="mirror"&&r!==0&&o!=="inertia"}const x4=40;class b4 extends oA{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:o="loop",keyframes:l,name:u,motionValue:f,element:p,...g}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Va.now();const v={autoplay:e,delay:t,type:n,repeat:s,repeatDelay:r,repeatType:o,name:u,motionValue:f,element:p,...g},x=p?.KeyframeResolver||cA;this.keyframeResolver=new x(l,(b,w,M)=>this.onKeyframesResolved(b,w,v,!M),u,f,p),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,n,s){this.keyframeResolver=void 0;const{name:r,type:o,velocity:l,delay:u,isHandoff:f,onUpdate:p}=n;this.resolvedAt=Va.now(),g4(e,r,o,l)||((Au.instantAnimations||!u)&&p?.(aA(e,n,t)),e[0]=e[e.length-1],KT(n),n.repeat=0);const v={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>x4?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...n,keyframes:e},x=!f&&_4(v)?new p4({...v,element:v.motionValue.owner.current}):new lA(v);x.finished.then(()=>this.notifyFinished()).catch(qo),this.pendingTimeline&&(this.stopTimeline=x.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=x}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),i4()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const S4=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function M4(i){const e=S4.exec(i);if(!e)return[,];const[,t,n,s]=e;return[`--${t??n}`,s]}function II(i,e,t=1){const[n,s]=M4(i);if(!n)return;const r=window.getComputedStyle(e).getPropertyValue(n);if(r){const o=r.trim();return $N(o)?parseFloat(o):o}return tA(s)?II(s,e,t+1):s}function uA(i,e){return i?.[e]??i?.default??i}const OI=new Set(["width","height","top","left","right","bottom",...Hm]),T4={test:i=>i==="auto",parse:i=>i},PI=i=>e=>e.test(i),UI=[Gm,$t,xc,Dh,mk,pk,T4],yR=i=>UI.find(PI(i));function w4(i){return typeof i=="number"?i===0:i!==null?i==="none"||i==="0"||tI(i):!0}const A4=new Set(["brightness","contrast","saturate","opacity"]);function E4(i){const[e,t]=i.slice(0,-1).split("(");if(e==="drop-shadow")return i;const[n]=t.match(nA)||[];if(!n)return i;const s=t.replace(n,"");let r=A4.has(e)?1:0;return n!==t&&(r*=100),e+"("+r+s+")"}const C4=/\b([a-z-]*)\(.*?\)/gu,QT={...zh,getAnimatableNone:i=>{const e=i.match(C4);return e?e.map(E4).join(" "):i}},_R={...Gm,transform:Math.round},R4={rotate:Dh,rotateX:Dh,rotateY:Dh,rotateZ:Dh,scale:G_,scaleX:G_,scaleY:G_,scaleZ:G_,skew:Dh,skewX:Dh,skewY:Dh,distance:$t,translateX:$t,translateY:$t,translateZ:$t,x:$t,y:$t,z:$t,perspective:$t,transformPerspective:$t,opacity:uv,originX:aR,originY:aR,originZ:$t},hA={borderWidth:$t,borderTopWidth:$t,borderRightWidth:$t,borderBottomWidth:$t,borderLeftWidth:$t,borderRadius:$t,radius:$t,borderTopLeftRadius:$t,borderTopRightRadius:$t,borderBottomRightRadius:$t,borderBottomLeftRadius:$t,width:$t,maxWidth:$t,height:$t,maxHeight:$t,top:$t,right:$t,bottom:$t,left:$t,padding:$t,paddingTop:$t,paddingRight:$t,paddingBottom:$t,paddingLeft:$t,margin:$t,marginTop:$t,marginRight:$t,marginBottom:$t,marginLeft:$t,backgroundPositionX:$t,backgroundPositionY:$t,...R4,zIndex:_R,fillOpacity:uv,strokeOpacity:uv,numOctaves:_R},D4={...hA,color:Ds,backgroundColor:Ds,outlineColor:Ds,fill:Ds,stroke:Ds,borderColor:Ds,borderTopColor:Ds,borderRightColor:Ds,borderBottomColor:Ds,borderLeftColor:Ds,filter:QT,WebkitFilter:QT},LI=i=>D4[i];function FI(i,e){let t=LI(i);return t!==QT&&(t=zh),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const N4=new Set(["auto","none","0"]);function I4(i,e,t){let n=0,s;for(;n<i.length&&!s;){const r=i[n];typeof r=="string"&&!N4.has(r)&&hv(r).values.length&&(s=i[n]),n++}if(s&&t)for(const r of e)i[r]=FI(t,s)}class O4 extends cA{constructor(e,t,n,s,r){super(e,t,n,s,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let f=e[u];if(typeof f=="string"&&(f=f.trim(),tA(f))){const p=II(f,t.current);p!==void 0&&(e[u]=p),u===e.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!OI.has(n)||e.length!==2)return;const[s,r]=e,o=yR(s),l=yR(r);if(o!==l)if(pR(o)&&pR(l))for(let u=0;u<e.length;u++){const f=e[u];typeof f=="string"&&(e[u]=parseFloat(f))}else fd[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||w4(e[s]))&&n.push(s);n.length&&I4(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fd[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const s=t[t.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(t);s&&s.jump(this.measuredOrigin,!1);const r=n.length-1,o=n[r];n[r]=fd[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function P4(i,e,t){if(i instanceof EventTarget)return[i];if(typeof i=="string"){let n=document;const s=t?.[i]??n.querySelectorAll(i);return s?Array.from(s):[]}return Array.from(i)}const kI=(i,e)=>e&&typeof i=="number"?e.transform(i):i;function BI(i){return eI(i)&&"offsetHeight"in i}const xR=30,U4=i=>!isNaN(parseFloat(i));class L4{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=Va.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const r of this.dependents)r.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Va.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=U4(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Jw);const n=this.events[e].add(t);return e==="change"?()=>{n(),ki.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Va.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>xR)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,xR);return nI(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Am(i,e){return new L4(i,e)}const{schedule:fA}=dI(queueMicrotask,!1),xl={x:!1,y:!1};function zI(){return xl.x||xl.y}function F4(i){return i==="x"||i==="y"?xl[i]?null:(xl[i]=!0,()=>{xl[i]=!1}):xl.x||xl.y?null:(xl.x=xl.y=!0,()=>{xl.x=xl.y=!1})}function VI(i,e){const t=P4(i),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[t,s,()=>n.abort()]}function bR(i){return!(i.pointerType==="touch"||zI())}function k4(i,e,t={}){const[n,s,r]=VI(i,t),o=l=>{if(!bR(l))return;const{target:u}=l,f=e(u,l);if(typeof f!="function"||!u)return;const p=g=>{bR(g)&&(f(g),u.removeEventListener("pointerleave",p))};u.addEventListener("pointerleave",p,s)};return n.forEach(l=>{l.addEventListener("pointerenter",o,s)}),r}const GI=(i,e)=>e?i===e?!0:GI(i,e.parentElement):!1,dA=i=>i.pointerType==="mouse"?typeof i.button!="number"||i.button<=0:i.isPrimary!==!1,B4=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function z4(i){return B4.has(i.tagName)||i.tabIndex!==-1}const qx=new WeakSet;function SR(i){return e=>{e.key==="Enter"&&i(e)}}function MM(i,e){i.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const V4=(i,e)=>{const t=i.currentTarget;if(!t)return;const n=SR(()=>{if(qx.has(t))return;MM(t,"down");const s=SR(()=>{MM(t,"up")}),r=()=>MM(t,"cancel");t.addEventListener("keyup",s,e),t.addEventListener("blur",r,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function MR(i){return dA(i)&&!zI()}function G4(i,e,t={}){const[n,s,r]=VI(i,t),o=l=>{const u=l.currentTarget;if(!MR(l))return;qx.add(u);const f=e(u,l),p=(x,b)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",v),qx.has(u)&&qx.delete(u),MR(x)&&typeof f=="function"&&f(x,{success:b})},g=x=>{p(x,u===window||u===document||t.useGlobalTarget||GI(u,x.target))},v=x=>{p(x,!1)};window.addEventListener("pointerup",g,s),window.addEventListener("pointercancel",v,s)};return n.forEach(l=>{(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,s),BI(l)&&(l.addEventListener("focus",f=>V4(f,s)),!z4(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),r}function HI(i){return eI(i)&&"ownerSVGElement"in i}function H4(i){return HI(i)&&i.tagName==="svg"}const Or=i=>!!(i&&i.getVelocity),W4=[...UI,Ds,zh],j4=i=>W4.find(PI(i)),pA=_e.createContext({transformPagePoint:i=>i,isStatic:!1,reducedMotion:"never"});function TR(i,e){if(typeof i=="function")return i(e);i!=null&&(i.current=e)}function q4(...i){return e=>{let t=!1;const n=i.map(s=>{const r=TR(s,e);return!t&&typeof r=="function"&&(t=!0),r});if(t)return()=>{for(let s=0;s<n.length;s++){const r=n[s];typeof r=="function"?r():TR(i[s],null)}}}}function X4(...i){return _e.useCallback(q4(...i),i)}class Y4 extends _e.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const n=t.offsetParent,s=BI(n)&&n.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Z4({children:i,isPresent:e,anchorX:t,root:n}){const s=_e.useId(),r=_e.useRef(null),o=_e.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=_e.useContext(pA),u=X4(r,i?.ref);return _e.useInsertionEffect(()=>{const{width:f,height:p,top:g,left:v,right:x}=o.current;if(e||!r.current||!f||!p)return;const b=t==="left"?`left: ${v}`:`right: ${x}`;r.current.dataset.motionPopId=s;const w=document.createElement("style");l&&(w.nonce=l);const M=n??document.head;return M.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${f}px !important;
            height: ${p}px !important;
            ${b}px !important;
            top: ${g}px !important;
          }
        `),()=>{M.contains(w)&&M.removeChild(w)}},[e]),ee.jsx(Y4,{isPresent:e,childRef:r,sizeRef:o,children:_e.cloneElement(i,{ref:u})})}const K4=({children:i,initial:e,isPresent:t,onExitComplete:n,custom:s,presenceAffectsLayout:r,mode:o,anchorX:l,root:u})=>{const f=qw(Q4),p=_e.useId();let g=!0,v=_e.useMemo(()=>(g=!1,{id:p,initial:e,isPresent:t,custom:s,onExitComplete:x=>{f.set(x,!0);for(const b of f.values())if(!b)return;n&&n()},register:x=>(f.set(x,!1),()=>f.delete(x))}),[t,f,n]);return r&&g&&(v={...v}),_e.useMemo(()=>{f.forEach((x,b)=>f.set(b,!1))},[t]),_e.useEffect(()=>{!t&&!f.size&&n&&n()},[t]),o==="popLayout"&&(i=ee.jsx(Z4,{isPresent:t,anchorX:l,root:u,children:i})),ee.jsx(M1.Provider,{value:v,children:i})};function Q4(){return new Map}function WI(i=!0){const e=_e.useContext(M1);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:s}=e,r=_e.useId();_e.useEffect(()=>{if(i)return s(r)},[i]);const o=_e.useCallback(()=>i&&n&&n(r),[r,n,i]);return!t&&n?[!1,o]:[!0]}const H_=i=>i.key||"";function wR(i){const e=[];return _e.Children.forEach(i,t=>{_e.isValidElement(t)&&e.push(t)}),e}const jm=({children:i,custom:e,initial:t=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:r="sync",propagate:o=!1,anchorX:l="left",root:u})=>{const[f,p]=WI(o),g=_e.useMemo(()=>wR(i),[i]),v=o&&!f?[]:g.map(H_),x=_e.useRef(!0),b=_e.useRef(g),w=qw(()=>new Map),[M,S]=_e.useState(g),[C,R]=_e.useState(g);JN(()=>{x.current=!1,b.current=g;for(let O=0;O<C.length;O++){const U=H_(C[O]);v.includes(U)?w.delete(U):w.get(U)!==!0&&w.set(U,!1)}},[C,v.length,v.join("-")]);const I=[];if(g!==M){let O=[...g];for(let U=0;U<C.length;U++){const k=C[U],P=H_(k);v.includes(P)||(O.splice(U,0,k),I.push(k))}return r==="wait"&&I.length&&(O=I),R(wR(O)),S(g),null}const{forceRender:D}=_e.useContext(jw);return ee.jsx(ee.Fragment,{children:C.map(O=>{const U=H_(O),k=o&&!f?!1:g===C||v.includes(U),P=()=>{if(w.has(U))w.set(U,!0);else return;let F=!0;w.forEach(H=>{H||(F=!1)}),F&&(D?.(),R(b.current),o&&p?.(),n&&n())};return ee.jsx(K4,{isPresent:k,initial:!x.current||t?void 0:!1,custom:e,presenceAffectsLayout:s,mode:r,root:u,onExitComplete:k?void 0:P,anchorX:l,children:O},U)})})},jI=_e.createContext({strict:!1}),AR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Em={};for(const i in AR)Em[i]={isEnabled:e=>AR[i].some(t=>!!e[t])};function J4(i){for(const e in i)Em[e]={...Em[e],...i[e]}}const $4=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ab(i){return i.startsWith("while")||i.startsWith("drag")&&i!=="draggable"||i.startsWith("layout")||i.startsWith("onTap")||i.startsWith("onPan")||i.startsWith("onLayout")||$4.has(i)}let qI=i=>!ab(i);function eB(i){typeof i=="function"&&(qI=e=>e.startsWith("on")?!ab(e):i(e))}try{eB(require("@emotion/is-prop-valid").default)}catch{}function tB(i,e,t){const n={};for(const s in i)s==="values"&&typeof i.values=="object"||(qI(s)||t===!0&&ab(s)||!e&&!ab(s)||i.draggable&&s.startsWith("onDrag"))&&(n[s]=i[s]);return n}const T1=_e.createContext({});function w1(i){return i!==null&&typeof i=="object"&&typeof i.start=="function"}function fv(i){return typeof i=="string"||Array.isArray(i)}const mA=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],gA=["initial",...mA];function A1(i){return w1(i.animate)||gA.some(e=>fv(i[e]))}function XI(i){return!!(A1(i)||i.variants)}function nB(i,e){if(A1(i)){const{initial:t,animate:n}=i;return{initial:t===!1||fv(t)?t:void 0,animate:fv(n)?n:void 0}}return i.inherit!==!1?e:{}}function iB(i){const{initial:e,animate:t}=nB(i,_e.useContext(T1));return _e.useMemo(()=>({initial:e,animate:t}),[ER(e),ER(t)])}function ER(i){return Array.isArray(i)?i.join(" "):i}function CR(i,e){return e.max===e.min?0:i/(e.max-e.min)*100}const w0={correct:(i,e)=>{if(!e.target)return i;if(typeof i=="string")if($t.test(i))i=parseFloat(i);else return i;const t=CR(i,e.target.x),n=CR(i,e.target.y);return`${t}% ${n}%`}},sB={correct:(i,{treeScale:e,projectionDelta:t})=>{const n=i,s=zh.parse(i);if(s.length>5)return n;const r=zh.createTransformer(i),o=typeof s[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;s[0+o]/=l,s[1+o]/=u;const f=Yi(l,u,.5);return typeof s[2+o]=="number"&&(s[2+o]/=f),typeof s[3+o]=="number"&&(s[3+o]/=f),r(s)}},JT={borderRadius:{...w0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:w0,borderTopRightRadius:w0,borderBottomLeftRadius:w0,borderBottomRightRadius:w0,boxShadow:sB};function YI(i,{layout:e,layoutId:t}){return Wm.has(i)||i.startsWith("origin")||(e||t!==void 0)&&(!!JT[i]||i==="opacity")}const rB={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},aB=Hm.length;function oB(i,e,t){let n="",s=!0;for(let r=0;r<aB;r++){const o=Hm[r],l=i[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const f=kI(l,hA[o]);if(!u){s=!1;const p=rB[o]||o;n+=`${p}(${f}) `}t&&(e[o]=f)}}return n=n.trim(),t?n=t(e,s?"":n):s&&(n="none"),n}function vA(i,e,t){const{style:n,vars:s,transformOrigin:r}=i;let o=!1,l=!1;for(const u in e){const f=e[u];if(Wm.has(u)){o=!0;continue}else if(mI(u)){s[u]=f;continue}else{const p=kI(f,hA[u]);u.startsWith("origin")?(l=!0,r[u]=p):n[u]=p}}if(e.transform||(o||t?n.transform=oB(e,i.transform,t):n.transform&&(n.transform="none")),l){const{originX:u="50%",originY:f="50%",originZ:p=0}=r;n.transformOrigin=`${u} ${f} ${p}`}}const yA=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ZI(i,e,t){for(const n in e)!Or(e[n])&&!YI(n,t)&&(i[n]=e[n])}function lB({transformTemplate:i},e){return _e.useMemo(()=>{const t=yA();return vA(t,e,i),Object.assign({},t.vars,t.style)},[e])}function cB(i,e){const t=i.style||{},n={};return ZI(n,t,i),Object.assign(n,lB(i,e)),n}function uB(i,e){const t={},n=cB(i,e);return i.drag&&i.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=i.drag===!0?"none":`pan-${i.drag==="x"?"y":"x"}`),i.tabIndex===void 0&&(i.onTap||i.onTapStart||i.whileTap)&&(t.tabIndex=0),t.style=n,t}const hB={offset:"stroke-dashoffset",array:"stroke-dasharray"},fB={offset:"strokeDashoffset",array:"strokeDasharray"};function dB(i,e,t=1,n=0,s=!0){i.pathLength=1;const r=s?hB:fB;i[r.offset]=$t.transform(-n);const o=$t.transform(e),l=$t.transform(t);i[r.array]=`${o} ${l}`}function KI(i,{attrX:e,attrY:t,attrScale:n,pathLength:s,pathSpacing:r=1,pathOffset:o=0,...l},u,f,p){if(vA(i,l,f),u){i.style.viewBox&&(i.attrs.viewBox=i.style.viewBox);return}i.attrs=i.style,i.style={};const{attrs:g,style:v}=i;g.transform&&(v.transform=g.transform,delete g.transform),(v.transform||g.transformOrigin)&&(v.transformOrigin=g.transformOrigin??"50% 50%",delete g.transformOrigin),v.transform&&(v.transformBox=p?.transformBox??"fill-box",delete g.transformBox),e!==void 0&&(g.x=e),t!==void 0&&(g.y=t),n!==void 0&&(g.scale=n),s!==void 0&&dB(g,s,r,o,!1)}const QI=()=>({...yA(),attrs:{}}),JI=i=>typeof i=="string"&&i.toLowerCase()==="svg";function pB(i,e,t,n){const s=_e.useMemo(()=>{const r=QI();return KI(r,e,JI(n),i.transformTemplate,i.style),{...r.attrs,style:{...r.style}}},[e]);if(i.style){const r={};ZI(r,i.style,i),s.style={...r,...s.style}}return s}const mB=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function _A(i){return typeof i!="string"||i.includes("-")?!1:!!(mB.indexOf(i)>-1||/[A-Z]/u.test(i))}function gB(i,e,t,{latestValues:n},s,r=!1){const l=(_A(i)?pB:uB)(e,n,s,i),u=tB(e,typeof i=="string",r),f=i!==_e.Fragment?{...u,...l,ref:t}:{},{children:p}=e,g=_e.useMemo(()=>Or(p)?p.get():p,[p]);return _e.createElement(i,{...f,children:g})}function RR(i){const e=[{},{}];return i?.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function xA(i,e,t,n){if(typeof e=="function"){const[s,r]=RR(n);e=e(t!==void 0?t:i.custom,s,r)}if(typeof e=="string"&&(e=i.variants&&i.variants[e]),typeof e=="function"){const[s,r]=RR(n);e=e(t!==void 0?t:i.custom,s,r)}return e}function Xx(i){return Or(i)?i.get():i}function vB({scrapeMotionValuesFromProps:i,createRenderState:e},t,n,s){return{latestValues:yB(t,n,s,i),renderState:e()}}function yB(i,e,t,n){const s={},r=n(i,{});for(const v in r)s[v]=Xx(r[v]);let{initial:o,animate:l}=i;const u=A1(i),f=XI(i);e&&f&&!u&&i.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let p=t?t.initial===!1:!1;p=p||o===!1;const g=p?l:o;if(g&&typeof g!="boolean"&&!w1(g)){const v=Array.isArray(g)?g:[g];for(let x=0;x<v.length;x++){const b=xA(i,v[x]);if(b){const{transitionEnd:w,transition:M,...S}=b;for(const C in S){let R=S[C];if(Array.isArray(R)){const I=p?R.length-1:0;R=R[I]}R!==null&&(s[C]=R)}for(const C in w)s[C]=w[C]}}}return s}const $I=i=>(e,t)=>{const n=_e.useContext(T1),s=_e.useContext(M1),r=()=>vB(i,e,n,s);return t?r():qw(r)};function bA(i,e,t){const{style:n}=i,s={};for(const r in n)(Or(n[r])||e.style&&Or(e.style[r])||YI(r,i)||t?.getValue(r)?.liveStyle!==void 0)&&(s[r]=n[r]);return s}const _B=$I({scrapeMotionValuesFromProps:bA,createRenderState:yA});function eO(i,e,t){const n=bA(i,e,t);for(const s in i)if(Or(i[s])||Or(e[s])){const r=Hm.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[r]=i[s]}return n}const xB=$I({scrapeMotionValuesFromProps:eO,createRenderState:QI}),bB=Symbol.for("motionComponentSymbol");function fm(i){return i&&typeof i=="object"&&Object.prototype.hasOwnProperty.call(i,"current")}function SB(i,e,t){return _e.useCallback(n=>{n&&i.onMount&&i.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):fm(t)&&(t.current=n))},[e])}const SA=i=>i.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),MB="framerAppearId",tO="data-"+SA(MB),nO=_e.createContext({});function TB(i,e,t,n,s){const{visualElement:r}=_e.useContext(T1),o=_e.useContext(jI),l=_e.useContext(M1),u=_e.useContext(pA).reducedMotion,f=_e.useRef(null);n=n||o.renderer,!f.current&&n&&(f.current=n(i,{visualState:e,parent:r,props:t,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:u}));const p=f.current,g=_e.useContext(nO);p&&!p.projection&&s&&(p.type==="html"||p.type==="svg")&&wB(f.current,t,s,g);const v=_e.useRef(!1);_e.useInsertionEffect(()=>{p&&v.current&&p.update(t,l)});const x=t[tO],b=_e.useRef(!!x&&!window.MotionHandoffIsComplete?.(x)&&window.MotionHasOptimisedAnimation?.(x));return JN(()=>{p&&(v.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),p.scheduleRenderMicrotask(),b.current&&p.animationState&&p.animationState.animateChanges())}),_e.useEffect(()=>{p&&(!b.current&&p.animationState&&p.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(x)}),b.current=!1),p.enteringChildren=void 0)}),p}function wB(i,e,t,n){const{layoutId:s,layout:r,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:f,layoutCrossfade:p}=e;i.projection=new t(i.latestValues,e["data-framer-portal-id"]?void 0:iO(i.parent)),i.projection.setOptions({layoutId:s,layout:r,alwaysMeasureLayout:!!o||l&&fm(l),visualElement:i,animationType:typeof r=="string"?r:"both",initialPromotionConfig:n,crossfade:p,layoutScroll:u,layoutRoot:f})}function iO(i){if(i)return i.options.allowProjection!==!1?i.projection:iO(i.parent)}function TM(i,{forwardMotionProps:e=!1}={},t,n){t&&J4(t);const s=_A(i)?xB:_B;function r(l,u){let f;const p={..._e.useContext(pA),...l,layoutId:AB(l)},{isStatic:g}=p,v=iB(l),x=s(l,g);if(!g&&Xw){EB();const b=CB(p);f=b.MeasureLayout,v.visualElement=TB(i,x,p,n,b.ProjectionNode)}return ee.jsxs(T1.Provider,{value:v,children:[f&&v.visualElement?ee.jsx(f,{visualElement:v.visualElement,...p}):null,gB(i,l,SB(x,v.visualElement,u),x,g,e)]})}r.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const o=_e.forwardRef(r);return o[bB]=i,o}function AB({layoutId:i}){const e=_e.useContext(jw).id;return e&&i!==void 0?e+"-"+i:i}function EB(i,e){_e.useContext(jI).strict}function CB(i){const{drag:e,layout:t}=Em;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e?.isEnabled(i)||t?.isEnabled(i)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function RB(i,e){if(typeof Proxy>"u")return TM;const t=new Map,n=(r,o)=>TM(r,o,i,e),s=(r,o)=>n(r,o);return new Proxy(s,{get:(r,o)=>o==="create"?n:(t.has(o)||t.set(o,TM(o,void 0,i,e)),t.get(o))})}function sO({top:i,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:i,max:n}}}function DB({x:i,y:e}){return{top:e.min,right:i.max,bottom:e.max,left:i.min}}function NB(i,e){if(!e)return i;const t=e({x:i.left,y:i.top}),n=e({x:i.right,y:i.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function wM(i){return i===void 0||i===1}function $T({scale:i,scaleX:e,scaleY:t}){return!wM(i)||!wM(e)||!wM(t)}function $f(i){return $T(i)||rO(i)||i.z||i.rotate||i.rotateX||i.rotateY||i.skewX||i.skewY}function rO(i){return DR(i.x)||DR(i.y)}function DR(i){return i&&i!=="0%"}function ob(i,e,t){const n=i-t,s=e*n;return t+s}function NR(i,e,t,n,s){return s!==void 0&&(i=ob(i,s,n)),ob(i,t,n)+e}function ew(i,e=0,t=1,n,s){i.min=NR(i.min,e,t,n,s),i.max=NR(i.max,e,t,n,s)}function aO(i,{x:e,y:t}){ew(i.x,e.translate,e.scale,e.originPoint),ew(i.y,t.translate,t.scale,t.originPoint)}const IR=.999999999999,OR=1.0000000000001;function IB(i,e,t,n=!1){const s=t.length;if(!s)return;e.x=e.y=1;let r,o;for(let l=0;l<s;l++){r=t[l],o=r.projectionDelta;const{visualElement:u}=r.options;u&&u.props.style&&u.props.style.display==="contents"||(n&&r.options.layoutScroll&&r.scroll&&r!==r.root&&pm(i,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,aO(i,o)),n&&$f(r.latestValues)&&pm(i,r.latestValues))}e.x<OR&&e.x>IR&&(e.x=1),e.y<OR&&e.y>IR&&(e.y=1)}function dm(i,e){i.min=i.min+e,i.max=i.max+e}function PR(i,e,t,n,s=.5){const r=Yi(i.min,i.max,s);ew(i,e,t,r,n)}function pm(i,e){PR(i.x,e.x,e.scaleX,e.scale,e.originX),PR(i.y,e.y,e.scaleY,e.scale,e.originY)}function oO(i,e){return sO(NB(i.getBoundingClientRect(),e))}function OB(i,e,t){const n=oO(i,t),{scroll:s}=e;return s&&(dm(n.x,s.offset.x),dm(n.y,s.offset.y)),n}const UR=()=>({translate:0,scale:1,origin:0,originPoint:0}),mm=()=>({x:UR(),y:UR()}),LR=()=>({min:0,max:0}),ks=()=>({x:LR(),y:LR()}),tw={current:null},lO={current:!1};function PB(){if(lO.current=!0,!!Xw)if(window.matchMedia){const i=window.matchMedia("(prefers-reduced-motion)"),e=()=>tw.current=i.matches;i.addEventListener("change",e),e()}else tw.current=!1}const UB=new WeakMap;function LB(i,e,t){for(const n in e){const s=e[n],r=t[n];if(Or(s))i.addValue(n,s);else if(Or(r))i.addValue(n,Am(s,{owner:i}));else if(r!==s)if(i.hasValue(n)){const o=i.getValue(n);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=i.getStaticValue(n);i.addValue(n,Am(o!==void 0?o:s,{owner:i}))}}for(const n in t)e[n]===void 0&&i.removeValue(n);return e}const FR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class FB{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:r,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=cA,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=Va.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,ki.render(this.render,!1,!0))};const{latestValues:u,renderState:f}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=f,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!r,this.isControllingVariants=A1(t),this.isVariantNode=XI(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...g}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in g){const x=g[v];u[v]!==void 0&&Or(x)&&x.set(u[v])}}mount(e){this.current=e,UB.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),lO.current||PB(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:tw.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Bh(this.notifyUpdate),Bh(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=Wm.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&ki.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let r;window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{s(),r&&r(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Em){const t=Em[e];if(!t)continue;const{isEnabled:n,Feature:s}=t;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ks()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<FR.length;n++){const s=FR[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const r="on"+s,o=e[r];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=LB(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=Am(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&($N(n)||tI(n))?n=parseFloat(n):!j4(n)&&zh.test(t)&&(n=FI(e,t)),this.setBaseTarget(e,Or(n)?n.get():n)),Or(n)?n.get():n}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if(typeof t=="string"||typeof t=="object"){const r=xA(this.props,t,this.presenceContext?.custom);r&&(n=r[e])}if(t&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Or(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Jw),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){fA.render(this.render)}}class cO extends FB{constructor(){super(...arguments),this.KeyframeResolver=O4}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Or(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function uO(i,{style:e,vars:t},n,s){const r=i.style;let o;for(o in e)r[o]=e[o];s?.applyProjectionStyles(r,n);for(o in t)r.setProperty(o,t[o])}function kB(i){return window.getComputedStyle(i)}class BB extends cO{constructor(){super(...arguments),this.type="html",this.renderInstance=uO}readValueFromInstance(e,t){if(Wm.has(t))return this.projection?.isProjecting?jT(t):Jk(e,t);{const n=kB(e),s=(mI(t)?n.getPropertyValue(t):n[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return oO(e,t)}build(e,t,n){vA(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return bA(e,t,n)}}const hO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function zB(i,e,t,n){uO(i,e,void 0,n);for(const s in e.attrs)i.setAttribute(hO.has(s)?s:SA(s),e.attrs[s])}class VB extends cO{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ks}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Wm.has(t)){const n=LI(t);return n&&n.default||0}return t=hO.has(t)?t:SA(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return eO(e,t,n)}build(e,t,n){KI(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,s){zB(e,t,n,s)}mount(e){this.isSVGTag=JI(e.tagName),super.mount(e)}}const GB=(i,e)=>_A(i)?new VB(e):new BB(e,{allowProjection:i!==_e.Fragment});function Sm(i,e,t){const n=i.getProps();return xA(n,e,t!==void 0?t:n.custom,i)}const nw=i=>Array.isArray(i);function HB(i,e,t){i.hasValue(e)?i.getValue(e).set(t):i.addValue(e,Am(t))}function WB(i){return nw(i)?i[i.length-1]||0:i}function jB(i,e){const t=Sm(i,e);let{transitionEnd:n={},transition:s={},...r}=t||{};r={...r,...n};for(const o in r){const l=WB(r[o]);HB(i,o,l)}}function qB(i){return!!(Or(i)&&i.add)}function iw(i,e){const t=i.getValue("willChange");if(qB(t))return t.add(e);if(!t&&Au.WillChange){const n=new Au.WillChange("auto");i.addValue("willChange",n),n.add(e)}}function fO(i){return i.props[tO]}const XB=i=>i!==null;function YB(i,{repeat:e,repeatType:t="loop"},n){const s=i.filter(XB),r=e&&t!=="loop"&&e%2===1?0:s.length-1;return s[r]}const ZB={type:"spring",stiffness:500,damping:25,restSpeed:10},KB=i=>({type:"spring",stiffness:550,damping:i===0?2*Math.sqrt(550):30,restSpeed:10}),QB={type:"keyframes",duration:.8},JB={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},$B=(i,{keyframes:e})=>e.length>2?QB:Wm.has(i)?i.startsWith("scale")?KB(e[1]):ZB:JB;function ez({when:i,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:s,repeat:r,repeatType:o,repeatDelay:l,from:u,elapsed:f,...p}){return!!Object.keys(p).length}const MA=(i,e,t,n={},s,r)=>o=>{const l=uA(n,i)||{},u=l.delay||n.delay||0;let{elapsed:f=0}=n;f=f-_c(u);const p={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-f,onUpdate:v=>{e.set(v),l.onUpdate&&l.onUpdate(v)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:i,motionValue:e,element:r?void 0:s};ez(l)||Object.assign(p,$B(i,p)),p.duration&&(p.duration=_c(p.duration)),p.repeatDelay&&(p.repeatDelay=_c(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let g=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(KT(p),p.delay===0&&(g=!0)),(Au.instantAnimations||Au.skipAnimations)&&(g=!0,KT(p),p.delay=0),p.allowFlatten=!l.type&&!l.ease,g&&!r&&e.get()!==void 0){const v=YB(p.keyframes,l);if(v!==void 0){ki.update(()=>{p.onUpdate(v),p.onComplete()});return}}return l.isSync?new lA(p):new b4(p)};function tz({protectedKeys:i,needsAnimating:e},t){const n=i.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function dO(i,e,{delay:t=0,transitionOverride:n,type:s}={}){let{transition:r=i.getDefaultTransition(),transitionEnd:o,...l}=e;n&&(r=n);const u=[],f=s&&i.animationState&&i.animationState.getState()[s];for(const p in l){const g=i.getValue(p,i.latestValues[p]??null),v=l[p];if(v===void 0||f&&tz(f,p))continue;const x={delay:t,...uA(r||{},p)},b=g.get();if(b!==void 0&&!g.isAnimating&&!Array.isArray(v)&&v===b&&!x.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const S=fO(i);if(S){const C=window.MotionHandoffAnimation(S,p,ki);C!==null&&(x.startTime=C,w=!0)}}iw(i,p),g.start(MA(p,g,v,i.shouldReduceMotion&&OI.has(p)?{type:!1}:x,i,w));const M=g.animation;M&&u.push(M)}return o&&Promise.all(u).then(()=>{ki.update(()=>{o&&jB(i,o)})}),u}function pO(i,e,t,n=0,s=1){const r=Array.from(i).sort((f,p)=>f.sortNodePosition(p)).indexOf(e),o=i.size,l=(o-1)*n;return typeof t=="function"?t(r,o):s===1?r*n:l-r*n}function sw(i,e,t={}){const n=Sm(i,e,t.type==="exit"?i.presenceContext?.custom:void 0);let{transition:s=i.getDefaultTransition()||{}}=n||{};t.transitionOverride&&(s=t.transitionOverride);const r=n?()=>Promise.all(dO(i,n,t)):()=>Promise.resolve(),o=i.variantChildren&&i.variantChildren.size?(u=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:g}=s;return nz(i,e,u,f,p,g,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,f]=l==="beforeChildren"?[r,o]:[o,r];return u().then(()=>f())}else return Promise.all([r(),o(t.delay)])}function nz(i,e,t=0,n=0,s=0,r=1,o){const l=[];for(const u of i.variantChildren)u.notify("AnimationStart",e),l.push(sw(u,e,{...o,delay:t+(typeof n=="function"?0:n)+pO(i.variantChildren,u,n,s,r)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(l)}function iz(i,e,t={}){i.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(r=>sw(i,r,t));n=Promise.all(s)}else if(typeof e=="string")n=sw(i,e,t);else{const s=typeof e=="function"?Sm(i,e,t.custom):e;n=Promise.all(dO(i,s,t))}return n.then(()=>{i.notify("AnimationComplete",e)})}function mO(i,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==i.length)return!1;for(let n=0;n<t;n++)if(e[n]!==i[n])return!1;return!0}const sz=gA.length;function gO(i){if(!i)return;if(!i.isControllingVariants){const t=i.parent?gO(i.parent)||{}:{};return i.props.initial!==void 0&&(t.initial=i.props.initial),t}const e={};for(let t=0;t<sz;t++){const n=gA[t],s=i.props[n];(fv(s)||s===!1)&&(e[n]=s)}return e}const rz=[...mA].reverse(),az=mA.length;function oz(i){return e=>Promise.all(e.map(({animation:t,options:n})=>iz(i,t,n)))}function lz(i){let e=oz(i),t=kR(),n=!0;const s=u=>(f,p)=>{const g=Sm(i,p,u==="exit"?i.presenceContext?.custom:void 0);if(g){const{transition:v,transitionEnd:x,...b}=g;f={...f,...b,...x}}return f};function r(u){e=u(i)}function o(u){const{props:f}=i,p=gO(i.parent)||{},g=[],v=new Set;let x={},b=1/0;for(let M=0;M<az;M++){const S=rz[M],C=t[S],R=f[S]!==void 0?f[S]:p[S],I=fv(R),D=S===u?C.isActive:null;D===!1&&(b=M);let O=R===p[S]&&R!==f[S]&&I;if(O&&n&&i.manuallyAnimateOnMount&&(O=!1),C.protectedKeys={...x},!C.isActive&&D===null||!R&&!C.prevProp||w1(R)||typeof R=="boolean")continue;const U=cz(C.prevProp,R);let k=U||S===u&&C.isActive&&!O&&I||M>b&&I,P=!1;const F=Array.isArray(R)?R:[R];let H=F.reduce(s(S),{});D===!1&&(H={});const{prevResolvedValues:G={}}=C,j={...G,...H},K=X=>{k=!0,v.has(X)&&(P=!0,v.delete(X)),C.needsAnimating[X]=!0;const oe=i.getValue(X);oe&&(oe.liveStyle=!1)};for(const X in j){const oe=H[X],ne=G[X];if(x.hasOwnProperty(X))continue;let ie=!1;nw(oe)&&nw(ne)?ie=!mO(oe,ne):ie=oe!==ne,ie?oe!=null?K(X):v.add(X):oe!==void 0&&v.has(X)?K(X):C.protectedKeys[X]=!0}C.prevProp=R,C.prevResolvedValues=H,C.isActive&&(x={...x,...H}),n&&i.blockInitialAnimation&&(k=!1);const te=O&&U;k&&(!te||P)&&g.push(...F.map(X=>{const oe={type:S};if(typeof X=="string"&&n&&!te&&i.manuallyAnimateOnMount&&i.parent){const{parent:ne}=i,ie=Sm(ne,X);if(ne.enteringChildren&&ie){const{delayChildren:B}=ie.transition||{};oe.delay=pO(ne.enteringChildren,i,B)}}return{animation:X,options:oe}}))}if(v.size){const M={};if(typeof f.initial!="boolean"){const S=Sm(i,Array.isArray(f.initial)?f.initial[0]:f.initial);S&&S.transition&&(M.transition=S.transition)}v.forEach(S=>{const C=i.getBaseTarget(S),R=i.getValue(S);R&&(R.liveStyle=!0),M[S]=C??null}),g.push({animation:M})}let w=!!g.length;return n&&(f.initial===!1||f.initial===f.animate)&&!i.manuallyAnimateOnMount&&(w=!1),n=!1,w?e(g):Promise.resolve()}function l(u,f){if(t[u].isActive===f)return Promise.resolve();i.variantChildren?.forEach(g=>g.animationState?.setActive(u,f)),t[u].isActive=f;const p=o(u);for(const g in t)t[g].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:r,getState:()=>t,reset:()=>{t=kR()}}}function cz(i,e){return typeof e=="string"?e!==i:Array.isArray(e)?!mO(e,i):!1}function Lf(i=!1){return{isActive:i,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function kR(){return{animate:Lf(!0),whileInView:Lf(),whileHover:Lf(),whileTap:Lf(),whileDrag:Lf(),whileFocus:Lf(),exit:Lf()}}class Xh{constructor(e){this.isMounted=!1,this.node=e}update(){}}class uz extends Xh{constructor(e){super(e),e.animationState||(e.animationState=lz(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();w1(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let hz=0;class fz extends Xh{constructor(){super(...arguments),this.id=hz++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);t&&!e&&s.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const dz={animation:{Feature:uz},exit:{Feature:fz}};function dv(i,e,t,n={passive:!0}){return i.addEventListener(e,t,n),()=>i.removeEventListener(e,t)}function zv(i){return{point:{x:i.pageX,y:i.pageY}}}const pz=i=>e=>dA(e)&&i(e,zv(e));function Y0(i,e,t,n){return dv(i,e,pz(t),n)}const vO=1e-4,mz=1-vO,gz=1+vO,yO=.01,vz=0-yO,yz=0+yO;function oa(i){return i.max-i.min}function _z(i,e,t){return Math.abs(i-e)<=t}function BR(i,e,t,n=.5){i.origin=n,i.originPoint=Yi(e.min,e.max,i.origin),i.scale=oa(t)/oa(e),i.translate=Yi(t.min,t.max,i.origin)-i.originPoint,(i.scale>=mz&&i.scale<=gz||isNaN(i.scale))&&(i.scale=1),(i.translate>=vz&&i.translate<=yz||isNaN(i.translate))&&(i.translate=0)}function Z0(i,e,t,n){BR(i.x,e.x,t.x,n?n.originX:void 0),BR(i.y,e.y,t.y,n?n.originY:void 0)}function zR(i,e,t){i.min=t.min+e.min,i.max=i.min+oa(e)}function xz(i,e,t){zR(i.x,e.x,t.x),zR(i.y,e.y,t.y)}function VR(i,e,t){i.min=e.min-t.min,i.max=i.min+oa(e)}function lb(i,e,t){VR(i.x,e.x,t.x),VR(i.y,e.y,t.y)}function Ho(i){return[i("x"),i("y")]}const _O=({current:i})=>i?i.ownerDocument.defaultView:null,GR=(i,e)=>Math.abs(i-e);function bz(i,e){const t=GR(i.x,e.x),n=GR(i.y,e.y);return Math.sqrt(t**2+n**2)}class xO{constructor(e,t,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:r=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=EM(this.lastMoveEventInfo,this.history),x=this.startEvent!==null,b=bz(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!x&&!b)return;const{point:w}=v,{timestamp:M}=mr;this.history.push({...w,timestamp:M});const{onStart:S,onMove:C}=this.handlers;x||(S&&S(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,v)},this.handlePointerMove=(v,x)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=AM(x,this.transformPagePoint),ki.update(this.updatePoint,!0)},this.handlePointerUp=(v,x)=>{this.end();const{onEnd:b,onSessionEnd:w,resumeAnimation:M}=this.handlers;if(this.dragSnapToOrigin&&M&&M(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=EM(v.type==="pointercancel"?this.lastMoveEventInfo:AM(x,this.transformPagePoint),this.history);this.startEvent&&b&&b(v,S),w&&w(v,S)},!dA(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=o,this.contextWindow=s||window;const l=zv(e),u=AM(l,this.transformPagePoint),{point:f}=u,{timestamp:p}=mr;this.history=[{...f,timestamp:p}];const{onSessionStart:g}=t;g&&g(e,EM(u,this.history)),this.removeListeners=Fv(Y0(this.contextWindow,"pointermove",this.handlePointerMove),Y0(this.contextWindow,"pointerup",this.handlePointerUp),Y0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Bh(this.updatePoint)}}function AM(i,e){return e?{point:e(i.point)}:i}function HR(i,e){return{x:i.x-e.x,y:i.y-e.y}}function EM({point:i},e){return{point:i,delta:HR(i,bO(e)),offset:HR(i,Sz(e)),velocity:Mz(e,.1)}}function Sz(i){return i[0]}function bO(i){return i[i.length-1]}function Mz(i,e){if(i.length<2)return{x:0,y:0};let t=i.length-1,n=null;const s=bO(i);for(;t>=0&&(n=i[t],!(s.timestamp-n.timestamp>_c(e)));)t--;if(!n)return{x:0,y:0};const r=Wo(s.timestamp-n.timestamp);if(r===0)return{x:0,y:0};const o={x:(s.x-n.x)/r,y:(s.y-n.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Tz(i,{min:e,max:t},n){return e!==void 0&&i<e?i=n?Yi(e,i,n.min):Math.max(i,e):t!==void 0&&i>t&&(i=n?Yi(t,i,n.max):Math.min(i,t)),i}function WR(i,e,t){return{min:e!==void 0?i.min+e:void 0,max:t!==void 0?i.max+t-(i.max-i.min):void 0}}function wz(i,{top:e,left:t,bottom:n,right:s}){return{x:WR(i.x,t,s),y:WR(i.y,e,n)}}function jR(i,e){let t=e.min-i.min,n=e.max-i.max;return e.max-e.min<i.max-i.min&&([t,n]=[n,t]),{min:t,max:n}}function Az(i,e){return{x:jR(i.x,e.x),y:jR(i.y,e.y)}}function Ez(i,e){let t=.5;const n=oa(i),s=oa(e);return s>n?t=cv(e.min,e.max-n,i.min):n>s&&(t=cv(i.min,i.max-s,e.min)),wu(0,1,t)}function Cz(i,e){const t={};return e.min!==void 0&&(t.min=e.min-i.min),e.max!==void 0&&(t.max=e.max-i.min),t}const rw=.35;function Rz(i=rw){return i===!1?i=0:i===!0&&(i=rw),{x:qR(i,"left","right"),y:qR(i,"top","bottom")}}function qR(i,e,t){return{min:XR(i,e),max:XR(i,t)}}function XR(i,e){return typeof i=="number"?i:i[e]||0}const Dz=new WeakMap;class Nz{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ks(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=g=>{const{dragSnapToOrigin:v}=this.getProps();v?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(zv(g).point)},o=(g,v)=>{const{drag:x,dragPropagation:b,onDragStart:w}=this.getProps();if(x&&!b&&(this.openDragLock&&this.openDragLock(),this.openDragLock=F4(x),!this.openDragLock))return;this.latestPointerEvent=g,this.latestPanInfo=v,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ho(S=>{let C=this.getAxisMotionValue(S).get()||0;if(xc.test(C)){const{projection:R}=this.visualElement;if(R&&R.layout){const I=R.layout.layoutBox[S];I&&(C=oa(I)*(parseFloat(C)/100))}}this.originPoint[S]=C}),w&&ki.postRender(()=>w(g,v)),iw(this.visualElement,"transform");const{animationState:M}=this.visualElement;M&&M.setActive("whileDrag",!0)},l=(g,v)=>{this.latestPointerEvent=g,this.latestPanInfo=v;const{dragPropagation:x,dragDirectionLock:b,onDirectionLock:w,onDrag:M}=this.getProps();if(!x&&!this.openDragLock)return;const{offset:S}=v;if(b&&this.currentDirection===null){this.currentDirection=Iz(S),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",v.point,S),this.updateAxis("y",v.point,S),this.visualElement.render(),M&&M(g,v)},u=(g,v)=>{this.latestPointerEvent=g,this.latestPanInfo=v,this.stop(g,v),this.latestPointerEvent=null,this.latestPanInfo=null},f=()=>Ho(g=>this.getAnimationState(g)==="paused"&&this.getAxisMotionValue(g).animation?.play()),{dragSnapToOrigin:p}=this.getProps();this.panSession=new xO(e,{onSessionStart:r,onStart:o,onMove:l,onSessionEnd:u,resumeAnimation:f},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:n,contextWindow:_O(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,s=t||this.latestPanInfo,r=this.isDragging;if(this.cancel(),!r||!s||!n)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&ki.postRender(()=>l(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:s}=this.getProps();if(!n||!W_(e,s,this.currentDirection))return;const r=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=Tz(o,this.constraints[e],this.elastic[e])),r.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;e&&fm(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=wz(n.layoutBox,e):this.constraints=!1,this.elastic=Rz(t),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Ho(r=>{this.constraints!==!1&&this.getAxisMotionValue(r)&&(this.constraints[r]=Cz(n.layoutBox[r],this.constraints[r]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!fm(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const r=OB(n,s.root,this.visualElement.getTransformPagePoint());let o=Az(s.layout.layoutBox,r);if(t){const l=t(DB(o));this.hasMutatedConstraints=!!l,l&&(o=sO(l))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:s,dragTransition:r,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},f=Ho(p=>{if(!W_(p,t,this.currentDirection))return;let g=u&&u[p]||{};o&&(g={min:0,max:0});const v=s?200:1e6,x=s?40:1e7,b={type:"inertia",velocity:n?e[p]:0,bounceStiffness:v,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...r,...g};return this.startAxisValueAnimation(p,b)});return Promise.all(f).then(l)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return iw(this.visualElement,e),n.start(MA(e,n,0,t,this.visualElement,!1))}stopAnimation(){Ho(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ho(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[t];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Ho(t=>{const{drag:n}=this.getProps();if(!W_(t,n,this.currentDirection))return;const{projection:s}=this.visualElement,r=this.getAxisMotionValue(t);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[t];r.set(e[t]-Yi(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!fm(t)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ho(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();s[o]=Ez({min:u,max:u},this.constraints[o])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Ho(o=>{if(!W_(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:f}=this.constraints[o];l.set(Yi(u,f,s[o]))})}addListeners(){if(!this.visualElement.current)return;Dz.set(this.visualElement,this);const e=this.visualElement.current,t=Y0(e,"pointerdown",u=>{const{drag:f,dragListener:p=!0}=this.getProps();f&&p&&this.start(u)}),n=()=>{const{dragConstraints:u}=this.getProps();fm(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,r=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ki.read(n);const o=dv(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:f})=>{this.isDragging&&f&&(Ho(p=>{const g=this.getAxisMotionValue(p);g&&(this.originPoint[p]+=u[p].translate,g.set(g.get()+u[p].translate))}),this.visualElement.render())}));return()=>{o(),t(),r(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:r=!1,dragElastic:o=rw,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:s,dragConstraints:r,dragElastic:o,dragMomentum:l}}}function W_(i,e,t){return(e===!0||e===i)&&(t===null||t===i)}function Iz(i,e=10){let t=null;return Math.abs(i.y)>e?t="y":Math.abs(i.x)>e&&(t="x"),t}class Oz extends Xh{constructor(e){super(e),this.removeGroupControls=qo,this.removeListeners=qo,this.controls=new Nz(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||qo}unmount(){this.removeGroupControls(),this.removeListeners()}}const YR=i=>(e,t)=>{i&&ki.postRender(()=>i(e,t))};class Pz extends Xh{constructor(){super(...arguments),this.removePointerDownListener=qo}onPointerDown(e){this.session=new xO(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:_O(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:YR(e),onStart:YR(t),onMove:n,onEnd:(r,o)=>{delete this.session,s&&ki.postRender(()=>s(r,o))}}}mount(){this.removePointerDownListener=Y0(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Yx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let CM=!1;class Uz extends _e.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:s}=this.props,{projection:r}=e;r&&(t.group&&t.group.add(r),n&&n.register&&s&&n.register(r),CM&&r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),Yx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:s,isPresent:r}=this.props,{projection:o}=n;return o&&(o.isPresent=r,CM=!0,s||e.layoutDependency!==t||t===void 0||e.isPresent!==r?o.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?o.promote():o.relegate()||ki.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),fA.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:s}=e;CM=!0,s&&(s.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function SO(i){const[e,t]=WI(),n=_e.useContext(jw);return ee.jsx(Uz,{...i,layoutGroup:n,switchLayoutGroup:_e.useContext(nO),isPresent:e,safeToRemove:t})}function Lz(i,e,t){const n=Or(i)?i:Am(i);return n.start(MA("",n,e,t)),n.animation}const Fz=(i,e)=>i.depth-e.depth;class kz{constructor(){this.children=[],this.isDirty=!1}add(e){Yw(this.children,e),this.isDirty=!0}remove(e){Zw(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Fz),this.isDirty=!1,this.children.forEach(e)}}function Bz(i,e){const t=Va.now(),n=({timestamp:s})=>{const r=s-t;r>=e&&(Bh(n),i(r-e))};return ki.setup(n,!0),()=>Bh(n)}const MO=["TopLeft","TopRight","BottomLeft","BottomRight"],zz=MO.length,ZR=i=>typeof i=="string"?parseFloat(i):i,KR=i=>typeof i=="number"||$t.test(i);function Vz(i,e,t,n,s,r){s?(i.opacity=Yi(0,t.opacity??1,Gz(n)),i.opacityExit=Yi(e.opacity??1,0,Hz(n))):r&&(i.opacity=Yi(e.opacity??1,t.opacity??1,n));for(let o=0;o<zz;o++){const l=`border${MO[o]}Radius`;let u=QR(e,l),f=QR(t,l);if(u===void 0&&f===void 0)continue;u||(u=0),f||(f=0),u===0||f===0||KR(u)===KR(f)?(i[l]=Math.max(Yi(ZR(u),ZR(f),n),0),(xc.test(f)||xc.test(u))&&(i[l]+="%")):i[l]=f}(e.rotate||t.rotate)&&(i.rotate=Yi(e.rotate||0,t.rotate||0,n))}function QR(i,e){return i[e]!==void 0?i[e]:i.borderRadius}const Gz=TO(0,.5,cI),Hz=TO(.5,.95,qo);function TO(i,e,t){return n=>n<i?0:n>e?1:t(cv(i,e,n))}function JR(i,e){i.min=e.min,i.max=e.max}function gl(i,e){JR(i.x,e.x),JR(i.y,e.y)}function $R(i,e){i.translate=e.translate,i.scale=e.scale,i.originPoint=e.originPoint,i.origin=e.origin}function e3(i,e,t,n,s){return i-=e,i=ob(i,1/t,n),s!==void 0&&(i=ob(i,1/s,n)),i}function Wz(i,e=0,t=1,n=.5,s,r=i,o=i){if(xc.test(e)&&(e=parseFloat(e),e=Yi(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Yi(r.min,r.max,n);i===r&&(l-=e),i.min=e3(i.min,e,t,l,s),i.max=e3(i.max,e,t,l,s)}function t3(i,e,[t,n,s],r,o){Wz(i,e[t],e[n],e[s],e.scale,r,o)}const jz=["x","scaleX","originX"],qz=["y","scaleY","originY"];function n3(i,e,t,n){t3(i.x,e,jz,t?t.x:void 0,n?n.x:void 0),t3(i.y,e,qz,t?t.y:void 0,n?n.y:void 0)}function i3(i){return i.translate===0&&i.scale===1}function wO(i){return i3(i.x)&&i3(i.y)}function s3(i,e){return i.min===e.min&&i.max===e.max}function Xz(i,e){return s3(i.x,e.x)&&s3(i.y,e.y)}function r3(i,e){return Math.round(i.min)===Math.round(e.min)&&Math.round(i.max)===Math.round(e.max)}function AO(i,e){return r3(i.x,e.x)&&r3(i.y,e.y)}function a3(i){return oa(i.x)/oa(i.y)}function o3(i,e){return i.translate===e.translate&&i.scale===e.scale&&i.originPoint===e.originPoint}class Yz{constructor(){this.members=[]}add(e){Yw(this.members,e),e.scheduleRender()}remove(e){if(Zw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(s=>e===s);if(t===0)return!1;let n;for(let s=t;s>=0;s--){const r=this.members[s];if(r.isPresent!==!1){n=r;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Zz(i,e,t){let n="";const s=i.x.translate/e.x,r=i.y.translate/e.y,o=t?.z||0;if((s||r||o)&&(n=`translate3d(${s}px, ${r}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:f,rotate:p,rotateX:g,rotateY:v,skewX:x,skewY:b}=t;f&&(n=`perspective(${f}px) ${n}`),p&&(n+=`rotate(${p}deg) `),g&&(n+=`rotateX(${g}deg) `),v&&(n+=`rotateY(${v}deg) `),x&&(n+=`skewX(${x}deg) `),b&&(n+=`skewY(${b}deg) `)}const l=i.x.scale*e.x,u=i.y.scale*e.y;return(l!==1||u!==1)&&(n+=`scale(${l}, ${u})`),n||"none"}const RM=["","X","Y","Z"],Kz=1e3;let Qz=0;function DM(i,e,t,n){const{latestValues:s}=e;s[i]&&(t[i]=s[i],e.setStaticValue(i,0),n&&(n[i]=0))}function EO(i){if(i.hasCheckedOptimisedAppear=!0,i.root===i)return;const{visualElement:e}=i.options;if(!e)return;const t=fO(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:s,layoutId:r}=i.options;window.MotionCancelOptimisedAnimation(t,"transform",ki,!(s||r))}const{parent:n}=i;n&&!n.hasCheckedOptimisedAppear&&EO(n)}function CO({attachResizeListener:i,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},l=e?.()){this.id=Qz++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(eV),this.nodes.forEach(sV),this.nodes.forEach(rV),this.nodes.forEach(tV)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new kz)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Jw),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=HI(o)&&!H4(o),this.instance=o;const{layoutId:l,layout:u,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||l)&&(this.isLayoutDirty=!0),i){let p,g=0;const v=()=>this.root.updateBlockedByResize=!1;ki.read(()=>{g=window.innerWidth}),i(o,()=>{const x=window.innerWidth;x!==g&&(g=x,this.root.updateBlockedByResize=!0,p&&p(),p=Bz(v,250),Yx.hasAnimatedSinceResize&&(Yx.hasAnimatedSinceResize=!1,this.nodes.forEach(u3)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&f&&(l||u)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:g,hasRelativeLayoutChanged:v,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||f.getDefaultTransition()||uV,{onLayoutAnimationStart:w,onLayoutAnimationComplete:M}=f.getProps(),S=!this.targetLayout||!AO(this.targetLayout,x),C=!g&&v;if(this.options.layoutRoot||this.resumeFrom||C||g&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...uA(b,"layout"),onPlay:w,onComplete:M};(f.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(p,C)}else g||u3(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Bh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(aV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&EO(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const g=this.path[p];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const f=this.getTransformTemplate();this.prevTransformTemplateValue=f?f(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(l3);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(c3);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(iV),this.nodes.forEach(Jz),this.nodes.forEach($z)):this.nodes.forEach(c3),this.clearAllSnapshots();const l=Va.now();mr.delta=wu(0,1e3/60,l-mr.timestamp),mr.timestamp=l,mr.isProcessing=!0,yM.update.process(mr),yM.preRender.process(mr),yM.render.process(mr),mr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,fA.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(nV),this.sharedNodes.forEach(oV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ki.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ki.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!oa(this.snapshot.measuredBox.x)&&!oa(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=ks(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const u=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!wO(this.projectionDelta),u=this.getTransformTemplate(),f=u?u(this.latestValues,""):void 0,p=f!==this.prevTransformTemplateValue;o&&this.instance&&(l||$f(this.latestValues)||p)&&(s(this.instance,f),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),hV(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return ks();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(fV))){const{scroll:f}=this.root;f&&(dm(l.x,f.offset.x),dm(l.y,f.offset.y))}return l}removeElementScroll(o){const l=ks();if(gl(l,o),this.scroll?.wasRoot)return l;for(let u=0;u<this.path.length;u++){const f=this.path[u],{scroll:p,options:g}=f;f!==this.root&&p&&g.layoutScroll&&(p.wasRoot&&gl(l,o),dm(l.x,p.offset.x),dm(l.y,p.offset.y))}return l}applyTransform(o,l=!1){const u=ks();gl(u,o);for(let f=0;f<this.path.length;f++){const p=this.path[f];!l&&p.options.layoutScroll&&p.scroll&&p!==p.root&&pm(u,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),$f(p.latestValues)&&pm(u,p.latestValues)}return $f(this.latestValues)&&pm(u,this.latestValues),u}removeTransform(o){const l=ks();gl(l,o);for(let u=0;u<this.path.length;u++){const f=this.path[u];if(!f.instance||!$f(f.latestValues))continue;$T(f.latestValues)&&f.updateSnapshot();const p=ks(),g=f.measurePageBox();gl(p,g),n3(l,f.latestValues,f.snapshot?f.snapshot.layoutBox:void 0,p)}return $f(this.latestValues)&&n3(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==mr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:g}=this.options;if(!this.layout||!(p||g))return;this.resolvedRelativeTargetAt=mr.timestamp;const v=this.getClosestProjectingParent();v&&this.linkedParentVersion!==v.layoutVersion&&!v.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(v&&v.layout?this.createRelativeTarget(v,this.layout.layoutBox,v.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ks(),this.targetWithTransforms=ks()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),xz(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gl(this.target,this.layout.layoutBox),aO(this.target,this.targetDelta)):gl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?this.createRelativeTarget(v,this.target,v.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||$T(this.parent.latestValues)||rO(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,l,u){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ks(),this.relativeTargetOrigin=ks(),lb(this.relativeTargetOrigin,l,u),gl(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===mr.timestamp&&(u=!1),u)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;gl(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,v=this.treeScale.y;IB(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=ks());const{target:x}=o;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():($R(this.prevProjectionDelta.x,this.projectionDelta.x),$R(this.prevProjectionDelta.y,this.projectionDelta.y)),Z0(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==v||!o3(this.projectionDelta.x,this.prevProjectionDelta.x)||!o3(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mm(),this.projectionDelta=mm(),this.projectionDeltaWithTransform=mm()}setAnimationOrigin(o,l=!1){const u=this.snapshot,f=u?u.latestValues:{},p={...this.latestValues},g=mm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const v=ks(),x=u?u.source:void 0,b=this.layout?this.layout.source:void 0,w=x!==b,M=this.getStack(),S=!M||M.members.length<=1,C=!!(w&&!S&&this.options.crossfade===!0&&!this.path.some(cV));this.animationProgress=0;let R;this.mixTargetDelta=I=>{const D=I/1e3;h3(g.x,o.x,D),h3(g.y,o.y,D),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(lb(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),lV(this.relativeTarget,this.relativeTargetOrigin,v,D),R&&Xz(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=ks()),gl(R,this.relativeTarget)),w&&(this.animationValues=p,Vz(p,f,this.latestValues,D,C,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Bh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ki.update(()=>{Yx.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Am(0)),this.currentAnimation=Lz(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Kz),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:f,latestValues:p}=o;if(!(!l||!u||!f)){if(this!==o&&this.layout&&f&&RO(this.options.animationType,this.layout.layoutBox,f.layoutBox)){u=this.target||ks();const g=oa(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+g;const v=oa(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+v}gl(l,u),pm(l,p),Z0(this.projectionDeltaWithTransform,this.layoutCorrected,l,p)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Yz),this.sharedNodes.get(o).add(l);const f=l.options.initialPromotionConfig;l.promote({transition:f?f.transition:void 0,preserveFollowOpacity:f&&f.shouldPreserveFollowOpacity?f.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const f=this.getStack();f&&f.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const f={};u.z&&DM("z",o,f,this.animationValues);for(let p=0;p<RM.length;p++)DM(`rotate${RM[p]}`,o,f,this.animationValues),DM(`skew${RM[p]}`,o,f,this.animationValues);o.render();for(const p in f)o.setStaticValue(p,f[p]),this.animationValues&&(this.animationValues[p]=f[p]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Xx(l?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Xx(l?.pointerEvents)||""),this.hasProjected&&!$f(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const p=f.animationValues||f.latestValues;this.applyTransformsToTarget();let g=Zz(this.projectionDeltaWithTransform,this.treeScale,p);u&&(g=u(p,g)),o.transform=g;const{x:v,y:x}=this.projectionDelta;o.transformOrigin=`${v.origin*100}% ${x.origin*100}% 0`,f.animationValues?o.opacity=f===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:o.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const b in JT){if(p[b]===void 0)continue;const{correct:w,applyTo:M,isCSSVariable:S}=JT[b],C=g==="none"?p[b]:w(p[b],f);if(M){const R=M.length;for(let I=0;I<R;I++)o[M[I]]=C}else S?this.options.visualElement.renderState.vars[b]=C:o[b]=C}this.options.layoutId&&(o.pointerEvents=f===this?Xx(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(l3),this.root.sharedNodes.clear()}}}function Jz(i){i.updateLayout()}function $z(i){const e=i.resumeFrom?.snapshot||i.snapshot;if(i.isLead()&&i.layout&&e&&i.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:n}=i.layout,{animationType:s}=i.options,r=e.source!==i.layout.source;s==="size"?Ho(p=>{const g=r?e.measuredBox[p]:e.layoutBox[p],v=oa(g);g.min=t[p].min,g.max=g.min+v}):RO(s,e.layoutBox,t)&&Ho(p=>{const g=r?e.measuredBox[p]:e.layoutBox[p],v=oa(t[p]);g.max=g.min+v,i.relativeTarget&&!i.currentAnimation&&(i.isProjectionDirty=!0,i.relativeTarget[p].max=i.relativeTarget[p].min+v)});const o=mm();Z0(o,t,e.layoutBox);const l=mm();r?Z0(l,i.applyTransform(n,!0),e.measuredBox):Z0(l,t,e.layoutBox);const u=!wO(o);let f=!1;if(!i.resumeFrom){const p=i.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:g,layout:v}=p;if(g&&v){const x=ks();lb(x,e.layoutBox,g.layoutBox);const b=ks();lb(b,t,v.layoutBox),AO(x,b)||(f=!0),p.options.layoutRoot&&(i.relativeTarget=b,i.relativeTargetOrigin=x,i.relativeParent=p)}}}i.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:f})}else if(i.isLead()){const{onExitComplete:t}=i.options;t&&t()}i.options.transition=void 0}function eV(i){i.parent&&(i.isProjecting()||(i.isProjectionDirty=i.parent.isProjectionDirty),i.isSharedProjectionDirty||(i.isSharedProjectionDirty=!!(i.isProjectionDirty||i.parent.isProjectionDirty||i.parent.isSharedProjectionDirty)),i.isTransformDirty||(i.isTransformDirty=i.parent.isTransformDirty))}function tV(i){i.isProjectionDirty=i.isSharedProjectionDirty=i.isTransformDirty=!1}function nV(i){i.clearSnapshot()}function l3(i){i.clearMeasurements()}function c3(i){i.isLayoutDirty=!1}function iV(i){const{visualElement:e}=i.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),i.resetTransform()}function u3(i){i.finishAnimation(),i.targetDelta=i.relativeTarget=i.target=void 0,i.isProjectionDirty=!0}function sV(i){i.resolveTargetDelta()}function rV(i){i.calcProjection()}function aV(i){i.resetSkewAndRotation()}function oV(i){i.removeLeadSnapshot()}function h3(i,e,t){i.translate=Yi(e.translate,0,t),i.scale=Yi(e.scale,1,t),i.origin=e.origin,i.originPoint=e.originPoint}function f3(i,e,t,n){i.min=Yi(e.min,t.min,n),i.max=Yi(e.max,t.max,n)}function lV(i,e,t,n){f3(i.x,e.x,t.x,n),f3(i.y,e.y,t.y,n)}function cV(i){return i.animationValues&&i.animationValues.opacityExit!==void 0}const uV={duration:.45,ease:[.4,0,.1,1]},d3=i=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(i),p3=d3("applewebkit/")&&!d3("chrome/")?Math.round:qo;function m3(i){i.min=p3(i.min),i.max=p3(i.max)}function hV(i){m3(i.x),m3(i.y)}function RO(i,e,t){return i==="position"||i==="preserve-aspect"&&!_z(a3(e),a3(t),.2)}function fV(i){return i!==i.root&&i.scroll?.wasRoot}const dV=CO({attachResizeListener:(i,e)=>dv(i,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),NM={current:void 0},DO=CO({measureScroll:i=>({x:i.scrollLeft,y:i.scrollTop}),defaultParent:()=>{if(!NM.current){const i=new dV({});i.mount(window),i.setOptions({layoutScroll:!0}),NM.current=i}return NM.current},resetTransform:(i,e)=>{i.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:i=>window.getComputedStyle(i).position==="fixed"}),pV={pan:{Feature:Pz},drag:{Feature:Oz,ProjectionNode:DO,MeasureLayout:SO}};function g3(i,e,t){const{props:n}=i;i.animationState&&n.whileHover&&i.animationState.setActive("whileHover",t==="Start");const s="onHover"+t,r=n[s];r&&ki.postRender(()=>r(e,zv(e)))}class mV extends Xh{mount(){const{current:e}=this.node;e&&(this.unmount=k4(e,(t,n)=>(g3(this.node,n,"Start"),s=>g3(this.node,s,"End"))))}unmount(){}}class gV extends Xh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Fv(dv(this.node.current,"focus",()=>this.onFocus()),dv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function v3(i,e,t){const{props:n}=i;if(i.current instanceof HTMLButtonElement&&i.current.disabled)return;i.animationState&&n.whileTap&&i.animationState.setActive("whileTap",t==="Start");const s="onTap"+(t==="End"?"":t),r=n[s];r&&ki.postRender(()=>r(e,zv(e)))}class vV extends Xh{mount(){const{current:e}=this.node;e&&(this.unmount=G4(e,(t,n)=>(v3(this.node,n,"Start"),(s,{success:r})=>v3(this.node,s,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const aw=new WeakMap,IM=new WeakMap,yV=i=>{const e=aw.get(i.target);e&&e(i)},_V=i=>{i.forEach(yV)};function xV({root:i,...e}){const t=i||document;IM.has(t)||IM.set(t,{});const n=IM.get(t),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(_V,{root:i,...e})),n[s]}function bV(i,e,t){const n=xV(e);return aw.set(i,t),n.observe(i),()=>{aw.delete(i),n.unobserve(i)}}const SV={some:0,all:1};class MV extends Xh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:s="some",once:r}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:SV[s]},l=u=>{const{isIntersecting:f}=u;if(this.isInView===f||(this.isInView=f,r&&!f&&this.hasEnteredView))return;f&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",f);const{onViewportEnter:p,onViewportLeave:g}=this.node.getProps(),v=f?p:g;v&&v(u)};return bV(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(TV(e,t))&&this.startObserver()}unmount(){}}function TV({viewport:i={}},{viewport:e={}}={}){return t=>i[t]!==e[t]}const wV={inView:{Feature:MV},tap:{Feature:vV},focus:{Feature:gV},hover:{Feature:mV}},AV={layout:{ProjectionNode:DO,MeasureLayout:SO}},EV={...dz,...wV,...pV,...AV},En=RB(EV,GB);function CV({currentChapter:i,chapters:e,onChapterSelect:t}){return ee.jsx("nav",{className:"navigation",children:ee.jsxs("div",{className:"nav-content",children:[ee.jsx(En.h1,{className:"nav-title holographic",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8},children:"The Amplituhedron"}),ee.jsx("div",{className:"chapter-nav",children:e.map((n,s)=>ee.jsxs(En.button,{className:`chapter-btn ${i===n.id?"active":""}`,onClick:()=>t(n.id),whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:s*.1+.5},children:[ee.jsx("span",{className:"chapter-number",children:String(n.id).padStart(2,"0")}),ee.jsx("span",{className:"chapter-title",children:n.title})]},n.id))})]})})}function RV({complexity:i=1}){const n=()=>{const s=[];s.push(ee.jsx("line",{x1:"0",y1:30,x2:30,y2:40,stroke:"#4a9eff",strokeWidth:"2",markerEnd:"url(#arrowhead)"},"in1")),s.push(ee.jsx("line",{x1:"0",y1:70,x2:30,y2:60,stroke:"#4a9eff",strokeWidth:"2",markerEnd:"url(#arrowhead)"},"in2")),s.push(ee.jsx("line",{x1:70,y1:40,x2:100,y2:30,stroke:"#06ffa5",strokeWidth:"2",markerEnd:"url(#arrowhead)"},"out1")),s.push(ee.jsx("line",{x1:70,y1:60,x2:100,y2:70,stroke:"#06ffa5",strokeWidth:"2",markerEnd:"url(#arrowhead)"},"out2"));for(let r=0;r<i;r++){const o=r/i*Math.PI*.5-Math.PI*.25;if(r%2===0){const u=`M 30 50 Q 50 ${50+Math.sin(o)*15} 70 50`;s.push(ee.jsx("path",{d:u,stroke:"#ffbe0b",strokeWidth:"2",fill:"none",strokeDasharray:"2,2"},`internal-${r}`))}else s.push(ee.jsx("line",{x1:35,y1:50+r*5-i*2.5,x2:65,y2:50+r*5-i*2.5,stroke:"#ff006e",strokeWidth:"2"},`internal-${r}`))}return s.push(ee.jsx("circle",{cx:30,cy:50,r:"4",fill:"#fff"},"vertex1")),s.push(ee.jsx("circle",{cx:70,cy:50,r:"4",fill:"#fff"},"vertex2")),s};return ee.jsx("div",{className:"feynman-diagram-wrapper",children:ee.jsxs("svg",{width:100,height:100,viewBox:"0 0 100 100",children:[ee.jsx("defs",{children:ee.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:ee.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#4a9eff"})})}),n()]})})}function DV({onNext:i,onPrevious:e}){const[t,n]=_e.useState(0),[s,r]=_e.useState(!1),[o,l]=_e.useState(0),[u,f]=_e.useState(!1),p=()=>{o===0&&f(!0);const b=o+1;l(b),b<=5?n(w=>w===0?2:Math.min(w*2,64)):r(!0)},g=["Imagine two particles racing toward each other at nearly the speed of light.","When they collide, they can transform into other particles.","But HOW do we calculate what happens?","Physicists use something called Feynman diagrams.","Click below to see how these diagrams work..."],[v,x]=_e.useState(0);return _e.useEffect(()=>{const b=setTimeout(()=>{v<g.length-1&&x(w=>w+1)},3e3);return()=>clearTimeout(b)},[v]),ee.jsx(En.div,{className:"chapter chapter1",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:ee.jsxs("div",{className:"chapter-content",children:[ee.jsx(En.h2,{className:"chapter-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:"Chapter 1: The Problem"}),ee.jsx(jm,{mode:"wait",children:ee.jsx(En.p,{className:"chapter-text",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:g[v]},v)}),v===g.length-1&&ee.jsxs(ee.Fragment,{children:[ee.jsx("div",{className:"particle-collision-demo",children:ee.jsxs("div",{className:"collision-explanation",children:[ee.jsx("div",{className:"particle particle-left",children:ee.jsx("span",{children:"Electron"})}),ee.jsx("div",{className:"collision-point",children:"ðŸ’¥"}),ee.jsx("div",{className:"particle particle-right",children:ee.jsx("span",{children:"Positron"})})]})}),ee.jsxs(En.div,{className:"diagram-intro",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[ee.jsx("p",{children:"Each diagram shows one possible way the collision could happen:"}),ee.jsxs("div",{className:"diagram-legend",children:[ee.jsxs("div",{className:"legend-item",children:[ee.jsx("span",{style:{color:"#4a9eff"},children:"â†’"})," Incoming particles"]}),ee.jsxs("div",{className:"legend-item",children:[ee.jsx("span",{style:{color:"#06ffa5"},children:"â†’"})," Outgoing particles"]}),ee.jsxs("div",{className:"legend-item",children:[ee.jsx("span",{style:{color:"#ffbe0b"},children:"ã€°ï¸"})," Forces exchanged"]})]})]}),ee.jsxs("div",{className:"diagram-container",onClick:p,style:{cursor:t<64?"pointer":"default"},children:[t===0?ee.jsx(En.div,{className:"click-prompt",animate:{scale:[1,1.05,1]},transition:{repeat:1/0,duration:2},children:ee.jsx("p",{children:"Click here to see what physicists must calculate"})}):ee.jsxs(ee.Fragment,{children:[ee.jsx("div",{className:"diagram-grid",children:[...Array(Math.min(t,64))].map((b,w)=>ee.jsx(En.div,{className:"diagram-item",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:w*.02,duration:.3,type:"spring"},children:ee.jsx(RV,{complexity:Math.floor(w/8)+1})},w))}),u&&!s&&ee.jsxs(En.div,{className:"explanation-box glass",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[ee.jsx("p",{children:"Each diagram = one quantum possibility"}),ee.jsx("p",{className:"small",children:"Keep clicking to see the problem..."})]})]}),t>16&&!s&&ee.jsxs(En.div,{className:"diagram-counter",initial:{opacity:0},animate:{opacity:1},children:[ee.jsxs("p",{children:["Diagrams shown: ",t," of ~200 needed"]}),ee.jsx("p",{className:"small",children:"And this is just for 4 particles!"})]})]})]}),s&&ee.jsxs(En.div,{className:"overwhelm-message glass",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},children:[ee.jsx("h3",{children:"There has to be a simpler way."}),ee.jsx("p",{children:"For 8 particles, you'd need millions of diagrams."}),ee.jsx("p",{children:"Each one requires complex calculations."}),ee.jsx("p",{children:"What if all these diagrams are just different views of something deeper?"}),ee.jsx("button",{className:"next-button",onClick:i,children:"Discover the hint â†’"})]}),ee.jsxs("div",{className:"chapter-nav",children:[ee.jsx("button",{onClick:e,children:"â† Back"}),s&&ee.jsx("button",{onClick:i,children:"Next â†’"})]})]})})}const Vv="182",ed={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},td={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},NO=0,ow=1,IO=2,NV=3,OO=0,Mm=1,K0=2,ad=3,Eu=0,Lr=1,sa=2,bc=0,pd=1,cb=2,lw=3,cw=4,PO=5,Ih=100,UO=101,LO=102,FO=103,kO=104,BO=200,zO=201,VO=202,GO=203,ub=204,hb=205,HO=206,WO=207,jO=208,qO=209,XO=210,YO=211,ZO=212,KO=213,QO=214,fb=0,db=1,pb=2,xd=3,mb=4,gb=5,vb=6,yb=7,Gv=0,JO=1,$O=2,Xo=0,TA=1,wA=2,AA=3,E1=4,EA=5,CA=6,RA=7,uw="attached",eP="detached",C1=300,Sc=301,Vh=302,pv=303,mv=304,qm=306,gv=1e3,Ga=1001,vv=1002,ms=1003,DA=1004,IV=1004,gm=1005,OV=1005,ti=1006,Q0=1007,PV=1007,vc=1008,UV=1008,ra=1009,NA=1010,IA=1011,Cm=1012,R1=1013,Ko=1014,Pr=1015,El=1016,D1=1017,N1=1018,Rm=1020,OA=35902,PA=35899,UA=1021,LA=1022,Ur=1023,Mc=1026,Ph=1027,I1=1028,Hv=1029,bd=1030,O1=1031,LV=1032,P1=1033,J0=33776,$0=33777,ev=33778,tv=33779,_b=35840,xb=35841,bb=35842,Sb=35843,Mb=36196,Tb=37492,wb=37496,Ab=37488,Eb=37489,Cb=37490,Rb=37491,Db=37808,Nb=37809,Ib=37810,Ob=37811,Pb=37812,Ub=37813,Lb=37814,Fb=37815,kb=37816,Bb=37817,zb=37818,Vb=37819,Gb=37820,Hb=37821,Wb=36492,jb=36494,qb=36495,Xb=36283,Yb=36284,Zb=36285,Kb=36286,tP=2200,nP=2201,iP=2202,yv=2300,Qb=2301,Zx=2302,od=2400,ld=2401,_v=2402,U1=2500,FA=2501,FV=0,kV=1,BV=2,sP=3200,rP=3201,zV=3202,VV=3203,Yh=0,aP=1,xu="",Ir="srgb",Gh="srgb-linear",xv="linear",Jn="srgb",GV="",HV="rg",WV="ga",jV=0,nd=7680,qV=7681,XV=7682,YV=7683,ZV=34055,KV=34056,QV=5386,JV=512,$V=513,e2=514,t2=515,n2=516,i2=517,s2=518,hw=519,oP=512,lP=513,cP=514,L1=515,uP=516,hP=517,F1=518,fP=519,bv=35044,md=35048,r2=35040,a2=35045,o2=35049,l2=35041,c2=35046,u2=35050,h2=35042,f2="100",fw="300 es",ao=2e3,Dm=2001,d2={COMPUTE:"compute",RENDER:"render"},p2={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},m2={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function dP(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const g2={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function vm(i,e){return new g2[i](e)}function pP(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function Sv(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function mP(){const i=Sv("canvas");return i.style.display="block",i}const y3={};let Hh=null;function v2(i){Hh=i}function y2(){return Hh}function Mv(...i){const e="THREE."+i.shift();Hh?Hh("log",e,...i):console.log(e,...i)}function Tt(...i){const e="THREE."+i.shift();Hh?Hh("warn",e,...i):console.warn(e,...i)}function kt(...i){const e="THREE."+i.shift();Hh?Hh("error",e,...i):console.error(e,...i)}function Nm(...i){const e=i.join(" ");e in y3||(y3[e]=!0,Tt(...i))}function _2(i,e,t){return new Promise(function(n,s){function r(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:s();break;case i.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:n()}}setTimeout(r,t)})}let Ec=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const s=n[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}};const Rr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _3=1234567;const gd=Math.PI/180,Im=180/Math.PI;function lo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Rr[i&255]+Rr[i>>8&255]+Rr[i>>16&255]+Rr[i>>24&255]+"-"+Rr[e&255]+Rr[e>>8&255]+"-"+Rr[e>>16&15|64]+Rr[e>>24&255]+"-"+Rr[t&63|128]+Rr[t>>8&255]+"-"+Rr[t>>16&255]+Rr[t>>24&255]+Rr[n&255]+Rr[n>>8&255]+Rr[n>>16&255]+Rr[n>>24&255]).toLowerCase()}function Qt(i,e,t){return Math.max(e,Math.min(t,i))}function kA(i,e){return(i%e+e)%e}function x2(i,e,t,n,s){return n+(i-e)*(s-n)/(t-e)}function b2(i,e,t){return i!==e?(t-i)/(e-i):0}function nv(i,e,t){return(1-t)*i+t*e}function S2(i,e,t,n){return nv(i,e,1-Math.exp(-t*n))}function M2(i,e=1){return e-Math.abs(kA(i,e*2)-e)}function T2(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function w2(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function A2(i,e){return i+Math.floor(Math.random()*(e-i+1))}function E2(i,e){return i+Math.random()*(e-i)}function C2(i){return i*(.5-Math.random())}function R2(i){i!==void 0&&(_3=i);let e=_3+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function D2(i){return i*gd}function N2(i){return i*Im}function I2(i){return(i&i-1)===0&&i!==0}function O2(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function P2(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function U2(i,e,t,n,s){const r=Math.cos,o=Math.sin,l=r(t/2),u=o(t/2),f=r((e+n)/2),p=o((e+n)/2),g=r((e-n)/2),v=o((e-n)/2),x=r((n-e)/2),b=o((n-e)/2);switch(s){case"XYX":i.set(l*p,u*g,u*v,l*f);break;case"YZY":i.set(u*v,l*p,u*g,l*f);break;case"ZXZ":i.set(u*g,u*v,l*p,l*f);break;case"XZX":i.set(l*p,u*b,u*x,l*f);break;case"YXY":i.set(u*x,l*p,u*b,l*f);break;case"ZYZ":i.set(u*b,u*x,l*p,l*f);break;default:Tt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function aa(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function dn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const L2={DEG2RAD:gd,RAD2DEG:Im,generateUUID:lo,clamp:Qt,euclideanModulo:kA,mapLinear:x2,inverseLerp:b2,lerp:nv,damp:S2,pingpong:M2,smoothstep:T2,smootherstep:w2,randInt:A2,randFloat:E2,randFloatSpread:C2,seededRandom:R2,degToRad:D2,radToDeg:N2,isPowerOfTwo:I2,ceilPowerOfTwo:O2,floorPowerOfTwo:P2,setQuaternionFromProperEuler:U2,normalize:dn,denormalize:aa};class st{constructor(e=0,t=0){st.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Qt(this.x,e.x,t.x),this.y=Qt(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Qt(this.x,e,t),this.y=Qt(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Qt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Qt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*s+e.x,this.y=r*s+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Fr{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,r,o,l){let u=n[s+0],f=n[s+1],p=n[s+2],g=n[s+3],v=r[o+0],x=r[o+1],b=r[o+2],w=r[o+3];if(l<=0){e[t+0]=u,e[t+1]=f,e[t+2]=p,e[t+3]=g;return}if(l>=1){e[t+0]=v,e[t+1]=x,e[t+2]=b,e[t+3]=w;return}if(g!==w||u!==v||f!==x||p!==b){let M=u*v+f*x+p*b+g*w;M<0&&(v=-v,x=-x,b=-b,w=-w,M=-M);let S=1-l;if(M<.9995){const C=Math.acos(M),R=Math.sin(C);S=Math.sin(S*C)/R,l=Math.sin(l*C)/R,u=u*S+v*l,f=f*S+x*l,p=p*S+b*l,g=g*S+w*l}else{u=u*S+v*l,f=f*S+x*l,p=p*S+b*l,g=g*S+w*l;const C=1/Math.sqrt(u*u+f*f+p*p+g*g);u*=C,f*=C,p*=C,g*=C}}e[t]=u,e[t+1]=f,e[t+2]=p,e[t+3]=g}static multiplyQuaternionsFlat(e,t,n,s,r,o){const l=n[s],u=n[s+1],f=n[s+2],p=n[s+3],g=r[o],v=r[o+1],x=r[o+2],b=r[o+3];return e[t]=l*b+p*g+u*x-f*v,e[t+1]=u*b+p*v+f*g-l*x,e[t+2]=f*b+p*x+l*v-u*g,e[t+3]=p*b-l*g-u*v-f*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,s=e._y,r=e._z,o=e._order,l=Math.cos,u=Math.sin,f=l(n/2),p=l(s/2),g=l(r/2),v=u(n/2),x=u(s/2),b=u(r/2);switch(o){case"XYZ":this._x=v*p*g+f*x*b,this._y=f*x*g-v*p*b,this._z=f*p*b+v*x*g,this._w=f*p*g-v*x*b;break;case"YXZ":this._x=v*p*g+f*x*b,this._y=f*x*g-v*p*b,this._z=f*p*b-v*x*g,this._w=f*p*g+v*x*b;break;case"ZXY":this._x=v*p*g-f*x*b,this._y=f*x*g+v*p*b,this._z=f*p*b+v*x*g,this._w=f*p*g-v*x*b;break;case"ZYX":this._x=v*p*g-f*x*b,this._y=f*x*g+v*p*b,this._z=f*p*b-v*x*g,this._w=f*p*g+v*x*b;break;case"YZX":this._x=v*p*g+f*x*b,this._y=f*x*g+v*p*b,this._z=f*p*b-v*x*g,this._w=f*p*g-v*x*b;break;case"XZY":this._x=v*p*g-f*x*b,this._y=f*x*g-v*p*b,this._z=f*p*b+v*x*g,this._w=f*p*g+v*x*b;break;default:Tt("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],r=t[8],o=t[1],l=t[5],u=t[9],f=t[2],p=t[6],g=t[10],v=n+l+g;if(v>0){const x=.5/Math.sqrt(v+1);this._w=.25/x,this._x=(p-u)*x,this._y=(r-f)*x,this._z=(o-s)*x}else if(n>l&&n>g){const x=2*Math.sqrt(1+n-l-g);this._w=(p-u)/x,this._x=.25*x,this._y=(s+o)/x,this._z=(r+f)/x}else if(l>g){const x=2*Math.sqrt(1+l-n-g);this._w=(r-f)/x,this._x=(s+o)/x,this._y=.25*x,this._z=(u+p)/x}else{const x=2*Math.sqrt(1+g-n-l);this._w=(o-s)/x,this._x=(r+f)/x,this._y=(u+p)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qt(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,r=e._z,o=e._w,l=t._x,u=t._y,f=t._z,p=t._w;return this._x=n*p+o*l+s*f-r*u,this._y=s*p+o*u+r*l-n*f,this._z=r*p+o*f+n*u-s*l,this._w=o*p-n*l-s*u-r*f,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,s=e._y,r=e._z,o=e._w,l=this.dot(e);l<0&&(n=-n,s=-s,r=-r,o=-o,l=-l);let u=1-t;if(l<.9995){const f=Math.acos(l),p=Math.sin(f);u=Math.sin(u*f)/p,t=Math.sin(t*f)/p,this._x=this._x*u+n*t,this._y=this._y*u+s*t,this._z=this._z*u+r*t,this._w=this._w*u+o*t,this._onChangeCallback()}else this._x=this._x*u+n*t,this._y=this._y*u+s*t,this._z=this._z*u+r*t,this._w=this._w*u+o*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class re{constructor(e=0,t=0,n=0){re.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(x3.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(x3.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*s,this.y=r[1]*t+r[4]*n+r[7]*s,this.z=r[2]*t+r[5]*n+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*s+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*s+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*s+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*s+r[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,r=e.x,o=e.y,l=e.z,u=e.w,f=2*(o*s-l*n),p=2*(l*t-r*s),g=2*(r*n-o*t);return this.x=t+u*f+o*g-l*p,this.y=n+u*p+l*f-r*g,this.z=s+u*g+r*p-o*f,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*s,this.y=r[1]*t+r[5]*n+r[9]*s,this.z=r[2]*t+r[6]*n+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Qt(this.x,e.x,t.x),this.y=Qt(this.y,e.y,t.y),this.z=Qt(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Qt(this.x,e,t),this.y=Qt(this.y,e,t),this.z=Qt(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Qt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,r=e.z,o=t.x,l=t.y,u=t.z;return this.x=s*u-r*l,this.y=r*o-n*u,this.z=n*l-s*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return OM.copy(this).projectOnVector(e),this.sub(OM)}reflect(e){return this.sub(OM.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Qt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const OM=new re,x3=new Fr;class on{constructor(e,t,n,s,r,o,l,u,f){on.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,l,u,f)}set(e,t,n,s,r,o,l,u,f){const p=this.elements;return p[0]=e,p[1]=s,p[2]=l,p[3]=t,p[4]=r,p[5]=u,p[6]=n,p[7]=o,p[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],l=n[3],u=n[6],f=n[1],p=n[4],g=n[7],v=n[2],x=n[5],b=n[8],w=s[0],M=s[3],S=s[6],C=s[1],R=s[4],I=s[7],D=s[2],O=s[5],U=s[8];return r[0]=o*w+l*C+u*D,r[3]=o*M+l*R+u*O,r[6]=o*S+l*I+u*U,r[1]=f*w+p*C+g*D,r[4]=f*M+p*R+g*O,r[7]=f*S+p*I+g*U,r[2]=v*w+x*C+b*D,r[5]=v*M+x*R+b*O,r[8]=v*S+x*I+b*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],l=e[5],u=e[6],f=e[7],p=e[8];return t*o*p-t*l*f-n*r*p+n*l*u+s*r*f-s*o*u}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],l=e[5],u=e[6],f=e[7],p=e[8],g=p*o-l*f,v=l*u-p*r,x=f*r-o*u,b=t*g+n*v+s*x;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const w=1/b;return e[0]=g*w,e[1]=(s*f-p*n)*w,e[2]=(l*n-s*o)*w,e[3]=v*w,e[4]=(p*t-s*u)*w,e[5]=(s*r-l*t)*w,e[6]=x*w,e[7]=(n*u-f*t)*w,e[8]=(o*t-n*r)*w,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,r,o,l){const u=Math.cos(r),f=Math.sin(r);return this.set(n*u,n*f,-n*(u*o+f*l)+o+e,-s*f,s*u,-s*(-f*o+u*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(PM.makeScale(e,t)),this}rotate(e){return this.premultiply(PM.makeRotation(-e)),this}translate(e,t){return this.premultiply(PM.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const PM=new on,b3=new on().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),S3=new on().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function F2(){const i={enabled:!0,workingColorSpace:Gh,spaces:{},convert:function(s,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===Jn&&(s.r=Su(s.r),s.g=Su(s.g),s.b=Su(s.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Jn&&(s.r=Tm(s.r),s.g=Tm(s.g),s.b=Tm(s.b))),s},workingToColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},colorSpaceToWorking:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===xu?xv:this.spaces[s].transfer},getToneMappingMode:function(s){return this.spaces[s].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,o){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,r){return Nm("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(s,r)},toWorkingColorSpace:function(s,r){return Nm("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(s,r)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Gh]:{primaries:e,whitePoint:n,transfer:xv,toXYZ:b3,fromXYZ:S3,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Ir},outputColorSpaceConfig:{drawingBufferColorSpace:Ir}},[Ir]:{primaries:e,whitePoint:n,transfer:Jn,toXYZ:b3,fromXYZ:S3,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Ir}}}),i}const On=F2();function Su(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Tm(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let kp;class gP{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{kp===void 0&&(kp=Sv("canvas")),kp.width=e.width,kp.height=e.height;const s=kp.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),n=kp}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Sv("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=Su(r[o]/255)*255;return n.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Su(t[n]/255)*255):t[n]=Su(t[n]);return{data:t,width:e.width,height:e.height}}else return Tt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let k2=0,Uh=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:k2++}),this.uuid=lo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,l=s.length;o<l;o++)s[o].isDataTexture?r.push(UM(s[o].image)):r.push(UM(s[o]))}else r=UM(s);n.url=r}return t||(e.images[this.uuid]=n),n}};function UM(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?gP.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Tt("Texture: Unable to serialize Texture."),{})}let B2=0;const LM=new re;class Ki extends Ec{constructor(e=Ki.DEFAULT_IMAGE,t=Ki.DEFAULT_MAPPING,n=Ga,s=Ga,r=ti,o=vc,l=Ur,u=ra,f=Ki.DEFAULT_ANISOTROPY,p=xu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:B2++}),this.uuid=lo(),this.name="",this.source=new Uh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=f,this.format=l,this.internalFormat=null,this.type=u,this.offset=new st(0,0),this.repeat=new st(1,1),this.center=new st(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new on,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(LM).x}get height(){return this.source.getSize(LM).y}get depth(){return this.source.getSize(LM).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Tt(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){Tt(`Texture.setValues(): property '${t}' does not exist.`);continue}s&&n&&s.isVector2&&n.isVector2||s&&n&&s.isVector3&&n.isVector3||s&&n&&s.isMatrix3&&n.isMatrix3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==C1)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case gv:e.x=e.x-Math.floor(e.x);break;case Ga:e.x=e.x<0?0:1;break;case vv:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case gv:e.y=e.y-Math.floor(e.y);break;case Ga:e.y=e.y<0?0:1;break;case vv:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ki.DEFAULT_IMAGE=null;Ki.DEFAULT_MAPPING=C1;Ki.DEFAULT_ANISOTROPY=1;class $n{constructor(e=0,t=0,n=0,s=1){$n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*s+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*s+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*s+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*s+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,r;const u=e.elements,f=u[0],p=u[4],g=u[8],v=u[1],x=u[5],b=u[9],w=u[2],M=u[6],S=u[10];if(Math.abs(p-v)<.01&&Math.abs(g-w)<.01&&Math.abs(b-M)<.01){if(Math.abs(p+v)<.1&&Math.abs(g+w)<.1&&Math.abs(b+M)<.1&&Math.abs(f+x+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const R=(f+1)/2,I=(x+1)/2,D=(S+1)/2,O=(p+v)/4,U=(g+w)/4,k=(b+M)/4;return R>I&&R>D?R<.01?(n=0,s=.707106781,r=.707106781):(n=Math.sqrt(R),s=O/n,r=U/n):I>D?I<.01?(n=.707106781,s=0,r=.707106781):(s=Math.sqrt(I),n=O/s,r=k/s):D<.01?(n=.707106781,s=.707106781,r=0):(r=Math.sqrt(D),n=U/r,s=k/r),this.set(n,s,r,t),this}let C=Math.sqrt((M-b)*(M-b)+(g-w)*(g-w)+(v-p)*(v-p));return Math.abs(C)<.001&&(C=1),this.x=(M-b)/C,this.y=(g-w)/C,this.z=(v-p)/C,this.w=Math.acos((f+x+S-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Qt(this.x,e.x,t.x),this.y=Qt(this.y,e.y,t.y),this.z=Qt(this.z,e.z,t.z),this.w=Qt(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Qt(this.x,e,t),this.y=Qt(this.y,e,t),this.z=Qt(this.z,e,t),this.w=Qt(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Qt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class BA extends Ec{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ti,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new $n(0,0,e,t),this.scissorTest=!1,this.viewport=new $n(0,0,e,t);const s={width:e,height:t,depth:n.depth},r=new Ki(s);this.textures=[];const o=n.count;for(let l=0;l<o;l++)this.textures[l]=r.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:ti,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,r=this.textures.length;s<r;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=n,this.textures[s].isData3DTexture!==!0&&(this.textures[s].isArrayTexture=this.textures[s].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new Uh(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ha extends BA{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class k1 extends Ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=ms,this.minFilter=ms,this.wrapR=Ga,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class z2 extends Ha{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new k1(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class B1 extends Ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=ms,this.minFilter=ms,this.wrapR=Ga,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class V2 extends Ha{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new B1(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class $s{constructor(e=new re(1/0,1/0,1/0),t=new re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(vl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(vl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=vl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,l=r.count;o<l;o++)e.isMesh===!0?e.getVertexPosition(o,vl):vl.fromBufferAttribute(r,o),vl.applyMatrix4(e.matrixWorld),this.expandByPoint(vl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),j_.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),j_.copy(n.boundingBox)),j_.applyMatrix4(e.matrixWorld),this.union(j_)}const s=e.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,vl),vl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(A0),q_.subVectors(this.max,A0),Bp.subVectors(e.a,A0),zp.subVectors(e.b,A0),Vp.subVectors(e.c,A0),Sh.subVectors(zp,Bp),Mh.subVectors(Vp,zp),Ff.subVectors(Bp,Vp);let t=[0,-Sh.z,Sh.y,0,-Mh.z,Mh.y,0,-Ff.z,Ff.y,Sh.z,0,-Sh.x,Mh.z,0,-Mh.x,Ff.z,0,-Ff.x,-Sh.y,Sh.x,0,-Mh.y,Mh.x,0,-Ff.y,Ff.x,0];return!FM(t,Bp,zp,Vp,q_)||(t=[1,0,0,0,1,0,0,0,1],!FM(t,Bp,zp,Vp,q_))?!1:(X_.crossVectors(Sh,Mh),t=[X_.x,X_.y,X_.z],FM(t,Bp,zp,Vp,q_))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,vl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(vl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const hu=[new re,new re,new re,new re,new re,new re,new re,new re],vl=new re,j_=new $s,Bp=new re,zp=new re,Vp=new re,Sh=new re,Mh=new re,Ff=new re,A0=new re,q_=new re,X_=new re,kf=new re;function FM(i,e,t,n,s){for(let r=0,o=i.length-3;r<=o;r+=3){kf.fromArray(i,r);const l=s.x*Math.abs(kf.x)+s.y*Math.abs(kf.y)+s.z*Math.abs(kf.z),u=e.dot(kf),f=t.dot(kf),p=n.dot(kf);if(Math.max(-Math.max(u,f,p),Math.min(u,f,p))>l)return!1}return!0}const G2=new $s,E0=new re,kM=new re;class er{constructor(e=new re,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):G2.setFromPoints(e).getCenter(n);let s=0;for(let r=0,o=e.length;r<o;r++)s=Math.max(s,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;E0.subVectors(e,this.center);const t=E0.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=(n-this.radius)*.5;this.center.addScaledVector(E0,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(kM.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(E0.copy(e.center).add(kM)),this.expandByPoint(E0.copy(e.center).sub(kM))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const fu=new re,BM=new re,Y_=new re,Th=new re,zM=new re,Z_=new re,VM=new re;class Nd{constructor(e=new re,t=new re(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fu.copy(this.origin).addScaledVector(this.direction,t),fu.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){BM.copy(e).add(t).multiplyScalar(.5),Y_.copy(t).sub(e).normalize(),Th.copy(this.origin).sub(BM);const r=e.distanceTo(t)*.5,o=-this.direction.dot(Y_),l=Th.dot(this.direction),u=-Th.dot(Y_),f=Th.lengthSq(),p=Math.abs(1-o*o);let g,v,x,b;if(p>0)if(g=o*u-l,v=o*l-u,b=r*p,g>=0)if(v>=-b)if(v<=b){const w=1/p;g*=w,v*=w,x=g*(g+o*v+2*l)+v*(o*g+v+2*u)+f}else v=r,g=Math.max(0,-(o*v+l)),x=-g*g+v*(v+2*u)+f;else v=-r,g=Math.max(0,-(o*v+l)),x=-g*g+v*(v+2*u)+f;else v<=-b?(g=Math.max(0,-(-o*r+l)),v=g>0?-r:Math.min(Math.max(-r,-u),r),x=-g*g+v*(v+2*u)+f):v<=b?(g=0,v=Math.min(Math.max(-r,-u),r),x=v*(v+2*u)+f):(g=Math.max(0,-(o*r+l)),v=g>0?r:Math.min(Math.max(-r,-u),r),x=-g*g+v*(v+2*u)+f);else v=o>0?-r:r,g=Math.max(0,-(o*v+l)),x=-g*g+v*(v+2*u)+f;return n&&n.copy(this.origin).addScaledVector(this.direction,g),s&&s.copy(BM).addScaledVector(Y_,v),x}intersectSphere(e,t){fu.subVectors(e.center,this.origin);const n=fu.dot(this.direction),s=fu.dot(fu)-n*n,r=e.radius*e.radius;if(s>r)return null;const o=Math.sqrt(r-s),l=n-o,u=n+o;return u<0?null:l<0?this.at(u,t):this.at(l,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,r,o,l,u;const f=1/this.direction.x,p=1/this.direction.y,g=1/this.direction.z,v=this.origin;return f>=0?(n=(e.min.x-v.x)*f,s=(e.max.x-v.x)*f):(n=(e.max.x-v.x)*f,s=(e.min.x-v.x)*f),p>=0?(r=(e.min.y-v.y)*p,o=(e.max.y-v.y)*p):(r=(e.max.y-v.y)*p,o=(e.min.y-v.y)*p),n>o||r>s||((r>n||isNaN(n))&&(n=r),(o<s||isNaN(s))&&(s=o),g>=0?(l=(e.min.z-v.z)*g,u=(e.max.z-v.z)*g):(l=(e.max.z-v.z)*g,u=(e.min.z-v.z)*g),n>u||l>s)||((l>n||n!==n)&&(n=l),(u<s||s!==s)&&(s=u),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return this.intersectBox(e,fu)!==null}intersectTriangle(e,t,n,s,r){zM.subVectors(t,e),Z_.subVectors(n,e),VM.crossVectors(zM,Z_);let o=this.direction.dot(VM),l;if(o>0){if(s)return null;l=1}else if(o<0)l=-1,o=-o;else return null;Th.subVectors(this.origin,e);const u=l*this.direction.dot(Z_.crossVectors(Th,Z_));if(u<0)return null;const f=l*this.direction.dot(zM.cross(Th));if(f<0||u+f>o)return null;const p=-l*Th.dot(VM);return p<0?null:this.at(p/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Kt{constructor(e,t,n,s,r,o,l,u,f,p,g,v,x,b,w,M){Kt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,l,u,f,p,g,v,x,b,w,M)}set(e,t,n,s,r,o,l,u,f,p,g,v,x,b,w,M){const S=this.elements;return S[0]=e,S[4]=t,S[8]=n,S[12]=s,S[1]=r,S[5]=o,S[9]=l,S[13]=u,S[2]=f,S[6]=p,S[10]=g,S[14]=v,S[3]=x,S[7]=b,S[11]=w,S[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Kt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,s=1/Gp.setFromMatrixColumn(e,0).length(),r=1/Gp.setFromMatrixColumn(e,1).length(),o=1/Gp.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,r=e.z,o=Math.cos(n),l=Math.sin(n),u=Math.cos(s),f=Math.sin(s),p=Math.cos(r),g=Math.sin(r);if(e.order==="XYZ"){const v=o*p,x=o*g,b=l*p,w=l*g;t[0]=u*p,t[4]=-u*g,t[8]=f,t[1]=x+b*f,t[5]=v-w*f,t[9]=-l*u,t[2]=w-v*f,t[6]=b+x*f,t[10]=o*u}else if(e.order==="YXZ"){const v=u*p,x=u*g,b=f*p,w=f*g;t[0]=v+w*l,t[4]=b*l-x,t[8]=o*f,t[1]=o*g,t[5]=o*p,t[9]=-l,t[2]=x*l-b,t[6]=w+v*l,t[10]=o*u}else if(e.order==="ZXY"){const v=u*p,x=u*g,b=f*p,w=f*g;t[0]=v-w*l,t[4]=-o*g,t[8]=b+x*l,t[1]=x+b*l,t[5]=o*p,t[9]=w-v*l,t[2]=-o*f,t[6]=l,t[10]=o*u}else if(e.order==="ZYX"){const v=o*p,x=o*g,b=l*p,w=l*g;t[0]=u*p,t[4]=b*f-x,t[8]=v*f+w,t[1]=u*g,t[5]=w*f+v,t[9]=x*f-b,t[2]=-f,t[6]=l*u,t[10]=o*u}else if(e.order==="YZX"){const v=o*u,x=o*f,b=l*u,w=l*f;t[0]=u*p,t[4]=w-v*g,t[8]=b*g+x,t[1]=g,t[5]=o*p,t[9]=-l*p,t[2]=-f*p,t[6]=x*g+b,t[10]=v-w*g}else if(e.order==="XZY"){const v=o*u,x=o*f,b=l*u,w=l*f;t[0]=u*p,t[4]=-g,t[8]=f*p,t[1]=v*g+w,t[5]=o*p,t[9]=x*g-b,t[2]=b*g-x,t[6]=l*p,t[10]=w*g+v}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(H2,e,W2)}lookAt(e,t,n){const s=this.elements;return io.subVectors(e,t),io.lengthSq()===0&&(io.z=1),io.normalize(),wh.crossVectors(n,io),wh.lengthSq()===0&&(Math.abs(n.z)===1?io.x+=1e-4:io.z+=1e-4,io.normalize(),wh.crossVectors(n,io)),wh.normalize(),K_.crossVectors(io,wh),s[0]=wh.x,s[4]=K_.x,s[8]=io.x,s[1]=wh.y,s[5]=K_.y,s[9]=io.y,s[2]=wh.z,s[6]=K_.z,s[10]=io.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],l=n[4],u=n[8],f=n[12],p=n[1],g=n[5],v=n[9],x=n[13],b=n[2],w=n[6],M=n[10],S=n[14],C=n[3],R=n[7],I=n[11],D=n[15],O=s[0],U=s[4],k=s[8],P=s[12],F=s[1],H=s[5],G=s[9],j=s[13],K=s[2],te=s[6],W=s[10],X=s[14],oe=s[3],ne=s[7],ie=s[11],B=s[15];return r[0]=o*O+l*F+u*K+f*oe,r[4]=o*U+l*H+u*te+f*ne,r[8]=o*k+l*G+u*W+f*ie,r[12]=o*P+l*j+u*X+f*B,r[1]=p*O+g*F+v*K+x*oe,r[5]=p*U+g*H+v*te+x*ne,r[9]=p*k+g*G+v*W+x*ie,r[13]=p*P+g*j+v*X+x*B,r[2]=b*O+w*F+M*K+S*oe,r[6]=b*U+w*H+M*te+S*ne,r[10]=b*k+w*G+M*W+S*ie,r[14]=b*P+w*j+M*X+S*B,r[3]=C*O+R*F+I*K+D*oe,r[7]=C*U+R*H+I*te+D*ne,r[11]=C*k+R*G+I*W+D*ie,r[15]=C*P+R*j+I*X+D*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],r=e[12],o=e[1],l=e[5],u=e[9],f=e[13],p=e[2],g=e[6],v=e[10],x=e[14],b=e[3],w=e[7],M=e[11],S=e[15],C=u*x-f*v,R=l*x-f*g,I=l*v-u*g,D=o*x-f*p,O=o*v-u*p,U=o*g-l*p;return t*(w*C-M*R+S*I)-n*(b*C-M*D+S*O)+s*(b*R-w*D+S*U)-r*(b*I-w*O+M*U)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],l=e[5],u=e[6],f=e[7],p=e[8],g=e[9],v=e[10],x=e[11],b=e[12],w=e[13],M=e[14],S=e[15],C=g*M*f-w*v*f+w*u*x-l*M*x-g*u*S+l*v*S,R=b*v*f-p*M*f-b*u*x+o*M*x+p*u*S-o*v*S,I=p*w*f-b*g*f+b*l*x-o*w*x-p*l*S+o*g*S,D=b*g*u-p*w*u-b*l*v+o*w*v+p*l*M-o*g*M,O=t*C+n*R+s*I+r*D;if(O===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const U=1/O;return e[0]=C*U,e[1]=(w*v*r-g*M*r-w*s*x+n*M*x+g*s*S-n*v*S)*U,e[2]=(l*M*r-w*u*r+w*s*f-n*M*f-l*s*S+n*u*S)*U,e[3]=(g*u*r-l*v*r-g*s*f+n*v*f+l*s*x-n*u*x)*U,e[4]=R*U,e[5]=(p*M*r-b*v*r+b*s*x-t*M*x-p*s*S+t*v*S)*U,e[6]=(b*u*r-o*M*r-b*s*f+t*M*f+o*s*S-t*u*S)*U,e[7]=(o*v*r-p*u*r+p*s*f-t*v*f-o*s*x+t*u*x)*U,e[8]=I*U,e[9]=(b*g*r-p*w*r-b*n*x+t*w*x+p*n*S-t*g*S)*U,e[10]=(o*w*r-b*l*r+b*n*f-t*w*f-o*n*S+t*l*S)*U,e[11]=(p*l*r-o*g*r-p*n*f+t*g*f+o*n*x-t*l*x)*U,e[12]=D*U,e[13]=(p*w*s-b*g*s+b*n*v-t*w*v-p*n*M+t*g*M)*U,e[14]=(b*l*s-o*w*s-b*n*u+t*w*u+o*n*M-t*l*M)*U,e[15]=(o*g*s-p*l*s+p*n*u-t*g*u-o*n*v+t*l*v)*U,this}scale(e){const t=this.elements,n=e.x,s=e.y,r=e.z;return t[0]*=n,t[4]*=s,t[8]*=r,t[1]*=n,t[5]*=s,t[9]*=r,t[2]*=n,t[6]*=s,t[10]*=r,t[3]*=n,t[7]*=s,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,s))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),r=1-n,o=e.x,l=e.y,u=e.z,f=r*o,p=r*l;return this.set(f*o+n,f*l-s*u,f*u+s*l,0,f*l+s*u,p*l+n,p*u-s*o,0,f*u-s*l,p*u+s*o,r*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,r,o){return this.set(1,n,r,0,e,1,o,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,r=t._x,o=t._y,l=t._z,u=t._w,f=r+r,p=o+o,g=l+l,v=r*f,x=r*p,b=r*g,w=o*p,M=o*g,S=l*g,C=u*f,R=u*p,I=u*g,D=n.x,O=n.y,U=n.z;return s[0]=(1-(w+S))*D,s[1]=(x+I)*D,s[2]=(b-R)*D,s[3]=0,s[4]=(x-I)*O,s[5]=(1-(v+S))*O,s[6]=(M+C)*O,s[7]=0,s[8]=(b+R)*U,s[9]=(M-C)*U,s[10]=(1-(v+w))*U,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;if(e.x=s[12],e.y=s[13],e.z=s[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let r=Gp.set(s[0],s[1],s[2]).length();const o=Gp.set(s[4],s[5],s[6]).length(),l=Gp.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),yl.copy(this);const f=1/r,p=1/o,g=1/l;return yl.elements[0]*=f,yl.elements[1]*=f,yl.elements[2]*=f,yl.elements[4]*=p,yl.elements[5]*=p,yl.elements[6]*=p,yl.elements[8]*=g,yl.elements[9]*=g,yl.elements[10]*=g,t.setFromRotationMatrix(yl),n.x=r,n.y=o,n.z=l,this}makePerspective(e,t,n,s,r,o,l=ao,u=!1){const f=this.elements,p=2*r/(t-e),g=2*r/(n-s),v=(t+e)/(t-e),x=(n+s)/(n-s);let b,w;if(u)b=r/(o-r),w=o*r/(o-r);else if(l===ao)b=-(o+r)/(o-r),w=-2*o*r/(o-r);else if(l===Dm)b=-o/(o-r),w=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return f[0]=p,f[4]=0,f[8]=v,f[12]=0,f[1]=0,f[5]=g,f[9]=x,f[13]=0,f[2]=0,f[6]=0,f[10]=b,f[14]=w,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(e,t,n,s,r,o,l=ao,u=!1){const f=this.elements,p=2/(t-e),g=2/(n-s),v=-(t+e)/(t-e),x=-(n+s)/(n-s);let b,w;if(u)b=1/(o-r),w=o/(o-r);else if(l===ao)b=-2/(o-r),w=-(o+r)/(o-r);else if(l===Dm)b=-1/(o-r),w=-r/(o-r);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return f[0]=p,f[4]=0,f[8]=0,f[12]=v,f[1]=0,f[5]=g,f[9]=0,f[13]=x,f[2]=0,f[6]=0,f[10]=b,f[14]=w,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Gp=new re,yl=new Kt,H2=new re(0,0,0),W2=new re(1,1,1),wh=new re,K_=new re,io=new re,M3=new Kt,T3=new Fr;class uo{constructor(e=0,t=0,n=0,s=uo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,r=s[0],o=s[4],l=s[8],u=s[1],f=s[5],p=s[9],g=s[2],v=s[6],x=s[10];switch(t){case"XYZ":this._y=Math.asin(Qt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-p,x),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(v,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Qt(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(l,x),this._z=Math.atan2(u,f)):(this._y=Math.atan2(-g,r),this._z=0);break;case"ZXY":this._x=Math.asin(Qt(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-g,x),this._z=Math.atan2(-o,f)):(this._y=0,this._z=Math.atan2(u,r));break;case"ZYX":this._y=Math.asin(-Qt(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(v,x),this._z=Math.atan2(u,r)):(this._x=0,this._z=Math.atan2(-o,f));break;case"YZX":this._z=Math.asin(Qt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,f),this._y=Math.atan2(-g,r)):(this._x=0,this._y=Math.atan2(l,x));break;case"XZY":this._z=Math.asin(-Qt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(v,f),this._y=Math.atan2(l,r)):(this._x=Math.atan2(-p,x),this._y=0);break;default:Tt("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return M3.makeRotationFromQuaternion(e),this.setFromRotationMatrix(M3,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return T3.setFromEuler(this),this.setFromQuaternion(T3,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}uo.DEFAULT_ORDER="XYZ";class Om{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let j2=0;const w3=new re,Hp=new Fr,du=new Kt,Q_=new re,C0=new re,q2=new re,X2=new Fr,A3=new re(1,0,0),E3=new re(0,1,0),C3=new re(0,0,1),R3={type:"added"},Y2={type:"removed"},Wp={type:"childadded",child:null},GM={type:"childremoved",child:null};class zn extends Ec{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:j2++}),this.uuid=lo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=zn.DEFAULT_UP.clone();const e=new re,t=new uo,n=new Fr,s=new re(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Kt},normalMatrix:{value:new on}}),this.matrix=new Kt,this.matrixWorld=new Kt,this.matrixAutoUpdate=zn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=zn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Om,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Hp.setFromAxisAngle(e,t),this.quaternion.multiply(Hp),this}rotateOnWorldAxis(e,t){return Hp.setFromAxisAngle(e,t),this.quaternion.premultiply(Hp),this}rotateX(e){return this.rotateOnAxis(A3,e)}rotateY(e){return this.rotateOnAxis(E3,e)}rotateZ(e){return this.rotateOnAxis(C3,e)}translateOnAxis(e,t){return w3.copy(e).applyQuaternion(this.quaternion),this.position.add(w3.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(A3,e)}translateY(e){return this.translateOnAxis(E3,e)}translateZ(e){return this.translateOnAxis(C3,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(du.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Q_.copy(e):Q_.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),C0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?du.lookAt(C0,Q_,this.up):du.lookAt(Q_,C0,this.up),this.quaternion.setFromRotationMatrix(du),s&&(du.extractRotation(s.matrixWorld),Hp.setFromRotationMatrix(du),this.quaternion.premultiply(Hp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(kt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(R3),Wp.child=e,this.dispatchEvent(Wp),Wp.child=null):kt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Y2),GM.child=e,this.dispatchEvent(GM),GM.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),du.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),du.multiply(e.parent.matrixWorld)),e.applyMatrix4(du),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(R3),Wp.child=e,this.dispatchEvent(Wp),Wp.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(C0,e,q2),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(C0,X2,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(l=>({...l,boundingBox:l.boundingBox?l.boundingBox.toJSON():void 0,boundingSphere:l.boundingSphere?l.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(l=>({...l})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function r(l,u){return l[u.uuid]===void 0&&(l[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const u=l.shapes;if(Array.isArray(u))for(let f=0,p=u.length;f<p;f++){const g=u[f];r(e.shapes,g)}else r(e.shapes,u)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let u=0,f=this.material.length;u<f;u++)l.push(r(e.materials,this.material[u]));s.material=l}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){const u=this.animations[l];s.animations.push(r(e.animations,u))}}if(t){const l=o(e.geometries),u=o(e.materials),f=o(e.textures),p=o(e.images),g=o(e.shapes),v=o(e.skeletons),x=o(e.animations),b=o(e.nodes);l.length>0&&(n.geometries=l),u.length>0&&(n.materials=u),f.length>0&&(n.textures=f),p.length>0&&(n.images=p),g.length>0&&(n.shapes=g),v.length>0&&(n.skeletons=v),x.length>0&&(n.animations=x),b.length>0&&(n.nodes=b)}return n.object=s,n;function o(l){const u=[];for(const f in l){const p=l[f];delete p.metadata,u.push(p)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}zn.DEFAULT_UP=new re(0,1,0);zn.DEFAULT_MATRIX_AUTO_UPDATE=!0;zn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _l=new re,pu=new re,HM=new re,mu=new re,jp=new re,qp=new re,D3=new re,WM=new re,jM=new re,qM=new re,XM=new $n,YM=new $n,ZM=new $n;class za{constructor(e=new re,t=new re,n=new re){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),_l.subVectors(e,t),s.cross(_l);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,t,n,s,r){_l.subVectors(s,t),pu.subVectors(n,t),HM.subVectors(e,t);const o=_l.dot(_l),l=_l.dot(pu),u=_l.dot(HM),f=pu.dot(pu),p=pu.dot(HM),g=o*f-l*l;if(g===0)return r.set(0,0,0),null;const v=1/g,x=(f*u-l*p)*v,b=(o*p-l*u)*v;return r.set(1-x-b,b,x)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,mu)===null?!1:mu.x>=0&&mu.y>=0&&mu.x+mu.y<=1}static getInterpolation(e,t,n,s,r,o,l,u){return this.getBarycoord(e,t,n,s,mu)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(r,mu.x),u.addScaledVector(o,mu.y),u.addScaledVector(l,mu.z),u)}static getInterpolatedAttribute(e,t,n,s,r,o){return XM.setScalar(0),YM.setScalar(0),ZM.setScalar(0),XM.fromBufferAttribute(e,t),YM.fromBufferAttribute(e,n),ZM.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(XM,r.x),o.addScaledVector(YM,r.y),o.addScaledVector(ZM,r.z),o}static isFrontFacing(e,t,n,s){return _l.subVectors(n,t),pu.subVectors(e,t),_l.cross(pu).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _l.subVectors(this.c,this.b),pu.subVectors(this.a,this.b),_l.cross(pu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return za.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return za.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,s,r){return za.getInterpolation(e,this.a,this.b,this.c,t,n,s,r)}containsPoint(e){return za.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return za.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,r=this.c;let o,l;jp.subVectors(s,n),qp.subVectors(r,n),WM.subVectors(e,n);const u=jp.dot(WM),f=qp.dot(WM);if(u<=0&&f<=0)return t.copy(n);jM.subVectors(e,s);const p=jp.dot(jM),g=qp.dot(jM);if(p>=0&&g<=p)return t.copy(s);const v=u*g-p*f;if(v<=0&&u>=0&&p<=0)return o=u/(u-p),t.copy(n).addScaledVector(jp,o);qM.subVectors(e,r);const x=jp.dot(qM),b=qp.dot(qM);if(b>=0&&x<=b)return t.copy(r);const w=x*f-u*b;if(w<=0&&f>=0&&b<=0)return l=f/(f-b),t.copy(n).addScaledVector(qp,l);const M=p*b-x*g;if(M<=0&&g-p>=0&&x-b>=0)return D3.subVectors(r,s),l=(g-p)/(g-p+(x-b)),t.copy(s).addScaledVector(D3,l);const S=1/(M+w+v);return o=w*S,l=v*S,t.copy(n).addScaledVector(jp,o).addScaledVector(qp,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const vP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ah={h:0,s:0,l:0},J_={h:0,s:0,l:0};function KM(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class St{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ir){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,On.colorSpaceToWorking(this,t),this}setRGB(e,t,n,s=On.workingColorSpace){return this.r=e,this.g=t,this.b=n,On.colorSpaceToWorking(this,s),this}setHSL(e,t,n,s=On.workingColorSpace){if(e=kA(e,1),t=Qt(t,0,1),n=Qt(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=KM(o,r,e+1/3),this.g=KM(o,r,e),this.b=KM(o,r,e-1/3)}return On.colorSpaceToWorking(this,s),this}setStyle(e,t=Ir){function n(r){r!==void 0&&parseFloat(r)<1&&Tt("Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=s[1],l=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:Tt("Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);Tt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ir){const n=vP[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Tt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Su(e.r),this.g=Su(e.g),this.b=Su(e.b),this}copyLinearToSRGB(e){return this.r=Tm(e.r),this.g=Tm(e.g),this.b=Tm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ir){return On.workingToColorSpace(Dr.copy(this),e),Math.round(Qt(Dr.r*255,0,255))*65536+Math.round(Qt(Dr.g*255,0,255))*256+Math.round(Qt(Dr.b*255,0,255))}getHexString(e=Ir){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=On.workingColorSpace){On.workingToColorSpace(Dr.copy(this),t);const n=Dr.r,s=Dr.g,r=Dr.b,o=Math.max(n,s,r),l=Math.min(n,s,r);let u,f;const p=(l+o)/2;if(l===o)u=0,f=0;else{const g=o-l;switch(f=p<=.5?g/(o+l):g/(2-o-l),o){case n:u=(s-r)/g+(s<r?6:0);break;case s:u=(r-n)/g+2;break;case r:u=(n-s)/g+4;break}u/=6}return e.h=u,e.s=f,e.l=p,e}getRGB(e,t=On.workingColorSpace){return On.workingToColorSpace(Dr.copy(this),t),e.r=Dr.r,e.g=Dr.g,e.b=Dr.b,e}getStyle(e=Ir){On.workingToColorSpace(Dr.copy(this),e);const t=Dr.r,n=Dr.g,s=Dr.b;return e!==Ir?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,t,n){return this.getHSL(Ah),this.setHSL(Ah.h+e,Ah.s+t,Ah.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Ah),e.getHSL(J_);const n=nv(Ah.h,J_.h,t),s=nv(Ah.s,J_.s,t),r=nv(Ah.l,J_.l,t);return this.setHSL(n,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*s,this.g=r[1]*t+r[4]*n+r[7]*s,this.b=r[2]*t+r[5]*n+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Dr=new St;St.NAMES=vP;let Z2=0;class kr extends Ec{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Z2++}),this.uuid=lo(),this.name="",this.type="Material",this.blending=pd,this.side=Eu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=ub,this.blendDst=hb,this.blendEquation=Ih,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new St(0,0,0),this.blendAlpha=0,this.depthFunc=xd,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=hw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=nd,this.stencilZFail=nd,this.stencilZPass=nd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Tt(`Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){Tt(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==pd&&(n.blending=this.blending),this.side!==Eu&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==ub&&(n.blendSrc=this.blendSrc),this.blendDst!==hb&&(n.blendDst=this.blendDst),this.blendEquation!==Ih&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==xd&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==hw&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==nd&&(n.stencilFail=this.stencilFail),this.stencilZFail!==nd&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==nd&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(r){const o=[];for(const l in r){const u=r[l];delete u.metadata,o.push(u)}return o}if(t){const r=s(e.textures),o=s(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const s=t.length;n=new Array(s);for(let r=0;r!==s;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Iu extends kr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.combine=Gv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const bu=K2();function K2(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),s=new Uint32Array(512);for(let u=0;u<256;++u){const f=u-127;f<-27?(n[u]=0,n[u|256]=32768,s[u]=24,s[u|256]=24):f<-14?(n[u]=1024>>-f-14,n[u|256]=1024>>-f-14|32768,s[u]=-f-1,s[u|256]=-f-1):f<=15?(n[u]=f+15<<10,n[u|256]=f+15<<10|32768,s[u]=13,s[u|256]=13):f<128?(n[u]=31744,n[u|256]=64512,s[u]=24,s[u|256]=24):(n[u]=31744,n[u|256]=64512,s[u]=13,s[u|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),l=new Uint32Array(64);for(let u=1;u<1024;++u){let f=u<<13,p=0;for(;(f&8388608)===0;)f<<=1,p-=8388608;f&=-8388609,p+=947912704,r[u]=f|p}for(let u=1024;u<2048;++u)r[u]=939524096+(u-1024<<13);for(let u=1;u<31;++u)o[u]=u<<23;o[31]=1199570944,o[32]=2147483648;for(let u=33;u<63;++u)o[u]=2147483648+(u-32<<23);o[63]=3347054592;for(let u=1;u<64;++u)u!==32&&(l[u]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:s,mantissaTable:r,exponentTable:o,offsetTable:l}}function La(i){Math.abs(i)>65504&&Tt("DataUtils.toHalfFloat(): Value out of range."),i=Qt(i,-65504,65504),bu.floatView[0]=i;const e=bu.uint32View[0],t=e>>23&511;return bu.baseTable[t]+((e&8388607)>>bu.shiftTable[t])}function G0(i){const e=i>>10;return bu.uint32View[0]=bu.mantissaTable[bu.offsetTable[e]+(i&1023)]+bu.exponentTable[e],bu.floatView[0]}class Q2{static toHalfFloat(e){return La(e)}static fromHalfFloat(e){return G0(e)}}const Cs=new re,$_=new st;let J2=0;class li{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:J2++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=bv,this.updateRanges=[],this.gpuType=Pr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)$_.fromBufferAttribute(this,t),$_.applyMatrix3(e),this.setXY(t,$_.x,$_.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Cs.fromBufferAttribute(this,t),Cs.applyMatrix3(e),this.setXYZ(t,Cs.x,Cs.y,Cs.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Cs.fromBufferAttribute(this,t),Cs.applyMatrix4(e),this.setXYZ(t,Cs.x,Cs.y,Cs.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Cs.fromBufferAttribute(this,t),Cs.applyNormalMatrix(e),this.setXYZ(t,Cs.x,Cs.y,Cs.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Cs.fromBufferAttribute(this,t),Cs.transformDirection(e),this.setXYZ(t,Cs.x,Cs.y,Cs.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=aa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=dn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=aa(t,this.array)),t}setX(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=aa(t,this.array)),t}setY(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=aa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=aa(t,this.array)),t}setW(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array),s=dn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array),s=dn(s,this.array),r=dn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==bv&&(e.usage=this.usage),e}}class $2 extends li{constructor(e,t,n){super(new Int8Array(e),t,n)}}class e5 extends li{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class t5 extends li{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class n5 extends li{constructor(e,t,n){super(new Int16Array(e),t,n)}}class zA extends li{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class i5 extends li{constructor(e,t,n){super(new Int32Array(e),t,n)}}class VA extends li{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class s5 extends li{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=G0(this.array[e*this.itemSize]);return this.normalized&&(t=aa(t,this.array)),t}setX(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize]=La(t),this}getY(e){let t=G0(this.array[e*this.itemSize+1]);return this.normalized&&(t=aa(t,this.array)),t}setY(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize+1]=La(t),this}getZ(e){let t=G0(this.array[e*this.itemSize+2]);return this.normalized&&(t=aa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize+2]=La(t),this}getW(e){let t=G0(this.array[e*this.itemSize+3]);return this.normalized&&(t=aa(t,this.array)),t}setW(e,t){return this.normalized&&(t=dn(t,this.array)),this.array[e*this.itemSize+3]=La(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array)),this.array[e+0]=La(t),this.array[e+1]=La(n),this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array),s=dn(s,this.array)),this.array[e+0]=La(t),this.array[e+1]=La(n),this.array[e+2]=La(s),this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array),s=dn(s,this.array),r=dn(r,this.array)),this.array[e+0]=La(t),this.array[e+1]=La(n),this.array[e+2]=La(s),this.array[e+3]=La(r),this}}class It extends li{constructor(e,t,n){super(new Float32Array(e),t,n)}}let r5=0;const Go=new Kt,QM=new zn,Xp=new re,so=new $s,R0=new $s,Js=new re;class nn extends Ec{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:r5++}),this.uuid=lo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(dP(e)?VA:zA)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new on().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Go.makeRotationFromQuaternion(e),this.applyMatrix4(Go),this}rotateX(e){return Go.makeRotationX(e),this.applyMatrix4(Go),this}rotateY(e){return Go.makeRotationY(e),this.applyMatrix4(Go),this}rotateZ(e){return Go.makeRotationZ(e),this.applyMatrix4(Go),this}translate(e,t,n){return Go.makeTranslation(e,t,n),this.applyMatrix4(Go),this}scale(e,t,n){return Go.makeScale(e,t,n),this.applyMatrix4(Go),this}lookAt(e){return QM.lookAt(e),QM.updateMatrix(),this.applyMatrix4(QM.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xp).negate(),this.translate(Xp.x,Xp.y,Xp.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new It(n,3))}else{const n=Math.min(e.length,t.count);for(let s=0;s<n;s++){const r=e[s];t.setXYZ(s,r.x,r.y,r.z||0)}e.length>t.count&&Tt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new $s);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){kt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new re(-1/0,-1/0,-1/0),new re(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){const r=t[n];so.setFromBufferAttribute(r),this.morphTargetsRelative?(Js.addVectors(this.boundingBox.min,so.min),this.boundingBox.expandByPoint(Js),Js.addVectors(this.boundingBox.max,so.max),this.boundingBox.expandByPoint(Js)):(this.boundingBox.expandByPoint(so.min),this.boundingBox.expandByPoint(so.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&kt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new er);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){kt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new re,1/0);return}if(e){const n=this.boundingSphere.center;if(so.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const l=t[r];R0.setFromBufferAttribute(l),this.morphTargetsRelative?(Js.addVectors(so.min,R0.min),so.expandByPoint(Js),Js.addVectors(so.max,R0.max),so.expandByPoint(Js)):(so.expandByPoint(R0.min),so.expandByPoint(R0.max))}so.getCenter(n);let s=0;for(let r=0,o=e.count;r<o;r++)Js.fromBufferAttribute(e,r),s=Math.max(s,n.distanceToSquared(Js));if(t)for(let r=0,o=t.length;r<o;r++){const l=t[r],u=this.morphTargetsRelative;for(let f=0,p=l.count;f<p;f++)Js.fromBufferAttribute(l,f),u&&(Xp.fromBufferAttribute(e,f),Js.add(Xp)),s=Math.max(s,n.distanceToSquared(Js))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&kt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){kt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,s=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new li(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),l=[],u=[];for(let k=0;k<n.count;k++)l[k]=new re,u[k]=new re;const f=new re,p=new re,g=new re,v=new st,x=new st,b=new st,w=new re,M=new re;function S(k,P,F){f.fromBufferAttribute(n,k),p.fromBufferAttribute(n,P),g.fromBufferAttribute(n,F),v.fromBufferAttribute(r,k),x.fromBufferAttribute(r,P),b.fromBufferAttribute(r,F),p.sub(f),g.sub(f),x.sub(v),b.sub(v);const H=1/(x.x*b.y-b.x*x.y);isFinite(H)&&(w.copy(p).multiplyScalar(b.y).addScaledVector(g,-x.y).multiplyScalar(H),M.copy(g).multiplyScalar(x.x).addScaledVector(p,-b.x).multiplyScalar(H),l[k].add(w),l[P].add(w),l[F].add(w),u[k].add(M),u[P].add(M),u[F].add(M))}let C=this.groups;C.length===0&&(C=[{start:0,count:e.count}]);for(let k=0,P=C.length;k<P;++k){const F=C[k],H=F.start,G=F.count;for(let j=H,K=H+G;j<K;j+=3)S(e.getX(j+0),e.getX(j+1),e.getX(j+2))}const R=new re,I=new re,D=new re,O=new re;function U(k){D.fromBufferAttribute(s,k),O.copy(D);const P=l[k];R.copy(P),R.sub(D.multiplyScalar(D.dot(P))).normalize(),I.crossVectors(O,P);const H=I.dot(u[k])<0?-1:1;o.setXYZW(k,R.x,R.y,R.z,H)}for(let k=0,P=C.length;k<P;++k){const F=C[k],H=F.start,G=F.count;for(let j=H,K=H+G;j<K;j+=3)U(e.getX(j+0)),U(e.getX(j+1)),U(e.getX(j+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new li(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let v=0,x=n.count;v<x;v++)n.setXYZ(v,0,0,0);const s=new re,r=new re,o=new re,l=new re,u=new re,f=new re,p=new re,g=new re;if(e)for(let v=0,x=e.count;v<x;v+=3){const b=e.getX(v+0),w=e.getX(v+1),M=e.getX(v+2);s.fromBufferAttribute(t,b),r.fromBufferAttribute(t,w),o.fromBufferAttribute(t,M),p.subVectors(o,r),g.subVectors(s,r),p.cross(g),l.fromBufferAttribute(n,b),u.fromBufferAttribute(n,w),f.fromBufferAttribute(n,M),l.add(p),u.add(p),f.add(p),n.setXYZ(b,l.x,l.y,l.z),n.setXYZ(w,u.x,u.y,u.z),n.setXYZ(M,f.x,f.y,f.z)}else for(let v=0,x=t.count;v<x;v+=3)s.fromBufferAttribute(t,v+0),r.fromBufferAttribute(t,v+1),o.fromBufferAttribute(t,v+2),p.subVectors(o,r),g.subVectors(s,r),p.cross(g),n.setXYZ(v+0,p.x,p.y,p.z),n.setXYZ(v+1,p.x,p.y,p.z),n.setXYZ(v+2,p.x,p.y,p.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Js.fromBufferAttribute(e,t),Js.normalize(),e.setXYZ(t,Js.x,Js.y,Js.z)}toNonIndexed(){function e(l,u){const f=l.array,p=l.itemSize,g=l.normalized,v=new f.constructor(u.length*p);let x=0,b=0;for(let w=0,M=u.length;w<M;w++){l.isInterleavedBufferAttribute?x=u[w]*l.data.stride+l.offset:x=u[w]*p;for(let S=0;S<p;S++)v[b++]=f[x++]}return new li(v,p,g)}if(this.index===null)return Tt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new nn,n=this.index.array,s=this.attributes;for(const l in s){const u=s[l],f=e(u,n);t.setAttribute(l,f)}const r=this.morphAttributes;for(const l in r){const u=[],f=r[l];for(let p=0,g=f.length;p<g;p++){const v=f[p],x=e(v,n);u.push(x)}t.morphAttributes[l]=u}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,u=o.length;l<u;l++){const f=o[l];t.addGroup(f.start,f.count,f.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const f in u)u[f]!==void 0&&(e[f]=u[f]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n){const f=n[u];e.data.attributes[u]=f.toJSON(e.data)}const s={};let r=!1;for(const u in this.morphAttributes){const f=this.morphAttributes[u],p=[];for(let g=0,v=f.length;g<v;g++){const x=f[g];p.push(x.toJSON(e.data))}p.length>0&&(s[u]=p,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere=l.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const s=e.attributes;for(const f in s){const p=s[f];this.setAttribute(f,p.clone(t))}const r=e.morphAttributes;for(const f in r){const p=[],g=r[f];for(let v=0,x=g.length;v<x;v++)p.push(g[v].clone(t));this.morphAttributes[f]=p}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let f=0,p=o.length;f<p;f++){const g=o[f];this.addGroup(g.start,g.count,g.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const N3=new Kt,Bf=new Nd,ex=new er,I3=new re,tx=new re,nx=new re,ix=new re,JM=new re,sx=new re,O3=new re,rx=new re;class Qi extends zn{constructor(e=new nn,t=new Iu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const l=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}getVertexPosition(e,t){const n=this.geometry,s=n.attributes.position,r=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(s,e);const l=this.morphTargetInfluences;if(r&&l){sx.set(0,0,0);for(let u=0,f=r.length;u<f;u++){const p=l[u],g=r[u];p!==0&&(JM.fromBufferAttribute(g,e),o?sx.addScaledVector(JM,p):sx.addScaledVector(JM.sub(t),p))}t.add(sx)}return t}raycast(e,t){const n=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),ex.copy(n.boundingSphere),ex.applyMatrix4(r),Bf.copy(e.ray).recast(e.near),!(ex.containsPoint(Bf.origin)===!1&&(Bf.intersectSphere(ex,I3)===null||Bf.origin.distanceToSquared(I3)>(e.far-e.near)**2))&&(N3.copy(r).invert(),Bf.copy(e.ray).applyMatrix4(N3),!(n.boundingBox!==null&&Bf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Bf)))}_computeIntersections(e,t,n){let s;const r=this.geometry,o=this.material,l=r.index,u=r.attributes.position,f=r.attributes.uv,p=r.attributes.uv1,g=r.attributes.normal,v=r.groups,x=r.drawRange;if(l!==null)if(Array.isArray(o))for(let b=0,w=v.length;b<w;b++){const M=v[b],S=o[M.materialIndex],C=Math.max(M.start,x.start),R=Math.min(l.count,Math.min(M.start+M.count,x.start+x.count));for(let I=C,D=R;I<D;I+=3){const O=l.getX(I),U=l.getX(I+1),k=l.getX(I+2);s=ax(this,S,e,n,f,p,g,O,U,k),s&&(s.faceIndex=Math.floor(I/3),s.face.materialIndex=M.materialIndex,t.push(s))}}else{const b=Math.max(0,x.start),w=Math.min(l.count,x.start+x.count);for(let M=b,S=w;M<S;M+=3){const C=l.getX(M),R=l.getX(M+1),I=l.getX(M+2);s=ax(this,o,e,n,f,p,g,C,R,I),s&&(s.faceIndex=Math.floor(M/3),t.push(s))}}else if(u!==void 0)if(Array.isArray(o))for(let b=0,w=v.length;b<w;b++){const M=v[b],S=o[M.materialIndex],C=Math.max(M.start,x.start),R=Math.min(u.count,Math.min(M.start+M.count,x.start+x.count));for(let I=C,D=R;I<D;I+=3){const O=I,U=I+1,k=I+2;s=ax(this,S,e,n,f,p,g,O,U,k),s&&(s.faceIndex=Math.floor(I/3),s.face.materialIndex=M.materialIndex,t.push(s))}}else{const b=Math.max(0,x.start),w=Math.min(u.count,x.start+x.count);for(let M=b,S=w;M<S;M+=3){const C=M,R=M+1,I=M+2;s=ax(this,o,e,n,f,p,g,C,R,I),s&&(s.faceIndex=Math.floor(M/3),t.push(s))}}}}function a5(i,e,t,n,s,r,o,l){let u;if(e.side===Lr?u=n.intersectTriangle(o,r,s,!0,l):u=n.intersectTriangle(s,r,o,e.side===Eu,l),u===null)return null;rx.copy(l),rx.applyMatrix4(i.matrixWorld);const f=t.ray.origin.distanceTo(rx);return f<t.near||f>t.far?null:{distance:f,point:rx.clone(),object:i}}function ax(i,e,t,n,s,r,o,l,u,f){i.getVertexPosition(l,tx),i.getVertexPosition(u,nx),i.getVertexPosition(f,ix);const p=a5(i,e,t,n,tx,nx,ix,O3);if(p){const g=new re;za.getBarycoord(O3,tx,nx,ix,g),s&&(p.uv=za.getInterpolatedAttribute(s,l,u,f,g,new st)),r&&(p.uv1=za.getInterpolatedAttribute(r,l,u,f,g,new st)),o&&(p.normal=za.getInterpolatedAttribute(o,l,u,f,g,new re),p.normal.dot(n.direction)>0&&p.normal.multiplyScalar(-1));const v={a:l,b:u,c:f,normal:new re,materialIndex:0};za.getNormal(tx,nx,ix,v.normal),p.face=v,p.barycoord=g}return p}class Id extends nn{constructor(e=1,t=1,n=1,s=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:r,depthSegments:o};const l=this;s=Math.floor(s),r=Math.floor(r),o=Math.floor(o);const u=[],f=[],p=[],g=[];let v=0,x=0;b("z","y","x",-1,-1,n,t,e,o,r,0),b("z","y","x",1,-1,n,t,-e,o,r,1),b("x","z","y",1,1,e,n,t,s,o,2),b("x","z","y",1,-1,e,n,-t,s,o,3),b("x","y","z",1,-1,e,t,n,s,r,4),b("x","y","z",-1,-1,e,t,-n,s,r,5),this.setIndex(u),this.setAttribute("position",new It(f,3)),this.setAttribute("normal",new It(p,3)),this.setAttribute("uv",new It(g,2));function b(w,M,S,C,R,I,D,O,U,k,P){const F=I/U,H=D/k,G=I/2,j=D/2,K=O/2,te=U+1,W=k+1;let X=0,oe=0;const ne=new re;for(let ie=0;ie<W;ie++){const B=ie*H-j;for(let Q=0;Q<te;Q++){const ae=Q*F-G;ne[w]=ae*C,ne[M]=B*R,ne[S]=K,f.push(ne.x,ne.y,ne.z),ne[w]=0,ne[M]=0,ne[S]=O>0?1:-1,p.push(ne.x,ne.y,ne.z),g.push(Q/U),g.push(1-ie/k),X+=1}}for(let ie=0;ie<k;ie++)for(let B=0;B<U;B++){const Q=v+B+te*ie,ae=v+B+te*(ie+1),fe=v+(B+1)+te*(ie+1),de=v+(B+1)+te*ie;u.push(Q,ae,de),u.push(ae,fe,de),oe+=6}l.addGroup(x,oe,P),x+=oe,v+=X}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Id(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Pm(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const s=i[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(Tt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():Array.isArray(s)?e[t][n]=s.slice():e[t][n]=s}}return e}function na(i){const e={};for(let t=0;t<i.length;t++){const n=Pm(i[t]);for(const s in n)e[s]=n[s]}return e}function o5(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function yP(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:On.workingColorSpace}const GA={clone:Pm,merge:na};var l5=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,c5=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ho extends kr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=l5,this.fragmentShader=c5,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Pm(e.uniforms),this.uniformsGroups=o5(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?t.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[s]={type:"m4",value:o.toArray()}:t.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class z1 extends zn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Kt,this.projectionMatrix=new Kt,this.projectionMatrixInverse=new Kt,this.coordinateSystem=ao,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Eh=new re,P3=new st,U3=new st;let ps=class extends z1{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Im*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(gd*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Im*2*Math.atan(Math.tan(gd*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Eh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Eh.x,Eh.y).multiplyScalar(-e/Eh.z),Eh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Eh.x,Eh.y).multiplyScalar(-e/Eh.z)}getViewSize(e,t){return this.getViewBounds(e,P3,U3),t.subVectors(U3,P3)}setViewOffset(e,t,n,s,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(gd*.5*this.fov)/this.zoom,n=2*t,s=this.aspect*n,r=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const u=o.fullWidth,f=o.fullHeight;r+=o.offsetX*s/u,t-=o.offsetY*n/f,s*=o.width/u,n*=o.height/f}const l=this.filmOffset;l!==0&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Yp=-90,Zp=1;class _P extends zn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new ps(Yp,Zp,e,t);s.layers=this.layers,this.add(s);const r=new ps(Yp,Zp,e,t);r.layers=this.layers,this.add(r);const o=new ps(Yp,Zp,e,t);o.layers=this.layers,this.add(o);const l=new ps(Yp,Zp,e,t);l.layers=this.layers,this.add(l);const u=new ps(Yp,Zp,e,t);u.layers=this.layers,this.add(u);const f=new ps(Yp,Zp,e,t);f.layers=this.layers,this.add(f)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,r,o,l,u]=t;for(const f of t)this.remove(f);if(e===ao)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===Dm)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const f of t)this.add(f),f.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,l,u,f,p]=this.children,g=e.getRenderTarget(),v=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;const w=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(t,r),e.setRenderTarget(n,1,s),e.render(t,o),e.setRenderTarget(n,2,s),e.render(t,l),e.setRenderTarget(n,3,s),e.render(t,u),e.setRenderTarget(n,4,s),e.render(t,f),n.texture.generateMipmaps=w,e.setRenderTarget(n,5,s),e.render(t,p),e.setRenderTarget(g,v,x),e.xr.enabled=b,n.texture.needsPMREMUpdate=!0}}class Wv extends Ki{constructor(e=[],t=Sc,n,s,r,o,l,u,f,p){super(e,t,n,s,r,o,l,u,f,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class HA extends Ha{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new Wv(s),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Id(5,5,5),r=new ho({name:"CubemapFromEquirect",uniforms:Pm(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Lr,blending:bc});r.uniforms.tEquirect.value=t;const o=new Qi(s,r),l=t.minFilter;return t.minFilter===vc&&(t.minFilter=ti),new _P(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,s=!0){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,s);e.setRenderTarget(r)}}class ym extends zn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const u5={type:"move"};class Kx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ym,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ym,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new re,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new re),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ym,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new re,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new re),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let s=null,r=null,o=null;const l=this._targetRay,u=this._grip,f=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(f&&e.hand){o=!0;for(const w of e.hand.values()){const M=t.getJointPose(w,n),S=this._getHandJoint(f,w);M!==null&&(S.matrix.fromArray(M.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=M.radius),S.visible=M!==null}const p=f.joints["index-finger-tip"],g=f.joints["thumb-tip"],v=p.position.distanceTo(g.position),x=.02,b=.005;f.inputState.pinching&&v>x+b?(f.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!f.inputState.pinching&&v<=x-b&&(f.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(u.matrix.fromArray(r.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,r.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(r.linearVelocity)):u.hasLinearVelocity=!1,r.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(r.angularVelocity)):u.hasAngularVelocity=!1));l!==null&&(s=t.getPose(e.targetRaySpace,n),s===null&&r!==null&&(s=r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(u5)))}return l!==null&&(l.visible=s!==null),u!==null&&(u.visible=r!==null),f!==null&&(f.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new ym;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class V1{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new St(e),this.density=t}clone(){return new V1(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class G1{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new St(e),this.near=t,this.far=n}clone(){return new G1(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class WA extends zn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new uo,this.environmentIntensity=1,this.environmentRotation=new uo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class H1{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=bv,this.updateRanges=[],this.version=0,this.uuid=lo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ta=new re;class Sd{constructor(e,t,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.applyMatrix4(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.applyNormalMatrix(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.transformDirection(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=aa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=dn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=dn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=dn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=dn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=dn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=aa(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=aa(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=aa(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=aa(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array),s=dn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=dn(t,this.array),n=dn(n,this.array),s=dn(s,this.array),r=dn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){Mv("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return new li(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Sd(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){Mv("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class jA extends kr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Kp;const D0=new re,Qp=new re,Jp=new re,$p=new st,N0=new st,xP=new Kt,ox=new re,I0=new re,lx=new re,L3=new st,$M=new st,F3=new st;class bP extends zn{constructor(e=new jA){if(super(),this.isSprite=!0,this.type="Sprite",Kp===void 0){Kp=new nn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new H1(t,5);Kp.setIndex([0,1,2,0,2,3]),Kp.setAttribute("position",new Sd(n,3,0,!1)),Kp.setAttribute("uv",new Sd(n,2,3,!1))}this.geometry=Kp,this.material=e,this.center=new st(.5,.5),this.count=1}raycast(e,t){e.camera===null&&kt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Qp.setFromMatrixScale(this.matrixWorld),xP.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Jp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Qp.multiplyScalar(-Jp.z);const n=this.material.rotation;let s,r;n!==0&&(r=Math.cos(n),s=Math.sin(n));const o=this.center;cx(ox.set(-.5,-.5,0),Jp,o,Qp,s,r),cx(I0.set(.5,-.5,0),Jp,o,Qp,s,r),cx(lx.set(.5,.5,0),Jp,o,Qp,s,r),L3.set(0,0),$M.set(1,0),F3.set(1,1);let l=e.ray.intersectTriangle(ox,I0,lx,!1,D0);if(l===null&&(cx(I0.set(-.5,.5,0),Jp,o,Qp,s,r),$M.set(0,1),l=e.ray.intersectTriangle(ox,lx,I0,!1,D0),l===null))return;const u=e.ray.origin.distanceTo(D0);u<e.near||u>e.far||t.push({distance:u,point:D0.clone(),uv:za.getInterpolation(D0,ox,I0,lx,L3,$M,F3,new st),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function cx(i,e,t,n,s,r){$p.subVectors(i,t).addScalar(.5).multiply(n),s!==void 0?(N0.x=r*$p.x-s*$p.y,N0.y=s*$p.x+r*$p.y):N0.copy($p),i.copy(e),i.x+=N0.x,i.y+=N0.y,i.applyMatrix4(xP)}const ux=new re,k3=new re;class SP extends zn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,s=t.length;n<s;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const s=this.levels;let r;for(r=0;r<s.length&&!(t<s[r].distance);r++);return s.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const s=t.splice(n,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,s;for(n=1,s=t.length;n<s;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ux.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(ux);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ux.setFromMatrixPosition(e.matrixWorld),k3.setFromMatrixPosition(this.matrixWorld);const n=ux.distanceTo(k3)/e.zoom;t[0].object.visible=!0;let s,r;for(s=1,r=t.length;s<r;s++){let o=t[s].distance;if(t[s].object.visible&&(o-=o*t[s].hysteresis),n>=o)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<r;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let s=0,r=n.length;s<r;s++){const o=n[s];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const B3=new re,z3=new $n,V3=new $n,h5=new re,G3=new Kt,hx=new re,eT=new er,H3=new Kt,tT=new Nd;class MP extends Qi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=uw,this.bindMatrix=new Kt,this.bindMatrixInverse=new Kt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new $s),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,hx),this.boundingBox.expandByPoint(hx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new er),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,hx),this.boundingSphere.expandByPoint(hx)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),eT.copy(this.boundingSphere),eT.applyMatrix4(s),e.ray.intersectsSphere(eT)!==!1&&(H3.copy(s).invert(),tT.copy(e.ray).applyMatrix4(H3),!(this.boundingBox!==null&&tT.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,tT)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new $n,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===uw?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===eP?this.bindMatrixInverse.copy(this.bindMatrix).invert():Tt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;z3.fromBufferAttribute(s.attributes.skinIndex,e),V3.fromBufferAttribute(s.attributes.skinWeight,e),B3.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=V3.getComponent(r);if(o!==0){const l=z3.getComponent(r);G3.multiplyMatrices(n.bones[l].matrixWorld,n.boneInverses[l]),t.addScaledVector(h5.copy(B3).applyMatrix4(G3),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class qA extends zn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Al extends Ki{constructor(e=null,t=1,n=1,s,r,o,l,u,f=ms,p=ms,g,v){super(null,o,l,u,f,p,s,r,g,v),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const W3=new Kt,f5=new Kt;class W1{constructor(e=[],t=[]){this.uuid=lo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Tt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new Kt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Kt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const l=e[r]?e[r].matrixWorld:f5;W3.multiplyMatrices(l,t[r]),W3.toArray(n,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new W1(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Al(t,e,e,Ur,Pr);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const r=e.bones[n];let o=t[r];o===void 0&&(Tt("Skeleton: No bone found with UUID:",r),o=new qA),this.bones.push(o),this.boneInverses.push(new Kt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,r=t.length;s<r;s++){const o=t[s];e.bones.push(o.uuid);const l=n[s];e.boneInverses.push(l.toArray())}return e}}class Md extends li{constructor(e,t,n,s=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const em=new Kt,j3=new Kt,fx=[],q3=new $s,d5=new Kt,O0=new Qi,P0=new er;class TP extends Qi{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Md(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,d5)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new $s),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,em),q3.copy(e.boundingBox).applyMatrix4(em),this.boundingBox.union(q3)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new er),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,em),P0.copy(e.boundingSphere).applyMatrix4(em),this.boundingSphere.union(P0)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,s=this.morphTexture.source.data.data,r=n.length+1,o=e*r+1;for(let l=0;l<n.length;l++)n[l]=s[o+l]}raycast(e,t){const n=this.matrixWorld,s=this.count;if(O0.geometry=this.geometry,O0.material=this.material,O0.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),P0.copy(this.boundingSphere),P0.applyMatrix4(n),e.ray.intersectsSphere(P0)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,em),j3.multiplyMatrices(n,em),O0.matrixWorld=j3,O0.raycast(e,fx);for(let o=0,l=fx.length;o<l;o++){const u=fx[o];u.instanceId=r,u.object=this,t.push(u)}fx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Md(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new Al(new Float32Array(s*this.count),s,this.count,I1,Pr));const r=this.morphTexture.source.data.data;let o=0;for(let f=0;f<n.length;f++)o+=n[f];const l=this.geometry.morphTargetsRelative?1:1-o,u=s*e;r[u]=l,r.set(n,u+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const nT=new re,p5=new re,m5=new on;class _u{constructor(e=new re(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=nT.subVectors(n,t).cross(p5.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(nT),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||m5.getNormalMatrix(e),s=this.coplanarPoint(nT).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const zf=new er,g5=new st(.5,.5),dx=new re;class Xm{constructor(e=new _u,t=new _u,n=new _u,s=new _u,r=new _u,o=new _u){this.planes=[e,t,n,s,r,o]}set(e,t,n,s,r,o){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(n),l[3].copy(s),l[4].copy(r),l[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=ao,n=!1){const s=this.planes,r=e.elements,o=r[0],l=r[1],u=r[2],f=r[3],p=r[4],g=r[5],v=r[6],x=r[7],b=r[8],w=r[9],M=r[10],S=r[11],C=r[12],R=r[13],I=r[14],D=r[15];if(s[0].setComponents(f-o,x-p,S-b,D-C).normalize(),s[1].setComponents(f+o,x+p,S+b,D+C).normalize(),s[2].setComponents(f+l,x+g,S+w,D+R).normalize(),s[3].setComponents(f-l,x-g,S-w,D-R).normalize(),n)s[4].setComponents(u,v,M,I).normalize(),s[5].setComponents(f-u,x-v,S-M,D-I).normalize();else if(s[4].setComponents(f-u,x-v,S-M,D-I).normalize(),t===ao)s[5].setComponents(f+u,x+v,S+M,D+I).normalize();else if(t===Dm)s[5].setComponents(u,v,M,I).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),zf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),zf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(zf)}intersectsSprite(e){zf.center.set(0,0,0);const t=g5.distanceTo(e.center);return zf.radius=.7071067811865476+t,zf.applyMatrix4(e.matrixWorld),this.intersectsSphere(zf)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(dx.x=s.normal.x>0?e.max.x:e.min.x,dx.y=s.normal.y>0?e.max.y:e.min.y,dx.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(dx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const pc=new Kt,mc=new Xm;class j1{constructor(){this.coordinateSystem=ao}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(pc.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),mc.setFromProjectionMatrix(pc,s.coordinateSystem,s.reversedDepth),mc.containsPoint(e))return!0}return!1}clone(){return new j1}}function iT(i,e){return i-e}function v5(i,e){return i.z-e.z}function y5(i,e){return e.z-i.z}class _5{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,s){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const l=r[this.index];o.push(l),this.index++,l.start=e,l.count=t,l.z=n,l.index=s}reset(){this.list.length=0,this.index=0}}const Ua=new Kt,x5=new St(1,1,1),X3=new Xm,b5=new j1,px=new $s,Vf=new er,U0=new re,Y3=new re,S5=new re,sT=new _5,Nr=new Qi,mx=[];function M5(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const s=i.count;for(let r=0;r<s;r++)for(let o=0;o<n;o++)e.setComponent(r+t,o,i.getComponent(r,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Gf(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class wP extends Qi{constructor(e,t,n=t*2,s){super(new nn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Al(t,e,e,Ur,Pr);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Al(t,e,e,Hv,Ko);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Al(t,e,e,Ur,Pr);n.colorSpace=On.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const o=e.getAttribute(r),{array:l,itemSize:u,normalized:f}=o,p=new l.constructor(n*u),g=new li(p,u,f);t.setAttribute(r,g)}if(e.getIndex()!==null){const r=n>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new li(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),r=t.getAttribute(n);if(s.itemSize!==r.itemSize||s.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new $s);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,Ua),this.getBoundingBoxAt(r,px).applyMatrix4(Ua),e.union(px)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new er);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,Ua),this.getBoundingSphereAt(r,Vf).applyMatrix4(Ua),e.union(Vf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(iT),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=n):(s=this._instanceInfo.length,this._instanceInfo.push(n));const r=this._matricesTexture;Ua.identity().toArray(r.image.data,s*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(x5.toArray(o.image.data,s*4),o.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=n===-1?o.count:n),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let u;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(iT),u=this._availableGeometryIds.shift(),r[u]=s):(u=this._geometryCount,this._geometryCount++,r.push(s)),this.setGeometryAt(u,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,u}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,s=n.getIndex()!==null,r=n.getIndex(),o=t.getIndex(),l=this._geometryInfo[e];if(s&&o.count>l.reservedIndexCount||t.attributes.position.count>l.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const u=l.vertexStart,f=l.reservedVertexCount;l.vertexCount=t.getAttribute("position").count;for(const p in n.attributes){const g=t.getAttribute(p),v=n.getAttribute(p);M5(g,v,u);const x=g.itemSize;for(let b=g.count,w=f;b<w;b++){const M=u+b;for(let S=0;S<x;S++)v.setComponent(M,S,0)}v.needsUpdate=!0,v.addUpdateRange(u*x,f*x)}if(s){const p=l.indexStart,g=l.reservedIndexCount;l.indexCount=t.getIndex().count;for(let v=0;v<o.count;v++)r.setX(p+v,u+o.getX(v));for(let v=o.count,x=g;v<x;v++)r.setX(p+v,u);r.needsUpdate=!0,r.addUpdateRange(p,l.reservedIndexCount)}return l.start=s?l.indexStart:l.vertexStart,l.count=s?l.indexCount:l.vertexCount,l.boundingBox=null,t.boundingBox!==null&&(l.boundingBox=t.boundingBox.clone()),l.boundingSphere=null,t.boundingSphere!==null&&(l.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let s=0,r=n.length;s<r;s++)n[s].active&&n[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,s=n.map((o,l)=>l).sort((o,l)=>n[o].vertexStart-n[l].vertexStart),r=this.geometry;for(let o=0,l=n.length;o<l;o++){const u=s[o],f=n[u];if(f.active!==!1){if(r.index!==null){if(f.indexStart!==t){const{indexStart:p,vertexStart:g,reservedIndexCount:v}=f,x=r.index,b=x.array,w=e-g;for(let M=p;M<p+v;M++)b[M]=b[M]+w;x.array.copyWithin(t,p,p+v),x.addUpdateRange(t,v),x.needsUpdate=!0,f.indexStart=t}t+=f.reservedIndexCount}if(f.vertexStart!==e){const{vertexStart:p,reservedVertexCount:g}=f,v=r.attributes;for(const x in v){const b=v[x],{array:w,itemSize:M}=b;w.copyWithin(e*M,p*M,(p+g)*M),b.addUpdateRange(e*M,g*M),b.needsUpdate=!0}f.vertexStart=e}e+=f.reservedVertexCount,f.start=r.index?f.indexStart:f.vertexStart,this._nextIndexStart=r.index?f.indexStart+f.reservedIndexCount:0,this._nextVertexStart=f.vertexStart+f.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const r=new $s,o=n.index,l=n.attributes.position;for(let u=s.start,f=s.start+s.count;u<f;u++){let p=u;o&&(p=o.getX(p)),r.expandByPoint(U0.fromBufferAttribute(l,p))}s.boundingBox=r}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const r=new er;this.getBoundingBoxAt(e,px),px.getCenter(r.center);const o=n.index,l=n.attributes.position;let u=0;for(let f=s.start,p=s.start+s.count;f<p;f++){let g=f;o&&(g=o.getX(g)),U0.fromBufferAttribute(l,g),u=Math.max(u,r.center.distanceToSquared(U0))}r.radius=Math.sqrt(u),s.boundingSphere=r}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(iT);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),r=new Int32Array(e);Gf(this._multiDrawCounts,s),Gf(this._multiDrawStarts,r),this._multiDrawCounts=s,this._multiDrawStarts=r,this._maxInstanceCount=e;const o=this._indirectTexture,l=this._matricesTexture,u=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Gf(o.image.data,this._indirectTexture.image.data),l.dispose(),this._initMatricesTexture(),Gf(l.image.data,this._matricesTexture.image.data),u&&(u.dispose(),this._initColorsTexture(),Gf(u.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(l=>l.active);if(Math.max(...n.map(l=>l.vertexStart+l.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(u=>u.indexStart+u.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new nn,this._initializeGeometry(r));const o=this.geometry;r.index&&Gf(r.index.array,o.index.array);for(const l in r.attributes)Gf(r.attributes[l].array,o.attributes[l].array)}raycast(e,t){const n=this._instanceInfo,s=this._geometryInfo,r=this.matrixWorld,o=this.geometry;Nr.material=this.material,Nr.geometry.index=o.index,Nr.geometry.attributes=o.attributes,Nr.geometry.boundingBox===null&&(Nr.geometry.boundingBox=new $s),Nr.geometry.boundingSphere===null&&(Nr.geometry.boundingSphere=new er);for(let l=0,u=n.length;l<u;l++){if(!n[l].visible||!n[l].active)continue;const f=n[l].geometryIndex,p=s[f];Nr.geometry.setDrawRange(p.start,p.count),this.getMatrixAt(l,Nr.matrixWorld).premultiply(r),this.getBoundingBoxAt(f,Nr.geometry.boundingBox),this.getBoundingSphereAt(f,Nr.geometry.boundingSphere),Nr.raycast(e,mx);for(let g=0,v=mx.length;g<v;g++){const x=mx[g];x.object=this,x.batchId=l,t.push(x)}mx.length=0}Nr.material=null,Nr.geometry.index=null,Nr.geometry.attributes={},Nr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,s,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=s.getIndex(),l=o===null?1:o.array.BYTES_PER_ELEMENT,u=this._instanceInfo,f=this._multiDrawStarts,p=this._multiDrawCounts,g=this._geometryInfo,v=this.perObjectFrustumCulled,x=this._indirectTexture,b=x.image.data,w=n.isArrayCamera?b5:X3;v&&!n.isArrayCamera&&(Ua.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),X3.setFromProjectionMatrix(Ua,n.coordinateSystem,n.reversedDepth));let M=0;if(this.sortObjects){Ua.copy(this.matrixWorld).invert(),U0.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Ua),Y3.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Ua);for(let R=0,I=u.length;R<I;R++)if(u[R].visible&&u[R].active){const D=u[R].geometryIndex;this.getMatrixAt(R,Ua),this.getBoundingSphereAt(D,Vf).applyMatrix4(Ua);let O=!1;if(v&&(O=!w.intersectsSphere(Vf,n)),!O){const U=g[D],k=S5.subVectors(Vf.center,U0).dot(Y3);sT.push(U.start,U.count,k,R)}}const S=sT.list,C=this.customSort;C===null?S.sort(r.transparent?y5:v5):C.call(this,S,n);for(let R=0,I=S.length;R<I;R++){const D=S[R];f[M]=D.start*l,p[M]=D.count,b[M]=D.index,M++}sT.reset()}else for(let S=0,C=u.length;S<C;S++)if(u[S].visible&&u[S].active){const R=u[S].geometryIndex;let I=!1;if(v&&(this.getMatrixAt(S,Ua),this.getBoundingSphereAt(R,Vf).applyMatrix4(Ua),I=!w.intersectsSphere(Vf,n)),!I){const D=g[R];f[M]=D.start*l,p[M]=D.count,b[M]=S,M++}}x.needsUpdate=!0,this._multiDrawCount=M,this._visibilityChanged=!1}onBeforeShadow(e,t,n,s,r,o){this.onBeforeRender(e,null,s,r,o)}}class ua extends kr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new St(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Jb=new re,$b=new re,Z3=new Kt,L0=new Nd,gx=new er,rT=new re,K3=new re;class Wh extends zn{constructor(e=new nn,t=new ua){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let s=1,r=t.count;s<r;s++)Jb.fromBufferAttribute(t,s-1),$b.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=Jb.distanceTo($b);e.setAttribute("lineDistance",new It(n,1))}else Tt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),gx.copy(n.boundingSphere),gx.applyMatrix4(s),gx.radius+=r,e.ray.intersectsSphere(gx)===!1)return;Z3.copy(s).invert(),L0.copy(e.ray).applyMatrix4(Z3);const l=r/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,f=this.isLineSegments?2:1,p=n.index,v=n.attributes.position;if(p!==null){const x=Math.max(0,o.start),b=Math.min(p.count,o.start+o.count);for(let w=x,M=b-1;w<M;w+=f){const S=p.getX(w),C=p.getX(w+1),R=vx(this,e,L0,u,S,C,w);R&&t.push(R)}if(this.isLineLoop){const w=p.getX(b-1),M=p.getX(x),S=vx(this,e,L0,u,w,M,b-1);S&&t.push(S)}}else{const x=Math.max(0,o.start),b=Math.min(v.count,o.start+o.count);for(let w=x,M=b-1;w<M;w+=f){const S=vx(this,e,L0,u,w,w+1,w);S&&t.push(S)}if(this.isLineLoop){const w=vx(this,e,L0,u,b-1,x,b-1);w&&t.push(w)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const l=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}}function vx(i,e,t,n,s,r,o){const l=i.geometry.attributes.position;if(Jb.fromBufferAttribute(l,s),$b.fromBufferAttribute(l,r),t.distanceSqToSegment(Jb,$b,rT,K3)>n)return;rT.applyMatrix4(i.matrixWorld);const f=e.ray.origin.distanceTo(rT);if(!(f<e.near||f>e.far))return{distance:f,point:K3.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}const Q3=new re,J3=new re;class Cc extends Wh{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let s=0,r=t.count;s<r;s+=2)Q3.fromBufferAttribute(t,s),J3.fromBufferAttribute(t,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+Q3.distanceTo(J3);e.setAttribute("lineDistance",new It(n,1))}else Tt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class AP extends Wh{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class q1 extends kr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const $3=new Kt,dw=new Nd,yx=new er,_x=new re;let EP=class extends zn{constructor(e=new nn,t=new q1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),yx.copy(n.boundingSphere),yx.applyMatrix4(s),yx.radius+=r,e.ray.intersectsSphere(yx)===!1)return;$3.copy(s).invert(),dw.copy(e.ray).applyMatrix4($3);const l=r/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,f=n.index,g=n.attributes.position;if(f!==null){const v=Math.max(0,o.start),x=Math.min(f.count,o.start+o.count);for(let b=v,w=x;b<w;b++){const M=f.getX(b);_x.fromBufferAttribute(g,M),eD(_x,M,u,s,e,t,this)}}else{const v=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count);for(let b=v,w=x;b<w;b++)_x.fromBufferAttribute(g,b),eD(_x,b,u,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const l=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}};function eD(i,e,t,n,s,r,o){const l=dw.distanceSqToPoint(i);if(l<t){const u=new re;dw.closestPointToPoint(i,u),u.applyMatrix4(n);const f=s.ray.origin.distanceTo(u);if(f<s.near||f>s.far)return;r.push({distance:f,distanceToRay:Math.sqrt(l),point:u,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class CP extends Ki{constructor(e,t,n,s,r=ti,o=ti,l,u,f){super(e,t,n,s,r,o,l,u,f),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const p=this;function g(){p.needsUpdate=!0,p._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(g))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class T5 extends CP{constructor(e,t,n,s,r,o,l,u){super({},e,t,n,s,r,o,l,u),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class w5 extends Ki{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=ms,this.minFilter=ms,this.generateMipmaps=!1,this.needsUpdate=!0}}class X1 extends Ki{constructor(e,t,n,s,r,o,l,u,f,p,g,v){super(null,o,l,u,f,p,s,r,g,v),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class A5 extends X1{constructor(e,t,n,s,r,o){super(e,t,n,r,o),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Ga,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class E5 extends X1{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Sc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class C5 extends Ki{constructor(e,t,n,s,r,o,l,u,f){super(e,t,n,s,r,o,l,u,f),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Td extends Ki{constructor(e,t,n=Ko,s,r,o,l=ms,u=ms,f,p=Mc,g=1){if(p!==Mc&&p!==Ph)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const v={width:e,height:t,depth:g};super(v,s,r,o,l,u,p,n,f),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Uh(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class RP extends Td{constructor(e,t=Ko,n=Sc,s,r,o=ms,l=ms,u,f=Mc){const p={width:e,height:e,depth:1},g=[p,p,p,p,p,p];super(e,e,t,n,s,r,o,l,u,f),this.image=g,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class XA extends Ki{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class Y1 extends nn{constructor(e=1,t=1,n=4,s=8,r=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:s,heightSegments:r},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),s=Math.max(3,Math.floor(s)),r=Math.max(1,Math.floor(r));const o=[],l=[],u=[],f=[],p=t/2,g=Math.PI/2*e,v=t,x=2*g+v,b=n*2+r,w=s+1,M=new re,S=new re;for(let C=0;C<=b;C++){let R=0,I=0,D=0,O=0;if(C<=n){const P=C/n,F=P*Math.PI/2;I=-p-e*Math.cos(F),D=e*Math.sin(F),O=-e*Math.cos(F),R=P*g}else if(C<=n+r){const P=(C-n)/r;I=-p+P*t,D=e,O=0,R=g+P*v}else{const P=(C-n-r)/n,F=P*Math.PI/2;I=p+e*Math.sin(F),D=e*Math.cos(F),O=e*Math.sin(F),R=g+v+P*g}const U=Math.max(0,Math.min(1,R/x));let k=0;C===0?k=.5/s:C===b&&(k=-.5/s);for(let P=0;P<=s;P++){const F=P/s,H=F*Math.PI*2,G=Math.sin(H),j=Math.cos(H);S.x=-D*j,S.y=I,S.z=D*G,l.push(S.x,S.y,S.z),M.set(-D*j,O,D*G),M.normalize(),u.push(M.x,M.y,M.z),f.push(F+k,U)}if(C>0){const P=(C-1)*w;for(let F=0;F<s;F++){const H=P+F,G=P+F+1,j=C*w+F,K=C*w+F+1;o.push(H,G,j),o.push(G,K,j)}}}this.setIndex(o),this.setAttribute("position",new It(l,3)),this.setAttribute("normal",new It(u,3)),this.setAttribute("uv",new It(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Y1(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Z1 extends nn{constructor(e=1,t=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},t=Math.max(3,t);const r=[],o=[],l=[],u=[],f=new re,p=new st;o.push(0,0,0),l.push(0,0,1),u.push(.5,.5);for(let g=0,v=3;g<=t;g++,v+=3){const x=n+g/t*s;f.x=e*Math.cos(x),f.y=e*Math.sin(x),o.push(f.x,f.y,f.z),l.push(0,0,1),p.x=(o[v]/e+1)/2,p.y=(o[v+1]/e+1)/2,u.push(p.x,p.y)}for(let g=1;g<=t;g++)r.push(g,g+1,0);this.setIndex(r),this.setAttribute("position",new It(o,3)),this.setAttribute("normal",new It(l,3)),this.setAttribute("uv",new It(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Z1(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class jv extends nn{constructor(e=1,t=1,n=1,s=32,r=1,o=!1,l=0,u=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:r,openEnded:o,thetaStart:l,thetaLength:u};const f=this;s=Math.floor(s),r=Math.floor(r);const p=[],g=[],v=[],x=[];let b=0;const w=[],M=n/2;let S=0;C(),o===!1&&(e>0&&R(!0),t>0&&R(!1)),this.setIndex(p),this.setAttribute("position",new It(g,3)),this.setAttribute("normal",new It(v,3)),this.setAttribute("uv",new It(x,2));function C(){const I=new re,D=new re;let O=0;const U=(t-e)/n;for(let k=0;k<=r;k++){const P=[],F=k/r,H=F*(t-e)+e;for(let G=0;G<=s;G++){const j=G/s,K=j*u+l,te=Math.sin(K),W=Math.cos(K);D.x=H*te,D.y=-F*n+M,D.z=H*W,g.push(D.x,D.y,D.z),I.set(te,U,W).normalize(),v.push(I.x,I.y,I.z),x.push(j,1-F),P.push(b++)}w.push(P)}for(let k=0;k<s;k++)for(let P=0;P<r;P++){const F=w[P][k],H=w[P+1][k],G=w[P+1][k+1],j=w[P][k+1];(e>0||P!==0)&&(p.push(F,H,j),O+=3),(t>0||P!==r-1)&&(p.push(H,G,j),O+=3)}f.addGroup(S,O,0),S+=O}function R(I){const D=b,O=new st,U=new re;let k=0;const P=I===!0?e:t,F=I===!0?1:-1;for(let G=1;G<=s;G++)g.push(0,M*F,0),v.push(0,F,0),x.push(.5,.5),b++;const H=b;for(let G=0;G<=s;G++){const K=G/s*u+l,te=Math.cos(K),W=Math.sin(K);U.x=P*W,U.y=M*F,U.z=P*te,g.push(U.x,U.y,U.z),v.push(0,F,0),O.x=te*.5+.5,O.y=W*.5*F+.5,x.push(O.x,O.y),b++}for(let G=0;G<s;G++){const j=D+G,K=H+G;I===!0?p.push(K,K+1,j):p.push(K+1,K,j),k+=3}f.addGroup(S,k,I===!0?1:2),S+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jv(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class qv extends jv{constructor(e=1,t=1,n=32,s=1,r=!1,o=0,l=Math.PI*2){super(0,e,t,n,s,r,o,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:l}}static fromJSON(e){return new qv(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Zh extends nn{constructor(e=[],t=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s};const r=[],o=[];l(s),f(n),p(),this.setAttribute("position",new It(r,3)),this.setAttribute("normal",new It(r.slice(),3)),this.setAttribute("uv",new It(o,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function l(C){const R=new re,I=new re,D=new re;for(let O=0;O<t.length;O+=3)x(t[O+0],R),x(t[O+1],I),x(t[O+2],D),u(R,I,D,C)}function u(C,R,I,D){const O=D+1,U=[];for(let k=0;k<=O;k++){U[k]=[];const P=C.clone().lerp(I,k/O),F=R.clone().lerp(I,k/O),H=O-k;for(let G=0;G<=H;G++)G===0&&k===O?U[k][G]=P:U[k][G]=P.clone().lerp(F,G/H)}for(let k=0;k<O;k++)for(let P=0;P<2*(O-k)-1;P++){const F=Math.floor(P/2);P%2===0?(v(U[k][F+1]),v(U[k+1][F]),v(U[k][F])):(v(U[k][F+1]),v(U[k+1][F+1]),v(U[k+1][F]))}}function f(C){const R=new re;for(let I=0;I<r.length;I+=3)R.x=r[I+0],R.y=r[I+1],R.z=r[I+2],R.normalize().multiplyScalar(C),r[I+0]=R.x,r[I+1]=R.y,r[I+2]=R.z}function p(){const C=new re;for(let R=0;R<r.length;R+=3){C.x=r[R+0],C.y=r[R+1],C.z=r[R+2];const I=M(C)/2/Math.PI+.5,D=S(C)/Math.PI+.5;o.push(I,1-D)}b(),g()}function g(){for(let C=0;C<o.length;C+=6){const R=o[C+0],I=o[C+2],D=o[C+4],O=Math.max(R,I,D),U=Math.min(R,I,D);O>.9&&U<.1&&(R<.2&&(o[C+0]+=1),I<.2&&(o[C+2]+=1),D<.2&&(o[C+4]+=1))}}function v(C){r.push(C.x,C.y,C.z)}function x(C,R){const I=C*3;R.x=e[I+0],R.y=e[I+1],R.z=e[I+2]}function b(){const C=new re,R=new re,I=new re,D=new re,O=new st,U=new st,k=new st;for(let P=0,F=0;P<r.length;P+=9,F+=6){C.set(r[P+0],r[P+1],r[P+2]),R.set(r[P+3],r[P+4],r[P+5]),I.set(r[P+6],r[P+7],r[P+8]),O.set(o[F+0],o[F+1]),U.set(o[F+2],o[F+3]),k.set(o[F+4],o[F+5]),D.copy(C).add(R).add(I).divideScalar(3);const H=M(D);w(O,F+0,C,H),w(U,F+2,R,H),w(k,F+4,I,H)}}function w(C,R,I,D){D<0&&C.x===1&&(o[R]=C.x-1),I.x===0&&I.z===0&&(o[R]=D/2/Math.PI+.5)}function M(C){return Math.atan2(C.z,-C.x)}function S(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zh(e.vertices,e.indices,e.radius,e.detail)}}class K1 extends Zh{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new K1(e.radius,e.detail)}}const xx=new re,bx=new re,aT=new re,Sx=new za;class DP extends nn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),r=Math.cos(gd*t),o=e.getIndex(),l=e.getAttribute("position"),u=o?o.count:l.count,f=[0,0,0],p=["a","b","c"],g=new Array(3),v={},x=[];for(let b=0;b<u;b+=3){o?(f[0]=o.getX(b),f[1]=o.getX(b+1),f[2]=o.getX(b+2)):(f[0]=b,f[1]=b+1,f[2]=b+2);const{a:w,b:M,c:S}=Sx;if(w.fromBufferAttribute(l,f[0]),M.fromBufferAttribute(l,f[1]),S.fromBufferAttribute(l,f[2]),Sx.getNormal(aT),g[0]=`${Math.round(w.x*s)},${Math.round(w.y*s)},${Math.round(w.z*s)}`,g[1]=`${Math.round(M.x*s)},${Math.round(M.y*s)},${Math.round(M.z*s)}`,g[2]=`${Math.round(S.x*s)},${Math.round(S.y*s)},${Math.round(S.z*s)}`,!(g[0]===g[1]||g[1]===g[2]||g[2]===g[0]))for(let C=0;C<3;C++){const R=(C+1)%3,I=g[C],D=g[R],O=Sx[p[C]],U=Sx[p[R]],k=`${I}_${D}`,P=`${D}_${I}`;P in v&&v[P]?(aT.dot(v[P].normal)<=r&&(x.push(O.x,O.y,O.z),x.push(U.x,U.y,U.z)),v[P]=null):k in v||(v[k]={index0:f[C],index1:f[R],normal:aT.clone()})}}for(const b in v)if(v[b]){const{index0:w,index1:M}=v[b];xx.fromBufferAttribute(l,w),bx.fromBufferAttribute(l,M),x.push(xx.x,xx.y,xx.z),x.push(bx.x,bx.y,bx.z)}this.setAttribute("position",new It(x,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Rl{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Tt("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(s),t.push(r),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let s=0;const r=n.length;let o;t?o=t:o=e*n[r-1];let l=0,u=r-1,f;for(;l<=u;)if(s=Math.floor(l+(u-l)/2),f=n[s]-o,f<0)l=s+1;else if(f>0)u=s-1;else{u=s;break}if(s=u,n[s]===o)return s/(r-1);const p=n[s],v=n[s+1]-p,x=(o-p)/v;return(s+x)/(r-1)}getTangent(e,t){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const o=this.getPoint(s),l=this.getPoint(r),u=t||(o.isVector2?new st:new re);return u.copy(l).sub(o).normalize(),u}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new re,s=[],r=[],o=[],l=new re,u=new Kt;for(let x=0;x<=e;x++){const b=x/e;s[x]=this.getTangentAt(b,new re)}r[0]=new re,o[0]=new re;let f=Number.MAX_VALUE;const p=Math.abs(s[0].x),g=Math.abs(s[0].y),v=Math.abs(s[0].z);p<=f&&(f=p,n.set(1,0,0)),g<=f&&(f=g,n.set(0,1,0)),v<=f&&n.set(0,0,1),l.crossVectors(s[0],n).normalize(),r[0].crossVectors(s[0],l),o[0].crossVectors(s[0],r[0]);for(let x=1;x<=e;x++){if(r[x]=r[x-1].clone(),o[x]=o[x-1].clone(),l.crossVectors(s[x-1],s[x]),l.length()>Number.EPSILON){l.normalize();const b=Math.acos(Qt(s[x-1].dot(s[x]),-1,1));r[x].applyMatrix4(u.makeRotationAxis(l,b))}o[x].crossVectors(s[x],r[x])}if(t===!0){let x=Math.acos(Qt(r[0].dot(r[e]),-1,1));x/=e,s[0].dot(l.crossVectors(r[0],r[e]))>0&&(x=-x);for(let b=1;b<=e;b++)r[b].applyMatrix4(u.makeRotationAxis(s[b],x*b)),o[b].crossVectors(s[b],r[b])}return{tangents:s,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Q1 extends Rl{constructor(e=0,t=0,n=1,s=1,r=0,o=Math.PI*2,l=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=l,this.aRotation=u}getPoint(e,t=new st){const n=t,s=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=s;for(;r>s;)r-=s;r<Number.EPSILON&&(o?r=0:r=s),this.aClockwise===!0&&!o&&(r===s?r=-s:r=r-s);const l=this.aStartAngle+e*r;let u=this.aX+this.xRadius*Math.cos(l),f=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const p=Math.cos(this.aRotation),g=Math.sin(this.aRotation),v=u-this.aX,x=f-this.aY;u=v*p-x*g+this.aX,f=v*g+x*p+this.aY}return n.set(u,f)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class NP extends Q1{constructor(e,t,n,s,r,o){super(e,t,n,n,s,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function YA(){let i=0,e=0,t=0,n=0;function s(r,o,l,u){i=r,e=l,t=-3*r+3*o-2*l-u,n=2*r-2*o+l+u}return{initCatmullRom:function(r,o,l,u,f){s(o,l,f*(l-r),f*(u-o))},initNonuniformCatmullRom:function(r,o,l,u,f,p,g){let v=(o-r)/f-(l-r)/(f+p)+(l-o)/p,x=(l-o)/p-(u-o)/(p+g)+(u-l)/g;v*=p,x*=p,s(o,l,v,x)},calc:function(r){const o=r*r,l=o*r;return i+e*r+t*o+n*l}}}const Mx=new re,oT=new YA,lT=new YA,cT=new YA;class IP extends Rl{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new re){const n=t,s=this.points,r=s.length,o=(r-(this.closed?0:1))*e;let l=Math.floor(o),u=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:u===0&&l===r-1&&(l=r-2,u=1);let f,p;this.closed||l>0?f=s[(l-1)%r]:(Mx.subVectors(s[0],s[1]).add(s[0]),f=Mx);const g=s[l%r],v=s[(l+1)%r];if(this.closed||l+2<r?p=s[(l+2)%r]:(Mx.subVectors(s[r-1],s[r-2]).add(s[r-1]),p=Mx),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let b=Math.pow(f.distanceToSquared(g),x),w=Math.pow(g.distanceToSquared(v),x),M=Math.pow(v.distanceToSquared(p),x);w<1e-4&&(w=1),b<1e-4&&(b=w),M<1e-4&&(M=w),oT.initNonuniformCatmullRom(f.x,g.x,v.x,p.x,b,w,M),lT.initNonuniformCatmullRom(f.y,g.y,v.y,p.y,b,w,M),cT.initNonuniformCatmullRom(f.z,g.z,v.z,p.z,b,w,M)}else this.curveType==="catmullrom"&&(oT.initCatmullRom(f.x,g.x,v.x,p.x,this.tension),lT.initCatmullRom(f.y,g.y,v.y,p.y,this.tension),cT.initCatmullRom(f.z,g.z,v.z,p.z,this.tension));return n.set(oT.calc(u),lT.calc(u),cT.calc(u)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new re().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function tD(i,e,t,n,s){const r=(n-e)*.5,o=(s-t)*.5,l=i*i,u=i*l;return(2*t-2*n+r+o)*u+(-3*t+3*n-2*r-o)*l+r*i+t}function R5(i,e){const t=1-i;return t*t*e}function D5(i,e){return 2*(1-i)*i*e}function N5(i,e){return i*i*e}function iv(i,e,t,n){return R5(i,e)+D5(i,t)+N5(i,n)}function I5(i,e){const t=1-i;return t*t*t*e}function O5(i,e){const t=1-i;return 3*t*t*i*e}function P5(i,e){return 3*(1-i)*i*i*e}function U5(i,e){return i*i*i*e}function sv(i,e,t,n,s){return I5(i,e)+O5(i,t)+P5(i,n)+U5(i,s)}class ZA extends Rl{constructor(e=new st,t=new st,n=new st,s=new st){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new st){const n=t,s=this.v0,r=this.v1,o=this.v2,l=this.v3;return n.set(sv(e,s.x,r.x,o.x,l.x),sv(e,s.y,r.y,o.y,l.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class OP extends Rl{constructor(e=new re,t=new re,n=new re,s=new re){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new re){const n=t,s=this.v0,r=this.v1,o=this.v2,l=this.v3;return n.set(sv(e,s.x,r.x,o.x,l.x),sv(e,s.y,r.y,o.y,l.y),sv(e,s.z,r.z,o.z,l.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class KA extends Rl{constructor(e=new st,t=new st){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new st){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new st){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class PP extends Rl{constructor(e=new re,t=new re){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new re){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new re){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class QA extends Rl{constructor(e=new st,t=new st,n=new st){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new st){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(iv(e,s.x,r.x,o.x),iv(e,s.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class JA extends Rl{constructor(e=new re,t=new re,n=new re){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new re){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(iv(e,s.x,r.x,o.x),iv(e,s.y,r.y,o.y),iv(e,s.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class $A extends Rl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new st){const n=t,s=this.points,r=(s.length-1)*e,o=Math.floor(r),l=r-o,u=s[o===0?o:o-1],f=s[o],p=s[o>s.length-2?s.length-1:o+1],g=s[o>s.length-3?s.length-1:o+2];return n.set(tD(l,u.x,f.x,p.x,g.x),tD(l,u.y,f.y,p.y,g.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new st().fromArray(s))}return this}}var e1=Object.freeze({__proto__:null,ArcCurve:NP,CatmullRomCurve3:IP,CubicBezierCurve:ZA,CubicBezierCurve3:OP,EllipseCurve:Q1,LineCurve:KA,LineCurve3:PP,QuadraticBezierCurve:QA,QuadraticBezierCurve3:JA,SplineCurve:$A});class UP extends Rl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new e1[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let r=0;for(;r<s.length;){if(s[r]>=n){const o=s[r]-n,l=this.curves[r],u=l.getLength(),f=u===0?0:1-o/u;return l.getPointAt(f,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,r=this.curves;s<r.length;s++){const o=r[s],l=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,u=o.getPoints(l);for(let f=0;f<u.length;f++){const p=u[f];n&&n.equals(p)||(t.push(p),n=p)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(new e1[s.type]().fromJSON(s))}return this}}class t1 extends UP{constructor(e){super(),this.type="Path",this.currentPoint=new st,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new KA(this.currentPoint.clone(),new st(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const r=new QA(this.currentPoint.clone(),new st(e,t),new st(n,s));return this.curves.push(r),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,r,o){const l=new ZA(this.currentPoint.clone(),new st(e,t),new st(n,s),new st(r,o));return this.curves.push(l),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new $A(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,r,o){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+l,t+u,n,s,r,o),this}absarc(e,t,n,s,r,o){return this.absellipse(e,t,n,n,s,r,o),this}ellipse(e,t,n,s,r,o,l,u){const f=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(e+f,t+p,n,s,r,o,l,u),this}absellipse(e,t,n,s,r,o,l,u){const f=new Q1(e,t,n,s,r,o,l,u);if(this.curves.length>0){const g=f.getPoint(0);g.equals(this.currentPoint)||this.lineTo(g.x,g.y)}this.curves.push(f);const p=f.getPoint(1);return this.currentPoint.copy(p),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Fh extends t1{constructor(e){super(e),this.uuid=lo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(new t1().fromJSON(s))}return this}}function L5(i,e,t=2){const n=e&&e.length,s=n?e[0]*t:i.length;let r=LP(i,0,s,t,!0);const o=[];if(!r||r.next===r.prev)return o;let l,u,f;if(n&&(r=V5(i,e,r,t)),i.length>80*t){l=i[0],u=i[1];let p=l,g=u;for(let v=t;v<s;v+=t){const x=i[v],b=i[v+1];x<l&&(l=x),b<u&&(u=b),x>p&&(p=x),b>g&&(g=b)}f=Math.max(p-l,g-u),f=f!==0?32767/f:0}return Tv(r,o,t,l,u,f,0),o}function LP(i,e,t,n,s){let r;if(s===J5(i,e,t,n)>0)for(let o=e;o<t;o+=n)r=nD(o/n|0,i[o],i[o+1],r);else for(let o=t-n;o>=e;o-=n)r=nD(o/n|0,i[o],i[o+1],r);return r&&Um(r,r.next)&&(Av(r),r=r.next),r}function wd(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Um(t,t.next)||Zi(t.prev,t,t.next)===0)){if(Av(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Tv(i,e,t,n,s,r,o){if(!i)return;!o&&r&&q5(i,n,s,r);let l=i;for(;i.prev!==i.next;){const u=i.prev,f=i.next;if(r?k5(i,n,s,r):F5(i)){e.push(u.i,i.i,f.i),Av(i),i=f.next,l=f.next;continue}if(i=f,i===l){o?o===1?(i=B5(wd(i),e),Tv(i,e,t,n,s,r,2)):o===2&&z5(i,e,t,n,s,r):Tv(wd(i),e,t,n,s,r,1);break}}}function F5(i){const e=i.prev,t=i,n=i.next;if(Zi(e,t,n)>=0)return!1;const s=e.x,r=t.x,o=n.x,l=e.y,u=t.y,f=n.y,p=Math.min(s,r,o),g=Math.min(l,u,f),v=Math.max(s,r,o),x=Math.max(l,u,f);let b=n.next;for(;b!==e;){if(b.x>=p&&b.x<=v&&b.y>=g&&b.y<=x&&H0(s,l,r,u,o,f,b.x,b.y)&&Zi(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function k5(i,e,t,n){const s=i.prev,r=i,o=i.next;if(Zi(s,r,o)>=0)return!1;const l=s.x,u=r.x,f=o.x,p=s.y,g=r.y,v=o.y,x=Math.min(l,u,f),b=Math.min(p,g,v),w=Math.max(l,u,f),M=Math.max(p,g,v),S=pw(x,b,e,t,n),C=pw(w,M,e,t,n);let R=i.prevZ,I=i.nextZ;for(;R&&R.z>=S&&I&&I.z<=C;){if(R.x>=x&&R.x<=w&&R.y>=b&&R.y<=M&&R!==s&&R!==o&&H0(l,p,u,g,f,v,R.x,R.y)&&Zi(R.prev,R,R.next)>=0||(R=R.prevZ,I.x>=x&&I.x<=w&&I.y>=b&&I.y<=M&&I!==s&&I!==o&&H0(l,p,u,g,f,v,I.x,I.y)&&Zi(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;R&&R.z>=S;){if(R.x>=x&&R.x<=w&&R.y>=b&&R.y<=M&&R!==s&&R!==o&&H0(l,p,u,g,f,v,R.x,R.y)&&Zi(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;I&&I.z<=C;){if(I.x>=x&&I.x<=w&&I.y>=b&&I.y<=M&&I!==s&&I!==o&&H0(l,p,u,g,f,v,I.x,I.y)&&Zi(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function B5(i,e){let t=i;do{const n=t.prev,s=t.next.next;!Um(n,s)&&kP(n,t,t.next,s)&&wv(n,s)&&wv(s,n)&&(e.push(n.i,t.i,s.i),Av(t),Av(t.next),t=i=s),t=t.next}while(t!==i);return wd(t)}function z5(i,e,t,n,s,r){let o=i;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&Z5(o,l)){let u=BP(o,l);o=wd(o,o.next),u=wd(u,u.next),Tv(o,e,t,n,s,r,0),Tv(u,e,t,n,s,r,0);return}l=l.next}o=o.next}while(o!==i)}function V5(i,e,t,n){const s=[];for(let r=0,o=e.length;r<o;r++){const l=e[r]*n,u=r<o-1?e[r+1]*n:i.length,f=LP(i,l,u,n,!1);f===f.next&&(f.steiner=!0),s.push(Y5(f))}s.sort(G5);for(let r=0;r<s.length;r++)t=H5(s[r],t);return t}function G5(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),s=(e.next.y-e.y)/(e.next.x-e.x);t=n-s}return t}function H5(i,e){const t=W5(i,e);if(!t)return e;const n=BP(t,i);return wd(n,n.next),wd(t,t.next)}function W5(i,e){let t=e;const n=i.x,s=i.y;let r=-1/0,o;if(Um(i,t))return t;do{if(Um(i,t.next))return t.next;if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const g=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=n&&g>r&&(r=g,o=t.x<t.next.x?t:t.next,g===n))return o}t=t.next}while(t!==e);if(!o)return null;const l=o,u=o.x,f=o.y;let p=1/0;t=o;do{if(n>=t.x&&t.x>=u&&n!==t.x&&FP(s<f?n:r,s,u,f,s<f?r:n,s,t.x,t.y)){const g=Math.abs(s-t.y)/(n-t.x);wv(t,i)&&(g<p||g===p&&(t.x>o.x||t.x===o.x&&j5(o,t)))&&(o=t,p=g)}t=t.next}while(t!==l);return o}function j5(i,e){return Zi(i.prev,i,e.prev)<0&&Zi(e.next,i,i.next)<0}function q5(i,e,t,n){let s=i;do s.z===0&&(s.z=pw(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,X5(s)}function X5(i){let e,t=1;do{let n=i,s;i=null;let r=null;for(e=0;n;){e++;let o=n,l=0;for(let f=0;f<t&&(l++,o=o.nextZ,!!o);f++);let u=t;for(;l>0||u>0&&o;)l!==0&&(u===0||!o||n.z<=o.z)?(s=n,n=n.nextZ,l--):(s=o,o=o.nextZ,u--),r?r.nextZ=s:i=s,s.prevZ=r,r=s;n=o}r.nextZ=null,t*=2}while(e>1);return i}function pw(i,e,t,n,s){return i=(i-t)*s|0,e=(e-n)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Y5(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function FP(i,e,t,n,s,r,o,l){return(s-o)*(e-l)>=(i-o)*(r-l)&&(i-o)*(n-l)>=(t-o)*(e-l)&&(t-o)*(r-l)>=(s-o)*(n-l)}function H0(i,e,t,n,s,r,o,l){return!(i===o&&e===l)&&FP(i,e,t,n,s,r,o,l)}function Z5(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!K5(i,e)&&(wv(i,e)&&wv(e,i)&&Q5(i,e)&&(Zi(i.prev,i,e.prev)||Zi(i,e.prev,e))||Um(i,e)&&Zi(i.prev,i,i.next)>0&&Zi(e.prev,e,e.next)>0)}function Zi(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Um(i,e){return i.x===e.x&&i.y===e.y}function kP(i,e,t,n){const s=wx(Zi(i,e,t)),r=wx(Zi(i,e,n)),o=wx(Zi(t,n,i)),l=wx(Zi(t,n,e));return!!(s!==r&&o!==l||s===0&&Tx(i,t,e)||r===0&&Tx(i,n,e)||o===0&&Tx(t,i,n)||l===0&&Tx(t,e,n))}function Tx(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function wx(i){return i>0?1:i<0?-1:0}function K5(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&kP(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function wv(i,e){return Zi(i.prev,i,i.next)<0?Zi(i,e,i.next)>=0&&Zi(i,i.prev,e)>=0:Zi(i,e,i.prev)<0||Zi(i,i.next,e)<0}function Q5(i,e){let t=i,n=!1;const s=(i.x+e.x)/2,r=(i.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&s<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function BP(i,e){const t=mw(i.i,i.x,i.y),n=mw(e.i,e.x,e.y),s=i.next,r=e.prev;return i.next=e,e.prev=i,t.next=s,s.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function nD(i,e,t,n){const s=mw(i,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function Av(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function mw(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function J5(i,e,t,n){let s=0;for(let r=e,o=t-n;r<t;r+=n)s+=(i[o]-i[r])*(i[r+1]+i[o+1]),o=r;return s}class $5{static triangulate(e,t,n=2){return L5(e,t,n)}}class Ml{static area(e){const t=e.length;let n=0;for(let s=t-1,r=0;r<t;s=r++)n+=e[s].x*e[r].y-e[r].x*e[s].y;return n*.5}static isClockWise(e){return Ml.area(e)<0}static triangulateShape(e,t){const n=[],s=[],r=[];iD(e),sD(n,e);let o=e.length;t.forEach(iD);for(let u=0;u<t.length;u++)s.push(o),o+=t[u].length,sD(n,t[u]);const l=$5.triangulate(n,s);for(let u=0;u<l.length;u+=3)r.push(l.slice(u,u+3));return r}}function iD(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function sD(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class J1 extends nn{constructor(e=new Fh([new st(.5,.5),new st(-.5,.5),new st(-.5,-.5),new st(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],r=[];for(let l=0,u=e.length;l<u;l++){const f=e[l];o(f)}this.setAttribute("position",new It(s,3)),this.setAttribute("uv",new It(r,2)),this.computeVertexNormals();function o(l){const u=[],f=t.curveSegments!==void 0?t.curveSegments:12,p=t.steps!==void 0?t.steps:1,g=t.depth!==void 0?t.depth:1;let v=t.bevelEnabled!==void 0?t.bevelEnabled:!0,x=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:x-.1,w=t.bevelOffset!==void 0?t.bevelOffset:0,M=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,C=t.UVGenerator!==void 0?t.UVGenerator:e6;let R,I=!1,D,O,U,k;if(S){R=S.getSpacedPoints(p),I=!0,v=!1;const De=S.isCatmullRomCurve3?S.closed:!1;D=S.computeFrenetFrames(p,De),O=new re,U=new re,k=new re}v||(M=0,x=0,b=0,w=0);const P=l.extractPoints(f);let F=P.shape;const H=P.holes;if(!Ml.isClockWise(F)){F=F.reverse();for(let De=0,ge=H.length;De<ge;De++){const ye=H[De];Ml.isClockWise(ye)&&(H[De]=ye.reverse())}}function j(De){const ye=10000000000000001e-36;let Ge=De[0];for(let Y=1;Y<=De.length;Y++){const Be=Y%De.length,Ne=De[Be],Me=Ne.x-Ge.x,Oe=Ne.y-Ge.y,q=Me*Me+Oe*Oe,V=Math.max(Math.abs(Ne.x),Math.abs(Ne.y),Math.abs(Ge.x),Math.abs(Ge.y)),ue=ye*V*V;if(q<=ue){De.splice(Be,1),Y--;continue}Ge=Ne}}j(F),H.forEach(j);const K=H.length,te=F;for(let De=0;De<K;De++){const ge=H[De];F=F.concat(ge)}function W(De,ge,ye){return ge||kt("ExtrudeGeometry: vec does not exist"),De.clone().addScaledVector(ge,ye)}const X=F.length;function oe(De,ge,ye){let Ge,Y,Be;const Ne=De.x-ge.x,Me=De.y-ge.y,Oe=ye.x-De.x,q=ye.y-De.y,V=Ne*Ne+Me*Me,ue=Ne*q-Me*Oe;if(Math.abs(ue)>Number.EPSILON){const Re=Math.sqrt(V),we=Math.sqrt(Oe*Oe+q*q),be=ge.x-Me/Re,it=ge.y+Ne/Re,tt=ye.x-q/we,ht=ye.y+Oe/we,yt=((tt-be)*q-(ht-it)*Oe)/(Ne*q-Me*Oe);Ge=be+Ne*yt-De.x,Y=it+Me*yt-De.y;const He=Ge*Ge+Y*Y;if(He<=2)return new st(Ge,Y);Be=Math.sqrt(He/2)}else{let Re=!1;Ne>Number.EPSILON?Oe>Number.EPSILON&&(Re=!0):Ne<-Number.EPSILON?Oe<-Number.EPSILON&&(Re=!0):Math.sign(Me)===Math.sign(q)&&(Re=!0),Re?(Ge=-Me,Y=Ne,Be=Math.sqrt(V)):(Ge=Ne,Y=Me,Be=Math.sqrt(V/2))}return new st(Ge/Be,Y/Be)}const ne=[];for(let De=0,ge=te.length,ye=ge-1,Ge=De+1;De<ge;De++,ye++,Ge++)ye===ge&&(ye=0),Ge===ge&&(Ge=0),ne[De]=oe(te[De],te[ye],te[Ge]);const ie=[];let B,Q=ne.concat();for(let De=0,ge=K;De<ge;De++){const ye=H[De];B=[];for(let Ge=0,Y=ye.length,Be=Y-1,Ne=Ge+1;Ge<Y;Ge++,Be++,Ne++)Be===Y&&(Be=0),Ne===Y&&(Ne=0),B[Ge]=oe(ye[Ge],ye[Be],ye[Ne]);ie.push(B),Q=Q.concat(B)}let ae;if(M===0)ae=Ml.triangulateShape(te,H);else{const De=[],ge=[];for(let ye=0;ye<M;ye++){const Ge=ye/M,Y=x*Math.cos(Ge*Math.PI/2),Be=b*Math.sin(Ge*Math.PI/2)+w;for(let Ne=0,Me=te.length;Ne<Me;Ne++){const Oe=W(te[Ne],ne[Ne],Be);Ie(Oe.x,Oe.y,-Y),Ge===0&&De.push(Oe)}for(let Ne=0,Me=K;Ne<Me;Ne++){const Oe=H[Ne];B=ie[Ne];const q=[];for(let V=0,ue=Oe.length;V<ue;V++){const Re=W(Oe[V],B[V],Be);Ie(Re.x,Re.y,-Y),Ge===0&&q.push(Re)}Ge===0&&ge.push(q)}}ae=Ml.triangulateShape(De,ge)}const fe=ae.length,de=b+w;for(let De=0;De<X;De++){const ge=v?W(F[De],Q[De],de):F[De];I?(U.copy(D.normals[0]).multiplyScalar(ge.x),O.copy(D.binormals[0]).multiplyScalar(ge.y),k.copy(R[0]).add(U).add(O),Ie(k.x,k.y,k.z)):Ie(ge.x,ge.y,0)}for(let De=1;De<=p;De++)for(let ge=0;ge<X;ge++){const ye=v?W(F[ge],Q[ge],de):F[ge];I?(U.copy(D.normals[De]).multiplyScalar(ye.x),O.copy(D.binormals[De]).multiplyScalar(ye.y),k.copy(R[De]).add(U).add(O),Ie(k.x,k.y,k.z)):Ie(ye.x,ye.y,g/p*De)}for(let De=M-1;De>=0;De--){const ge=De/M,ye=x*Math.cos(ge*Math.PI/2),Ge=b*Math.sin(ge*Math.PI/2)+w;for(let Y=0,Be=te.length;Y<Be;Y++){const Ne=W(te[Y],ne[Y],Ge);Ie(Ne.x,Ne.y,g+ye)}for(let Y=0,Be=H.length;Y<Be;Y++){const Ne=H[Y];B=ie[Y];for(let Me=0,Oe=Ne.length;Me<Oe;Me++){const q=W(Ne[Me],B[Me],Ge);I?Ie(q.x,q.y+R[p-1].y,R[p-1].x+ye):Ie(q.x,q.y,g+ye)}}}se(),ce();function se(){const De=s.length/3;if(v){let ge=0,ye=X*ge;for(let Ge=0;Ge<fe;Ge++){const Y=ae[Ge];Ye(Y[2]+ye,Y[1]+ye,Y[0]+ye)}ge=p+M*2,ye=X*ge;for(let Ge=0;Ge<fe;Ge++){const Y=ae[Ge];Ye(Y[0]+ye,Y[1]+ye,Y[2]+ye)}}else{for(let ge=0;ge<fe;ge++){const ye=ae[ge];Ye(ye[2],ye[1],ye[0])}for(let ge=0;ge<fe;ge++){const ye=ae[ge];Ye(ye[0]+X*p,ye[1]+X*p,ye[2]+X*p)}}n.addGroup(De,s.length/3-De,0)}function ce(){const De=s.length/3;let ge=0;pe(te,ge),ge+=te.length;for(let ye=0,Ge=H.length;ye<Ge;ye++){const Y=H[ye];pe(Y,ge),ge+=Y.length}n.addGroup(De,s.length/3-De,1)}function pe(De,ge){let ye=De.length;for(;--ye>=0;){const Ge=ye;let Y=ye-1;Y<0&&(Y=De.length-1);for(let Be=0,Ne=p+M*2;Be<Ne;Be++){const Me=X*Be,Oe=X*(Be+1),q=ge+Ge+Me,V=ge+Y+Me,ue=ge+Y+Oe,Re=ge+Ge+Oe;et(q,V,ue,Re)}}}function Ie(De,ge,ye){u.push(De),u.push(ge),u.push(ye)}function Ye(De,ge,ye){qe(De),qe(ge),qe(ye);const Ge=s.length/3,Y=C.generateTopUV(n,s,Ge-3,Ge-2,Ge-1);dt(Y[0]),dt(Y[1]),dt(Y[2])}function et(De,ge,ye,Ge){qe(De),qe(ge),qe(Ge),qe(ge),qe(ye),qe(Ge);const Y=s.length/3,Be=C.generateSideWallUV(n,s,Y-6,Y-3,Y-2,Y-1);dt(Be[0]),dt(Be[1]),dt(Be[3]),dt(Be[1]),dt(Be[2]),dt(Be[3])}function qe(De){s.push(u[De*3+0]),s.push(u[De*3+1]),s.push(u[De*3+2])}function dt(De){r.push(De.x),r.push(De.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return t6(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const l=t[e.shapes[r]];n.push(l)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new e1[s.type]().fromJSON(s)),new J1(n,e.options)}}const e6={generateTopUV:function(i,e,t,n,s){const r=e[t*3],o=e[t*3+1],l=e[n*3],u=e[n*3+1],f=e[s*3],p=e[s*3+1];return[new st(r,o),new st(l,u),new st(f,p)]},generateSideWallUV:function(i,e,t,n,s,r){const o=e[t*3],l=e[t*3+1],u=e[t*3+2],f=e[n*3],p=e[n*3+1],g=e[n*3+2],v=e[s*3],x=e[s*3+1],b=e[s*3+2],w=e[r*3],M=e[r*3+1],S=e[r*3+2];return Math.abs(l-p)<Math.abs(o-f)?[new st(o,1-u),new st(f,1-g),new st(v,1-b),new st(w,1-S)]:[new st(l,1-u),new st(p,1-g),new st(x,1-b),new st(M,1-S)]}};function t6(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,s=i.length;n<s;n++){const r=i[n];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class $1 extends Zh{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $1(e.radius,e.detail)}}class eS extends nn{constructor(e=[new st(0,-.5),new st(.5,0),new st(0,.5)],t=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=Math.floor(t),s=Qt(s,0,Math.PI*2);const r=[],o=[],l=[],u=[],f=[],p=1/t,g=new re,v=new st,x=new re,b=new re,w=new re;let M=0,S=0;for(let C=0;C<=e.length-1;C++)switch(C){case 0:M=e[C+1].x-e[C].x,S=e[C+1].y-e[C].y,x.x=S*1,x.y=-M,x.z=S*0,w.copy(x),x.normalize(),u.push(x.x,x.y,x.z);break;case e.length-1:u.push(w.x,w.y,w.z);break;default:M=e[C+1].x-e[C].x,S=e[C+1].y-e[C].y,x.x=S*1,x.y=-M,x.z=S*0,b.copy(x),x.x+=w.x,x.y+=w.y,x.z+=w.z,x.normalize(),u.push(x.x,x.y,x.z),w.copy(b)}for(let C=0;C<=t;C++){const R=n+C*p*s,I=Math.sin(R),D=Math.cos(R);for(let O=0;O<=e.length-1;O++){g.x=e[O].x*I,g.y=e[O].y,g.z=e[O].x*D,o.push(g.x,g.y,g.z),v.x=C/t,v.y=O/(e.length-1),l.push(v.x,v.y);const U=u[3*O+0]*I,k=u[3*O+1],P=u[3*O+0]*D;f.push(U,k,P)}}for(let C=0;C<t;C++)for(let R=0;R<e.length-1;R++){const I=R+C*e.length,D=I,O=I+e.length,U=I+e.length+1,k=I+1;r.push(D,O,k),r.push(U,k,O)}this.setIndex(r),this.setAttribute("position",new It(o,3)),this.setAttribute("uv",new It(l,2)),this.setAttribute("normal",new It(f,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new eS(e.points,e.segments,e.phiStart,e.phiLength)}}class Ym extends Zh{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ym(e.radius,e.detail)}}class Ou extends nn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const r=e/2,o=t/2,l=Math.floor(n),u=Math.floor(s),f=l+1,p=u+1,g=e/l,v=t/u,x=[],b=[],w=[],M=[];for(let S=0;S<p;S++){const C=S*v-o;for(let R=0;R<f;R++){const I=R*g-r;b.push(I,-C,0),w.push(0,0,1),M.push(R/l),M.push(1-S/u)}}for(let S=0;S<u;S++)for(let C=0;C<l;C++){const R=C+f*S,I=C+f*(S+1),D=C+1+f*(S+1),O=C+1+f*S;x.push(R,I,O),x.push(I,D,O)}this.setIndex(x),this.setAttribute("position",new It(b,3)),this.setAttribute("normal",new It(w,3)),this.setAttribute("uv",new It(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ou(e.width,e.height,e.widthSegments,e.heightSegments)}}class tS extends nn{constructor(e=.5,t=1,n=32,s=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:r,thetaLength:o},n=Math.max(3,n),s=Math.max(1,s);const l=[],u=[],f=[],p=[];let g=e;const v=(t-e)/s,x=new re,b=new st;for(let w=0;w<=s;w++){for(let M=0;M<=n;M++){const S=r+M/n*o;x.x=g*Math.cos(S),x.y=g*Math.sin(S),u.push(x.x,x.y,x.z),f.push(0,0,1),b.x=(x.x/t+1)/2,b.y=(x.y/t+1)/2,p.push(b.x,b.y)}g+=v}for(let w=0;w<s;w++){const M=w*(n+1);for(let S=0;S<n;S++){const C=S+M,R=C,I=C+n+1,D=C+n+2,O=C+1;l.push(R,I,O),l.push(I,D,O)}}this.setIndex(l),this.setAttribute("position",new It(u,3)),this.setAttribute("normal",new It(f,3)),this.setAttribute("uv",new It(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tS(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Xv extends nn{constructor(e=new Fh([new st(0,.5),new st(-.5,-.5),new st(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],r=[],o=[];let l=0,u=0;if(Array.isArray(e)===!1)f(e);else for(let p=0;p<e.length;p++)f(e[p]),this.addGroup(l,u,p),l+=u,u=0;this.setIndex(n),this.setAttribute("position",new It(s,3)),this.setAttribute("normal",new It(r,3)),this.setAttribute("uv",new It(o,2));function f(p){const g=s.length/3,v=p.extractPoints(t);let x=v.shape;const b=v.holes;Ml.isClockWise(x)===!1&&(x=x.reverse());for(let M=0,S=b.length;M<S;M++){const C=b[M];Ml.isClockWise(C)===!0&&(b[M]=C.reverse())}const w=Ml.triangulateShape(x,b);for(let M=0,S=b.length;M<S;M++){const C=b[M];x=x.concat(C)}for(let M=0,S=x.length;M<S;M++){const C=x[M];s.push(C.x,C.y,0),r.push(0,0,1),o.push(C.x,C.y)}for(let M=0,S=w.length;M<S;M++){const C=w[M],R=C[0]+g,I=C[1]+g,D=C[2]+g;n.push(R,I,D),u+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return n6(t,e)}static fromJSON(e,t){const n=[];for(let s=0,r=e.shapes.length;s<r;s++){const o=t[e.shapes[s]];n.push(o)}return new Xv(n,e.curveSegments)}}function n6(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const s=i[t];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e}class Yv extends nn{constructor(e=1,t=32,n=16,s=0,r=Math.PI*2,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:r,thetaStart:o,thetaLength:l},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(o+l,Math.PI);let f=0;const p=[],g=new re,v=new re,x=[],b=[],w=[],M=[];for(let S=0;S<=n;S++){const C=[],R=S/n;let I=0;S===0&&o===0?I=.5/t:S===n&&u===Math.PI&&(I=-.5/t);for(let D=0;D<=t;D++){const O=D/t;g.x=-e*Math.cos(s+O*r)*Math.sin(o+R*l),g.y=e*Math.cos(o+R*l),g.z=e*Math.sin(s+O*r)*Math.sin(o+R*l),b.push(g.x,g.y,g.z),v.copy(g).normalize(),w.push(v.x,v.y,v.z),M.push(O+I,1-R),C.push(f++)}p.push(C)}for(let S=0;S<n;S++)for(let C=0;C<t;C++){const R=p[S][C+1],I=p[S][C],D=p[S+1][C],O=p[S+1][C+1];(S!==0||o>0)&&x.push(R,I,O),(S!==n-1||u<Math.PI)&&x.push(I,D,O)}this.setIndex(x),this.setAttribute("position",new It(b,3)),this.setAttribute("normal",new It(w,3)),this.setAttribute("uv",new It(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yv(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Zv extends Zh{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Zv(e.radius,e.detail)}}class nS extends nn{constructor(e=1,t=.4,n=12,s=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:r},n=Math.floor(n),s=Math.floor(s);const o=[],l=[],u=[],f=[],p=new re,g=new re,v=new re;for(let x=0;x<=n;x++)for(let b=0;b<=s;b++){const w=b/s*r,M=x/n*Math.PI*2;g.x=(e+t*Math.cos(M))*Math.cos(w),g.y=(e+t*Math.cos(M))*Math.sin(w),g.z=t*Math.sin(M),l.push(g.x,g.y,g.z),p.x=e*Math.cos(w),p.y=e*Math.sin(w),v.subVectors(g,p).normalize(),u.push(v.x,v.y,v.z),f.push(b/s),f.push(x/n)}for(let x=1;x<=n;x++)for(let b=1;b<=s;b++){const w=(s+1)*x+b-1,M=(s+1)*(x-1)+b-1,S=(s+1)*(x-1)+b,C=(s+1)*x+b;o.push(w,M,C),o.push(M,S,C)}this.setIndex(o),this.setAttribute("position",new It(l,3)),this.setAttribute("normal",new It(u,3)),this.setAttribute("uv",new It(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nS(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class iS extends nn{constructor(e=1,t=.4,n=64,s=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:r,q:o},n=Math.floor(n),s=Math.floor(s);const l=[],u=[],f=[],p=[],g=new re,v=new re,x=new re,b=new re,w=new re,M=new re,S=new re;for(let R=0;R<=n;++R){const I=R/n*r*Math.PI*2;C(I,r,o,e,x),C(I+.01,r,o,e,b),M.subVectors(b,x),S.addVectors(b,x),w.crossVectors(M,S),S.crossVectors(w,M),w.normalize(),S.normalize();for(let D=0;D<=s;++D){const O=D/s*Math.PI*2,U=-t*Math.cos(O),k=t*Math.sin(O);g.x=x.x+(U*S.x+k*w.x),g.y=x.y+(U*S.y+k*w.y),g.z=x.z+(U*S.z+k*w.z),u.push(g.x,g.y,g.z),v.subVectors(g,x).normalize(),f.push(v.x,v.y,v.z),p.push(R/n),p.push(D/s)}}for(let R=1;R<=n;R++)for(let I=1;I<=s;I++){const D=(s+1)*(R-1)+(I-1),O=(s+1)*R+(I-1),U=(s+1)*R+I,k=(s+1)*(R-1)+I;l.push(D,O,k),l.push(O,U,k)}this.setIndex(l),this.setAttribute("position",new It(u,3)),this.setAttribute("normal",new It(f,3)),this.setAttribute("uv",new It(p,2));function C(R,I,D,O,U){const k=Math.cos(R),P=Math.sin(R),F=D/I*R,H=Math.cos(F);U.x=O*(2+H)*.5*k,U.y=O*(2+H)*P*.5,U.z=O*Math.sin(F)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iS(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class sS extends nn{constructor(e=new JA(new re(-1,-1,0),new re(-1,1,0),new re(1,1,0)),t=64,n=1,s=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const l=new re,u=new re,f=new st;let p=new re;const g=[],v=[],x=[],b=[];w(),this.setIndex(b),this.setAttribute("position",new It(g,3)),this.setAttribute("normal",new It(v,3)),this.setAttribute("uv",new It(x,2));function w(){for(let R=0;R<t;R++)M(R);M(r===!1?t:0),C(),S()}function M(R){p=e.getPointAt(R/t,p);const I=o.normals[R],D=o.binormals[R];for(let O=0;O<=s;O++){const U=O/s*Math.PI*2,k=Math.sin(U),P=-Math.cos(U);u.x=P*I.x+k*D.x,u.y=P*I.y+k*D.y,u.z=P*I.z+k*D.z,u.normalize(),v.push(u.x,u.y,u.z),l.x=p.x+n*u.x,l.y=p.y+n*u.y,l.z=p.z+n*u.z,g.push(l.x,l.y,l.z)}}function S(){for(let R=1;R<=t;R++)for(let I=1;I<=s;I++){const D=(s+1)*(R-1)+(I-1),O=(s+1)*R+(I-1),U=(s+1)*R+I,k=(s+1)*(R-1)+I;b.push(D,O,k),b.push(O,U,k)}}function C(){for(let R=0;R<=t;R++)for(let I=0;I<=s;I++)f.x=R/t,f.y=I/s,x.push(f.x,f.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new sS(new e1[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class zP extends nn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,s=new re,r=new re;if(e.index!==null){const o=e.attributes.position,l=e.index;let u=e.groups;u.length===0&&(u=[{start:0,count:l.count,materialIndex:0}]);for(let f=0,p=u.length;f<p;++f){const g=u[f],v=g.start,x=g.count;for(let b=v,w=v+x;b<w;b+=3)for(let M=0;M<3;M++){const S=l.getX(b+M),C=l.getX(b+(M+1)%3);s.fromBufferAttribute(o,S),r.fromBufferAttribute(o,C),rD(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let l=0,u=o.count/3;l<u;l++)for(let f=0;f<3;f++){const p=3*l+f,g=3*l+(f+1)%3;s.fromBufferAttribute(o,p),r.fromBufferAttribute(o,g),rD(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new It(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function rD(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(s)===!0?!1:(t.add(n),t.add(s),!0)}var aD=Object.freeze({__proto__:null,BoxGeometry:Id,CapsuleGeometry:Y1,CircleGeometry:Z1,ConeGeometry:qv,CylinderGeometry:jv,DodecahedronGeometry:K1,EdgesGeometry:DP,ExtrudeGeometry:J1,IcosahedronGeometry:$1,LatheGeometry:eS,OctahedronGeometry:Ym,PlaneGeometry:Ou,PolyhedronGeometry:Zh,RingGeometry:tS,ShapeGeometry:Xv,SphereGeometry:Yv,TetrahedronGeometry:Zv,TorusGeometry:nS,TorusKnotGeometry:iS,TubeGeometry:sS,WireframeGeometry:zP});class VP extends kr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new St(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class eE extends ho{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class tE extends kr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yh,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class GP extends tE{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new st(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Qt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new St(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new St(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new St(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class HP extends kr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new St(16777215),this.specular=new St(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yh,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.combine=Gv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class WP extends kr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new St(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yh,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class jP extends kr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yh,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class qP extends kr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yh,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.combine=Gv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class rS extends kr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=sP,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class aS extends kr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class XP extends kr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new St(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yh,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class YP extends ua{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function cd(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function ZP(i){function e(s,r){return i[s]-i[r]}const t=i.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(e),n}function gw(i,e,t){const n=i.length,s=new i.constructor(n);for(let r=0,o=0;o!==n;++r){const l=t[r]*e;for(let u=0;u!==e;++u)s[o++]=i[l+u]}return s}function nE(i,e,t,n){let s=1,r=i[0];for(;r!==void 0&&r[n]===void 0;)r=i[s++];if(r===void 0)return;let o=r[n];if(o!==void 0)if(Array.isArray(o))do o=r[n],o!==void 0&&(e.push(r.time),t.push(...o)),r=i[s++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[n],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=i[s++];while(r!==void 0);else do o=r[n],o!==void 0&&(e.push(r.time),t.push(o)),r=i[s++];while(r!==void 0)}function i6(i,e,t,n,s=30){const r=i.clone();r.name=e;const o=[];for(let u=0;u<r.tracks.length;++u){const f=r.tracks[u],p=f.getValueSize(),g=[],v=[];for(let x=0;x<f.times.length;++x){const b=f.times[x]*s;if(!(b<t||b>=n)){g.push(f.times[x]);for(let w=0;w<p;++w)v.push(f.values[x*p+w])}}g.length!==0&&(f.times=cd(g,f.times.constructor),f.values=cd(v,f.values.constructor),o.push(f))}r.tracks=o;let l=1/0;for(let u=0;u<r.tracks.length;++u)l>r.tracks[u].times[0]&&(l=r.tracks[u].times[0]);for(let u=0;u<r.tracks.length;++u)r.tracks[u].shift(-1*l);return r.resetDuration(),r}function s6(i,e=0,t=i,n=30){n<=0&&(n=30);const s=t.tracks.length,r=e/n;for(let o=0;o<s;++o){const l=t.tracks[o],u=l.ValueTypeName;if(u==="bool"||u==="string")continue;const f=i.tracks.find(function(S){return S.name===l.name&&S.ValueTypeName===u});if(f===void 0)continue;let p=0;const g=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=g/3);let v=0;const x=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=x/3);const b=l.times.length-1;let w;if(r<=l.times[0]){const S=p,C=g-p;w=l.values.slice(S,C)}else if(r>=l.times[b]){const S=b*g+p,C=S+g-p;w=l.values.slice(S,C)}else{const S=l.createInterpolant(),C=p,R=g-p;S.evaluate(r),w=S.resultBuffer.slice(C,R)}u==="quaternion"&&new Fr().fromArray(w).normalize().conjugate().toArray(w);const M=f.times.length;for(let S=0;S<M;++S){const C=S*x+v;if(u==="quaternion")Fr.multiplyQuaternionsFlat(f.values,C,w,0,f.values,C);else{const R=x-v*2;for(let I=0;I<R;++I)f.values[C+I]-=w[I]}}}return i.blendMode=FA,i}class r6{static convertArray(e,t){return cd(e,t)}static isTypedArray(e){return pP(e)}static getKeyframeOrder(e){return ZP(e)}static sortedArray(e,t,n){return gw(e,t,n)}static flattenJSON(e,t,n,s){nE(e,t,n,s)}static subclip(e,t,n,s,r=30){return i6(e,t,n,s,r)}static makeClipAdditive(e,t=0,n=e,s=30){return s6(e,t,n,s)}}class Kv{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<s)){for(let l=n+2;;){if(s===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===l)break;if(r=s,s=t[++n],e<s)break t}o=t.length;break n}if(!(e>=r)){const l=t[1];e<l&&(n=2,r=l);for(let u=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(s=r,r=t[--n-1],e>=r)break t}o=n,n=0;break n}break e}for(;n<o;){const l=n+o>>>1;e<t[l]?o=l:n=l+1}if(s=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,s)}return this.interpolate_(n,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s;for(let o=0;o!==s;++o)t[o]=n[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class KP extends Kv{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:od,endingEnd:od}}intervalChanged_(e,t,n){const s=this.parameterPositions;let r=e-2,o=e+1,l=s[r],u=s[o];if(l===void 0)switch(this.getSettings_().endingStart){case ld:r=e,l=2*t-n;break;case _v:r=s.length-2,l=t+s[r]-s[r+1];break;default:r=e,l=n}if(u===void 0)switch(this.getSettings_().endingEnd){case ld:o=e,u=2*n-t;break;case _v:o=1,u=n+s[1]-s[0];break;default:o=e-1,u=t}const f=(n-t)*.5,p=this.valueSize;this._weightPrev=f/(t-l),this._weightNext=f/(u-n),this._offsetPrev=r*p,this._offsetNext=o*p}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,f=u-l,p=this._offsetPrev,g=this._offsetNext,v=this._weightPrev,x=this._weightNext,b=(n-t)/(s-t),w=b*b,M=w*b,S=-v*M+2*v*w-v*b,C=(1+v)*M+(-1.5-2*v)*w+(-.5+v)*b+1,R=(-1-x)*M+(1.5+x)*w+.5*b,I=x*M-x*w;for(let D=0;D!==l;++D)r[D]=S*o[p+D]+C*o[f+D]+R*o[u+D]+I*o[g+D];return r}}class iE extends Kv{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,f=u-l,p=(n-t)/(s-t),g=1-p;for(let v=0;v!==l;++v)r[v]=o[f+v]*g+o[u+v]*p;return r}}class QP extends Kv{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Qo{constructor(e,t,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=cd(t,this.TimeBufferType),this.values=cd(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:cd(e.times,Array),values:cd(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new QP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new iE(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new KP(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case yv:t=this.InterpolantFactoryMethodDiscrete;break;case Qb:t=this.InterpolantFactoryMethodLinear;break;case Zx:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Tt("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return yv;case this.InterpolantFactoryMethodLinear:return Qb;case this.InterpolantFactoryMethodSmooth:return Zx}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let r=0,o=s-1;for(;r!==s&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;if(++o,r!==0||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);const l=this.getValueSize();this.times=n.slice(r,o),this.values=this.values.slice(r*l,o*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(kt("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,r=n.length;r===0&&(kt("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==r;l++){const u=n[l];if(typeof u=="number"&&isNaN(u)){kt("KeyframeTrack: Time is not a valid number.",this,l,u),e=!1;break}if(o!==null&&o>u){kt("KeyframeTrack: Out of order keys.",this,l,u,o),e=!1;break}o=u}if(s!==void 0&&pP(s))for(let l=0,u=s.length;l!==u;++l){const f=s[l];if(isNaN(f)){kt("KeyframeTrack: Value is not a valid number.",this,l,f),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===Zx,r=e.length-1;let o=1;for(let l=1;l<r;++l){let u=!1;const f=e[l],p=e[l+1];if(f!==p&&(l!==1||f!==e[0]))if(s)u=!0;else{const g=l*n,v=g-n,x=g+n;for(let b=0;b!==n;++b){const w=t[g+b];if(w!==t[v+b]||w!==t[x+b]){u=!0;break}}}if(u){if(l!==o){e[o]=e[l];const g=l*n,v=o*n;for(let x=0;x!==n;++x)t[v+x]=t[g+x]}++o}}if(r>0){e[o]=e[r];for(let l=r*n,u=o*n,f=0;f!==n;++f)t[u+f]=t[l+f];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,s=new n(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}Qo.prototype.ValueTypeName="";Qo.prototype.TimeBufferType=Float32Array;Qo.prototype.ValueBufferType=Float32Array;Qo.prototype.DefaultInterpolation=Qb;class Od extends Qo{constructor(e,t,n){super(e,t,n)}}Od.prototype.ValueTypeName="bool";Od.prototype.ValueBufferType=Array;Od.prototype.DefaultInterpolation=yv;Od.prototype.InterpolantFactoryMethodLinear=void 0;Od.prototype.InterpolantFactoryMethodSmooth=void 0;class sE extends Qo{constructor(e,t,n,s){super(e,t,n,s)}}sE.prototype.ValueTypeName="color";class Ev extends Qo{constructor(e,t,n,s){super(e,t,n,s)}}Ev.prototype.ValueTypeName="number";class JP extends Kv{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=(n-t)/(s-t);let f=e*l;for(let p=f+l;f!==p;f+=4)Fr.slerpFlat(r,0,o,f-l,o,f,u);return r}}class Qv extends Qo{constructor(e,t,n,s){super(e,t,n,s)}InterpolantFactoryMethodLinear(e){return new JP(this.times,this.values,this.getValueSize(),e)}}Qv.prototype.ValueTypeName="quaternion";Qv.prototype.InterpolantFactoryMethodSmooth=void 0;class Pd extends Qo{constructor(e,t,n){super(e,t,n)}}Pd.prototype.ValueTypeName="string";Pd.prototype.ValueBufferType=Array;Pd.prototype.DefaultInterpolation=yv;Pd.prototype.InterpolantFactoryMethodLinear=void 0;Pd.prototype.InterpolantFactoryMethodSmooth=void 0;class Cv extends Qo{constructor(e,t,n,s){super(e,t,n,s)}}Cv.prototype.ValueTypeName="vector";class Rv{constructor(e="",t=-1,n=[],s=U1){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=lo(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let o=0,l=n.length;o!==l;++o)t.push(o6(n[o]).scale(s));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r.userData=JSON.parse(e.userData||"{}"),r}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let r=0,o=n.length;r!==o;++r)t.push(Qo.toJSON(n[r]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const r=t.length,o=[];for(let l=0;l<r;l++){let u=[],f=[];u.push((l+r-1)%r,l,(l+1)%r),f.push(0,1,0);const p=ZP(u);u=gw(u,1,p),f=gw(f,1,p),!s&&u[0]===0&&(u.push(r),f.push(f[0])),o.push(new Ev(".morphTargetInfluences["+t[l].name+"]",u,f).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},r=/^([\w-]*?)([\d]+)$/;for(let l=0,u=e.length;l<u;l++){const f=e[l],p=f.name.match(r);if(p&&p.length>1){const g=p[1];let v=s[g];v||(s[g]=v=[]),v.push(f)}}const o=[];for(const l in s)o.push(this.CreateFromMorphTargetSequence(l,s[l],t,n));return o}static parseAnimation(e,t){if(Tt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return kt("AnimationClip: No animation in JSONLoader data."),null;const n=function(g,v,x,b,w){if(x.length!==0){const M=[],S=[];nE(x,M,S,b),M.length!==0&&w.push(new g(v,M,S))}},s=[],r=e.name||"default",o=e.fps||30,l=e.blendMode;let u=e.length||-1;const f=e.hierarchy||[];for(let g=0;g<f.length;g++){const v=f[g].keys;if(!(!v||v.length===0))if(v[0].morphTargets){const x={};let b;for(b=0;b<v.length;b++)if(v[b].morphTargets)for(let w=0;w<v[b].morphTargets.length;w++)x[v[b].morphTargets[w]]=-1;for(const w in x){const M=[],S=[];for(let C=0;C!==v[b].morphTargets.length;++C){const R=v[b];M.push(R.time),S.push(R.morphTarget===w?1:0)}s.push(new Ev(".morphTargetInfluence["+w+"]",M,S))}u=x.length*o}else{const x=".bones["+t[g].name+"]";n(Cv,x+".position",v,"pos",s),n(Qv,x+".quaternion",v,"rot",s),n(Cv,x+".scale",v,"scl",s)}}return s.length===0?null:new this(r,u,s,l)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,s=e.length;n!==s;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function a6(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ev;case"vector":case"vector2":case"vector3":case"vector4":return Cv;case"color":return sE;case"quaternion":return Qv;case"bool":case"boolean":return Od;case"string":return Pd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function o6(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=a6(i.type);if(i.times===void 0){const t=[],n=[];nE(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const yc={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class rE{constructor(e,t,n){const s=this;let r=!1,o=0,l=0,u;const f=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(p){l++,r===!1&&s.onStart!==void 0&&s.onStart(p,o,l),r=!0},this.itemEnd=function(p){o++,s.onProgress!==void 0&&s.onProgress(p,o,l),o===l&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(p){s.onError!==void 0&&s.onError(p)},this.resolveURL=function(p){return u?u(p):p},this.setURLModifier=function(p){return u=p,this},this.addHandler=function(p,g){return f.push(p,g),this},this.removeHandler=function(p){const g=f.indexOf(p);return g!==-1&&f.splice(g,2),this},this.getHandler=function(p){for(let g=0,v=f.length;g<v;g+=2){const x=f[g],b=f[g+1];if(x.global&&(x.lastIndex=0),x.test(p))return b}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const $P=new rE;class qa{constructor(e){this.manager=e!==void 0?e:$P,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,r){n.load(e,s,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}qa.DEFAULT_MATERIAL_NAME="__DEFAULT";const gu={};class l6 extends Error{constructor(e,t){super(e),this.response=t}}class Cu extends qa{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=yc.get(`file:${e}`);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(gu[e]!==void 0){gu[e].push({onLoad:t,onProgress:n,onError:s});return}gu[e]=[],gu[e].push({onLoad:t,onProgress:n,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),l=this.mimeType,u=this.responseType;fetch(o).then(f=>{if(f.status===200||f.status===0){if(f.status===0&&Tt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||f.body===void 0||f.body.getReader===void 0)return f;const p=gu[e],g=f.body.getReader(),v=f.headers.get("X-File-Size")||f.headers.get("Content-Length"),x=v?parseInt(v):0,b=x!==0;let w=0;const M=new ReadableStream({start(S){C();function C(){g.read().then(({done:R,value:I})=>{if(R)S.close();else{w+=I.byteLength;const D=new ProgressEvent("progress",{lengthComputable:b,loaded:w,total:x});for(let O=0,U=p.length;O<U;O++){const k=p[O];k.onProgress&&k.onProgress(D)}S.enqueue(I),C()}},R=>{S.error(R)})}}});return new Response(M)}else throw new l6(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`,f)}).then(f=>{switch(u){case"arraybuffer":return f.arrayBuffer();case"blob":return f.blob();case"document":return f.text().then(p=>new DOMParser().parseFromString(p,l));case"json":return f.json();default:if(l==="")return f.text();{const g=/charset="?([^;"\s]*)"?/i.exec(l),v=g&&g[1]?g[1].toLowerCase():void 0,x=new TextDecoder(v);return f.arrayBuffer().then(b=>x.decode(b))}}}).then(f=>{yc.add(`file:${e}`,f);const p=gu[e];delete gu[e];for(let g=0,v=p.length;g<v;g++){const x=p[g];x.onLoad&&x.onLoad(f)}}).catch(f=>{const p=gu[e];if(p===void 0)throw this.manager.itemError(e),f;delete gu[e];for(let g=0,v=p.length;g<v;g++){const x=p[g];x.onError&&x.onError(f)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class c6 extends qa{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Cu(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{t(r.parse(JSON.parse(l)))}catch(u){s?s(u):kt(u),r.manager.itemError(e)}},n,s)}parse(e){const t=[];for(let n=0;n<e.length;n++){const s=Rv.parse(e[n]);t.push(s)}return t}}class u6 extends qa{constructor(e){super(e)}load(e,t,n,s){const r=this,o=[],l=new X1,u=new Cu(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(r.withCredentials);let f=0;function p(g){u.load(e[g],function(v){const x=r.parse(v,!0);o[g]={width:x.width,height:x.height,format:x.format,mipmaps:x.mipmaps},f+=1,f===6&&(x.mipmapCount===1&&(l.minFilter=ti),l.image=o,l.format=x.format,l.needsUpdate=!0,t&&t(l))},n,s)}if(Array.isArray(e))for(let g=0,v=e.length;g<v;++g)p(g);else u.load(e,function(g){const v=r.parse(g,!0);if(v.isCubemap){const x=v.mipmaps.length/v.mipmapCount;for(let b=0;b<x;b++){o[b]={mipmaps:[]};for(let w=0;w<v.mipmapCount;w++)o[b].mipmaps.push(v.mipmaps[b*v.mipmapCount+w]),o[b].format=v.format,o[b].width=v.width,o[b].height=v.height}l.image=o}else l.image.width=v.width,l.image.height=v.height,l.mipmaps=v.mipmaps;v.mipmapCount===1&&(l.minFilter=ti),l.format=v.format,l.needsUpdate=!0,t&&t(l)},n,s);return l}}const tm=new WeakMap;class Dv extends qa{constructor(e){super(e)}load(e,t,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=yc.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0);else{let g=tm.get(o);g===void 0&&(g=[],tm.set(o,g)),g.push({onLoad:t,onError:s})}return o}const l=Sv("img");function u(){p(),t&&t(this);const g=tm.get(this)||[];for(let v=0;v<g.length;v++){const x=g[v];x.onLoad&&x.onLoad(this)}tm.delete(this),r.manager.itemEnd(e)}function f(g){p(),s&&s(g),yc.remove(`image:${e}`);const v=tm.get(this)||[];for(let x=0;x<v.length;x++){const b=v[x];b.onError&&b.onError(g)}tm.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function p(){l.removeEventListener("load",u,!1),l.removeEventListener("error",f,!1)}return l.addEventListener("load",u,!1),l.addEventListener("error",f,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),yc.add(`image:${e}`,l),r.manager.itemStart(e),l.src=e,l}}class h6 extends qa{constructor(e){super(e)}load(e,t,n,s){const r=new Wv;r.colorSpace=Ir;const o=new Dv(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let l=0;function u(f){o.load(e[f],function(p){r.images[f]=p,l++,l===6&&(r.needsUpdate=!0,t&&t(r))},void 0,s)}for(let f=0;f<e.length;++f)u(f);return r}}class f6 extends qa{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Al,l=new Cu(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(r.withCredentials),l.load(e,function(u){let f;try{f=r.parse(u)}catch(p){if(s!==void 0)s(p);else{p(p);return}}f.image!==void 0?o.image=f.image:f.data!==void 0&&(o.image.width=f.width,o.image.height=f.height,o.image.data=f.data),o.wrapS=f.wrapS!==void 0?f.wrapS:Ga,o.wrapT=f.wrapT!==void 0?f.wrapT:Ga,o.magFilter=f.magFilter!==void 0?f.magFilter:ti,o.minFilter=f.minFilter!==void 0?f.minFilter:ti,o.anisotropy=f.anisotropy!==void 0?f.anisotropy:1,f.colorSpace!==void 0&&(o.colorSpace=f.colorSpace),f.flipY!==void 0&&(o.flipY=f.flipY),f.format!==void 0&&(o.format=f.format),f.type!==void 0&&(o.type=f.type),f.mipmaps!==void 0&&(o.mipmaps=f.mipmaps,o.minFilter=vc),f.mipmapCount===1&&(o.minFilter=ti),f.generateMipmaps!==void 0&&(o.generateMipmaps=f.generateMipmaps),o.needsUpdate=!0,t&&t(o,f)},n,s),o}}class d6 extends qa{constructor(e){super(e)}load(e,t,n,s){const r=new Ki,o=new Dv(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){r.image=l,r.needsUpdate=!0,t!==void 0&&t(r)},n,s),r}}class Kh extends zn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new St(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class eU extends Kh{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(zn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new St(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const uT=new Kt,oD=new re,lD=new re;class aE{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new st(512,512),this.mapType=ra,this.map=null,this.mapPass=null,this.matrix=new Kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Xm,this._frameExtents=new st(1,1),this._viewportCount=1,this._viewports=[new $n(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;oD.setFromMatrixPosition(e.matrixWorld),t.position.copy(oD),lD.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(lD),t.updateMatrixWorld(),uT.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(uT,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(uT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class p6 extends aE{constructor(){super(new ps(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Im*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height*this.aspect,r=e.distance||t.far;(n!==t.fov||s!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=s,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class tU extends Kh{constructor(e,t,n=0,s=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(zn.DEFAULT_UP),this.updateMatrix(),this.target=new zn,this.distance=n,this.angle=s,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new p6}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class m6 extends aE{constructor(){super(new ps(90,1,.5,500)),this.isPointLightShadow=!0}}class nU extends Kh{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new m6}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Mu extends z1{constructor(e=-1,t=1,n=1,s=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=n-e,o=n+e,l=s+t,u=s-t;if(this.view!==null&&this.view.enabled){const f=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=f*this.view.offsetX,o=r+f*this.view.width,l-=p*this.view.offsetY,u=l-p*this.view.height}this.projectionMatrix.makeOrthographic(r,o,l,u,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class g6 extends aE{constructor(){super(new Mu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class iU extends Kh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(zn.DEFAULT_UP),this.updateMatrix(),this.target=new zn,this.shadow=new g6}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class sU extends Kh{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class rU extends Kh{constructor(e,t,n=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class oE{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new re)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*s),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*s)),t.addScaledVector(o[5],1.092548*(s*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(n*r)),t.addScaledVector(o[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*s),t.addScaledVector(o[2],2*.511664*r),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*s),t.addScaledVector(o[5],2*.429043*s*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],2*.429043*n*r),t.addScaledVector(o[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const n=e.x,s=e.y,r=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-s*s)}}class aU extends Kh{constructor(e=new oE,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class oS extends qa{constructor(e){super(e),this.textures={}}load(e,t,n,s){const r=this,o=new Cu(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(l){try{t(r.parse(JSON.parse(l)))}catch(u){s?s(u):kt(u),r.manager.itemError(e)}},n,s)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&Tt("MaterialLoader: Undefined texture",r),t[r]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new St().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(s.allowOverride=e.allowOverride),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(s.uniforms[r]={},o.type){case"t":s.uniforms[r].value=n(o.value);break;case"c":s.uniforms[r].value=new St().setHex(o.value);break;case"v2":s.uniforms[r].value=new st().fromArray(o.value);break;case"v3":s.uniforms[r].value=new re().fromArray(o.value);break;case"v4":s.uniforms[r].value=new $n().fromArray(o.value);break;case"m3":s.uniforms[r].value=new on().fromArray(o.value);break;case"m4":s.uniforms[r].value=new Kt().fromArray(o.value);break;default:s.uniforms[r].value=o.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)s.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=new st().fromArray(r)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new st().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return oS.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:VP,SpriteMaterial:jA,RawShaderMaterial:eE,ShaderMaterial:ho,PointsMaterial:q1,MeshPhysicalMaterial:GP,MeshStandardMaterial:tE,MeshPhongMaterial:HP,MeshToonMaterial:WP,MeshNormalMaterial:jP,MeshLambertMaterial:qP,MeshDepthMaterial:rS,MeshDistanceMaterial:aS,MeshBasicMaterial:Iu,MeshMatcapMaterial:XP,LineDashedMaterial:YP,LineBasicMaterial:ua,Material:kr};return new t[e]}}class vw{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class lE extends nn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class oU extends qa{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Cu(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(l){try{t(r.parse(JSON.parse(l)))}catch(u){s?s(u):kt(u),r.manager.itemError(e)}},n,s)}parse(e){const t={},n={};function s(x,b){if(t[b]!==void 0)return t[b];const M=x.interleavedBuffers[b],S=r(x,M.buffer),C=vm(M.type,S),R=new H1(C,M.stride);return R.uuid=M.uuid,t[b]=R,R}function r(x,b){if(n[b]!==void 0)return n[b];const M=x.arrayBuffers[b],S=new Uint32Array(M).buffer;return n[b]=S,S}const o=e.isInstancedBufferGeometry?new lE:new nn,l=e.data.index;if(l!==void 0){const x=vm(l.type,l.array);o.setIndex(new li(x,1))}const u=e.data.attributes;for(const x in u){const b=u[x];let w;if(b.isInterleavedBufferAttribute){const M=s(e.data,b.data);w=new Sd(M,b.itemSize,b.offset,b.normalized)}else{const M=vm(b.type,b.array),S=b.isInstancedBufferAttribute?Md:li;w=new S(M,b.itemSize,b.normalized)}b.name!==void 0&&(w.name=b.name),b.usage!==void 0&&w.setUsage(b.usage),o.setAttribute(x,w)}const f=e.data.morphAttributes;if(f)for(const x in f){const b=f[x],w=[];for(let M=0,S=b.length;M<S;M++){const C=b[M];let R;if(C.isInterleavedBufferAttribute){const I=s(e.data,C.data);R=new Sd(I,C.itemSize,C.offset,C.normalized)}else{const I=vm(C.type,C.array);R=new li(I,C.itemSize,C.normalized)}C.name!==void 0&&(R.name=C.name),w.push(R)}o.morphAttributes[x]=w}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const g=e.data.groups||e.data.drawcalls||e.data.offsets;if(g!==void 0)for(let x=0,b=g.length;x!==b;++x){const w=g[x];o.addGroup(w.start,w.count,w.materialIndex)}const v=e.data.boundingSphere;return v!==void 0&&(o.boundingSphere=new er().fromJSON(v)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class v6 extends qa{constructor(e){super(e)}load(e,t,n,s){const r=this,o=this.path===""?vw.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const l=new Cu(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){let f=null;try{f=JSON.parse(u)}catch(g){s!==void 0&&s(g),g("ObjectLoader: Can't parse "+e+".",g.message);return}const p=f.metadata;if(p===void 0||p.type===void 0||p.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),kt("ObjectLoader: Can't load "+e);return}r.parse(f,t)},n,s)}async loadAsync(e,t){const n=this,s=this.path===""?vw.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const r=new Cu(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,t),l=JSON.parse(o),u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(l)}parse(e,t){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,s),o=this.parseImages(e.images,function(){t!==void 0&&t(f)}),l=this.parseTextures(e.textures,o),u=this.parseMaterials(e.materials,l),f=this.parseObject(e.object,r,u,l,n),p=this.parseSkeletons(e.skeletons,f);if(this.bindSkeletons(f,p),this.bindLightTargets(f),t!==void 0){let g=!1;for(const v in o)if(o[v].data instanceof HTMLImageElement){g=!0;break}g===!1&&t(f)}return f}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),l=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,s,l,o,t),f=this.parseSkeletons(e.skeletons,u);return this.bindSkeletons(u,f),this.bindLightTargets(u),u}parseShapes(e){const t={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const r=new Fh().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},s={};if(t.traverse(function(r){r.isBone&&(s[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const l=new W1().fromJSON(e[r],s);n[l.uuid]=l}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new oU;for(let r=0,o=e.length;r<o;r++){let l;const u=e[r];switch(u.type){case"BufferGeometry":case"InstancedBufferGeometry":l=s.parse(u);break;default:u.type in aD?l=aD[u.type].fromJSON(u,t):Tt(`ObjectLoader: Unsupported geometry type "${u.type}"`)}l.uuid=u.uuid,u.name!==void 0&&(l.name=u.name),u.userData!==void 0&&(l.userData=u.userData),n[u.uuid]=l}}return n}parseMaterials(e,t){const n={},s={};if(e!==void 0){const r=new oS;r.setTextures(t);for(let o=0,l=e.length;o<l;o++){const u=e[o];n[u.uuid]===void 0&&(n[u.uuid]=r.parse(u)),s[u.uuid]=n[u.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],r=Rv.parse(s);t[r.uuid]=r}return t}parseImages(e,t){const n=this,s={};let r;function o(u){return n.manager.itemStart(u),r.load(u,function(){n.manager.itemEnd(u)},void 0,function(){n.manager.itemError(u),n.manager.itemEnd(u)})}function l(u){if(typeof u=="string"){const f=u,p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:n.resourcePath+f;return o(p)}else return u.data?{data:vm(u.type,u.data),width:u.width,height:u.height}:null}if(e!==void 0&&e.length>0){const u=new rE(t);r=new Dv(u),r.setCrossOrigin(this.crossOrigin);for(let f=0,p=e.length;f<p;f++){const g=e[f],v=g.url;if(Array.isArray(v)){const x=[];for(let b=0,w=v.length;b<w;b++){const M=v[b],S=l(M);S!==null&&(S instanceof HTMLImageElement?x.push(S):x.push(new Al(S.data,S.width,S.height)))}s[g.uuid]=new Uh(x)}else{const x=l(g.url);s[g.uuid]=new Uh(x)}}}return s}async parseImagesAsync(e){const t=this,n={};let s;async function r(o){if(typeof o=="string"){const l=o,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:t.resourcePath+l;return await s.loadAsync(u)}else return o.data?{data:vm(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){s=new Dv(this.manager),s.setCrossOrigin(this.crossOrigin);for(let o=0,l=e.length;o<l;o++){const u=e[o],f=u.url;if(Array.isArray(f)){const p=[];for(let g=0,v=f.length;g<v;g++){const x=f[g],b=await r(x);b!==null&&(b instanceof HTMLImageElement?p.push(b):p.push(new Al(b.data,b.width,b.height)))}n[u.uuid]=new Uh(p)}else{const p=await r(u.url);n[u.uuid]=new Uh(p)}}}return n}parseTextures(e,t){function n(r,o){return typeof r=="number"?r:(Tt("ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const s={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const l=e[r];l.image===void 0&&Tt('ObjectLoader: No "image" specified for',l.uuid),t[l.image]===void 0&&Tt("ObjectLoader: Undefined image",l.image);const u=t[l.image],f=u.data;let p;Array.isArray(f)?(p=new Wv,f.length===6&&(p.needsUpdate=!0)):(f&&f.data?p=new Al:p=new Ki,f&&(p.needsUpdate=!0)),p.source=u,p.uuid=l.uuid,l.name!==void 0&&(p.name=l.name),l.mapping!==void 0&&(p.mapping=n(l.mapping,y6)),l.channel!==void 0&&(p.channel=l.channel),l.offset!==void 0&&p.offset.fromArray(l.offset),l.repeat!==void 0&&p.repeat.fromArray(l.repeat),l.center!==void 0&&p.center.fromArray(l.center),l.rotation!==void 0&&(p.rotation=l.rotation),l.wrap!==void 0&&(p.wrapS=n(l.wrap[0],cD),p.wrapT=n(l.wrap[1],cD)),l.format!==void 0&&(p.format=l.format),l.internalFormat!==void 0&&(p.internalFormat=l.internalFormat),l.type!==void 0&&(p.type=l.type),l.colorSpace!==void 0&&(p.colorSpace=l.colorSpace),l.minFilter!==void 0&&(p.minFilter=n(l.minFilter,uD)),l.magFilter!==void 0&&(p.magFilter=n(l.magFilter,uD)),l.anisotropy!==void 0&&(p.anisotropy=l.anisotropy),l.flipY!==void 0&&(p.flipY=l.flipY),l.generateMipmaps!==void 0&&(p.generateMipmaps=l.generateMipmaps),l.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(p.unpackAlignment=l.unpackAlignment),l.compareFunction!==void 0&&(p.compareFunction=l.compareFunction),l.userData!==void 0&&(p.userData=l.userData),s[l.uuid]=p}return s}parseObject(e,t,n,s,r){let o;function l(v){return t[v]===void 0&&Tt("ObjectLoader: Undefined geometry",v),t[v]}function u(v){if(v!==void 0){if(Array.isArray(v)){const x=[];for(let b=0,w=v.length;b<w;b++){const M=v[b];n[M]===void 0&&Tt("ObjectLoader: Undefined material",M),x.push(n[M])}return x}return n[v]===void 0&&Tt("ObjectLoader: Undefined material",v),n[v]}}function f(v){return s[v]===void 0&&Tt("ObjectLoader: Undefined texture",v),s[v]}let p,g;switch(e.type){case"Scene":o=new WA,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new St(e.background):o.background=f(e.background)),e.environment!==void 0&&(o.environment=f(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new G1(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new V1(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new ps(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Mu(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new sU(e.color,e.intensity);break;case"DirectionalLight":o=new iU(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new nU(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new rU(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new tU(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new eU(e.color,e.groundColor,e.intensity);break;case"LightProbe":const v=new oE().fromArray(e.sh);o=new aU(v,e.intensity);break;case"SkinnedMesh":p=l(e.geometry),g=u(e.material),o=new MP(p,g),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":p=l(e.geometry),g=u(e.material),o=new Qi(p,g);break;case"InstancedMesh":p=l(e.geometry),g=u(e.material);const x=e.count,b=e.instanceMatrix,w=e.instanceColor;o=new TP(p,g,x),o.instanceMatrix=new Md(new Float32Array(b.array),16),w!==void 0&&(o.instanceColor=new Md(new Float32Array(w.array),w.itemSize));break;case"BatchedMesh":p=l(e.geometry),g=u(e.material),o=new wP(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,g),o.geometry=p,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(M=>{let S=null,C=null;return M.boundingBox!==void 0&&(S=new $s().fromJSON(M.boundingBox)),M.boundingSphere!==void 0&&(C=new er().fromJSON(M.boundingSphere)),{...M,boundingBox:S,boundingSphere:C}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=f(e.matricesTexture.uuid),o._indirectTexture=f(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=f(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new er().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new $s().fromJSON(e.boundingBox));break;case"LOD":o=new SP;break;case"Line":o=new Wh(l(e.geometry),u(e.material));break;case"LineLoop":o=new AP(l(e.geometry),u(e.material));break;case"LineSegments":o=new Cc(l(e.geometry),u(e.material));break;case"PointCloud":case"Points":o=new EP(l(e.geometry),u(e.material));break;case"Sprite":o=new bP(u(e.material));break;case"Group":o=new ym;break;case"Bone":o=new qA;break;default:o=new zn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const v=e.children;for(let x=0;x<v.length;x++)o.add(this.parseObject(v[x],t,n,s,r))}if(e.animations!==void 0){const v=e.animations;for(let x=0;x<v.length;x++){const b=v[x];o.animations.push(r[b])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const v=e.levels;for(let x=0;x<v.length;x++){const b=v[x],w=o.getObjectByProperty("uuid",b.object);w!==void 0&&o.addLevel(w,b.distance,b.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=t[n.skeleton];s===void 0?Tt("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,s=e.getObjectByProperty("uuid",n);s!==void 0?t.target=s:t.target=new zn}})}}const y6={UVMapping:C1,CubeReflectionMapping:Sc,CubeRefractionMapping:Vh,EquirectangularReflectionMapping:pv,EquirectangularRefractionMapping:mv,CubeUVReflectionMapping:qm},cD={RepeatWrapping:gv,ClampToEdgeWrapping:Ga,MirroredRepeatWrapping:vv},uD={NearestFilter:ms,NearestMipmapNearestFilter:DA,NearestMipmapLinearFilter:gm,LinearFilter:ti,LinearMipmapNearestFilter:Q0,LinearMipmapLinearFilter:vc},hT=new WeakMap;class _6 extends qa{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Tt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Tt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=yc.get(`image-bitmap:${e}`);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(f=>{if(hT.has(o)===!0)s&&s(hT.get(o)),r.manager.itemError(e),r.manager.itemEnd(e);else return t&&t(f),r.manager.itemEnd(e),f});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader,l.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const u=fetch(e,l).then(function(f){return f.blob()}).then(function(f){return createImageBitmap(f,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(f){return yc.add(`image-bitmap:${e}`,f),t&&t(f),r.manager.itemEnd(e),f}).catch(function(f){s&&s(f),hT.set(u,f),yc.remove(`image-bitmap:${e}`),r.manager.itemError(e),r.manager.itemEnd(e)});yc.add(`image-bitmap:${e}`,u),r.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let Ax;class cE{static getContext(){return Ax===void 0&&(Ax=new(window.AudioContext||window.webkitAudioContext)),Ax}static setContext(e){Ax=e}}class x6 extends qa{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Cu(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(u){try{const f=u.slice(0);cE.getContext().decodeAudioData(f,function(g){t(g)}).catch(l)}catch(f){l(f)}},n,s);function l(u){s?s(u):kt(u),r.manager.itemError(e)}}}const hD=new Kt,fD=new Kt,Hf=new Kt;class b6{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ps,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ps,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Hf.copy(e.projectionMatrix);const s=t.eyeSep/2,r=s*t.near/t.focus,o=t.near*Math.tan(gd*t.fov*.5)/t.zoom;let l,u;fD.elements[12]=-s,hD.elements[12]=s,l=-o*t.aspect+r,u=o*t.aspect+r,Hf.elements[0]=2*t.near/(u-l),Hf.elements[8]=(u+l)/(u-l),this.cameraL.projectionMatrix.copy(Hf),l=-o*t.aspect-r,u=o*t.aspect-r,Hf.elements[0]=2*t.near/(u-l),Hf.elements[8]=(u+l)/(u-l),this.cameraR.projectionMatrix.copy(Hf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(fD),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(hD)}}class lU extends ps{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let uE=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};const Wf=new re,fT=new Fr,S6=new re,jf=new re,qf=new re;class M6 extends zn{constructor(){super(),this.type="AudioListener",this.context=cE.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new uE}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Wf,fT,S6),jf.set(0,0,-1).applyQuaternion(fT),qf.set(0,1,0).applyQuaternion(fT),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Wf.x,n),t.positionY.linearRampToValueAtTime(Wf.y,n),t.positionZ.linearRampToValueAtTime(Wf.z,n),t.forwardX.linearRampToValueAtTime(jf.x,n),t.forwardY.linearRampToValueAtTime(jf.y,n),t.forwardZ.linearRampToValueAtTime(jf.z,n),t.upX.linearRampToValueAtTime(qf.x,n),t.upY.linearRampToValueAtTime(qf.y,n),t.upZ.linearRampToValueAtTime(qf.z,n)}else t.setPosition(Wf.x,Wf.y,Wf.z),t.setOrientation(jf.x,jf.y,jf.z,qf.x,qf.y,qf.z)}}class cU extends zn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Tt("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Tt("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Tt("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Tt("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Tt("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Tt("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Tt("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Tt("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Xf=new re,dD=new Fr,T6=new re,Yf=new re;class w6 extends cU{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Xf,dD,T6),Yf.set(0,0,1).applyQuaternion(dD);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Xf.x,n),t.positionY.linearRampToValueAtTime(Xf.y,n),t.positionZ.linearRampToValueAtTime(Xf.z,n),t.orientationX.linearRampToValueAtTime(Yf.x,n),t.orientationY.linearRampToValueAtTime(Yf.y,n),t.orientationZ.linearRampToValueAtTime(Yf.z,n)}else t.setPosition(Xf.x,Xf.y,Xf.z),t.setOrientation(Yf.x,Yf.y,Yf.z)}}class A6{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class uU{constructor(e,t,n){this.binding=e,this.valueSize=n;let s,r,o;switch(t){case"quaternion":s=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,r=e*s+s;let o=this.cumulativeWeight;if(o===0){for(let l=0;l!==s;++l)n[r+l]=n[l];o=t}else{o+=t;const l=t/o;this._mixBufferRegion(n,r,0,l,s)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const u=t*this._origIndex;this._mixBufferRegion(n,s,u,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let u=t,f=t+t;u!==f;++u)if(n[u]!==n[u+t]){l.setValue(n,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(t,s);for(let r=n,o=s;r!==o;++r)t[r]=t[s+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,r){if(s>=.5)for(let o=0;o!==r;++o)e[t+o]=e[n+o]}_slerp(e,t,n,s){Fr.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,r){const o=this._workIndex*r;Fr.multiplyQuaternionsFlat(e,o,e,t,e,n),Fr.slerpFlat(e,t,e,t,e,o,s)}_lerp(e,t,n,s,r){const o=1-s;for(let l=0;l!==r;++l){const u=t+l;e[u]=e[u]*o+e[n+l]*s}}_lerpAdditive(e,t,n,s,r){for(let o=0;o!==r;++o){const l=t+o;e[l]=e[l]+e[n+o]*s}}}const hE="\\[\\]\\.:\\/",E6=new RegExp("["+hE+"]","g"),fE="[^"+hE+"]",C6="[^"+hE.replace("\\.","")+"]",R6=/((?:WC+[\/:])*)/.source.replace("WC",fE),D6=/(WCOD+)?/.source.replace("WCOD",C6),N6=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",fE),I6=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",fE),O6=new RegExp("^"+R6+D6+N6+I6+"$"),P6=["material","materials","bones","map"];class U6{constructor(e,t,n){const s=n||Bn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=n.length;s!==r;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Bn{constructor(e,t,n){this.path=t,this.parsedPath=n||Bn.parseTrackName(t),this.node=Bn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Bn.Composite(e,t,n):new Bn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(E6,"")}static parseTrackName(e){const t=O6.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=n.nodeName.substring(s+1);P6.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let o=0;o<r.length;o++){const l=r[o];if(l.name===t||l.uuid===t)return l;const u=n(l.children);if(u)return u}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)e[t++]=n[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,s=t.propertyName;let r=t.propertyIndex;if(e||(e=Bn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Tt("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let f=t.objectIndex;switch(n){case"materials":if(!e.material){kt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){kt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){kt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let p=0;p<e.length;p++)if(e[p].name===f){f=p;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){kt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){kt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){kt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(f!==void 0){if(e[f]===void 0){kt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[f]}}const o=e[s];if(o===void 0){const f=t.nodeName;kt("PropertyBinding: Trying to update property for track: "+f+"."+s+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?l=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){kt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){kt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Bn.Composite=U6;Bn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Bn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Bn.prototype.GetterByBindingType=[Bn.prototype._getValue_direct,Bn.prototype._getValue_array,Bn.prototype._getValue_arrayElement,Bn.prototype._getValue_toArray];Bn.prototype.SetterByBindingTypeAndVersioning=[[Bn.prototype._setValue_direct,Bn.prototype._setValue_direct_setNeedsUpdate,Bn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Bn.prototype._setValue_array,Bn.prototype._setValue_array_setNeedsUpdate,Bn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Bn.prototype._setValue_arrayElement,Bn.prototype._setValue_arrayElement_setNeedsUpdate,Bn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Bn.prototype._setValue_fromArray,Bn.prototype._setValue_fromArray_setNeedsUpdate,Bn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class L6{constructor(){this.isAnimationObjectGroup=!0,this.uuid=lo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length;let l,u=e.length,f=this.nCachedObjects_;for(let p=0,g=arguments.length;p!==g;++p){const v=arguments[p],x=v.uuid;let b=t[x];if(b===void 0){b=u++,t[x]=b,e.push(v);for(let w=0,M=o;w!==M;++w)r[w].push(new Bn(v,n[w],s[w]))}else if(b<f){l=e[b];const w=--f,M=e[w];t[M.uuid]=b,e[b]=M,t[x]=w,e[w]=v;for(let S=0,C=o;S!==C;++S){const R=r[S],I=R[w];let D=R[b];R[b]=I,D===void 0&&(D=new Bn(v,n[S],s[S])),R[w]=D}}else e[b]!==l&&kt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=f}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_;for(let o=0,l=arguments.length;o!==l;++o){const u=arguments[o],f=u.uuid,p=t[f];if(p!==void 0&&p>=r){const g=r++,v=e[g];t[v.uuid]=p,e[p]=v,t[f]=g,e[g]=u;for(let x=0,b=s;x!==b;++x){const w=n[x],M=w[g],S=w[p];w[p]=M,w[g]=S}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_,o=e.length;for(let l=0,u=arguments.length;l!==u;++l){const f=arguments[l],p=f.uuid,g=t[p];if(g!==void 0)if(delete t[p],g<r){const v=--r,x=e[v],b=--o,w=e[b];t[x.uuid]=g,e[g]=x,t[w.uuid]=v,e[v]=w,e.pop();for(let M=0,S=s;M!==S;++M){const C=n[M],R=C[v],I=C[b];C[g]=R,C[v]=I,C.pop()}}else{const v=--o,x=e[v];v>0&&(t[x.uuid]=g),e[g]=x,e.pop();for(let b=0,w=s;b!==w;++b){const M=n[b];M[g]=M[v],M.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let s=n[e];const r=this._bindings;if(s!==void 0)return r[s];const o=this._paths,l=this._parsedPaths,u=this._objects,f=u.length,p=this.nCachedObjects_,g=new Array(f);s=r.length,n[e]=s,o.push(e),l.push(t),r.push(g);for(let v=p,x=u.length;v!==x;++v){const b=u[v];g[v]=new Bn(b,e,t)}return g}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const s=this._paths,r=this._parsedPaths,o=this._bindings,l=o.length-1,u=o[l],f=e[l];t[f]=n,o[n]=u,o.pop(),r[n]=r[l],r.pop(),s[n]=s[l],s.pop()}}}class hU{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const r=t.tracks,o=r.length,l=new Array(o),u={endingStart:od,endingEnd:od};for(let f=0;f!==o;++f){const p=r[f].createInterpolant(null);l[f]=p,p.settings=u}this._interpolantSettings=u,this._interpolants=l,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=nP,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const s=this._clip.duration,r=e._clip.duration,o=r/s,l=s/r;e.warp(1,o,t),this.warp(l,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,r=s.time,o=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=s._lendControlInterpolant(),this._timeScaleInterpolant=l);const u=l.parameterPositions,f=l.sampleValues;return u[0]=r,u[1]=r+n,f[0]=e/o,f[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const u=(e-r)*n;u<0||n===0?t=0:(this._startTime=null,t=n*u)}t*=this._updateTimeScale(e);const o=this._updateTime(t),l=this._updateWeight(e);if(l>0){const u=this._interpolants,f=this._propertyBindings;switch(this.blendMode){case FA:for(let p=0,g=u.length;p!==g;++p)u[p].evaluate(o),f[p].accumulateAdditive(l);break;case U1:default:for(let p=0,g=u.length;p!==g;++p)u[p].evaluate(o),f[p].accumulate(s,l)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,r=this._loopCount;const o=n===iP;if(e===0)return r===-1?s:o&&(r&1)===1?t-s:s;if(n===tP){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),s>=t||s<0){const l=Math.floor(s/t);s-=t*l,r+=Math.abs(l);const u=this.repetitions-r;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const f=e<0;this._setEndings(f,!f,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=s;if(o&&(r&1)===1)return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=ld,s.endingEnd=ld):(e?s.endingStart=this.zeroSlopeAtStart?ld:od:s.endingStart=_v,t?s.endingEnd=this.zeroSlopeAtEnd?ld:od:s.endingEnd=_v)}_scheduleFading(e,t,n){const s=this._mixer,r=s.time;let o=this._weightInterpolant;o===null&&(o=s._lendControlInterpolant(),this._weightInterpolant=o);const l=o.parameterPositions,u=o.sampleValues;return l[0]=r,u[0]=t,l[1]=r+e,u[1]=n,this}}const F6=new Float32Array(1);class k6 extends Ec{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,r=s.length,o=e._propertyBindings,l=e._interpolants,u=n.uuid,f=this._bindingsByRootAndName;let p=f[u];p===void 0&&(p={},f[u]=p);for(let g=0;g!==r;++g){const v=s[g],x=v.name;let b=p[x];if(b!==void 0)++b.referenceCount,o[g]=b;else{if(b=o[g],b!==void 0){b._cacheIndex===null&&(++b.referenceCount,this._addInactiveBinding(b,u,x));continue}const w=t&&t._propertyBindings[g].binding.parsedPath;b=new uU(Bn.create(n,x,w),v.ValueTypeName,v.getValueSize()),++b.referenceCount,this._addInactiveBinding(b,u,x),o[g]=b}l[g].resultBuffer=b.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,r=this._actionsByClip[s];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const l=o.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=s.length,s.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,l=o[r],u=l.knownActions,f=u[u.length-1],p=e._byClipCacheIndex;f._byClipCacheIndex=p,u[p]=f,u.pop(),e._byClipCacheIndex=null;const g=l.actionByRoot,v=(e._localRoot||this._root).uuid;delete g[v],u.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,r=this._bindings;let o=s[t];o===void 0&&(o={},s[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,l=o[s],u=t[t.length-1],f=e._cacheIndex;u._cacheIndex=f,t[f]=u,t.pop(),delete l[r],Object.keys(l).length===0&&delete o[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new iE(new Float32Array(2),new Float32Array(2),1,F6),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,r=t[s];e.__cacheIndex=s,t[s]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const s=t||this._root,r=s.uuid;let o=typeof e=="string"?Rv.findByName(s,e):e;const l=o!==null?o.uuid:e,u=this._actionsByClip[l];let f=null;if(n===void 0&&(o!==null?n=o.blendMode:n=U1),u!==void 0){const g=u.actionByRoot[r];if(g!==void 0&&g.blendMode===n)return g;f=u.knownActions[0],o===null&&(o=f._clip)}if(o===null)return null;const p=new hU(this,o,t,n);return this._bindAction(p,f),this._addInactiveAction(p,l,r),p}existingAction(e,t){const n=t||this._root,s=n.uuid,r=typeof e=="string"?Rv.findByName(n,e):e,o=r?r.uuid:e,l=this._actionsByClip[o];return l!==void 0&&l.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,s=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let f=0;f!==n;++f)t[f]._update(s,e,r,o);const l=this._bindings,u=this._nActiveBindings;for(let f=0;f!==u;++f)l[f].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,r=s[n];if(r!==void 0){const o=r.knownActions;for(let l=0,u=o.length;l!==u;++l){const f=o[l];this._deactivateAction(f);const p=f._cacheIndex,g=t[t.length-1];f._cacheIndex=null,f._byClipCacheIndex=null,g._cacheIndex=p,t[p]=g,t.pop(),this._removeInactiveBindingsForAction(f)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const l=n[o].actionByRoot,u=l[t];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const s=this._bindingsByRootAndName,r=s[t];if(r!==void 0)for(const o in r){const l=r[o];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class B6 extends BA{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=n,this.texture=new B1(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class dE{constructor(e){this.value=e}clone(){return new dE(this.value.clone===void 0?this.value:this.value.clone())}}let z6=0;class V6 extends Ec{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:z6++}),this.name="",this.usage=bv,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,s=t.length;n<s;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class G6 extends H1{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class H6{constructor(e,t,n,s,r,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=s,this.count=r,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const pD=new Kt;class fU{constructor(e,t,n=0,s=1/0){this.ray=new Nd(e,t),this.near=n,this.far=s,this.camera=null,this.layers=new Om,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):kt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return pD.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(pD),this}intersectObject(e,t=!0,n=[]){return yw(e,this,n,t),n.sort(mD),n}intersectObjects(e,t=!0,n=[]){for(let s=0,r=e.length;s<r;s++)yw(e[s],this,n,t);return n.sort(mD),n}}function mD(i,e){return i.distance-e.distance}function yw(i,e,t,n){let s=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(s=!1),s===!0&&n===!0){const r=i.children;for(let o=0,l=r.length;o<l;o++)yw(r[o],e,t,!0)}}class W6{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=j6.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function j6(){this._document.hidden===!1&&this.reset()}class n1{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Qt(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Qt(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class q6{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class pE{constructor(e,t,n,s){pE.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,s){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=s,this}}const gD=new st;class X6{constructor(e=new st(1/0,1/0),t=new st(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=gD.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,gD).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const vD=new re,Ex=new re,nm=new re,im=new re,dT=new re,Y6=new re,Z6=new re;class K6{constructor(e=new re,t=new re){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){vD.subVectors(e,this.start),Ex.subVectors(this.end,this.start);const n=Ex.dot(Ex);let r=Ex.dot(vD)/n;return t&&(r=Qt(r,0,1)),r}closestPointToPoint(e,t,n){const s=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(s).add(this.start)}distanceSqToLine3(e,t=Y6,n=Z6){const s=10000000000000001e-32;let r,o;const l=this.start,u=e.start,f=this.end,p=e.end;nm.subVectors(f,l),im.subVectors(p,u),dT.subVectors(l,u);const g=nm.dot(nm),v=im.dot(im),x=im.dot(dT);if(g<=s&&v<=s)return t.copy(l),n.copy(u),t.sub(n),t.dot(t);if(g<=s)r=0,o=x/v,o=Qt(o,0,1);else{const b=nm.dot(dT);if(v<=s)o=0,r=Qt(-b/g,0,1);else{const w=nm.dot(im),M=g*v-w*w;M!==0?r=Qt((w*x-b*v)/M,0,1):r=0,o=(w*r+x)/v,o<0?(o=0,r=Qt(-b/g,0,1)):o>1&&(o=1,r=Qt((w-b)/g,0,1))}}return t.copy(l).add(nm.multiplyScalar(r)),n.copy(u).add(im.multiplyScalar(o)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const yD=new re;class Q6 extends zn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new nn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,l=1,u=32;o<u;o++,l++){const f=o/u*Math.PI*2,p=l/u*Math.PI*2;s.push(Math.cos(f),Math.sin(f),1,Math.cos(p),Math.sin(p),1)}n.setAttribute("position",new It(s,3));const r=new ua({fog:!1,toneMapped:!1});this.cone=new Cc(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),yD.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(yD),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ch=new re,Cx=new Kt,pT=new Kt;class J6 extends Cc{constructor(e){const t=dU(e),n=new nn,s=[],r=[];for(let f=0;f<t.length;f++){const p=t[f];p.parent&&p.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),r.push(0,0,0),r.push(0,0,0))}n.setAttribute("position",new It(s,3)),n.setAttribute("color",new It(r,3));const o=new ua({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const l=new St(255),u=new St(65280);this.setColors(l,u)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");pT.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const l=t[r];l.parent&&l.parent.isBone&&(Cx.multiplyMatrices(pT,l.matrixWorld),Ch.setFromMatrixPosition(Cx),s.setXYZ(o,Ch.x,Ch.y,Ch.z),Cx.multiplyMatrices(pT,l.parent.matrixWorld),Ch.setFromMatrixPosition(Cx),s.setXYZ(o+1,Ch.x,Ch.y,Ch.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const s=this.geometry.getAttribute("color");for(let r=0;r<s.count;r+=2)s.setXYZ(r,e.r,e.g,e.b),s.setXYZ(r+1,t.r,t.g,t.b);return s.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function dU(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...dU(i.children[t]));return e}class $6 extends Qi{constructor(e,t,n){const s=new Yv(t,4,2),r=new Iu({wireframe:!0,fog:!1,toneMapped:!1});super(s,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const e8=new re,_D=new St,xD=new St;class t8 extends zn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new Ym(t);s.rotateY(Math.PI*.5),this.material=new Iu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=s.getAttribute("position"),o=new Float32Array(r.count*3);s.setAttribute("color",new li(o,3)),this.add(new Qi(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");_D.copy(this.light.color),xD.copy(this.light.groundColor);for(let n=0,s=t.count;n<s;n++){const r=n<s/2?_D:xD;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(e8.setFromMatrixPosition(this.light.matrixWorld).negate())}}class n8 extends Cc{constructor(e=10,t=10,n=4473924,s=8947848){n=new St(n),s=new St(s);const r=t/2,o=e/t,l=e/2,u=[],f=[];for(let v=0,x=0,b=-l;v<=t;v++,b+=o){u.push(-l,0,b,l,0,b),u.push(b,0,-l,b,0,l);const w=v===r?n:s;w.toArray(f,x),x+=3,w.toArray(f,x),x+=3,w.toArray(f,x),x+=3,w.toArray(f,x),x+=3}const p=new nn;p.setAttribute("position",new It(u,3)),p.setAttribute("color",new It(f,3));const g=new ua({vertexColors:!0,toneMapped:!1});super(p,g),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class i8 extends Cc{constructor(e=10,t=16,n=8,s=64,r=4473924,o=8947848){r=new St(r),o=new St(o);const l=[],u=[];if(t>1)for(let g=0;g<t;g++){const v=g/t*(Math.PI*2),x=Math.sin(v)*e,b=Math.cos(v)*e;l.push(0,0,0),l.push(x,0,b);const w=g&1?r:o;u.push(w.r,w.g,w.b),u.push(w.r,w.g,w.b)}for(let g=0;g<n;g++){const v=g&1?r:o,x=e-e/n*g;for(let b=0;b<s;b++){let w=b/s*(Math.PI*2),M=Math.sin(w)*x,S=Math.cos(w)*x;l.push(M,0,S),u.push(v.r,v.g,v.b),w=(b+1)/s*(Math.PI*2),M=Math.sin(w)*x,S=Math.cos(w)*x,l.push(M,0,S),u.push(v.r,v.g,v.b)}}const f=new nn;f.setAttribute("position",new It(l,3)),f.setAttribute("color",new It(u,3));const p=new ua({vertexColors:!0,toneMapped:!1});super(f,p),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const bD=new re,Rx=new re,SD=new re;class s8 extends zn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new nn;s.setAttribute("position",new It([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new ua({fog:!1,toneMapped:!1});this.lightPlane=new Wh(s,r),this.add(this.lightPlane),s=new nn,s.setAttribute("position",new It([0,0,0,0,0,1],3)),this.targetLine=new Wh(s,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),bD.setFromMatrixPosition(this.light.matrixWorld),Rx.setFromMatrixPosition(this.light.target.matrixWorld),SD.subVectors(Rx,bD),this.lightPlane.lookAt(Rx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Rx),this.targetLine.scale.z=SD.length()}}const Dx=new re,ss=new z1;class r8 extends Cc{constructor(e){const t=new nn,n=new ua({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],r=[],o={};l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4");function l(b,w){u(b),u(w)}function u(b){s.push(0,0,0),r.push(0,0,0),o[b]===void 0&&(o[b]=[]),o[b].push(s.length/3-1)}t.setAttribute("position",new It(s,3)),t.setAttribute("color",new It(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const f=new St(16755200),p=new St(16711680),g=new St(43775),v=new St(16777215),x=new St(3355443);this.setColors(f,p,g,v,x)}setColors(e,t,n,s,r){const l=this.geometry.getAttribute("color");return l.setXYZ(0,e.r,e.g,e.b),l.setXYZ(1,e.r,e.g,e.b),l.setXYZ(2,e.r,e.g,e.b),l.setXYZ(3,e.r,e.g,e.b),l.setXYZ(4,e.r,e.g,e.b),l.setXYZ(5,e.r,e.g,e.b),l.setXYZ(6,e.r,e.g,e.b),l.setXYZ(7,e.r,e.g,e.b),l.setXYZ(8,e.r,e.g,e.b),l.setXYZ(9,e.r,e.g,e.b),l.setXYZ(10,e.r,e.g,e.b),l.setXYZ(11,e.r,e.g,e.b),l.setXYZ(12,e.r,e.g,e.b),l.setXYZ(13,e.r,e.g,e.b),l.setXYZ(14,e.r,e.g,e.b),l.setXYZ(15,e.r,e.g,e.b),l.setXYZ(16,e.r,e.g,e.b),l.setXYZ(17,e.r,e.g,e.b),l.setXYZ(18,e.r,e.g,e.b),l.setXYZ(19,e.r,e.g,e.b),l.setXYZ(20,e.r,e.g,e.b),l.setXYZ(21,e.r,e.g,e.b),l.setXYZ(22,e.r,e.g,e.b),l.setXYZ(23,e.r,e.g,e.b),l.setXYZ(24,t.r,t.g,t.b),l.setXYZ(25,t.r,t.g,t.b),l.setXYZ(26,t.r,t.g,t.b),l.setXYZ(27,t.r,t.g,t.b),l.setXYZ(28,t.r,t.g,t.b),l.setXYZ(29,t.r,t.g,t.b),l.setXYZ(30,t.r,t.g,t.b),l.setXYZ(31,t.r,t.g,t.b),l.setXYZ(32,n.r,n.g,n.b),l.setXYZ(33,n.r,n.g,n.b),l.setXYZ(34,n.r,n.g,n.b),l.setXYZ(35,n.r,n.g,n.b),l.setXYZ(36,n.r,n.g,n.b),l.setXYZ(37,n.r,n.g,n.b),l.setXYZ(38,s.r,s.g,s.b),l.setXYZ(39,s.r,s.g,s.b),l.setXYZ(40,r.r,r.g,r.b),l.setXYZ(41,r.r,r.g,r.b),l.setXYZ(42,r.r,r.g,r.b),l.setXYZ(43,r.r,r.g,r.b),l.setXYZ(44,r.r,r.g,r.b),l.setXYZ(45,r.r,r.g,r.b),l.setXYZ(46,r.r,r.g,r.b),l.setXYZ(47,r.r,r.g,r.b),l.setXYZ(48,r.r,r.g,r.b),l.setXYZ(49,r.r,r.g,r.b),l.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,s=1;let r,o;if(ss.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)r=1,o=0;else if(this.camera.coordinateSystem===ao)r=-1,o=1;else if(this.camera.coordinateSystem===Dm)r=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);ds("c",t,e,ss,0,0,r),ds("t",t,e,ss,0,0,o),ds("n1",t,e,ss,-n,-s,r),ds("n2",t,e,ss,n,-s,r),ds("n3",t,e,ss,-n,s,r),ds("n4",t,e,ss,n,s,r),ds("f1",t,e,ss,-n,-s,o),ds("f2",t,e,ss,n,-s,o),ds("f3",t,e,ss,-n,s,o),ds("f4",t,e,ss,n,s,o),ds("u1",t,e,ss,n*.7,s*1.1,r),ds("u2",t,e,ss,-n*.7,s*1.1,r),ds("u3",t,e,ss,0,s*2,r),ds("cf1",t,e,ss,-n,0,o),ds("cf2",t,e,ss,n,0,o),ds("cf3",t,e,ss,0,-s,o),ds("cf4",t,e,ss,0,s,o),ds("cn1",t,e,ss,-n,0,r),ds("cn2",t,e,ss,n,0,r),ds("cn3",t,e,ss,0,-s,r),ds("cn4",t,e,ss,0,s,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ds(i,e,t,n,s,r,o){Dx.set(s,r,o).unproject(n);const l=e[i];if(l!==void 0){const u=t.getAttribute("position");for(let f=0,p=l.length;f<p;f++)u.setXYZ(l[f],Dx.x,Dx.y,Dx.z)}}const Nx=new $s;class a8 extends Cc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),r=new nn;r.setIndex(new li(n,1)),r.setAttribute("position",new li(s,3)),super(r,new ua({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Nx.setFromObject(this.object),Nx.isEmpty())return;const e=Nx.min,t=Nx.max,n=this.geometry.attributes.position,s=n.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class o8 extends Cc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new nn;r.setIndex(new li(n,1)),r.setAttribute("position",new It(s,3)),super(r,new ua({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class l8 extends Wh{constructor(e,t=1,n=16776960){const s=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new nn;o.setAttribute("position",new It(r,3)),o.computeBoundingSphere(),super(o,new ua({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],u=new nn;u.setAttribute("position",new It(l,3)),u.computeBoundingSphere(),this.add(new Qi(u,new Iu({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const MD=new re;let Ix,mT;class c8 extends zn{constructor(e=new re(0,0,1),t=new re(0,0,0),n=1,s=16776960,r=n*.2,o=r*.2){super(),this.type="ArrowHelper",Ix===void 0&&(Ix=new nn,Ix.setAttribute("position",new It([0,0,0,0,1,0],3)),mT=new qv(.5,1,5,1),mT.translate(0,-.5,0)),this.position.copy(t),this.line=new Wh(Ix,new ua({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Qi(mT,new Iu({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{MD.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(MD,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class u8 extends Cc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new nn;s.setAttribute("position",new It(t,3)),s.setAttribute("color",new It(n,3));const r=new ua({vertexColors:!0,toneMapped:!1});super(s,r),this.type="AxesHelper"}setColors(e,t,n){const s=new St,r=this.geometry.attributes.color.array;return s.set(e),s.toArray(r,0),s.toArray(r,3),s.set(t),s.toArray(r,6),s.toArray(r,9),s.set(n),s.toArray(r,12),s.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class h8{constructor(){this.type="ShapePath",this.color=new St,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new t1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,s){return this.currentPath.quadraticCurveTo(e,t,n,s),this}bezierCurveTo(e,t,n,s,r,o){return this.currentPath.bezierCurveTo(e,t,n,s,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const C=[];for(let R=0,I=S.length;R<I;R++){const D=S[R],O=new Fh;O.curves=D.curves,C.push(O)}return C}function n(S,C){const R=C.length;let I=!1;for(let D=R-1,O=0;O<R;D=O++){let U=C[D],k=C[O],P=k.x-U.x,F=k.y-U.y;if(Math.abs(F)>Number.EPSILON){if(F<0&&(U=C[O],P=-P,k=C[D],F=-F),S.y<U.y||S.y>k.y)continue;if(S.y===U.y){if(S.x===U.x)return!0}else{const H=F*(S.x-U.x)-P*(S.y-U.y);if(H===0)return!0;if(H<0)continue;I=!I}}else{if(S.y!==U.y)continue;if(k.x<=S.x&&S.x<=U.x||U.x<=S.x&&S.x<=k.x)return!0}}return I}const s=Ml.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,l,u;const f=[];if(r.length===1)return l=r[0],u=new Fh,u.curves=l.curves,f.push(u),f;let p=!s(r[0].getPoints());p=e?!p:p;const g=[],v=[];let x=[],b=0,w;v[b]=void 0,x[b]=[];for(let S=0,C=r.length;S<C;S++)l=r[S],w=l.getPoints(),o=s(w),o=e?!o:o,o?(!p&&v[b]&&b++,v[b]={s:new Fh,p:w},v[b].s.curves=l.curves,p&&b++,x[b]=[]):x[b].push({h:l,p:w[0]});if(!v[0])return t(r);if(v.length>1){let S=!1,C=0;for(let R=0,I=v.length;R<I;R++)g[R]=[];for(let R=0,I=v.length;R<I;R++){const D=x[R];for(let O=0;O<D.length;O++){const U=D[O];let k=!0;for(let P=0;P<v.length;P++)n(U.p,v[P].p)&&(R!==P&&C++,k?(k=!1,g[P].push(U)):S=!0);k&&g[R].push(U)}}C>0&&S===!1&&(x=g)}let M;for(let S=0,C=v.length;S<C;S++){u=v[S].s,f.push(u),M=x[S];for(let R=0,I=M.length;R<I;R++)u.holes.push(M[R].h)}return f}}class f8 extends Ec{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Tt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function d8(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function p8(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function m8(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function _w(i,e,t,n){const s=g8(n);switch(t){case UA:return i*e;case I1:return i*e/s.components*s.byteLength;case Hv:return i*e/s.components*s.byteLength;case bd:return i*e*2/s.components*s.byteLength;case O1:return i*e*2/s.components*s.byteLength;case LA:return i*e*3/s.components*s.byteLength;case Ur:return i*e*4/s.components*s.byteLength;case P1:return i*e*4/s.components*s.byteLength;case J0:case $0:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case ev:case tv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case xb:case Sb:return Math.max(i,16)*Math.max(e,8)/4;case _b:case bb:return Math.max(i,8)*Math.max(e,8)/2;case Mb:case Tb:case Ab:case Eb:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case wb:case Cb:case Rb:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Db:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Nb:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case Ib:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case Ob:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case Pb:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case Ub:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Lb:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case Fb:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case kb:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Bb:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case zb:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case Vb:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Gb:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case Hb:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Wb:case jb:case qb:return Math.ceil(i/4)*Math.ceil(e/4)*16;case Xb:case Yb:return Math.ceil(i/4)*Math.ceil(e/4)*8;case Zb:case Kb:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function g8(i){switch(i){case ra:case NA:return{byteLength:1,components:1};case Cm:case IA:case El:return{byteLength:2,components:1};case D1:case N1:return{byteLength:2,components:4};case Ko:case R1:case Pr:return{byteLength:4,components:1};case OA:case PA:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class v8{static contain(e,t){return d8(e,t)}static cover(e,t){return p8(e,t)}static fill(e){return m8(e)}static getByteLength(e,t,n,s){return _w(e,t,n,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Vv}}));typeof window<"u"&&(window.__THREE__?Tt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Vv);function pU(){let i=null,e=!1,t=null,n=null;function s(r,o){t(r,o),n=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){i=r}}}function y8(i){const e=new WeakMap;function t(l,u){const f=l.array,p=l.usage,g=f.byteLength,v=i.createBuffer();i.bindBuffer(u,v),i.bufferData(u,f,p),l.onUploadCallback();let x;if(f instanceof Float32Array)x=i.FLOAT;else if(typeof Float16Array<"u"&&f instanceof Float16Array)x=i.HALF_FLOAT;else if(f instanceof Uint16Array)l.isFloat16BufferAttribute?x=i.HALF_FLOAT:x=i.UNSIGNED_SHORT;else if(f instanceof Int16Array)x=i.SHORT;else if(f instanceof Uint32Array)x=i.UNSIGNED_INT;else if(f instanceof Int32Array)x=i.INT;else if(f instanceof Int8Array)x=i.BYTE;else if(f instanceof Uint8Array)x=i.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)x=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:v,type:x,bytesPerElement:f.BYTES_PER_ELEMENT,version:l.version,size:g}}function n(l,u,f){const p=u.array,g=u.updateRanges;if(i.bindBuffer(f,l),g.length===0)i.bufferSubData(f,0,p);else{g.sort((x,b)=>x.start-b.start);let v=0;for(let x=1;x<g.length;x++){const b=g[v],w=g[x];w.start<=b.start+b.count+1?b.count=Math.max(b.count,w.start+w.count-b.start):(++v,g[v]=w)}g.length=v+1;for(let x=0,b=g.length;x<b;x++){const w=g[x];i.bufferSubData(f,w.start*p.BYTES_PER_ELEMENT,p,w.start,w.count)}u.clearUpdateRanges()}u.onUploadCallback()}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function r(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=e.get(l);u&&(i.deleteBuffer(u.buffer),e.delete(l))}function o(l,u){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){const p=e.get(l);(!p||p.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}const f=e.get(l);if(f===void 0)e.set(l,t(l,u));else if(f.version<l.version){if(f.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(f.buffer,l,u),f.version=l.version}}return{get:s,remove:r,update:o}}var _8=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,x8=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,b8=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,S8=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,M8=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,T8=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,w8=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,A8=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,E8=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,C8=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,R8=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,D8=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,N8=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,I8=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,O8=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,P8=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,U8=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,L8=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,F8=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,k8=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,B8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,z8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,V8=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,G8=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,H8=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,W8=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,j8=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,q8=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,X8=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Y8=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Z8="gl_FragColor = linearToOutputTexel( gl_FragColor );",K8=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Q8=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,J8=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,$8=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,eG=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,tG=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,nG=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,iG=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,sG=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,rG=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,aG=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,oG=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lG=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,cG=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,uG=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,hG=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,fG=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,dG=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,pG=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,mG=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,gG=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,vG=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,yG=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,_G=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,xG=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,bG=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,SG=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,MG=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,TG=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,wG=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,AG=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,EG=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,CG=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,RG=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,DG=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,NG=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,IG=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,OG=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,PG=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,UG=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,LG=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,FG=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,kG=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,BG=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,zG=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,VG=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,GG=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,HG=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,WG=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,jG=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,qG=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,XG=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,YG=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,ZG=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,KG=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,QG=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,JG=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,$G=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,eH=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,tH=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,nH=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,iH=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,sH=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,rH=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,aH=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,oH=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,lH=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,cH=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,uH=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,hH=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,fH=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,dH=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,pH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,gH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,vH=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const yH=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,_H=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,xH=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,bH=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,SH=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,MH=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TH=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,wH=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,AH=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,EH=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,CH=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,RH=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,DH=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,NH=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,IH=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,OH=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PH=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,UH=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,LH=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,FH=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kH=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,BH=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,zH=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,VH=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GH=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,HH=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WH=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jH=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qH=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,XH=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,YH=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ZH=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,KH=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,QH=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,fn={alphahash_fragment:_8,alphahash_pars_fragment:x8,alphamap_fragment:b8,alphamap_pars_fragment:S8,alphatest_fragment:M8,alphatest_pars_fragment:T8,aomap_fragment:w8,aomap_pars_fragment:A8,batching_pars_vertex:E8,batching_vertex:C8,begin_vertex:R8,beginnormal_vertex:D8,bsdfs:N8,iridescence_fragment:I8,bumpmap_pars_fragment:O8,clipping_planes_fragment:P8,clipping_planes_pars_fragment:U8,clipping_planes_pars_vertex:L8,clipping_planes_vertex:F8,color_fragment:k8,color_pars_fragment:B8,color_pars_vertex:z8,color_vertex:V8,common:G8,cube_uv_reflection_fragment:H8,defaultnormal_vertex:W8,displacementmap_pars_vertex:j8,displacementmap_vertex:q8,emissivemap_fragment:X8,emissivemap_pars_fragment:Y8,colorspace_fragment:Z8,colorspace_pars_fragment:K8,envmap_fragment:Q8,envmap_common_pars_fragment:J8,envmap_pars_fragment:$8,envmap_pars_vertex:eG,envmap_physical_pars_fragment:hG,envmap_vertex:tG,fog_vertex:nG,fog_pars_vertex:iG,fog_fragment:sG,fog_pars_fragment:rG,gradientmap_pars_fragment:aG,lightmap_pars_fragment:oG,lights_lambert_fragment:lG,lights_lambert_pars_fragment:cG,lights_pars_begin:uG,lights_toon_fragment:fG,lights_toon_pars_fragment:dG,lights_phong_fragment:pG,lights_phong_pars_fragment:mG,lights_physical_fragment:gG,lights_physical_pars_fragment:vG,lights_fragment_begin:yG,lights_fragment_maps:_G,lights_fragment_end:xG,logdepthbuf_fragment:bG,logdepthbuf_pars_fragment:SG,logdepthbuf_pars_vertex:MG,logdepthbuf_vertex:TG,map_fragment:wG,map_pars_fragment:AG,map_particle_fragment:EG,map_particle_pars_fragment:CG,metalnessmap_fragment:RG,metalnessmap_pars_fragment:DG,morphinstance_vertex:NG,morphcolor_vertex:IG,morphnormal_vertex:OG,morphtarget_pars_vertex:PG,morphtarget_vertex:UG,normal_fragment_begin:LG,normal_fragment_maps:FG,normal_pars_fragment:kG,normal_pars_vertex:BG,normal_vertex:zG,normalmap_pars_fragment:VG,clearcoat_normal_fragment_begin:GG,clearcoat_normal_fragment_maps:HG,clearcoat_pars_fragment:WG,iridescence_pars_fragment:jG,opaque_fragment:qG,packing:XG,premultiplied_alpha_fragment:YG,project_vertex:ZG,dithering_fragment:KG,dithering_pars_fragment:QG,roughnessmap_fragment:JG,roughnessmap_pars_fragment:$G,shadowmap_pars_fragment:eH,shadowmap_pars_vertex:tH,shadowmap_vertex:nH,shadowmask_pars_fragment:iH,skinbase_vertex:sH,skinning_pars_vertex:rH,skinning_vertex:aH,skinnormal_vertex:oH,specularmap_fragment:lH,specularmap_pars_fragment:cH,tonemapping_fragment:uH,tonemapping_pars_fragment:hH,transmission_fragment:fH,transmission_pars_fragment:dH,uv_pars_fragment:pH,uv_pars_vertex:mH,uv_vertex:gH,worldpos_vertex:vH,background_vert:yH,background_frag:_H,backgroundCube_vert:xH,backgroundCube_frag:bH,cube_vert:SH,cube_frag:MH,depth_vert:TH,depth_frag:wH,distance_vert:AH,distance_frag:EH,equirect_vert:CH,equirect_frag:RH,linedashed_vert:DH,linedashed_frag:NH,meshbasic_vert:IH,meshbasic_frag:OH,meshlambert_vert:PH,meshlambert_frag:UH,meshmatcap_vert:LH,meshmatcap_frag:FH,meshnormal_vert:kH,meshnormal_frag:BH,meshphong_vert:zH,meshphong_frag:VH,meshphysical_vert:GH,meshphysical_frag:HH,meshtoon_vert:WH,meshtoon_frag:jH,points_vert:qH,points_frag:XH,shadow_vert:YH,shadow_frag:ZH,sprite_vert:KH,sprite_frag:QH},wt={common:{diffuse:{value:new St(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new on}},envmap:{envMap:{value:null},envMapRotation:{value:new on},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new on}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new on}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new on},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new on},normalScale:{value:new st(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new on},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new on}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new on}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new on}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new St(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new St(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0},uvTransform:{value:new on}},sprite:{diffuse:{value:new St(16777215)},opacity:{value:1},center:{value:new st(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}}},bl={basic:{uniforms:na([wt.common,wt.specularmap,wt.envmap,wt.aomap,wt.lightmap,wt.fog]),vertexShader:fn.meshbasic_vert,fragmentShader:fn.meshbasic_frag},lambert:{uniforms:na([wt.common,wt.specularmap,wt.envmap,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.fog,wt.lights,{emissive:{value:new St(0)}}]),vertexShader:fn.meshlambert_vert,fragmentShader:fn.meshlambert_frag},phong:{uniforms:na([wt.common,wt.specularmap,wt.envmap,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.fog,wt.lights,{emissive:{value:new St(0)},specular:{value:new St(1118481)},shininess:{value:30}}]),vertexShader:fn.meshphong_vert,fragmentShader:fn.meshphong_frag},standard:{uniforms:na([wt.common,wt.envmap,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.roughnessmap,wt.metalnessmap,wt.fog,wt.lights,{emissive:{value:new St(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fn.meshphysical_vert,fragmentShader:fn.meshphysical_frag},toon:{uniforms:na([wt.common,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.gradientmap,wt.fog,wt.lights,{emissive:{value:new St(0)}}]),vertexShader:fn.meshtoon_vert,fragmentShader:fn.meshtoon_frag},matcap:{uniforms:na([wt.common,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.fog,{matcap:{value:null}}]),vertexShader:fn.meshmatcap_vert,fragmentShader:fn.meshmatcap_frag},points:{uniforms:na([wt.points,wt.fog]),vertexShader:fn.points_vert,fragmentShader:fn.points_frag},dashed:{uniforms:na([wt.common,wt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fn.linedashed_vert,fragmentShader:fn.linedashed_frag},depth:{uniforms:na([wt.common,wt.displacementmap]),vertexShader:fn.depth_vert,fragmentShader:fn.depth_frag},normal:{uniforms:na([wt.common,wt.bumpmap,wt.normalmap,wt.displacementmap,{opacity:{value:1}}]),vertexShader:fn.meshnormal_vert,fragmentShader:fn.meshnormal_frag},sprite:{uniforms:na([wt.sprite,wt.fog]),vertexShader:fn.sprite_vert,fragmentShader:fn.sprite_frag},background:{uniforms:{uvTransform:{value:new on},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fn.background_vert,fragmentShader:fn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new on}},vertexShader:fn.backgroundCube_vert,fragmentShader:fn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fn.cube_vert,fragmentShader:fn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fn.equirect_vert,fragmentShader:fn.equirect_frag},distance:{uniforms:na([wt.common,wt.displacementmap,{referencePosition:{value:new re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fn.distance_vert,fragmentShader:fn.distance_frag},shadow:{uniforms:na([wt.lights,wt.fog,{color:{value:new St(0)},opacity:{value:1}}]),vertexShader:fn.shadow_vert,fragmentShader:fn.shadow_frag}};bl.physical={uniforms:na([bl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new on},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new on},clearcoatNormalScale:{value:new st(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new on},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new on},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new on},sheen:{value:0},sheenColor:{value:new St(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new on},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new on},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new on},transmissionSamplerSize:{value:new st},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new on},attenuationDistance:{value:0},attenuationColor:{value:new St(0)},specularColor:{value:new St(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new on},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new on},anisotropyVector:{value:new st},anisotropyMap:{value:null},anisotropyMapTransform:{value:new on}}]),vertexShader:fn.meshphysical_vert,fragmentShader:fn.meshphysical_frag};const Ox={r:0,b:0,g:0},Zf=new uo,JH=new Kt;function $H(i,e,t,n,s,r,o){const l=new St(0);let u=r===!0?0:1,f,p,g=null,v=0,x=null;function b(R){let I=R.isScene===!0?R.background:null;return I&&I.isTexture&&(I=(R.backgroundBlurriness>0?t:e).get(I)),I}function w(R){let I=!1;const D=b(R);D===null?S(l,u):D&&D.isColor&&(S(D,1),I=!0);const O=i.xr.getEnvironmentBlendMode();O==="additive"?n.buffers.color.setClear(0,0,0,1,o):O==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||I)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function M(R,I){const D=b(I);D&&(D.isCubeTexture||D.mapping===qm)?(p===void 0&&(p=new Qi(new Id(1,1,1),new ho({name:"BackgroundCubeMaterial",uniforms:Pm(bl.backgroundCube.uniforms),vertexShader:bl.backgroundCube.vertexShader,fragmentShader:bl.backgroundCube.fragmentShader,side:Lr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(O,U,k){this.matrixWorld.copyPosition(k.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(p)),Zf.copy(I.backgroundRotation),Zf.x*=-1,Zf.y*=-1,Zf.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(Zf.y*=-1,Zf.z*=-1),p.material.uniforms.envMap.value=D,p.material.uniforms.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(JH.makeRotationFromEuler(Zf)),p.material.toneMapped=On.getTransfer(D.colorSpace)!==Jn,(g!==D||v!==D.version||x!==i.toneMapping)&&(p.material.needsUpdate=!0,g=D,v=D.version,x=i.toneMapping),p.layers.enableAll(),R.unshift(p,p.geometry,p.material,0,0,null)):D&&D.isTexture&&(f===void 0&&(f=new Qi(new Ou(2,2),new ho({name:"BackgroundMaterial",uniforms:Pm(bl.background.uniforms),vertexShader:bl.background.vertexShader,fragmentShader:bl.background.fragmentShader,side:Eu,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),f.geometry.deleteAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(f)),f.material.uniforms.t2D.value=D,f.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,f.material.toneMapped=On.getTransfer(D.colorSpace)!==Jn,D.matrixAutoUpdate===!0&&D.updateMatrix(),f.material.uniforms.uvTransform.value.copy(D.matrix),(g!==D||v!==D.version||x!==i.toneMapping)&&(f.material.needsUpdate=!0,g=D,v=D.version,x=i.toneMapping),f.layers.enableAll(),R.unshift(f,f.geometry,f.material,0,0,null))}function S(R,I){R.getRGB(Ox,yP(i)),n.buffers.color.setClear(Ox.r,Ox.g,Ox.b,I,o)}function C(){p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0),f!==void 0&&(f.geometry.dispose(),f.material.dispose(),f=void 0)}return{getClearColor:function(){return l},setClearColor:function(R,I=1){l.set(R),u=I,S(l,u)},getClearAlpha:function(){return u},setClearAlpha:function(R){u=R,S(l,u)},render:w,addToRenderList:M,dispose:C}}function e9(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},s=v(null);let r=s,o=!1;function l(F,H,G,j,K){let te=!1;const W=g(j,G,H);r!==W&&(r=W,f(r.object)),te=x(F,j,G,K),te&&b(F,j,G,K),K!==null&&e.update(K,i.ELEMENT_ARRAY_BUFFER),(te||o)&&(o=!1,I(F,H,G,j),K!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(K).buffer))}function u(){return i.createVertexArray()}function f(F){return i.bindVertexArray(F)}function p(F){return i.deleteVertexArray(F)}function g(F,H,G){const j=G.wireframe===!0;let K=n[F.id];K===void 0&&(K={},n[F.id]=K);let te=K[H.id];te===void 0&&(te={},K[H.id]=te);let W=te[j];return W===void 0&&(W=v(u()),te[j]=W),W}function v(F){const H=[],G=[],j=[];for(let K=0;K<t;K++)H[K]=0,G[K]=0,j[K]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:G,attributeDivisors:j,object:F,attributes:{},index:null}}function x(F,H,G,j){const K=r.attributes,te=H.attributes;let W=0;const X=G.getAttributes();for(const oe in X)if(X[oe].location>=0){const ie=K[oe];let B=te[oe];if(B===void 0&&(oe==="instanceMatrix"&&F.instanceMatrix&&(B=F.instanceMatrix),oe==="instanceColor"&&F.instanceColor&&(B=F.instanceColor)),ie===void 0||ie.attribute!==B||B&&ie.data!==B.data)return!0;W++}return r.attributesNum!==W||r.index!==j}function b(F,H,G,j){const K={},te=H.attributes;let W=0;const X=G.getAttributes();for(const oe in X)if(X[oe].location>=0){let ie=te[oe];ie===void 0&&(oe==="instanceMatrix"&&F.instanceMatrix&&(ie=F.instanceMatrix),oe==="instanceColor"&&F.instanceColor&&(ie=F.instanceColor));const B={};B.attribute=ie,ie&&ie.data&&(B.data=ie.data),K[oe]=B,W++}r.attributes=K,r.attributesNum=W,r.index=j}function w(){const F=r.newAttributes;for(let H=0,G=F.length;H<G;H++)F[H]=0}function M(F){S(F,0)}function S(F,H){const G=r.newAttributes,j=r.enabledAttributes,K=r.attributeDivisors;G[F]=1,j[F]===0&&(i.enableVertexAttribArray(F),j[F]=1),K[F]!==H&&(i.vertexAttribDivisor(F,H),K[F]=H)}function C(){const F=r.newAttributes,H=r.enabledAttributes;for(let G=0,j=H.length;G<j;G++)H[G]!==F[G]&&(i.disableVertexAttribArray(G),H[G]=0)}function R(F,H,G,j,K,te,W){W===!0?i.vertexAttribIPointer(F,H,G,K,te):i.vertexAttribPointer(F,H,G,j,K,te)}function I(F,H,G,j){w();const K=j.attributes,te=G.getAttributes(),W=H.defaultAttributeValues;for(const X in te){const oe=te[X];if(oe.location>=0){let ne=K[X];if(ne===void 0&&(X==="instanceMatrix"&&F.instanceMatrix&&(ne=F.instanceMatrix),X==="instanceColor"&&F.instanceColor&&(ne=F.instanceColor)),ne!==void 0){const ie=ne.normalized,B=ne.itemSize,Q=e.get(ne);if(Q===void 0)continue;const ae=Q.buffer,fe=Q.type,de=Q.bytesPerElement,se=fe===i.INT||fe===i.UNSIGNED_INT||ne.gpuType===R1;if(ne.isInterleavedBufferAttribute){const ce=ne.data,pe=ce.stride,Ie=ne.offset;if(ce.isInstancedInterleavedBuffer){for(let Ye=0;Ye<oe.locationSize;Ye++)S(oe.location+Ye,ce.meshPerAttribute);F.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=ce.meshPerAttribute*ce.count)}else for(let Ye=0;Ye<oe.locationSize;Ye++)M(oe.location+Ye);i.bindBuffer(i.ARRAY_BUFFER,ae);for(let Ye=0;Ye<oe.locationSize;Ye++)R(oe.location+Ye,B/oe.locationSize,fe,ie,pe*de,(Ie+B/oe.locationSize*Ye)*de,se)}else{if(ne.isInstancedBufferAttribute){for(let ce=0;ce<oe.locationSize;ce++)S(oe.location+ce,ne.meshPerAttribute);F.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let ce=0;ce<oe.locationSize;ce++)M(oe.location+ce);i.bindBuffer(i.ARRAY_BUFFER,ae);for(let ce=0;ce<oe.locationSize;ce++)R(oe.location+ce,B/oe.locationSize,fe,ie,B*de,B/oe.locationSize*ce*de,se)}}else if(W!==void 0){const ie=W[X];if(ie!==void 0)switch(ie.length){case 2:i.vertexAttrib2fv(oe.location,ie);break;case 3:i.vertexAttrib3fv(oe.location,ie);break;case 4:i.vertexAttrib4fv(oe.location,ie);break;default:i.vertexAttrib1fv(oe.location,ie)}}}}C()}function D(){k();for(const F in n){const H=n[F];for(const G in H){const j=H[G];for(const K in j)p(j[K].object),delete j[K];delete H[G]}delete n[F]}}function O(F){if(n[F.id]===void 0)return;const H=n[F.id];for(const G in H){const j=H[G];for(const K in j)p(j[K].object),delete j[K];delete H[G]}delete n[F.id]}function U(F){for(const H in n){const G=n[H];if(G[F.id]===void 0)continue;const j=G[F.id];for(const K in j)p(j[K].object),delete j[K];delete G[F.id]}}function k(){P(),o=!0,r!==s&&(r=s,f(r.object))}function P(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:l,reset:k,resetDefaultState:P,dispose:D,releaseStatesOfGeometry:O,releaseStatesOfProgram:U,initAttributes:w,enableAttribute:M,disableUnusedAttributes:C}}function t9(i,e,t){let n;function s(f){n=f}function r(f,p){i.drawArrays(n,f,p),t.update(p,n,1)}function o(f,p,g){g!==0&&(i.drawArraysInstanced(n,f,p,g),t.update(p,n,g))}function l(f,p,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,f,0,p,0,g);let x=0;for(let b=0;b<g;b++)x+=p[b];t.update(x,n,1)}function u(f,p,g,v){if(g===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let b=0;b<f.length;b++)o(f[b],p[b],v[b]);else{x.multiDrawArraysInstancedWEBGL(n,f,0,p,0,v,0,g);let b=0;for(let w=0;w<g;w++)b+=p[w]*v[w];t.update(b,n,1)}}this.setMode=s,this.render=r,this.renderInstances=o,this.renderMultiDraw=l,this.renderMultiDrawInstances=u}function n9(i,e,t,n){let s;function r(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const U=e.get("EXT_texture_filter_anisotropic");s=i.getParameter(U.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function o(U){return!(U!==Ur&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(U){const k=U===El&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(U!==ra&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&U!==Pr&&!k)}function u(U){if(U==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";U="mediump"}return U==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let f=t.precision!==void 0?t.precision:"highp";const p=u(f);p!==f&&(Tt("WebGLRenderer:",f,"not supported, using",p,"instead."),f=p);const g=t.logarithmicDepthBuffer===!0,v=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),x=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),b=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),w=i.getParameter(i.MAX_TEXTURE_SIZE),M=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),S=i.getParameter(i.MAX_VERTEX_ATTRIBS),C=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),R=i.getParameter(i.MAX_VARYING_VECTORS),I=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),D=i.getParameter(i.MAX_SAMPLES),O=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:u,textureFormatReadable:o,textureTypeReadable:l,precision:f,logarithmicDepthBuffer:g,reversedDepthBuffer:v,maxTextures:x,maxVertexTextures:b,maxTextureSize:w,maxCubemapSize:M,maxAttributes:S,maxVertexUniforms:C,maxVaryings:R,maxFragmentUniforms:I,maxSamples:D,samples:O}}function i9(i){const e=this;let t=null,n=0,s=!1,r=!1;const o=new _u,l=new on,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(g,v){const x=g.length!==0||v||n!==0||s;return s=v,n=g.length,x},this.beginShadows=function(){r=!0,p(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(g,v){t=p(g,v,0)},this.setState=function(g,v,x){const b=g.clippingPlanes,w=g.clipIntersection,M=g.clipShadows,S=i.get(g);if(!s||b===null||b.length===0||r&&!M)r?p(null):f();else{const C=r?0:n,R=C*4;let I=S.clippingState||null;u.value=I,I=p(b,v,R,x);for(let D=0;D!==R;++D)I[D]=t[D];S.clippingState=I,this.numIntersection=w?this.numPlanes:0,this.numPlanes+=C}};function f(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function p(g,v,x,b){const w=g!==null?g.length:0;let M=null;if(w!==0){if(M=u.value,b!==!0||M===null){const S=x+w*4,C=v.matrixWorldInverse;l.getNormalMatrix(C),(M===null||M.length<S)&&(M=new Float32Array(S));for(let R=0,I=x;R!==w;++R,I+=4)o.copy(g[R]).applyMatrix4(C,l),o.normal.toArray(M,I),M[I+3]=o.constant}u.value=M,u.needsUpdate=!0}return e.numPlanes=w,e.numIntersection=0,M}}function s9(i){let e=new WeakMap;function t(o,l){return l===pv?o.mapping=Sc:l===mv&&(o.mapping=Vh),o}function n(o){if(o&&o.isTexture){const l=o.mapping;if(l===pv||l===mv)if(e.has(o)){const u=e.get(o).texture;return t(u,o.mapping)}else{const u=o.image;if(u&&u.height>0){const f=new HA(u.height);return f.fromEquirectangularTexture(i,o),e.set(o,f),o.addEventListener("dispose",s),t(f.texture,o.mapping)}else return null}}return o}function s(o){const l=o.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}const Lh=4,TD=[.125,.215,.35,.446,.526,.582],id=20,r9=256,F0=new Mu,wD=new St;let gT=null,vT=0,yT=0,_T=!1;const a9=new re;class xw{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,s=100,r={}){const{size:o=256,position:l=a9}=r;gT=this._renderer.getRenderTarget(),vT=this._renderer.getActiveCubeFace(),yT=this._renderer.getActiveMipmapLevel(),_T=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const u=this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,n,s,u,l),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=CD(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ED(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(gT,vT,yT),this._renderer.xr.enabled=_T,e.scissorTest=!1,sm(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Sc||e.mapping===Vh?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),gT=this._renderer.getRenderTarget(),vT=this._renderer.getActiveCubeFace(),yT=this._renderer.getActiveMipmapLevel(),_T=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:ti,minFilter:ti,generateMipmaps:!1,type:El,format:Ur,colorSpace:Gh,depthBuffer:!1},s=AD(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=AD(e,t,n);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=o9(r)),this._blurMaterial=c9(r,e,t),this._ggxMaterial=l9(r,e,t)}return s}_compileMaterial(e){const t=new Qi(new nn,e);this._renderer.compile(t,F0)}_sceneToCubeUV(e,t,n,s,r){const u=new ps(90,1,t,n),f=[1,-1,1,1,1,1],p=[1,1,1,-1,-1,-1],g=this._renderer,v=g.autoClear,x=g.toneMapping;g.getClearColor(wD),g.toneMapping=Xo,g.autoClear=!1,g.state.buffers.depth.getReversed()&&(g.setRenderTarget(s),g.clearDepth(),g.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Qi(new Id,new Iu({name:"PMREM.Background",side:Lr,depthWrite:!1,depthTest:!1})));const w=this._backgroundBox,M=w.material;let S=!1;const C=e.background;C?C.isColor&&(M.color.copy(C),e.background=null,S=!0):(M.color.copy(wD),S=!0);for(let R=0;R<6;R++){const I=R%3;I===0?(u.up.set(0,f[R],0),u.position.set(r.x,r.y,r.z),u.lookAt(r.x+p[R],r.y,r.z)):I===1?(u.up.set(0,0,f[R]),u.position.set(r.x,r.y,r.z),u.lookAt(r.x,r.y+p[R],r.z)):(u.up.set(0,f[R],0),u.position.set(r.x,r.y,r.z),u.lookAt(r.x,r.y,r.z+p[R]));const D=this._cubeSize;sm(s,I*D,R>2?D:0,D,D),g.setRenderTarget(s),S&&g.render(w,u),g.render(e,u)}g.toneMapping=x,g.autoClear=v,e.background=C}_textureToCubeUV(e,t){const n=this._renderer,s=e.mapping===Sc||e.mapping===Vh;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=CD()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ED());const r=s?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=r;const l=r.uniforms;l.envMap.value=e;const u=this._cubeSize;sm(t,0,0,3*u,2*u),n.setRenderTarget(t),n.render(o,F0)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const s=this._lodMeshes.length;for(let r=1;r<s;r++)this._applyGGXFilter(e,r-1,r);t.autoClear=n}_applyGGXFilter(e,t,n){const s=this._renderer,r=this._pingPongRenderTarget,o=this._ggxMaterial,l=this._lodMeshes[n];l.material=o;const u=o.uniforms,f=n/(this._lodMeshes.length-1),p=t/(this._lodMeshes.length-1),g=Math.sqrt(f*f-p*p),v=0+f*1.25,x=g*v,{_lodMax:b}=this,w=this._sizeLods[n],M=3*w*(n>b-Lh?n-b+Lh:0),S=4*(this._cubeSize-w);u.envMap.value=e.texture,u.roughness.value=x,u.mipInt.value=b-t,sm(r,M,S,3*w,2*w),s.setRenderTarget(r),s.render(l,F0),u.envMap.value=r.texture,u.roughness.value=0,u.mipInt.value=b-n,sm(e,M,S,3*w,2*w),s.setRenderTarget(e),s.render(l,F0)}_blur(e,t,n,s,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,s,"latitudinal",r),this._halfBlur(o,e,n,n,s,"longitudinal",r)}_halfBlur(e,t,n,s,r,o,l){const u=this._renderer,f=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&kt("blur direction must be either latitudinal or longitudinal!");const p=3,g=this._lodMeshes[s];g.material=f;const v=f.uniforms,x=this._sizeLods[n]-1,b=isFinite(r)?Math.PI/(2*x):2*Math.PI/(2*id-1),w=r/b,M=isFinite(r)?1+Math.floor(p*w):id;M>id&&Tt(`sigmaRadians, ${r}, is too large and will clip, as it requested ${M} samples when the maximum is set to ${id}`);const S=[];let C=0;for(let U=0;U<id;++U){const k=U/w,P=Math.exp(-k*k/2);S.push(P),U===0?C+=P:U<M&&(C+=2*P)}for(let U=0;U<S.length;U++)S[U]=S[U]/C;v.envMap.value=e.texture,v.samples.value=M,v.weights.value=S,v.latitudinal.value=o==="latitudinal",l&&(v.poleAxis.value=l);const{_lodMax:R}=this;v.dTheta.value=b,v.mipInt.value=R-n;const I=this._sizeLods[s],D=3*I*(s>R-Lh?s-R+Lh:0),O=4*(this._cubeSize-I);sm(t,D,O,3*I,2*I),u.setRenderTarget(t),u.render(g,F0)}}function o9(i){const e=[],t=[],n=[];let s=i;const r=i-Lh+1+TD.length;for(let o=0;o<r;o++){const l=Math.pow(2,s);e.push(l);let u=1/l;o>i-Lh?u=TD[o-i+Lh-1]:o===0&&(u=0),t.push(u);const f=1/(l-2),p=-f,g=1+f,v=[p,p,g,p,g,g,p,p,g,g,p,g],x=6,b=6,w=3,M=2,S=1,C=new Float32Array(w*b*x),R=new Float32Array(M*b*x),I=new Float32Array(S*b*x);for(let O=0;O<x;O++){const U=O%3*2/3-1,k=O>2?0:-1,P=[U,k,0,U+2/3,k,0,U+2/3,k+1,0,U,k,0,U+2/3,k+1,0,U,k+1,0];C.set(P,w*b*O),R.set(v,M*b*O);const F=[O,O,O,O,O,O];I.set(F,S*b*O)}const D=new nn;D.setAttribute("position",new li(C,w)),D.setAttribute("uv",new li(R,M)),D.setAttribute("faceIndex",new li(I,S)),n.push(new Qi(D,null)),s>Lh&&s--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function AD(i,e,t){const n=new Ha(i,e,t);return n.texture.mapping=qm,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function sm(i,e,t,n,s){i.viewport.set(e,t,n,s),i.scissor.set(e,t,n,s)}function l9(i,e,t){return new ho({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:r9,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:lS(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:bc,depthTest:!1,depthWrite:!1})}function c9(i,e,t){const n=new Float32Array(id),s=new re(0,1,0);return new ho({name:"SphericalGaussianBlur",defines:{n:id,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:lS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:bc,depthTest:!1,depthWrite:!1})}function ED(){return new ho({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:lS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:bc,depthTest:!1,depthWrite:!1})}function CD(){return new ho({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:lS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:bc,depthTest:!1,depthWrite:!1})}function lS(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function u9(i){let e=new WeakMap,t=null;function n(l){if(l&&l.isTexture){const u=l.mapping,f=u===pv||u===mv,p=u===Sc||u===Vh;if(f||p){let g=e.get(l);const v=g!==void 0?g.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==v)return t===null&&(t=new xw(i)),g=f?t.fromEquirectangular(l,g):t.fromCubemap(l,g),g.texture.pmremVersion=l.pmremVersion,e.set(l,g),g.texture;if(g!==void 0)return g.texture;{const x=l.image;return f&&x&&x.height>0||p&&x&&s(x)?(t===null&&(t=new xw(i)),g=f?t.fromEquirectangular(l):t.fromCubemap(l),g.texture.pmremVersion=l.pmremVersion,e.set(l,g),l.addEventListener("dispose",r),g.texture):null}}}return l}function s(l){let u=0;const f=6;for(let p=0;p<f;p++)l[p]!==void 0&&u++;return u===f}function r(l){const u=l.target;u.removeEventListener("dispose",r);const f=e.get(u);f!==void 0&&(e.delete(u),f.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function h9(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const s=i.getExtension(n);return e[n]=s,s}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const s=t(n);return s===null&&Nm("WebGLRenderer: "+n+" extension not supported."),s}}}function f9(i,e,t,n){const s={},r=new WeakMap;function o(g){const v=g.target;v.index!==null&&e.remove(v.index);for(const b in v.attributes)e.remove(v.attributes[b]);v.removeEventListener("dispose",o),delete s[v.id];const x=r.get(v);x&&(e.remove(x),r.delete(v)),n.releaseStatesOfGeometry(v),v.isInstancedBufferGeometry===!0&&delete v._maxInstanceCount,t.memory.geometries--}function l(g,v){return s[v.id]===!0||(v.addEventListener("dispose",o),s[v.id]=!0,t.memory.geometries++),v}function u(g){const v=g.attributes;for(const x in v)e.update(v[x],i.ARRAY_BUFFER)}function f(g){const v=[],x=g.index,b=g.attributes.position;let w=0;if(x!==null){const C=x.array;w=x.version;for(let R=0,I=C.length;R<I;R+=3){const D=C[R+0],O=C[R+1],U=C[R+2];v.push(D,O,O,U,U,D)}}else if(b!==void 0){const C=b.array;w=b.version;for(let R=0,I=C.length/3-1;R<I;R+=3){const D=R+0,O=R+1,U=R+2;v.push(D,O,O,U,U,D)}}else return;const M=new(dP(v)?VA:zA)(v,1);M.version=w;const S=r.get(g);S&&e.remove(S),r.set(g,M)}function p(g){const v=r.get(g);if(v){const x=g.index;x!==null&&v.version<x.version&&f(g)}else f(g);return r.get(g)}return{get:l,update:u,getWireframeAttribute:p}}function d9(i,e,t){let n;function s(v){n=v}let r,o;function l(v){r=v.type,o=v.bytesPerElement}function u(v,x){i.drawElements(n,x,r,v*o),t.update(x,n,1)}function f(v,x,b){b!==0&&(i.drawElementsInstanced(n,x,r,v*o,b),t.update(x,n,b))}function p(v,x,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,x,0,r,v,0,b);let M=0;for(let S=0;S<b;S++)M+=x[S];t.update(M,n,1)}function g(v,x,b,w){if(b===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let S=0;S<v.length;S++)f(v[S]/o,x[S],w[S]);else{M.multiDrawElementsInstancedWEBGL(n,x,0,r,v,0,w,0,b);let S=0;for(let C=0;C<b;C++)S+=x[C]*w[C];t.update(S,n,1)}}this.setMode=s,this.setIndex=l,this.render=u,this.renderInstances=f,this.renderMultiDraw=p,this.renderMultiDrawInstances=g}function p9(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,o,l){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=l*(r/3);break;case i.LINES:t.lines+=l*(r/2);break;case i.LINE_STRIP:t.lines+=l*(r-1);break;case i.LINE_LOOP:t.lines+=l*r;break;case i.POINTS:t.points+=l*r;break;default:kt("WebGLInfo: Unknown draw mode:",o);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:n}}function m9(i,e,t){const n=new WeakMap,s=new $n;function r(o,l,u){const f=o.morphTargetInfluences,p=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,g=p!==void 0?p.length:0;let v=n.get(l);if(v===void 0||v.count!==g){let F=function(){k.dispose(),n.delete(l),l.removeEventListener("dispose",F)};var x=F;v!==void 0&&v.texture.dispose();const b=l.morphAttributes.position!==void 0,w=l.morphAttributes.normal!==void 0,M=l.morphAttributes.color!==void 0,S=l.morphAttributes.position||[],C=l.morphAttributes.normal||[],R=l.morphAttributes.color||[];let I=0;b===!0&&(I=1),w===!0&&(I=2),M===!0&&(I=3);let D=l.attributes.position.count*I,O=1;D>e.maxTextureSize&&(O=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);const U=new Float32Array(D*O*4*g),k=new k1(U,D,O,g);k.type=Pr,k.needsUpdate=!0;const P=I*4;for(let H=0;H<g;H++){const G=S[H],j=C[H],K=R[H],te=D*O*4*H;for(let W=0;W<G.count;W++){const X=W*P;b===!0&&(s.fromBufferAttribute(G,W),U[te+X+0]=s.x,U[te+X+1]=s.y,U[te+X+2]=s.z,U[te+X+3]=0),w===!0&&(s.fromBufferAttribute(j,W),U[te+X+4]=s.x,U[te+X+5]=s.y,U[te+X+6]=s.z,U[te+X+7]=0),M===!0&&(s.fromBufferAttribute(K,W),U[te+X+8]=s.x,U[te+X+9]=s.y,U[te+X+10]=s.z,U[te+X+11]=K.itemSize===4?s.w:1)}}v={count:g,texture:k,size:new st(D,O)},n.set(l,v),l.addEventListener("dispose",F)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)u.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let b=0;for(let M=0;M<f.length;M++)b+=f[M];const w=l.morphTargetsRelative?1:1-b;u.getUniforms().setValue(i,"morphTargetBaseInfluence",w),u.getUniforms().setValue(i,"morphTargetInfluences",f)}u.getUniforms().setValue(i,"morphTargetsTexture",v.texture,t),u.getUniforms().setValue(i,"morphTargetsTextureSize",v.size)}return{update:r}}function g9(i,e,t,n){let s=new WeakMap;function r(u){const f=n.render.frame,p=u.geometry,g=e.get(u,p);if(s.get(g)!==f&&(e.update(g),s.set(g,f)),u.isInstancedMesh&&(u.hasEventListener("dispose",l)===!1&&u.addEventListener("dispose",l),s.get(u)!==f&&(t.update(u.instanceMatrix,i.ARRAY_BUFFER),u.instanceColor!==null&&t.update(u.instanceColor,i.ARRAY_BUFFER),s.set(u,f))),u.isSkinnedMesh){const v=u.skeleton;s.get(v)!==f&&(v.update(),s.set(v,f))}return g}function o(){s=new WeakMap}function l(u){const f=u.target;f.removeEventListener("dispose",l),t.remove(f.instanceMatrix),f.instanceColor!==null&&t.remove(f.instanceColor)}return{update:r,dispose:o}}const v9={[TA]:"LINEAR_TONE_MAPPING",[wA]:"REINHARD_TONE_MAPPING",[AA]:"CINEON_TONE_MAPPING",[E1]:"ACES_FILMIC_TONE_MAPPING",[CA]:"AGX_TONE_MAPPING",[RA]:"NEUTRAL_TONE_MAPPING",[EA]:"CUSTOM_TONE_MAPPING"};function y9(i,e,t,n,s){const r=new Ha(e,t,{type:i,depthBuffer:n,stencilBuffer:s}),o=new Ha(e,t,{type:El,depthBuffer:!1,stencilBuffer:!1}),l=new nn;l.setAttribute("position",new It([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new It([0,2,0,0,2,0],2));const u=new eE({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),f=new Qi(l,u),p=new Mu(-1,1,1,-1,0,1);let g=null,v=null,x=!1,b,w=null,M=[],S=!1;this.setSize=function(C,R){r.setSize(C,R),o.setSize(C,R);for(let I=0;I<M.length;I++){const D=M[I];D.setSize&&D.setSize(C,R)}},this.setEffects=function(C){M=C,S=M.length>0&&M[0].isRenderPass===!0;const R=r.width,I=r.height;for(let D=0;D<M.length;D++){const O=M[D];O.setSize&&O.setSize(R,I)}},this.begin=function(C,R){if(x||C.toneMapping===Xo&&M.length===0)return!1;if(w=R,R!==null){const I=R.width,D=R.height;(r.width!==I||r.height!==D)&&this.setSize(I,D)}return S===!1&&C.setRenderTarget(r),b=C.toneMapping,C.toneMapping=Xo,!0},this.hasRenderPass=function(){return S},this.end=function(C,R){C.toneMapping=b,x=!0;let I=r,D=o;for(let O=0;O<M.length;O++){const U=M[O];if(U.enabled!==!1&&(U.render(C,D,I,R),U.needsSwap!==!1)){const k=I;I=D,D=k}}if(g!==C.outputColorSpace||v!==C.toneMapping){g=C.outputColorSpace,v=C.toneMapping,u.defines={},On.getTransfer(g)===Jn&&(u.defines.SRGB_TRANSFER="");const O=v9[v];O&&(u.defines[O]=""),u.needsUpdate=!0}u.uniforms.tDiffuse.value=I.texture,C.setRenderTarget(w),C.render(f,p),w=null,x=!1},this.isCompositing=function(){return x},this.dispose=function(){r.dispose(),o.dispose(),l.dispose(),u.dispose()}}const mU=new Ki,bw=new Td(1,1),gU=new k1,vU=new B1,yU=new Wv,RD=[],DD=[],ND=new Float32Array(16),ID=new Float32Array(9),OD=new Float32Array(4);function Zm(i,e,t){const n=i[0];if(n<=0||n>0)return i;const s=e*t;let r=RD[s];if(r===void 0&&(r=new Float32Array(s),RD[s]=r),e!==0){n.toArray(r,0);for(let o=1,l=0;o!==e;++o)l+=t,i[o].toArray(r,l)}return r}function Bs(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function zs(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function cS(i,e){let t=DD[e];t===void 0&&(t=new Int32Array(e),DD[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function _9(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function x9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Bs(t,e))return;i.uniform2fv(this.addr,e),zs(t,e)}}function b9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Bs(t,e))return;i.uniform3fv(this.addr,e),zs(t,e)}}function S9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Bs(t,e))return;i.uniform4fv(this.addr,e),zs(t,e)}}function M9(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Bs(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),zs(t,e)}else{if(Bs(t,n))return;OD.set(n),i.uniformMatrix2fv(this.addr,!1,OD),zs(t,n)}}function T9(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Bs(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),zs(t,e)}else{if(Bs(t,n))return;ID.set(n),i.uniformMatrix3fv(this.addr,!1,ID),zs(t,n)}}function w9(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Bs(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),zs(t,e)}else{if(Bs(t,n))return;ND.set(n),i.uniformMatrix4fv(this.addr,!1,ND),zs(t,n)}}function A9(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function E9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Bs(t,e))return;i.uniform2iv(this.addr,e),zs(t,e)}}function C9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Bs(t,e))return;i.uniform3iv(this.addr,e),zs(t,e)}}function R9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Bs(t,e))return;i.uniform4iv(this.addr,e),zs(t,e)}}function D9(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function N9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Bs(t,e))return;i.uniform2uiv(this.addr,e),zs(t,e)}}function I9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Bs(t,e))return;i.uniform3uiv(this.addr,e),zs(t,e)}}function O9(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Bs(t,e))return;i.uniform4uiv(this.addr,e),zs(t,e)}}function P9(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s);let r;this.type===i.SAMPLER_2D_SHADOW?(bw.compareFunction=t.isReversedDepthBuffer()?F1:L1,r=bw):r=mU,t.setTexture2D(e||r,s)}function U9(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||vU,s)}function L9(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||yU,s)}function F9(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||gU,s)}function k9(i){switch(i){case 5126:return _9;case 35664:return x9;case 35665:return b9;case 35666:return S9;case 35674:return M9;case 35675:return T9;case 35676:return w9;case 5124:case 35670:return A9;case 35667:case 35671:return E9;case 35668:case 35672:return C9;case 35669:case 35673:return R9;case 5125:return D9;case 36294:return N9;case 36295:return I9;case 36296:return O9;case 35678:case 36198:case 36298:case 36306:case 35682:return P9;case 35679:case 36299:case 36307:return U9;case 35680:case 36300:case 36308:case 36293:return L9;case 36289:case 36303:case 36311:case 36292:return F9}}function B9(i,e){i.uniform1fv(this.addr,e)}function z9(i,e){const t=Zm(e,this.size,2);i.uniform2fv(this.addr,t)}function V9(i,e){const t=Zm(e,this.size,3);i.uniform3fv(this.addr,t)}function G9(i,e){const t=Zm(e,this.size,4);i.uniform4fv(this.addr,t)}function H9(i,e){const t=Zm(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function W9(i,e){const t=Zm(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function j9(i,e){const t=Zm(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function q9(i,e){i.uniform1iv(this.addr,e)}function X9(i,e){i.uniform2iv(this.addr,e)}function Y9(i,e){i.uniform3iv(this.addr,e)}function Z9(i,e){i.uniform4iv(this.addr,e)}function K9(i,e){i.uniform1uiv(this.addr,e)}function Q9(i,e){i.uniform2uiv(this.addr,e)}function J9(i,e){i.uniform3uiv(this.addr,e)}function $9(i,e){i.uniform4uiv(this.addr,e)}function eW(i,e,t){const n=this.cache,s=e.length,r=cS(t,s);Bs(n,r)||(i.uniform1iv(this.addr,r),zs(n,r));let o;this.type===i.SAMPLER_2D_SHADOW?o=bw:o=mU;for(let l=0;l!==s;++l)t.setTexture2D(e[l]||o,r[l])}function tW(i,e,t){const n=this.cache,s=e.length,r=cS(t,s);Bs(n,r)||(i.uniform1iv(this.addr,r),zs(n,r));for(let o=0;o!==s;++o)t.setTexture3D(e[o]||vU,r[o])}function nW(i,e,t){const n=this.cache,s=e.length,r=cS(t,s);Bs(n,r)||(i.uniform1iv(this.addr,r),zs(n,r));for(let o=0;o!==s;++o)t.setTextureCube(e[o]||yU,r[o])}function iW(i,e,t){const n=this.cache,s=e.length,r=cS(t,s);Bs(n,r)||(i.uniform1iv(this.addr,r),zs(n,r));for(let o=0;o!==s;++o)t.setTexture2DArray(e[o]||gU,r[o])}function sW(i){switch(i){case 5126:return B9;case 35664:return z9;case 35665:return V9;case 35666:return G9;case 35674:return H9;case 35675:return W9;case 35676:return j9;case 5124:case 35670:return q9;case 35667:case 35671:return X9;case 35668:case 35672:return Y9;case 35669:case 35673:return Z9;case 5125:return K9;case 36294:return Q9;case 36295:return J9;case 36296:return $9;case 35678:case 36198:case 36298:case 36306:case 35682:return eW;case 35679:case 36299:case 36307:return tW;case 35680:case 36300:case 36308:case 36293:return nW;case 36289:case 36303:case 36311:case 36292:return iW}}class rW{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=k9(t.type)}}class aW{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=sW(t.type)}}class oW{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let r=0,o=s.length;r!==o;++r){const l=s[r];l.setValue(e,t[l.id],n)}}}const xT=/(\w+)(\])?(\[|\.)?/g;function PD(i,e){i.seq.push(e),i.map[e.id]=e}function lW(i,e,t){const n=i.name,s=n.length;for(xT.lastIndex=0;;){const r=xT.exec(n),o=xT.lastIndex;let l=r[1];const u=r[2]==="]",f=r[3];if(u&&(l=l|0),f===void 0||f==="["&&o+2===s){PD(t,f===void 0?new rW(l,i,e):new aW(l,i,e));break}else{let g=t.map[l];g===void 0&&(g=new oW(l),PD(t,g)),t=g}}}class Qx{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<n;++o){const l=e.getActiveUniform(t,o),u=e.getUniformLocation(t,l.name);lW(l,u,this)}const s=[],r=[];for(const o of this.seq)o.type===e.SAMPLER_2D_SHADOW||o.type===e.SAMPLER_CUBE_SHADOW||o.type===e.SAMPLER_2D_ARRAY_SHADOW?s.push(o):r.push(o);s.length>0&&(this.seq=s.concat(r))}setValue(e,t,n,s){const r=this.map[t];r!==void 0&&r.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let r=0,o=t.length;r!==o;++r){const l=t[r],u=n[l.id];u.needsUpdate!==!1&&l.setValue(e,u.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,r=e.length;s!==r;++s){const o=e[s];o.id in t&&n.push(o)}return n}}function UD(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const cW=37297;let uW=0;function hW(i,e){const t=i.split(`
`),n=[],s=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=s;o<r;o++){const l=o+1;n.push(`${l===e?">":" "} ${l}: ${t[o]}`)}return n.join(`
`)}const LD=new on;function fW(i){On._getMatrix(LD,On.workingColorSpace,i);const e=`mat3( ${LD.elements.map(t=>t.toFixed(4))} )`;switch(On.getTransfer(i)){case xv:return[e,"LinearTransferOETF"];case Jn:return[e,"sRGBTransferOETF"];default:return Tt("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function FD(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),r=(i.getShaderInfoLog(e)||"").trim();if(n&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const l=parseInt(o[1]);return t.toUpperCase()+`

`+r+`

`+hW(i.getShaderSource(e),l)}else return r}function dW(i,e){const t=fW(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const pW={[TA]:"Linear",[wA]:"Reinhard",[AA]:"Cineon",[E1]:"ACESFilmic",[CA]:"AgX",[RA]:"Neutral",[EA]:"Custom"};function mW(i,e){const t=pW[e];return t===void 0?(Tt("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Px=new re;function gW(){On.getLuminanceCoefficients(Px);const i=Px.x.toFixed(4),e=Px.y.toFixed(4),t=Px.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function vW(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(W0).join(`
`)}function yW(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function _W(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const r=i.getActiveAttrib(e,s),o=r.name;let l=1;r.type===i.FLOAT_MAT2&&(l=2),r.type===i.FLOAT_MAT3&&(l=3),r.type===i.FLOAT_MAT4&&(l=4),t[o]={type:r.type,location:i.getAttribLocation(e,o),locationSize:l}}return t}function W0(i){return i!==""}function kD(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function BD(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const xW=/^[ \t]*#include +<([\w\d./]+)>/gm;function Sw(i){return i.replace(xW,SW)}const bW=new Map;function SW(i,e){let t=fn[e];if(t===void 0){const n=bW.get(e);if(n!==void 0)t=fn[n],Tt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Sw(t)}const MW=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function zD(i){return i.replace(MW,TW)}function TW(i,e,t,n){let s="";for(let r=parseInt(e);r<parseInt(t);r++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return s}function VD(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const wW={[Mm]:"SHADOWMAP_TYPE_PCF",[ad]:"SHADOWMAP_TYPE_VSM"};function AW(i){return wW[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const EW={[Sc]:"ENVMAP_TYPE_CUBE",[Vh]:"ENVMAP_TYPE_CUBE",[qm]:"ENVMAP_TYPE_CUBE_UV"};function CW(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":EW[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const RW={[Vh]:"ENVMAP_MODE_REFRACTION"};function DW(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":RW[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const NW={[Gv]:"ENVMAP_BLENDING_MULTIPLY",[JO]:"ENVMAP_BLENDING_MIX",[$O]:"ENVMAP_BLENDING_ADD"};function IW(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":NW[i.combine]||"ENVMAP_BLENDING_NONE"}function OW(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function PW(i,e,t,n){const s=i.getContext(),r=t.defines;let o=t.vertexShader,l=t.fragmentShader;const u=AW(t),f=CW(t),p=DW(t),g=IW(t),v=OW(t),x=vW(t),b=yW(r),w=s.createProgram();let M,S,C=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(M=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(W0).join(`
`),M.length>0&&(M+=`
`),S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(W0).join(`
`),S.length>0&&(S+=`
`)):(M=[VD(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(W0).join(`
`),S=[VD(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",v?"#define CUBEUV_TEXEL_WIDTH "+v.texelWidth:"",v?"#define CUBEUV_TEXEL_HEIGHT "+v.texelHeight:"",v?"#define CUBEUV_MAX_MIP "+v.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Xo?"#define TONE_MAPPING":"",t.toneMapping!==Xo?fn.tonemapping_pars_fragment:"",t.toneMapping!==Xo?mW("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",fn.colorspace_pars_fragment,dW("linearToOutputTexel",t.outputColorSpace),gW(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(W0).join(`
`)),o=Sw(o),o=kD(o,t),o=BD(o,t),l=Sw(l),l=kD(l,t),l=BD(l,t),o=zD(o),l=zD(l),t.isRawShaderMaterial!==!0&&(C=`#version 300 es
`,M=[x,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,S=["#define varying in",t.glslVersion===fw?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===fw?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const R=C+M+o,I=C+S+l,D=UD(s,s.VERTEX_SHADER,R),O=UD(s,s.FRAGMENT_SHADER,I);s.attachShader(w,D),s.attachShader(w,O),t.index0AttributeName!==void 0?s.bindAttribLocation(w,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(w,0,"position"),s.linkProgram(w);function U(H){if(i.debug.checkShaderErrors){const G=s.getProgramInfoLog(w)||"",j=s.getShaderInfoLog(D)||"",K=s.getShaderInfoLog(O)||"",te=G.trim(),W=j.trim(),X=K.trim();let oe=!0,ne=!0;if(s.getProgramParameter(w,s.LINK_STATUS)===!1)if(oe=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,w,D,O);else{const ie=FD(s,D,"vertex"),B=FD(s,O,"fragment");kt("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(w,s.VALIDATE_STATUS)+`

Material Name: `+H.name+`
Material Type: `+H.type+`

Program Info Log: `+te+`
`+ie+`
`+B)}else te!==""?Tt("WebGLProgram: Program Info Log:",te):(W===""||X==="")&&(ne=!1);ne&&(H.diagnostics={runnable:oe,programLog:te,vertexShader:{log:W,prefix:M},fragmentShader:{log:X,prefix:S}})}s.deleteShader(D),s.deleteShader(O),k=new Qx(s,w),P=_W(s,w)}let k;this.getUniforms=function(){return k===void 0&&U(this),k};let P;this.getAttributes=function(){return P===void 0&&U(this),P};let F=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return F===!1&&(F=s.getProgramParameter(w,cW)),F},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(w),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=uW++,this.cacheKey=e,this.usedTimes=1,this.program=w,this.vertexShader=D,this.fragmentShader=O,this}let UW=0;class LW{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(t),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(s)===!1&&(o.add(s),s.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new FW(e),t.set(e,n)),n}}class FW{constructor(e){this.id=UW++,this.code=e,this.usedTimes=0}}function kW(i,e,t,n,s,r,o){const l=new Om,u=new LW,f=new Set,p=[],g=new Map,v=s.logarithmicDepthBuffer;let x=s.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function w(P){return f.add(P),P===0?"uv":`uv${P}`}function M(P,F,H,G,j){const K=G.fog,te=j.geometry,W=P.isMeshStandardMaterial?G.environment:null,X=(P.isMeshStandardMaterial?t:e).get(P.envMap||W),oe=X&&X.mapping===qm?X.image.height:null,ne=b[P.type];P.precision!==null&&(x=s.getMaxPrecision(P.precision),x!==P.precision&&Tt("WebGLProgram.getParameters:",P.precision,"not supported, using",x,"instead."));const ie=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,B=ie!==void 0?ie.length:0;let Q=0;te.morphAttributes.position!==void 0&&(Q=1),te.morphAttributes.normal!==void 0&&(Q=2),te.morphAttributes.color!==void 0&&(Q=3);let ae,fe,de,se;if(ne){const Nt=bl[ne];ae=Nt.vertexShader,fe=Nt.fragmentShader}else ae=P.vertexShader,fe=P.fragmentShader,u.update(P),de=u.getVertexShaderID(P),se=u.getFragmentShaderID(P);const ce=i.getRenderTarget(),pe=i.state.buffers.depth.getReversed(),Ie=j.isInstancedMesh===!0,Ye=j.isBatchedMesh===!0,et=!!P.map,qe=!!P.matcap,dt=!!X,De=!!P.aoMap,ge=!!P.lightMap,ye=!!P.bumpMap,Ge=!!P.normalMap,Y=!!P.displacementMap,Be=!!P.emissiveMap,Ne=!!P.metalnessMap,Me=!!P.roughnessMap,Oe=P.anisotropy>0,q=P.clearcoat>0,V=P.dispersion>0,ue=P.iridescence>0,Re=P.sheen>0,we=P.transmission>0,be=Oe&&!!P.anisotropyMap,it=q&&!!P.clearcoatMap,tt=q&&!!P.clearcoatNormalMap,ht=q&&!!P.clearcoatRoughnessMap,yt=ue&&!!P.iridescenceMap,He=ue&&!!P.iridescenceThicknessMap,Xe=Re&&!!P.sheenColorMap,Qe=Re&&!!P.sheenRoughnessMap,le=!!P.specularMap,Te=!!P.specularColorMap,ct=!!P.specularIntensityMap,he=we&&!!P.transmissionMap,We=we&&!!P.thicknessMap,Je=!!P.gradientMap,pt=!!P.alphaMap,$e=P.alphaTest>0,Le=!!P.alphaHash,rt=!!P.extensions;let xt=Xo;P.toneMapped&&(ce===null||ce.isXRRenderTarget===!0)&&(xt=i.toneMapping);const _t={shaderID:ne,shaderType:P.type,shaderName:P.name,vertexShader:ae,fragmentShader:fe,defines:P.defines,customVertexShaderID:de,customFragmentShaderID:se,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:x,batching:Ye,batchingColor:Ye&&j._colorsTexture!==null,instancing:Ie,instancingColor:Ie&&j.instanceColor!==null,instancingMorph:Ie&&j.morphTexture!==null,outputColorSpace:ce===null?i.outputColorSpace:ce.isXRRenderTarget===!0?ce.texture.colorSpace:Gh,alphaToCoverage:!!P.alphaToCoverage,map:et,matcap:qe,envMap:dt,envMapMode:dt&&X.mapping,envMapCubeUVHeight:oe,aoMap:De,lightMap:ge,bumpMap:ye,normalMap:Ge,displacementMap:Y,emissiveMap:Be,normalMapObjectSpace:Ge&&P.normalMapType===aP,normalMapTangentSpace:Ge&&P.normalMapType===Yh,metalnessMap:Ne,roughnessMap:Me,anisotropy:Oe,anisotropyMap:be,clearcoat:q,clearcoatMap:it,clearcoatNormalMap:tt,clearcoatRoughnessMap:ht,dispersion:V,iridescence:ue,iridescenceMap:yt,iridescenceThicknessMap:He,sheen:Re,sheenColorMap:Xe,sheenRoughnessMap:Qe,specularMap:le,specularColorMap:Te,specularIntensityMap:ct,transmission:we,transmissionMap:he,thicknessMap:We,gradientMap:Je,opaque:P.transparent===!1&&P.blending===pd&&P.alphaToCoverage===!1,alphaMap:pt,alphaTest:$e,alphaHash:Le,combine:P.combine,mapUv:et&&w(P.map.channel),aoMapUv:De&&w(P.aoMap.channel),lightMapUv:ge&&w(P.lightMap.channel),bumpMapUv:ye&&w(P.bumpMap.channel),normalMapUv:Ge&&w(P.normalMap.channel),displacementMapUv:Y&&w(P.displacementMap.channel),emissiveMapUv:Be&&w(P.emissiveMap.channel),metalnessMapUv:Ne&&w(P.metalnessMap.channel),roughnessMapUv:Me&&w(P.roughnessMap.channel),anisotropyMapUv:be&&w(P.anisotropyMap.channel),clearcoatMapUv:it&&w(P.clearcoatMap.channel),clearcoatNormalMapUv:tt&&w(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ht&&w(P.clearcoatRoughnessMap.channel),iridescenceMapUv:yt&&w(P.iridescenceMap.channel),iridescenceThicknessMapUv:He&&w(P.iridescenceThicknessMap.channel),sheenColorMapUv:Xe&&w(P.sheenColorMap.channel),sheenRoughnessMapUv:Qe&&w(P.sheenRoughnessMap.channel),specularMapUv:le&&w(P.specularMap.channel),specularColorMapUv:Te&&w(P.specularColorMap.channel),specularIntensityMapUv:ct&&w(P.specularIntensityMap.channel),transmissionMapUv:he&&w(P.transmissionMap.channel),thicknessMapUv:We&&w(P.thicknessMap.channel),alphaMapUv:pt&&w(P.alphaMap.channel),vertexTangents:!!te.attributes.tangent&&(Ge||Oe),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!te.attributes.color&&te.attributes.color.itemSize===4,pointsUvs:j.isPoints===!0&&!!te.attributes.uv&&(et||pt),fog:!!K,useFog:P.fog===!0,fogExp2:!!K&&K.isFogExp2,flatShading:P.flatShading===!0&&P.wireframe===!1,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:v,reversedDepthBuffer:pe,skinning:j.isSkinnedMesh===!0,morphTargets:te.morphAttributes.position!==void 0,morphNormals:te.morphAttributes.normal!==void 0,morphColors:te.morphAttributes.color!==void 0,morphTargetsCount:B,morphTextureStride:Q,numDirLights:F.directional.length,numPointLights:F.point.length,numSpotLights:F.spot.length,numSpotLightMaps:F.spotLightMap.length,numRectAreaLights:F.rectArea.length,numHemiLights:F.hemi.length,numDirLightShadows:F.directionalShadowMap.length,numPointLightShadows:F.pointShadowMap.length,numSpotLightShadows:F.spotShadowMap.length,numSpotLightShadowsWithMaps:F.numSpotLightShadowsWithMaps,numLightProbes:F.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:P.dithering,shadowMapEnabled:i.shadowMap.enabled&&H.length>0,shadowMapType:i.shadowMap.type,toneMapping:xt,decodeVideoTexture:et&&P.map.isVideoTexture===!0&&On.getTransfer(P.map.colorSpace)===Jn,decodeVideoTextureEmissive:Be&&P.emissiveMap.isVideoTexture===!0&&On.getTransfer(P.emissiveMap.colorSpace)===Jn,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===sa,flipSided:P.side===Lr,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionClipCullDistance:rt&&P.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(rt&&P.extensions.multiDraw===!0||Ye)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:P.customProgramCacheKey()};return _t.vertexUv1s=f.has(1),_t.vertexUv2s=f.has(2),_t.vertexUv3s=f.has(3),f.clear(),_t}function S(P){const F=[];if(P.shaderID?F.push(P.shaderID):(F.push(P.customVertexShaderID),F.push(P.customFragmentShaderID)),P.defines!==void 0)for(const H in P.defines)F.push(H),F.push(P.defines[H]);return P.isRawShaderMaterial===!1&&(C(F,P),R(F,P),F.push(i.outputColorSpace)),F.push(P.customProgramCacheKey),F.join()}function C(P,F){P.push(F.precision),P.push(F.outputColorSpace),P.push(F.envMapMode),P.push(F.envMapCubeUVHeight),P.push(F.mapUv),P.push(F.alphaMapUv),P.push(F.lightMapUv),P.push(F.aoMapUv),P.push(F.bumpMapUv),P.push(F.normalMapUv),P.push(F.displacementMapUv),P.push(F.emissiveMapUv),P.push(F.metalnessMapUv),P.push(F.roughnessMapUv),P.push(F.anisotropyMapUv),P.push(F.clearcoatMapUv),P.push(F.clearcoatNormalMapUv),P.push(F.clearcoatRoughnessMapUv),P.push(F.iridescenceMapUv),P.push(F.iridescenceThicknessMapUv),P.push(F.sheenColorMapUv),P.push(F.sheenRoughnessMapUv),P.push(F.specularMapUv),P.push(F.specularColorMapUv),P.push(F.specularIntensityMapUv),P.push(F.transmissionMapUv),P.push(F.thicknessMapUv),P.push(F.combine),P.push(F.fogExp2),P.push(F.sizeAttenuation),P.push(F.morphTargetsCount),P.push(F.morphAttributeCount),P.push(F.numDirLights),P.push(F.numPointLights),P.push(F.numSpotLights),P.push(F.numSpotLightMaps),P.push(F.numHemiLights),P.push(F.numRectAreaLights),P.push(F.numDirLightShadows),P.push(F.numPointLightShadows),P.push(F.numSpotLightShadows),P.push(F.numSpotLightShadowsWithMaps),P.push(F.numLightProbes),P.push(F.shadowMapType),P.push(F.toneMapping),P.push(F.numClippingPlanes),P.push(F.numClipIntersection),P.push(F.depthPacking)}function R(P,F){l.disableAll(),F.instancing&&l.enable(0),F.instancingColor&&l.enable(1),F.instancingMorph&&l.enable(2),F.matcap&&l.enable(3),F.envMap&&l.enable(4),F.normalMapObjectSpace&&l.enable(5),F.normalMapTangentSpace&&l.enable(6),F.clearcoat&&l.enable(7),F.iridescence&&l.enable(8),F.alphaTest&&l.enable(9),F.vertexColors&&l.enable(10),F.vertexAlphas&&l.enable(11),F.vertexUv1s&&l.enable(12),F.vertexUv2s&&l.enable(13),F.vertexUv3s&&l.enable(14),F.vertexTangents&&l.enable(15),F.anisotropy&&l.enable(16),F.alphaHash&&l.enable(17),F.batching&&l.enable(18),F.dispersion&&l.enable(19),F.batchingColor&&l.enable(20),F.gradientMap&&l.enable(21),P.push(l.mask),l.disableAll(),F.fog&&l.enable(0),F.useFog&&l.enable(1),F.flatShading&&l.enable(2),F.logarithmicDepthBuffer&&l.enable(3),F.reversedDepthBuffer&&l.enable(4),F.skinning&&l.enable(5),F.morphTargets&&l.enable(6),F.morphNormals&&l.enable(7),F.morphColors&&l.enable(8),F.premultipliedAlpha&&l.enable(9),F.shadowMapEnabled&&l.enable(10),F.doubleSided&&l.enable(11),F.flipSided&&l.enable(12),F.useDepthPacking&&l.enable(13),F.dithering&&l.enable(14),F.transmission&&l.enable(15),F.sheen&&l.enable(16),F.opaque&&l.enable(17),F.pointsUvs&&l.enable(18),F.decodeVideoTexture&&l.enable(19),F.decodeVideoTextureEmissive&&l.enable(20),F.alphaToCoverage&&l.enable(21),P.push(l.mask)}function I(P){const F=b[P.type];let H;if(F){const G=bl[F];H=GA.clone(G.uniforms)}else H=P.uniforms;return H}function D(P,F){let H=g.get(F);return H!==void 0?++H.usedTimes:(H=new PW(i,F,P,r),p.push(H),g.set(F,H)),H}function O(P){if(--P.usedTimes===0){const F=p.indexOf(P);p[F]=p[p.length-1],p.pop(),g.delete(P.cacheKey),P.destroy()}}function U(P){u.remove(P)}function k(){u.dispose()}return{getParameters:M,getProgramCacheKey:S,getUniforms:I,acquireProgram:D,releaseProgram:O,releaseShaderCache:U,programs:p,dispose:k}}function BW(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let l=i.get(o);return l===void 0&&(l={},i.set(o,l)),l}function n(o){i.delete(o)}function s(o,l,u){i.get(o)[l]=u}function r(){i=new WeakMap}return{has:e,get:t,remove:n,update:s,dispose:r}}function zW(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function GD(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function HD(){const i=[];let e=0;const t=[],n=[],s=[];function r(){e=0,t.length=0,n.length=0,s.length=0}function o(g,v,x,b,w,M){let S=i[e];return S===void 0?(S={id:g.id,object:g,geometry:v,material:x,groupOrder:b,renderOrder:g.renderOrder,z:w,group:M},i[e]=S):(S.id=g.id,S.object=g,S.geometry=v,S.material=x,S.groupOrder=b,S.renderOrder=g.renderOrder,S.z=w,S.group=M),e++,S}function l(g,v,x,b,w,M){const S=o(g,v,x,b,w,M);x.transmission>0?n.push(S):x.transparent===!0?s.push(S):t.push(S)}function u(g,v,x,b,w,M){const S=o(g,v,x,b,w,M);x.transmission>0?n.unshift(S):x.transparent===!0?s.unshift(S):t.unshift(S)}function f(g,v){t.length>1&&t.sort(g||zW),n.length>1&&n.sort(v||GD),s.length>1&&s.sort(v||GD)}function p(){for(let g=e,v=i.length;g<v;g++){const x=i[g];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}}return{opaque:t,transmissive:n,transparent:s,init:r,push:l,unshift:u,finish:p,sort:f}}function VW(){let i=new WeakMap;function e(n,s){const r=i.get(n);let o;return r===void 0?(o=new HD,i.set(n,[o])):s>=r.length?(o=new HD,r.push(o)):o=r[s],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function GW(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new re,color:new St};break;case"SpotLight":t={position:new re,direction:new re,color:new St,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new re,color:new St,distance:0,decay:0};break;case"HemisphereLight":t={direction:new re,skyColor:new St,groundColor:new St};break;case"RectAreaLight":t={color:new St,position:new re,halfWidth:new re,halfHeight:new re};break}return i[e.id]=t,t}}}function HW(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new st};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new st};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new st,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let WW=0;function jW(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function qW(i){const e=new GW,t=HW(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let f=0;f<9;f++)n.probe.push(new re);const s=new re,r=new Kt,o=new Kt;function l(f){let p=0,g=0,v=0;for(let P=0;P<9;P++)n.probe[P].set(0,0,0);let x=0,b=0,w=0,M=0,S=0,C=0,R=0,I=0,D=0,O=0,U=0;f.sort(jW);for(let P=0,F=f.length;P<F;P++){const H=f[P],G=H.color,j=H.intensity,K=H.distance;let te=null;if(H.shadow&&H.shadow.map&&(H.shadow.map.texture.format===bd?te=H.shadow.map.texture:te=H.shadow.map.depthTexture||H.shadow.map.texture),H.isAmbientLight)p+=G.r*j,g+=G.g*j,v+=G.b*j;else if(H.isLightProbe){for(let W=0;W<9;W++)n.probe[W].addScaledVector(H.sh.coefficients[W],j);U++}else if(H.isDirectionalLight){const W=e.get(H);if(W.color.copy(H.color).multiplyScalar(H.intensity),H.castShadow){const X=H.shadow,oe=t.get(H);oe.shadowIntensity=X.intensity,oe.shadowBias=X.bias,oe.shadowNormalBias=X.normalBias,oe.shadowRadius=X.radius,oe.shadowMapSize=X.mapSize,n.directionalShadow[x]=oe,n.directionalShadowMap[x]=te,n.directionalShadowMatrix[x]=H.shadow.matrix,C++}n.directional[x]=W,x++}else if(H.isSpotLight){const W=e.get(H);W.position.setFromMatrixPosition(H.matrixWorld),W.color.copy(G).multiplyScalar(j),W.distance=K,W.coneCos=Math.cos(H.angle),W.penumbraCos=Math.cos(H.angle*(1-H.penumbra)),W.decay=H.decay,n.spot[w]=W;const X=H.shadow;if(H.map&&(n.spotLightMap[D]=H.map,D++,X.updateMatrices(H),H.castShadow&&O++),n.spotLightMatrix[w]=X.matrix,H.castShadow){const oe=t.get(H);oe.shadowIntensity=X.intensity,oe.shadowBias=X.bias,oe.shadowNormalBias=X.normalBias,oe.shadowRadius=X.radius,oe.shadowMapSize=X.mapSize,n.spotShadow[w]=oe,n.spotShadowMap[w]=te,I++}w++}else if(H.isRectAreaLight){const W=e.get(H);W.color.copy(G).multiplyScalar(j),W.halfWidth.set(H.width*.5,0,0),W.halfHeight.set(0,H.height*.5,0),n.rectArea[M]=W,M++}else if(H.isPointLight){const W=e.get(H);if(W.color.copy(H.color).multiplyScalar(H.intensity),W.distance=H.distance,W.decay=H.decay,H.castShadow){const X=H.shadow,oe=t.get(H);oe.shadowIntensity=X.intensity,oe.shadowBias=X.bias,oe.shadowNormalBias=X.normalBias,oe.shadowRadius=X.radius,oe.shadowMapSize=X.mapSize,oe.shadowCameraNear=X.camera.near,oe.shadowCameraFar=X.camera.far,n.pointShadow[b]=oe,n.pointShadowMap[b]=te,n.pointShadowMatrix[b]=H.shadow.matrix,R++}n.point[b]=W,b++}else if(H.isHemisphereLight){const W=e.get(H);W.skyColor.copy(H.color).multiplyScalar(j),W.groundColor.copy(H.groundColor).multiplyScalar(j),n.hemi[S]=W,S++}}M>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=wt.LTC_FLOAT_1,n.rectAreaLTC2=wt.LTC_FLOAT_2):(n.rectAreaLTC1=wt.LTC_HALF_1,n.rectAreaLTC2=wt.LTC_HALF_2)),n.ambient[0]=p,n.ambient[1]=g,n.ambient[2]=v;const k=n.hash;(k.directionalLength!==x||k.pointLength!==b||k.spotLength!==w||k.rectAreaLength!==M||k.hemiLength!==S||k.numDirectionalShadows!==C||k.numPointShadows!==R||k.numSpotShadows!==I||k.numSpotMaps!==D||k.numLightProbes!==U)&&(n.directional.length=x,n.spot.length=w,n.rectArea.length=M,n.point.length=b,n.hemi.length=S,n.directionalShadow.length=C,n.directionalShadowMap.length=C,n.pointShadow.length=R,n.pointShadowMap.length=R,n.spotShadow.length=I,n.spotShadowMap.length=I,n.directionalShadowMatrix.length=C,n.pointShadowMatrix.length=R,n.spotLightMatrix.length=I+D-O,n.spotLightMap.length=D,n.numSpotLightShadowsWithMaps=O,n.numLightProbes=U,k.directionalLength=x,k.pointLength=b,k.spotLength=w,k.rectAreaLength=M,k.hemiLength=S,k.numDirectionalShadows=C,k.numPointShadows=R,k.numSpotShadows=I,k.numSpotMaps=D,k.numLightProbes=U,n.version=WW++)}function u(f,p){let g=0,v=0,x=0,b=0,w=0;const M=p.matrixWorldInverse;for(let S=0,C=f.length;S<C;S++){const R=f[S];if(R.isDirectionalLight){const I=n.directional[g];I.direction.setFromMatrixPosition(R.matrixWorld),s.setFromMatrixPosition(R.target.matrixWorld),I.direction.sub(s),I.direction.transformDirection(M),g++}else if(R.isSpotLight){const I=n.spot[x];I.position.setFromMatrixPosition(R.matrixWorld),I.position.applyMatrix4(M),I.direction.setFromMatrixPosition(R.matrixWorld),s.setFromMatrixPosition(R.target.matrixWorld),I.direction.sub(s),I.direction.transformDirection(M),x++}else if(R.isRectAreaLight){const I=n.rectArea[b];I.position.setFromMatrixPosition(R.matrixWorld),I.position.applyMatrix4(M),o.identity(),r.copy(R.matrixWorld),r.premultiply(M),o.extractRotation(r),I.halfWidth.set(R.width*.5,0,0),I.halfHeight.set(0,R.height*.5,0),I.halfWidth.applyMatrix4(o),I.halfHeight.applyMatrix4(o),b++}else if(R.isPointLight){const I=n.point[v];I.position.setFromMatrixPosition(R.matrixWorld),I.position.applyMatrix4(M),v++}else if(R.isHemisphereLight){const I=n.hemi[w];I.direction.setFromMatrixPosition(R.matrixWorld),I.direction.transformDirection(M),w++}}}return{setup:l,setupView:u,state:n}}function WD(i){const e=new qW(i),t=[],n=[];function s(p){f.camera=p,t.length=0,n.length=0}function r(p){t.push(p)}function o(p){n.push(p)}function l(){e.setup(t)}function u(p){e.setupView(t,p)}const f={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:f,setupLights:l,setupLightsView:u,pushLight:r,pushShadow:o}}function XW(i){let e=new WeakMap;function t(s,r=0){const o=e.get(s);let l;return o===void 0?(l=new WD(i),e.set(s,[l])):r>=o.length?(l=new WD(i),o.push(l)):l=o[r],l}function n(){e=new WeakMap}return{get:t,dispose:n}}const YW=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,ZW=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,KW=[new re(1,0,0),new re(-1,0,0),new re(0,1,0),new re(0,-1,0),new re(0,0,1),new re(0,0,-1)],QW=[new re(0,-1,0),new re(0,-1,0),new re(0,0,1),new re(0,0,-1),new re(0,-1,0),new re(0,-1,0)],jD=new Kt,k0=new re,bT=new re;function JW(i,e,t){let n=new Xm;const s=new st,r=new st,o=new $n,l=new rS,u=new aS,f={},p=t.maxTextureSize,g={[Eu]:Lr,[Lr]:Eu,[sa]:sa},v=new ho({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new st},radius:{value:4}},vertexShader:YW,fragmentShader:ZW}),x=v.clone();x.defines.HORIZONTAL_PASS=1;const b=new nn;b.setAttribute("position",new li(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const w=new Qi(b,v),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Mm;let S=this.type;this.render=function(O,U,k){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||O.length===0)return;O.type===K0&&(Tt("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),O.type=Mm);const P=i.getRenderTarget(),F=i.getActiveCubeFace(),H=i.getActiveMipmapLevel(),G=i.state;G.setBlending(bc),G.buffers.depth.getReversed()===!0?G.buffers.color.setClear(0,0,0,0):G.buffers.color.setClear(1,1,1,1),G.buffers.depth.setTest(!0),G.setScissorTest(!1);const j=S!==this.type;j&&U.traverse(function(K){K.material&&(Array.isArray(K.material)?K.material.forEach(te=>te.needsUpdate=!0):K.material.needsUpdate=!0)});for(let K=0,te=O.length;K<te;K++){const W=O[K],X=W.shadow;if(X===void 0){Tt("WebGLShadowMap:",W,"has no shadow.");continue}if(X.autoUpdate===!1&&X.needsUpdate===!1)continue;s.copy(X.mapSize);const oe=X.getFrameExtents();if(s.multiply(oe),r.copy(X.mapSize),(s.x>p||s.y>p)&&(s.x>p&&(r.x=Math.floor(p/oe.x),s.x=r.x*oe.x,X.mapSize.x=r.x),s.y>p&&(r.y=Math.floor(p/oe.y),s.y=r.y*oe.y,X.mapSize.y=r.y)),X.map===null||j===!0){if(X.map!==null&&(X.map.depthTexture!==null&&(X.map.depthTexture.dispose(),X.map.depthTexture=null),X.map.dispose()),this.type===ad){if(W.isPointLight){Tt("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}X.map=new Ha(s.x,s.y,{format:bd,type:El,minFilter:ti,magFilter:ti,generateMipmaps:!1}),X.map.texture.name=W.name+".shadowMap",X.map.depthTexture=new Td(s.x,s.y,Pr),X.map.depthTexture.name=W.name+".shadowMapDepth",X.map.depthTexture.format=Mc,X.map.depthTexture.compareFunction=null,X.map.depthTexture.minFilter=ms,X.map.depthTexture.magFilter=ms}else{W.isPointLight?(X.map=new HA(s.x),X.map.depthTexture=new RP(s.x,Ko)):(X.map=new Ha(s.x,s.y),X.map.depthTexture=new Td(s.x,s.y,Ko)),X.map.depthTexture.name=W.name+".shadowMap",X.map.depthTexture.format=Mc;const ie=i.state.buffers.depth.getReversed();this.type===Mm?(X.map.depthTexture.compareFunction=ie?F1:L1,X.map.depthTexture.minFilter=ti,X.map.depthTexture.magFilter=ti):(X.map.depthTexture.compareFunction=null,X.map.depthTexture.minFilter=ms,X.map.depthTexture.magFilter=ms)}X.camera.updateProjectionMatrix()}const ne=X.map.isWebGLCubeRenderTarget?6:1;for(let ie=0;ie<ne;ie++){if(X.map.isWebGLCubeRenderTarget)i.setRenderTarget(X.map,ie),i.clear();else{ie===0&&(i.setRenderTarget(X.map),i.clear());const B=X.getViewport(ie);o.set(r.x*B.x,r.y*B.y,r.x*B.z,r.y*B.w),G.viewport(o)}if(W.isPointLight){const B=X.camera,Q=X.matrix,ae=W.distance||B.far;ae!==B.far&&(B.far=ae,B.updateProjectionMatrix()),k0.setFromMatrixPosition(W.matrixWorld),B.position.copy(k0),bT.copy(B.position),bT.add(KW[ie]),B.up.copy(QW[ie]),B.lookAt(bT),B.updateMatrixWorld(),Q.makeTranslation(-k0.x,-k0.y,-k0.z),jD.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),X._frustum.setFromProjectionMatrix(jD,B.coordinateSystem,B.reversedDepth)}else X.updateMatrices(W);n=X.getFrustum(),I(U,k,X.camera,W,this.type)}X.isPointLightShadow!==!0&&this.type===ad&&C(X,k),X.needsUpdate=!1}S=this.type,M.needsUpdate=!1,i.setRenderTarget(P,F,H)};function C(O,U){const k=e.update(w);v.defines.VSM_SAMPLES!==O.blurSamples&&(v.defines.VSM_SAMPLES=O.blurSamples,x.defines.VSM_SAMPLES=O.blurSamples,v.needsUpdate=!0,x.needsUpdate=!0),O.mapPass===null&&(O.mapPass=new Ha(s.x,s.y,{format:bd,type:El})),v.uniforms.shadow_pass.value=O.map.depthTexture,v.uniforms.resolution.value=O.mapSize,v.uniforms.radius.value=O.radius,i.setRenderTarget(O.mapPass),i.clear(),i.renderBufferDirect(U,null,k,v,w,null),x.uniforms.shadow_pass.value=O.mapPass.texture,x.uniforms.resolution.value=O.mapSize,x.uniforms.radius.value=O.radius,i.setRenderTarget(O.map),i.clear(),i.renderBufferDirect(U,null,k,x,w,null)}function R(O,U,k,P){let F=null;const H=k.isPointLight===!0?O.customDistanceMaterial:O.customDepthMaterial;if(H!==void 0)F=H;else if(F=k.isPointLight===!0?u:l,i.localClippingEnabled&&U.clipShadows===!0&&Array.isArray(U.clippingPlanes)&&U.clippingPlanes.length!==0||U.displacementMap&&U.displacementScale!==0||U.alphaMap&&U.alphaTest>0||U.map&&U.alphaTest>0||U.alphaToCoverage===!0){const G=F.uuid,j=U.uuid;let K=f[G];K===void 0&&(K={},f[G]=K);let te=K[j];te===void 0&&(te=F.clone(),K[j]=te,U.addEventListener("dispose",D)),F=te}if(F.visible=U.visible,F.wireframe=U.wireframe,P===ad?F.side=U.shadowSide!==null?U.shadowSide:U.side:F.side=U.shadowSide!==null?U.shadowSide:g[U.side],F.alphaMap=U.alphaMap,F.alphaTest=U.alphaToCoverage===!0?.5:U.alphaTest,F.map=U.map,F.clipShadows=U.clipShadows,F.clippingPlanes=U.clippingPlanes,F.clipIntersection=U.clipIntersection,F.displacementMap=U.displacementMap,F.displacementScale=U.displacementScale,F.displacementBias=U.displacementBias,F.wireframeLinewidth=U.wireframeLinewidth,F.linewidth=U.linewidth,k.isPointLight===!0&&F.isMeshDistanceMaterial===!0){const G=i.properties.get(F);G.light=k}return F}function I(O,U,k,P,F){if(O.visible===!1)return;if(O.layers.test(U.layers)&&(O.isMesh||O.isLine||O.isPoints)&&(O.castShadow||O.receiveShadow&&F===ad)&&(!O.frustumCulled||n.intersectsObject(O))){O.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,O.matrixWorld);const j=e.update(O),K=O.material;if(Array.isArray(K)){const te=j.groups;for(let W=0,X=te.length;W<X;W++){const oe=te[W],ne=K[oe.materialIndex];if(ne&&ne.visible){const ie=R(O,ne,P,F);O.onBeforeShadow(i,O,U,k,j,ie,oe),i.renderBufferDirect(k,null,j,ie,O,oe),O.onAfterShadow(i,O,U,k,j,ie,oe)}}}else if(K.visible){const te=R(O,K,P,F);O.onBeforeShadow(i,O,U,k,j,te,null),i.renderBufferDirect(k,null,j,te,O,null),O.onAfterShadow(i,O,U,k,j,te,null)}}const G=O.children;for(let j=0,K=G.length;j<K;j++)I(G[j],U,k,P,F)}function D(O){O.target.removeEventListener("dispose",D);for(const k in f){const P=f[k],F=O.target.uuid;F in P&&(P[F].dispose(),delete P[F])}}}const $W={[fb]:db,[pb]:vb,[mb]:yb,[xd]:gb,[db]:fb,[vb]:pb,[yb]:mb,[gb]:xd};function e7(i,e){function t(){let he=!1;const We=new $n;let Je=null;const pt=new $n(0,0,0,0);return{setMask:function($e){Je!==$e&&!he&&(i.colorMask($e,$e,$e,$e),Je=$e)},setLocked:function($e){he=$e},setClear:function($e,Le,rt,xt,_t){_t===!0&&($e*=xt,Le*=xt,rt*=xt),We.set($e,Le,rt,xt),pt.equals(We)===!1&&(i.clearColor($e,Le,rt,xt),pt.copy(We))},reset:function(){he=!1,Je=null,pt.set(-1,0,0,0)}}}function n(){let he=!1,We=!1,Je=null,pt=null,$e=null;return{setReversed:function(Le){if(We!==Le){const rt=e.get("EXT_clip_control");Le?rt.clipControlEXT(rt.LOWER_LEFT_EXT,rt.ZERO_TO_ONE_EXT):rt.clipControlEXT(rt.LOWER_LEFT_EXT,rt.NEGATIVE_ONE_TO_ONE_EXT),We=Le;const xt=$e;$e=null,this.setClear(xt)}},getReversed:function(){return We},setTest:function(Le){Le?ce(i.DEPTH_TEST):pe(i.DEPTH_TEST)},setMask:function(Le){Je!==Le&&!he&&(i.depthMask(Le),Je=Le)},setFunc:function(Le){if(We&&(Le=$W[Le]),pt!==Le){switch(Le){case fb:i.depthFunc(i.NEVER);break;case db:i.depthFunc(i.ALWAYS);break;case pb:i.depthFunc(i.LESS);break;case xd:i.depthFunc(i.LEQUAL);break;case mb:i.depthFunc(i.EQUAL);break;case gb:i.depthFunc(i.GEQUAL);break;case vb:i.depthFunc(i.GREATER);break;case yb:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}pt=Le}},setLocked:function(Le){he=Le},setClear:function(Le){$e!==Le&&(We&&(Le=1-Le),i.clearDepth(Le),$e=Le)},reset:function(){he=!1,Je=null,pt=null,$e=null,We=!1}}}function s(){let he=!1,We=null,Je=null,pt=null,$e=null,Le=null,rt=null,xt=null,_t=null;return{setTest:function(Nt){he||(Nt?ce(i.STENCIL_TEST):pe(i.STENCIL_TEST))},setMask:function(Nt){We!==Nt&&!he&&(i.stencilMask(Nt),We=Nt)},setFunc:function(Nt,pn,Mn){(Je!==Nt||pt!==pn||$e!==Mn)&&(i.stencilFunc(Nt,pn,Mn),Je=Nt,pt=pn,$e=Mn)},setOp:function(Nt,pn,Mn){(Le!==Nt||rt!==pn||xt!==Mn)&&(i.stencilOp(Nt,pn,Mn),Le=Nt,rt=pn,xt=Mn)},setLocked:function(Nt){he=Nt},setClear:function(Nt){_t!==Nt&&(i.clearStencil(Nt),_t=Nt)},reset:function(){he=!1,We=null,Je=null,pt=null,$e=null,Le=null,rt=null,xt=null,_t=null}}}const r=new t,o=new n,l=new s,u=new WeakMap,f=new WeakMap;let p={},g={},v=new WeakMap,x=[],b=null,w=!1,M=null,S=null,C=null,R=null,I=null,D=null,O=null,U=new St(0,0,0),k=0,P=!1,F=null,H=null,G=null,j=null,K=null;const te=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,X=0;const oe=i.getParameter(i.VERSION);oe.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(oe)[1]),W=X>=1):oe.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(oe)[1]),W=X>=2);let ne=null,ie={};const B=i.getParameter(i.SCISSOR_BOX),Q=i.getParameter(i.VIEWPORT),ae=new $n().fromArray(B),fe=new $n().fromArray(Q);function de(he,We,Je,pt){const $e=new Uint8Array(4),Le=i.createTexture();i.bindTexture(he,Le),i.texParameteri(he,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(he,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let rt=0;rt<Je;rt++)he===i.TEXTURE_3D||he===i.TEXTURE_2D_ARRAY?i.texImage3D(We,0,i.RGBA,1,1,pt,0,i.RGBA,i.UNSIGNED_BYTE,$e):i.texImage2D(We+rt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,$e);return Le}const se={};se[i.TEXTURE_2D]=de(i.TEXTURE_2D,i.TEXTURE_2D,1),se[i.TEXTURE_CUBE_MAP]=de(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),se[i.TEXTURE_2D_ARRAY]=de(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),se[i.TEXTURE_3D]=de(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),l.setClear(0),ce(i.DEPTH_TEST),o.setFunc(xd),ye(!1),Ge(ow),ce(i.CULL_FACE),De(bc);function ce(he){p[he]!==!0&&(i.enable(he),p[he]=!0)}function pe(he){p[he]!==!1&&(i.disable(he),p[he]=!1)}function Ie(he,We){return g[he]!==We?(i.bindFramebuffer(he,We),g[he]=We,he===i.DRAW_FRAMEBUFFER&&(g[i.FRAMEBUFFER]=We),he===i.FRAMEBUFFER&&(g[i.DRAW_FRAMEBUFFER]=We),!0):!1}function Ye(he,We){let Je=x,pt=!1;if(he){Je=v.get(We),Je===void 0&&(Je=[],v.set(We,Je));const $e=he.textures;if(Je.length!==$e.length||Je[0]!==i.COLOR_ATTACHMENT0){for(let Le=0,rt=$e.length;Le<rt;Le++)Je[Le]=i.COLOR_ATTACHMENT0+Le;Je.length=$e.length,pt=!0}}else Je[0]!==i.BACK&&(Je[0]=i.BACK,pt=!0);pt&&i.drawBuffers(Je)}function et(he){return b!==he?(i.useProgram(he),b=he,!0):!1}const qe={[Ih]:i.FUNC_ADD,[UO]:i.FUNC_SUBTRACT,[LO]:i.FUNC_REVERSE_SUBTRACT};qe[FO]=i.MIN,qe[kO]=i.MAX;const dt={[BO]:i.ZERO,[zO]:i.ONE,[VO]:i.SRC_COLOR,[ub]:i.SRC_ALPHA,[XO]:i.SRC_ALPHA_SATURATE,[jO]:i.DST_COLOR,[HO]:i.DST_ALPHA,[GO]:i.ONE_MINUS_SRC_COLOR,[hb]:i.ONE_MINUS_SRC_ALPHA,[qO]:i.ONE_MINUS_DST_COLOR,[WO]:i.ONE_MINUS_DST_ALPHA,[YO]:i.CONSTANT_COLOR,[ZO]:i.ONE_MINUS_CONSTANT_COLOR,[KO]:i.CONSTANT_ALPHA,[QO]:i.ONE_MINUS_CONSTANT_ALPHA};function De(he,We,Je,pt,$e,Le,rt,xt,_t,Nt){if(he===bc){w===!0&&(pe(i.BLEND),w=!1);return}if(w===!1&&(ce(i.BLEND),w=!0),he!==PO){if(he!==M||Nt!==P){if((S!==Ih||I!==Ih)&&(i.blendEquation(i.FUNC_ADD),S=Ih,I=Ih),Nt)switch(he){case pd:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case cb:i.blendFunc(i.ONE,i.ONE);break;case lw:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case cw:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:kt("WebGLState: Invalid blending: ",he);break}else switch(he){case pd:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case cb:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case lw:kt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case cw:kt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:kt("WebGLState: Invalid blending: ",he);break}C=null,R=null,D=null,O=null,U.set(0,0,0),k=0,M=he,P=Nt}return}$e=$e||We,Le=Le||Je,rt=rt||pt,(We!==S||$e!==I)&&(i.blendEquationSeparate(qe[We],qe[$e]),S=We,I=$e),(Je!==C||pt!==R||Le!==D||rt!==O)&&(i.blendFuncSeparate(dt[Je],dt[pt],dt[Le],dt[rt]),C=Je,R=pt,D=Le,O=rt),(xt.equals(U)===!1||_t!==k)&&(i.blendColor(xt.r,xt.g,xt.b,_t),U.copy(xt),k=_t),M=he,P=!1}function ge(he,We){he.side===sa?pe(i.CULL_FACE):ce(i.CULL_FACE);let Je=he.side===Lr;We&&(Je=!Je),ye(Je),he.blending===pd&&he.transparent===!1?De(bc):De(he.blending,he.blendEquation,he.blendSrc,he.blendDst,he.blendEquationAlpha,he.blendSrcAlpha,he.blendDstAlpha,he.blendColor,he.blendAlpha,he.premultipliedAlpha),o.setFunc(he.depthFunc),o.setTest(he.depthTest),o.setMask(he.depthWrite),r.setMask(he.colorWrite);const pt=he.stencilWrite;l.setTest(pt),pt&&(l.setMask(he.stencilWriteMask),l.setFunc(he.stencilFunc,he.stencilRef,he.stencilFuncMask),l.setOp(he.stencilFail,he.stencilZFail,he.stencilZPass)),Be(he.polygonOffset,he.polygonOffsetFactor,he.polygonOffsetUnits),he.alphaToCoverage===!0?ce(i.SAMPLE_ALPHA_TO_COVERAGE):pe(i.SAMPLE_ALPHA_TO_COVERAGE)}function ye(he){F!==he&&(he?i.frontFace(i.CW):i.frontFace(i.CCW),F=he)}function Ge(he){he!==NO?(ce(i.CULL_FACE),he!==H&&(he===ow?i.cullFace(i.BACK):he===IO?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):pe(i.CULL_FACE),H=he}function Y(he){he!==G&&(W&&i.lineWidth(he),G=he)}function Be(he,We,Je){he?(ce(i.POLYGON_OFFSET_FILL),(j!==We||K!==Je)&&(i.polygonOffset(We,Je),j=We,K=Je)):pe(i.POLYGON_OFFSET_FILL)}function Ne(he){he?ce(i.SCISSOR_TEST):pe(i.SCISSOR_TEST)}function Me(he){he===void 0&&(he=i.TEXTURE0+te-1),ne!==he&&(i.activeTexture(he),ne=he)}function Oe(he,We,Je){Je===void 0&&(ne===null?Je=i.TEXTURE0+te-1:Je=ne);let pt=ie[Je];pt===void 0&&(pt={type:void 0,texture:void 0},ie[Je]=pt),(pt.type!==he||pt.texture!==We)&&(ne!==Je&&(i.activeTexture(Je),ne=Je),i.bindTexture(he,We||se[he]),pt.type=he,pt.texture=We)}function q(){const he=ie[ne];he!==void 0&&he.type!==void 0&&(i.bindTexture(he.type,null),he.type=void 0,he.texture=void 0)}function V(){try{i.compressedTexImage2D(...arguments)}catch(he){kt("WebGLState:",he)}}function ue(){try{i.compressedTexImage3D(...arguments)}catch(he){kt("WebGLState:",he)}}function Re(){try{i.texSubImage2D(...arguments)}catch(he){kt("WebGLState:",he)}}function we(){try{i.texSubImage3D(...arguments)}catch(he){kt("WebGLState:",he)}}function be(){try{i.compressedTexSubImage2D(...arguments)}catch(he){kt("WebGLState:",he)}}function it(){try{i.compressedTexSubImage3D(...arguments)}catch(he){kt("WebGLState:",he)}}function tt(){try{i.texStorage2D(...arguments)}catch(he){kt("WebGLState:",he)}}function ht(){try{i.texStorage3D(...arguments)}catch(he){kt("WebGLState:",he)}}function yt(){try{i.texImage2D(...arguments)}catch(he){kt("WebGLState:",he)}}function He(){try{i.texImage3D(...arguments)}catch(he){kt("WebGLState:",he)}}function Xe(he){ae.equals(he)===!1&&(i.scissor(he.x,he.y,he.z,he.w),ae.copy(he))}function Qe(he){fe.equals(he)===!1&&(i.viewport(he.x,he.y,he.z,he.w),fe.copy(he))}function le(he,We){let Je=f.get(We);Je===void 0&&(Je=new WeakMap,f.set(We,Je));let pt=Je.get(he);pt===void 0&&(pt=i.getUniformBlockIndex(We,he.name),Je.set(he,pt))}function Te(he,We){const pt=f.get(We).get(he);u.get(We)!==pt&&(i.uniformBlockBinding(We,pt,he.__bindingPointIndex),u.set(We,pt))}function ct(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),p={},ne=null,ie={},g={},v=new WeakMap,x=[],b=null,w=!1,M=null,S=null,C=null,R=null,I=null,D=null,O=null,U=new St(0,0,0),k=0,P=!1,F=null,H=null,G=null,j=null,K=null,ae.set(0,0,i.canvas.width,i.canvas.height),fe.set(0,0,i.canvas.width,i.canvas.height),r.reset(),o.reset(),l.reset()}return{buffers:{color:r,depth:o,stencil:l},enable:ce,disable:pe,bindFramebuffer:Ie,drawBuffers:Ye,useProgram:et,setBlending:De,setMaterial:ge,setFlipSided:ye,setCullFace:Ge,setLineWidth:Y,setPolygonOffset:Be,setScissorTest:Ne,activeTexture:Me,bindTexture:Oe,unbindTexture:q,compressedTexImage2D:V,compressedTexImage3D:ue,texImage2D:yt,texImage3D:He,updateUBOMapping:le,uniformBlockBinding:Te,texStorage2D:tt,texStorage3D:ht,texSubImage2D:Re,texSubImage3D:we,compressedTexSubImage2D:be,compressedTexSubImage3D:it,scissor:Xe,viewport:Qe,reset:ct}}function t7(i,e,t,n,s,r,o){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new st,p=new WeakMap;let g;const v=new WeakMap;let x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(q,V){return x?new OffscreenCanvas(q,V):Sv("canvas")}function w(q,V,ue){let Re=1;const we=Oe(q);if((we.width>ue||we.height>ue)&&(Re=ue/Math.max(we.width,we.height)),Re<1)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap||typeof VideoFrame<"u"&&q instanceof VideoFrame){const be=Math.floor(Re*we.width),it=Math.floor(Re*we.height);g===void 0&&(g=b(be,it));const tt=V?b(be,it):g;return tt.width=be,tt.height=it,tt.getContext("2d").drawImage(q,0,0,be,it),Tt("WebGLRenderer: Texture has been resized from ("+we.width+"x"+we.height+") to ("+be+"x"+it+")."),tt}else return"data"in q&&Tt("WebGLRenderer: Image in DataTexture is too big ("+we.width+"x"+we.height+")."),q;return q}function M(q){return q.generateMipmaps}function S(q){i.generateMipmap(q)}function C(q){return q.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:q.isWebGL3DRenderTarget?i.TEXTURE_3D:q.isWebGLArrayRenderTarget||q.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function R(q,V,ue,Re,we=!1){if(q!==null){if(i[q]!==void 0)return i[q];Tt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let be=V;if(V===i.RED&&(ue===i.FLOAT&&(be=i.R32F),ue===i.HALF_FLOAT&&(be=i.R16F),ue===i.UNSIGNED_BYTE&&(be=i.R8)),V===i.RED_INTEGER&&(ue===i.UNSIGNED_BYTE&&(be=i.R8UI),ue===i.UNSIGNED_SHORT&&(be=i.R16UI),ue===i.UNSIGNED_INT&&(be=i.R32UI),ue===i.BYTE&&(be=i.R8I),ue===i.SHORT&&(be=i.R16I),ue===i.INT&&(be=i.R32I)),V===i.RG&&(ue===i.FLOAT&&(be=i.RG32F),ue===i.HALF_FLOAT&&(be=i.RG16F),ue===i.UNSIGNED_BYTE&&(be=i.RG8)),V===i.RG_INTEGER&&(ue===i.UNSIGNED_BYTE&&(be=i.RG8UI),ue===i.UNSIGNED_SHORT&&(be=i.RG16UI),ue===i.UNSIGNED_INT&&(be=i.RG32UI),ue===i.BYTE&&(be=i.RG8I),ue===i.SHORT&&(be=i.RG16I),ue===i.INT&&(be=i.RG32I)),V===i.RGB_INTEGER&&(ue===i.UNSIGNED_BYTE&&(be=i.RGB8UI),ue===i.UNSIGNED_SHORT&&(be=i.RGB16UI),ue===i.UNSIGNED_INT&&(be=i.RGB32UI),ue===i.BYTE&&(be=i.RGB8I),ue===i.SHORT&&(be=i.RGB16I),ue===i.INT&&(be=i.RGB32I)),V===i.RGBA_INTEGER&&(ue===i.UNSIGNED_BYTE&&(be=i.RGBA8UI),ue===i.UNSIGNED_SHORT&&(be=i.RGBA16UI),ue===i.UNSIGNED_INT&&(be=i.RGBA32UI),ue===i.BYTE&&(be=i.RGBA8I),ue===i.SHORT&&(be=i.RGBA16I),ue===i.INT&&(be=i.RGBA32I)),V===i.RGB&&(ue===i.UNSIGNED_INT_5_9_9_9_REV&&(be=i.RGB9_E5),ue===i.UNSIGNED_INT_10F_11F_11F_REV&&(be=i.R11F_G11F_B10F)),V===i.RGBA){const it=we?xv:On.getTransfer(Re);ue===i.FLOAT&&(be=i.RGBA32F),ue===i.HALF_FLOAT&&(be=i.RGBA16F),ue===i.UNSIGNED_BYTE&&(be=it===Jn?i.SRGB8_ALPHA8:i.RGBA8),ue===i.UNSIGNED_SHORT_4_4_4_4&&(be=i.RGBA4),ue===i.UNSIGNED_SHORT_5_5_5_1&&(be=i.RGB5_A1)}return(be===i.R16F||be===i.R32F||be===i.RG16F||be===i.RG32F||be===i.RGBA16F||be===i.RGBA32F)&&e.get("EXT_color_buffer_float"),be}function I(q,V){let ue;return q?V===null||V===Ko||V===Rm?ue=i.DEPTH24_STENCIL8:V===Pr?ue=i.DEPTH32F_STENCIL8:V===Cm&&(ue=i.DEPTH24_STENCIL8,Tt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):V===null||V===Ko||V===Rm?ue=i.DEPTH_COMPONENT24:V===Pr?ue=i.DEPTH_COMPONENT32F:V===Cm&&(ue=i.DEPTH_COMPONENT16),ue}function D(q,V){return M(q)===!0||q.isFramebufferTexture&&q.minFilter!==ms&&q.minFilter!==ti?Math.log2(Math.max(V.width,V.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?V.mipmaps.length:1}function O(q){const V=q.target;V.removeEventListener("dispose",O),k(V),V.isVideoTexture&&p.delete(V)}function U(q){const V=q.target;V.removeEventListener("dispose",U),F(V)}function k(q){const V=n.get(q);if(V.__webglInit===void 0)return;const ue=q.source,Re=v.get(ue);if(Re){const we=Re[V.__cacheKey];we.usedTimes--,we.usedTimes===0&&P(q),Object.keys(Re).length===0&&v.delete(ue)}n.remove(q)}function P(q){const V=n.get(q);i.deleteTexture(V.__webglTexture);const ue=q.source,Re=v.get(ue);delete Re[V.__cacheKey],o.memory.textures--}function F(q){const V=n.get(q);if(q.depthTexture&&(q.depthTexture.dispose(),n.remove(q.depthTexture)),q.isWebGLCubeRenderTarget)for(let Re=0;Re<6;Re++){if(Array.isArray(V.__webglFramebuffer[Re]))for(let we=0;we<V.__webglFramebuffer[Re].length;we++)i.deleteFramebuffer(V.__webglFramebuffer[Re][we]);else i.deleteFramebuffer(V.__webglFramebuffer[Re]);V.__webglDepthbuffer&&i.deleteRenderbuffer(V.__webglDepthbuffer[Re])}else{if(Array.isArray(V.__webglFramebuffer))for(let Re=0;Re<V.__webglFramebuffer.length;Re++)i.deleteFramebuffer(V.__webglFramebuffer[Re]);else i.deleteFramebuffer(V.__webglFramebuffer);if(V.__webglDepthbuffer&&i.deleteRenderbuffer(V.__webglDepthbuffer),V.__webglMultisampledFramebuffer&&i.deleteFramebuffer(V.__webglMultisampledFramebuffer),V.__webglColorRenderbuffer)for(let Re=0;Re<V.__webglColorRenderbuffer.length;Re++)V.__webglColorRenderbuffer[Re]&&i.deleteRenderbuffer(V.__webglColorRenderbuffer[Re]);V.__webglDepthRenderbuffer&&i.deleteRenderbuffer(V.__webglDepthRenderbuffer)}const ue=q.textures;for(let Re=0,we=ue.length;Re<we;Re++){const be=n.get(ue[Re]);be.__webglTexture&&(i.deleteTexture(be.__webglTexture),o.memory.textures--),n.remove(ue[Re])}n.remove(q)}let H=0;function G(){H=0}function j(){const q=H;return q>=s.maxTextures&&Tt("WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+s.maxTextures),H+=1,q}function K(q){const V=[];return V.push(q.wrapS),V.push(q.wrapT),V.push(q.wrapR||0),V.push(q.magFilter),V.push(q.minFilter),V.push(q.anisotropy),V.push(q.internalFormat),V.push(q.format),V.push(q.type),V.push(q.generateMipmaps),V.push(q.premultiplyAlpha),V.push(q.flipY),V.push(q.unpackAlignment),V.push(q.colorSpace),V.join()}function te(q,V){const ue=n.get(q);if(q.isVideoTexture&&Ne(q),q.isRenderTargetTexture===!1&&q.isExternalTexture!==!0&&q.version>0&&ue.__version!==q.version){const Re=q.image;if(Re===null)Tt("WebGLRenderer: Texture marked for update but no image data found.");else if(Re.complete===!1)Tt("WebGLRenderer: Texture marked for update but image is incomplete");else{se(ue,q,V);return}}else q.isExternalTexture&&(ue.__webglTexture=q.sourceTexture?q.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,ue.__webglTexture,i.TEXTURE0+V)}function W(q,V){const ue=n.get(q);if(q.isRenderTargetTexture===!1&&q.version>0&&ue.__version!==q.version){se(ue,q,V);return}else q.isExternalTexture&&(ue.__webglTexture=q.sourceTexture?q.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,ue.__webglTexture,i.TEXTURE0+V)}function X(q,V){const ue=n.get(q);if(q.isRenderTargetTexture===!1&&q.version>0&&ue.__version!==q.version){se(ue,q,V);return}t.bindTexture(i.TEXTURE_3D,ue.__webglTexture,i.TEXTURE0+V)}function oe(q,V){const ue=n.get(q);if(q.isCubeDepthTexture!==!0&&q.version>0&&ue.__version!==q.version){ce(ue,q,V);return}t.bindTexture(i.TEXTURE_CUBE_MAP,ue.__webglTexture,i.TEXTURE0+V)}const ne={[gv]:i.REPEAT,[Ga]:i.CLAMP_TO_EDGE,[vv]:i.MIRRORED_REPEAT},ie={[ms]:i.NEAREST,[DA]:i.NEAREST_MIPMAP_NEAREST,[gm]:i.NEAREST_MIPMAP_LINEAR,[ti]:i.LINEAR,[Q0]:i.LINEAR_MIPMAP_NEAREST,[vc]:i.LINEAR_MIPMAP_LINEAR},B={[oP]:i.NEVER,[fP]:i.ALWAYS,[lP]:i.LESS,[L1]:i.LEQUAL,[cP]:i.EQUAL,[F1]:i.GEQUAL,[uP]:i.GREATER,[hP]:i.NOTEQUAL};function Q(q,V){if(V.type===Pr&&e.has("OES_texture_float_linear")===!1&&(V.magFilter===ti||V.magFilter===Q0||V.magFilter===gm||V.magFilter===vc||V.minFilter===ti||V.minFilter===Q0||V.minFilter===gm||V.minFilter===vc)&&Tt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(q,i.TEXTURE_WRAP_S,ne[V.wrapS]),i.texParameteri(q,i.TEXTURE_WRAP_T,ne[V.wrapT]),(q===i.TEXTURE_3D||q===i.TEXTURE_2D_ARRAY)&&i.texParameteri(q,i.TEXTURE_WRAP_R,ne[V.wrapR]),i.texParameteri(q,i.TEXTURE_MAG_FILTER,ie[V.magFilter]),i.texParameteri(q,i.TEXTURE_MIN_FILTER,ie[V.minFilter]),V.compareFunction&&(i.texParameteri(q,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(q,i.TEXTURE_COMPARE_FUNC,B[V.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(V.magFilter===ms||V.minFilter!==gm&&V.minFilter!==vc||V.type===Pr&&e.has("OES_texture_float_linear")===!1)return;if(V.anisotropy>1||n.get(V).__currentAnisotropy){const ue=e.get("EXT_texture_filter_anisotropic");i.texParameterf(q,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(V.anisotropy,s.getMaxAnisotropy())),n.get(V).__currentAnisotropy=V.anisotropy}}}function ae(q,V){let ue=!1;q.__webglInit===void 0&&(q.__webglInit=!0,V.addEventListener("dispose",O));const Re=V.source;let we=v.get(Re);we===void 0&&(we={},v.set(Re,we));const be=K(V);if(be!==q.__cacheKey){we[be]===void 0&&(we[be]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,ue=!0),we[be].usedTimes++;const it=we[q.__cacheKey];it!==void 0&&(we[q.__cacheKey].usedTimes--,it.usedTimes===0&&P(V)),q.__cacheKey=be,q.__webglTexture=we[be].texture}return ue}function fe(q,V,ue){return Math.floor(Math.floor(q/ue)/V)}function de(q,V,ue,Re){const be=q.updateRanges;if(be.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,V.width,V.height,ue,Re,V.data);else{be.sort((He,Xe)=>He.start-Xe.start);let it=0;for(let He=1;He<be.length;He++){const Xe=be[it],Qe=be[He],le=Xe.start+Xe.count,Te=fe(Qe.start,V.width,4),ct=fe(Xe.start,V.width,4);Qe.start<=le+1&&Te===ct&&fe(Qe.start+Qe.count-1,V.width,4)===Te?Xe.count=Math.max(Xe.count,Qe.start+Qe.count-Xe.start):(++it,be[it]=Qe)}be.length=it+1;const tt=i.getParameter(i.UNPACK_ROW_LENGTH),ht=i.getParameter(i.UNPACK_SKIP_PIXELS),yt=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,V.width);for(let He=0,Xe=be.length;He<Xe;He++){const Qe=be[He],le=Math.floor(Qe.start/4),Te=Math.ceil(Qe.count/4),ct=le%V.width,he=Math.floor(le/V.width),We=Te,Je=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,ct),i.pixelStorei(i.UNPACK_SKIP_ROWS,he),t.texSubImage2D(i.TEXTURE_2D,0,ct,he,We,Je,ue,Re,V.data)}q.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,tt),i.pixelStorei(i.UNPACK_SKIP_PIXELS,ht),i.pixelStorei(i.UNPACK_SKIP_ROWS,yt)}}function se(q,V,ue){let Re=i.TEXTURE_2D;(V.isDataArrayTexture||V.isCompressedArrayTexture)&&(Re=i.TEXTURE_2D_ARRAY),V.isData3DTexture&&(Re=i.TEXTURE_3D);const we=ae(q,V),be=V.source;t.bindTexture(Re,q.__webglTexture,i.TEXTURE0+ue);const it=n.get(be);if(be.version!==it.__version||we===!0){t.activeTexture(i.TEXTURE0+ue);const tt=On.getPrimaries(On.workingColorSpace),ht=V.colorSpace===xu?null:On.getPrimaries(V.colorSpace),yt=V.colorSpace===xu||tt===ht?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,V.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,V.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,yt);let He=w(V.image,!1,s.maxTextureSize);He=Me(V,He);const Xe=r.convert(V.format,V.colorSpace),Qe=r.convert(V.type);let le=R(V.internalFormat,Xe,Qe,V.colorSpace,V.isVideoTexture);Q(Re,V);let Te;const ct=V.mipmaps,he=V.isVideoTexture!==!0,We=it.__version===void 0||we===!0,Je=be.dataReady,pt=D(V,He);if(V.isDepthTexture)le=I(V.format===Ph,V.type),We&&(he?t.texStorage2D(i.TEXTURE_2D,1,le,He.width,He.height):t.texImage2D(i.TEXTURE_2D,0,le,He.width,He.height,0,Xe,Qe,null));else if(V.isDataTexture)if(ct.length>0){he&&We&&t.texStorage2D(i.TEXTURE_2D,pt,le,ct[0].width,ct[0].height);for(let $e=0,Le=ct.length;$e<Le;$e++)Te=ct[$e],he?Je&&t.texSubImage2D(i.TEXTURE_2D,$e,0,0,Te.width,Te.height,Xe,Qe,Te.data):t.texImage2D(i.TEXTURE_2D,$e,le,Te.width,Te.height,0,Xe,Qe,Te.data);V.generateMipmaps=!1}else he?(We&&t.texStorage2D(i.TEXTURE_2D,pt,le,He.width,He.height),Je&&de(V,He,Xe,Qe)):t.texImage2D(i.TEXTURE_2D,0,le,He.width,He.height,0,Xe,Qe,He.data);else if(V.isCompressedTexture)if(V.isCompressedArrayTexture){he&&We&&t.texStorage3D(i.TEXTURE_2D_ARRAY,pt,le,ct[0].width,ct[0].height,He.depth);for(let $e=0,Le=ct.length;$e<Le;$e++)if(Te=ct[$e],V.format!==Ur)if(Xe!==null)if(he){if(Je)if(V.layerUpdates.size>0){const rt=_w(Te.width,Te.height,V.format,V.type);for(const xt of V.layerUpdates){const _t=Te.data.subarray(xt*rt/Te.data.BYTES_PER_ELEMENT,(xt+1)*rt/Te.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,$e,0,0,xt,Te.width,Te.height,1,Xe,_t)}V.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,$e,0,0,0,Te.width,Te.height,He.depth,Xe,Te.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,$e,le,Te.width,Te.height,He.depth,0,Te.data,0,0);else Tt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else he?Je&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,$e,0,0,0,Te.width,Te.height,He.depth,Xe,Qe,Te.data):t.texImage3D(i.TEXTURE_2D_ARRAY,$e,le,Te.width,Te.height,He.depth,0,Xe,Qe,Te.data)}else{he&&We&&t.texStorage2D(i.TEXTURE_2D,pt,le,ct[0].width,ct[0].height);for(let $e=0,Le=ct.length;$e<Le;$e++)Te=ct[$e],V.format!==Ur?Xe!==null?he?Je&&t.compressedTexSubImage2D(i.TEXTURE_2D,$e,0,0,Te.width,Te.height,Xe,Te.data):t.compressedTexImage2D(i.TEXTURE_2D,$e,le,Te.width,Te.height,0,Te.data):Tt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):he?Je&&t.texSubImage2D(i.TEXTURE_2D,$e,0,0,Te.width,Te.height,Xe,Qe,Te.data):t.texImage2D(i.TEXTURE_2D,$e,le,Te.width,Te.height,0,Xe,Qe,Te.data)}else if(V.isDataArrayTexture)if(he){if(We&&t.texStorage3D(i.TEXTURE_2D_ARRAY,pt,le,He.width,He.height,He.depth),Je)if(V.layerUpdates.size>0){const $e=_w(He.width,He.height,V.format,V.type);for(const Le of V.layerUpdates){const rt=He.data.subarray(Le*$e/He.data.BYTES_PER_ELEMENT,(Le+1)*$e/He.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Le,He.width,He.height,1,Xe,Qe,rt)}V.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,He.width,He.height,He.depth,Xe,Qe,He.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,le,He.width,He.height,He.depth,0,Xe,Qe,He.data);else if(V.isData3DTexture)he?(We&&t.texStorage3D(i.TEXTURE_3D,pt,le,He.width,He.height,He.depth),Je&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,He.width,He.height,He.depth,Xe,Qe,He.data)):t.texImage3D(i.TEXTURE_3D,0,le,He.width,He.height,He.depth,0,Xe,Qe,He.data);else if(V.isFramebufferTexture){if(We)if(he)t.texStorage2D(i.TEXTURE_2D,pt,le,He.width,He.height);else{let $e=He.width,Le=He.height;for(let rt=0;rt<pt;rt++)t.texImage2D(i.TEXTURE_2D,rt,le,$e,Le,0,Xe,Qe,null),$e>>=1,Le>>=1}}else if(ct.length>0){if(he&&We){const $e=Oe(ct[0]);t.texStorage2D(i.TEXTURE_2D,pt,le,$e.width,$e.height)}for(let $e=0,Le=ct.length;$e<Le;$e++)Te=ct[$e],he?Je&&t.texSubImage2D(i.TEXTURE_2D,$e,0,0,Xe,Qe,Te):t.texImage2D(i.TEXTURE_2D,$e,le,Xe,Qe,Te);V.generateMipmaps=!1}else if(he){if(We){const $e=Oe(He);t.texStorage2D(i.TEXTURE_2D,pt,le,$e.width,$e.height)}Je&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Xe,Qe,He)}else t.texImage2D(i.TEXTURE_2D,0,le,Xe,Qe,He);M(V)&&S(Re),it.__version=be.version,V.onUpdate&&V.onUpdate(V)}q.__version=V.version}function ce(q,V,ue){if(V.image.length!==6)return;const Re=ae(q,V),we=V.source;t.bindTexture(i.TEXTURE_CUBE_MAP,q.__webglTexture,i.TEXTURE0+ue);const be=n.get(we);if(we.version!==be.__version||Re===!0){t.activeTexture(i.TEXTURE0+ue);const it=On.getPrimaries(On.workingColorSpace),tt=V.colorSpace===xu?null:On.getPrimaries(V.colorSpace),ht=V.colorSpace===xu||it===tt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,V.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,V.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,ht);const yt=V.isCompressedTexture||V.image[0].isCompressedTexture,He=V.image[0]&&V.image[0].isDataTexture,Xe=[];for(let Le=0;Le<6;Le++)!yt&&!He?Xe[Le]=w(V.image[Le],!0,s.maxCubemapSize):Xe[Le]=He?V.image[Le].image:V.image[Le],Xe[Le]=Me(V,Xe[Le]);const Qe=Xe[0],le=r.convert(V.format,V.colorSpace),Te=r.convert(V.type),ct=R(V.internalFormat,le,Te,V.colorSpace),he=V.isVideoTexture!==!0,We=be.__version===void 0||Re===!0,Je=we.dataReady;let pt=D(V,Qe);Q(i.TEXTURE_CUBE_MAP,V);let $e;if(yt){he&&We&&t.texStorage2D(i.TEXTURE_CUBE_MAP,pt,ct,Qe.width,Qe.height);for(let Le=0;Le<6;Le++){$e=Xe[Le].mipmaps;for(let rt=0;rt<$e.length;rt++){const xt=$e[rt];V.format!==Ur?le!==null?he?Je&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt,0,0,xt.width,xt.height,le,xt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt,ct,xt.width,xt.height,0,xt.data):Tt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):he?Je&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt,0,0,xt.width,xt.height,le,Te,xt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt,ct,xt.width,xt.height,0,le,Te,xt.data)}}}else{if($e=V.mipmaps,he&&We){$e.length>0&&pt++;const Le=Oe(Xe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,pt,ct,Le.width,Le.height)}for(let Le=0;Le<6;Le++)if(He){he?Je&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,Xe[Le].width,Xe[Le].height,le,Te,Xe[Le].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,ct,Xe[Le].width,Xe[Le].height,0,le,Te,Xe[Le].data);for(let rt=0;rt<$e.length;rt++){const _t=$e[rt].image[Le].image;he?Je&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt+1,0,0,_t.width,_t.height,le,Te,_t.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt+1,ct,_t.width,_t.height,0,le,Te,_t.data)}}else{he?Je&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,le,Te,Xe[Le]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,ct,le,Te,Xe[Le]);for(let rt=0;rt<$e.length;rt++){const xt=$e[rt];he?Je&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt+1,0,0,le,Te,xt.image[Le]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Le,rt+1,ct,le,Te,xt.image[Le])}}}M(V)&&S(i.TEXTURE_CUBE_MAP),be.__version=we.version,V.onUpdate&&V.onUpdate(V)}q.__version=V.version}function pe(q,V,ue,Re,we,be){const it=r.convert(ue.format,ue.colorSpace),tt=r.convert(ue.type),ht=R(ue.internalFormat,it,tt,ue.colorSpace),yt=n.get(V),He=n.get(ue);if(He.__renderTarget=V,!yt.__hasExternalTextures){const Xe=Math.max(1,V.width>>be),Qe=Math.max(1,V.height>>be);we===i.TEXTURE_3D||we===i.TEXTURE_2D_ARRAY?t.texImage3D(we,be,ht,Xe,Qe,V.depth,0,it,tt,null):t.texImage2D(we,be,ht,Xe,Qe,0,it,tt,null)}t.bindFramebuffer(i.FRAMEBUFFER,q),Be(V)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Re,we,He.__webglTexture,0,Y(V)):(we===i.TEXTURE_2D||we>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&we<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Re,we,He.__webglTexture,be),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Ie(q,V,ue){if(i.bindRenderbuffer(i.RENDERBUFFER,q),V.depthBuffer){const Re=V.depthTexture,we=Re&&Re.isDepthTexture?Re.type:null,be=I(V.stencilBuffer,we),it=V.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;Be(V)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Y(V),be,V.width,V.height):ue?i.renderbufferStorageMultisample(i.RENDERBUFFER,Y(V),be,V.width,V.height):i.renderbufferStorage(i.RENDERBUFFER,be,V.width,V.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,it,i.RENDERBUFFER,q)}else{const Re=V.textures;for(let we=0;we<Re.length;we++){const be=Re[we],it=r.convert(be.format,be.colorSpace),tt=r.convert(be.type),ht=R(be.internalFormat,it,tt,be.colorSpace);Be(V)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Y(V),ht,V.width,V.height):ue?i.renderbufferStorageMultisample(i.RENDERBUFFER,Y(V),ht,V.width,V.height):i.renderbufferStorage(i.RENDERBUFFER,ht,V.width,V.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Ye(q,V,ue){const Re=V.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,q),!(V.depthTexture&&V.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const we=n.get(V.depthTexture);if(we.__renderTarget=V,(!we.__webglTexture||V.depthTexture.image.width!==V.width||V.depthTexture.image.height!==V.height)&&(V.depthTexture.image.width=V.width,V.depthTexture.image.height=V.height,V.depthTexture.needsUpdate=!0),Re){if(we.__webglInit===void 0&&(we.__webglInit=!0,V.depthTexture.addEventListener("dispose",O)),we.__webglTexture===void 0){we.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,we.__webglTexture),Q(i.TEXTURE_CUBE_MAP,V.depthTexture);const yt=r.convert(V.depthTexture.format),He=r.convert(V.depthTexture.type);let Xe;V.depthTexture.format===Mc?Xe=i.DEPTH_COMPONENT24:V.depthTexture.format===Ph&&(Xe=i.DEPTH24_STENCIL8);for(let Qe=0;Qe<6;Qe++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,0,Xe,V.width,V.height,0,yt,He,null)}}else te(V.depthTexture,0);const be=we.__webglTexture,it=Y(V),tt=Re?i.TEXTURE_CUBE_MAP_POSITIVE_X+ue:i.TEXTURE_2D,ht=V.depthTexture.format===Ph?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(V.depthTexture.format===Mc)Be(V)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,ht,tt,be,0,it):i.framebufferTexture2D(i.FRAMEBUFFER,ht,tt,be,0);else if(V.depthTexture.format===Ph)Be(V)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,ht,tt,be,0,it):i.framebufferTexture2D(i.FRAMEBUFFER,ht,tt,be,0);else throw new Error("Unknown depthTexture format")}function et(q){const V=n.get(q),ue=q.isWebGLCubeRenderTarget===!0;if(V.__boundDepthTexture!==q.depthTexture){const Re=q.depthTexture;if(V.__depthDisposeCallback&&V.__depthDisposeCallback(),Re){const we=()=>{delete V.__boundDepthTexture,delete V.__depthDisposeCallback,Re.removeEventListener("dispose",we)};Re.addEventListener("dispose",we),V.__depthDisposeCallback=we}V.__boundDepthTexture=Re}if(q.depthTexture&&!V.__autoAllocateDepthBuffer)if(ue)for(let Re=0;Re<6;Re++)Ye(V.__webglFramebuffer[Re],q,Re);else{const Re=q.texture.mipmaps;Re&&Re.length>0?Ye(V.__webglFramebuffer[0],q,0):Ye(V.__webglFramebuffer,q,0)}else if(ue){V.__webglDepthbuffer=[];for(let Re=0;Re<6;Re++)if(t.bindFramebuffer(i.FRAMEBUFFER,V.__webglFramebuffer[Re]),V.__webglDepthbuffer[Re]===void 0)V.__webglDepthbuffer[Re]=i.createRenderbuffer(),Ie(V.__webglDepthbuffer[Re],q,!1);else{const we=q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,be=V.__webglDepthbuffer[Re];i.bindRenderbuffer(i.RENDERBUFFER,be),i.framebufferRenderbuffer(i.FRAMEBUFFER,we,i.RENDERBUFFER,be)}}else{const Re=q.texture.mipmaps;if(Re&&Re.length>0?t.bindFramebuffer(i.FRAMEBUFFER,V.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,V.__webglFramebuffer),V.__webglDepthbuffer===void 0)V.__webglDepthbuffer=i.createRenderbuffer(),Ie(V.__webglDepthbuffer,q,!1);else{const we=q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,be=V.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,be),i.framebufferRenderbuffer(i.FRAMEBUFFER,we,i.RENDERBUFFER,be)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function qe(q,V,ue){const Re=n.get(q);V!==void 0&&pe(Re.__webglFramebuffer,q,q.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),ue!==void 0&&et(q)}function dt(q){const V=q.texture,ue=n.get(q),Re=n.get(V);q.addEventListener("dispose",U);const we=q.textures,be=q.isWebGLCubeRenderTarget===!0,it=we.length>1;if(it||(Re.__webglTexture===void 0&&(Re.__webglTexture=i.createTexture()),Re.__version=V.version,o.memory.textures++),be){ue.__webglFramebuffer=[];for(let tt=0;tt<6;tt++)if(V.mipmaps&&V.mipmaps.length>0){ue.__webglFramebuffer[tt]=[];for(let ht=0;ht<V.mipmaps.length;ht++)ue.__webglFramebuffer[tt][ht]=i.createFramebuffer()}else ue.__webglFramebuffer[tt]=i.createFramebuffer()}else{if(V.mipmaps&&V.mipmaps.length>0){ue.__webglFramebuffer=[];for(let tt=0;tt<V.mipmaps.length;tt++)ue.__webglFramebuffer[tt]=i.createFramebuffer()}else ue.__webglFramebuffer=i.createFramebuffer();if(it)for(let tt=0,ht=we.length;tt<ht;tt++){const yt=n.get(we[tt]);yt.__webglTexture===void 0&&(yt.__webglTexture=i.createTexture(),o.memory.textures++)}if(q.samples>0&&Be(q)===!1){ue.__webglMultisampledFramebuffer=i.createFramebuffer(),ue.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,ue.__webglMultisampledFramebuffer);for(let tt=0;tt<we.length;tt++){const ht=we[tt];ue.__webglColorRenderbuffer[tt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,ue.__webglColorRenderbuffer[tt]);const yt=r.convert(ht.format,ht.colorSpace),He=r.convert(ht.type),Xe=R(ht.internalFormat,yt,He,ht.colorSpace,q.isXRRenderTarget===!0),Qe=Y(q);i.renderbufferStorageMultisample(i.RENDERBUFFER,Qe,Xe,q.width,q.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+tt,i.RENDERBUFFER,ue.__webglColorRenderbuffer[tt])}i.bindRenderbuffer(i.RENDERBUFFER,null),q.depthBuffer&&(ue.__webglDepthRenderbuffer=i.createRenderbuffer(),Ie(ue.__webglDepthRenderbuffer,q,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(be){t.bindTexture(i.TEXTURE_CUBE_MAP,Re.__webglTexture),Q(i.TEXTURE_CUBE_MAP,V);for(let tt=0;tt<6;tt++)if(V.mipmaps&&V.mipmaps.length>0)for(let ht=0;ht<V.mipmaps.length;ht++)pe(ue.__webglFramebuffer[tt][ht],q,V,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+tt,ht);else pe(ue.__webglFramebuffer[tt],q,V,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+tt,0);M(V)&&S(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(it){for(let tt=0,ht=we.length;tt<ht;tt++){const yt=we[tt],He=n.get(yt);let Xe=i.TEXTURE_2D;(q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(Xe=q.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Xe,He.__webglTexture),Q(Xe,yt),pe(ue.__webglFramebuffer,q,yt,i.COLOR_ATTACHMENT0+tt,Xe,0),M(yt)&&S(Xe)}t.unbindTexture()}else{let tt=i.TEXTURE_2D;if((q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(tt=q.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(tt,Re.__webglTexture),Q(tt,V),V.mipmaps&&V.mipmaps.length>0)for(let ht=0;ht<V.mipmaps.length;ht++)pe(ue.__webglFramebuffer[ht],q,V,i.COLOR_ATTACHMENT0,tt,ht);else pe(ue.__webglFramebuffer,q,V,i.COLOR_ATTACHMENT0,tt,0);M(V)&&S(tt),t.unbindTexture()}q.depthBuffer&&et(q)}function De(q){const V=q.textures;for(let ue=0,Re=V.length;ue<Re;ue++){const we=V[ue];if(M(we)){const be=C(q),it=n.get(we).__webglTexture;t.bindTexture(be,it),S(be),t.unbindTexture()}}}const ge=[],ye=[];function Ge(q){if(q.samples>0){if(Be(q)===!1){const V=q.textures,ue=q.width,Re=q.height;let we=i.COLOR_BUFFER_BIT;const be=q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,it=n.get(q),tt=V.length>1;if(tt)for(let yt=0;yt<V.length;yt++)t.bindFramebuffer(i.FRAMEBUFFER,it.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+yt,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,it.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+yt,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,it.__webglMultisampledFramebuffer);const ht=q.texture.mipmaps;ht&&ht.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,it.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,it.__webglFramebuffer);for(let yt=0;yt<V.length;yt++){if(q.resolveDepthBuffer&&(q.depthBuffer&&(we|=i.DEPTH_BUFFER_BIT),q.stencilBuffer&&q.resolveStencilBuffer&&(we|=i.STENCIL_BUFFER_BIT)),tt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,it.__webglColorRenderbuffer[yt]);const He=n.get(V[yt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,He,0)}i.blitFramebuffer(0,0,ue,Re,0,0,ue,Re,we,i.NEAREST),u===!0&&(ge.length=0,ye.length=0,ge.push(i.COLOR_ATTACHMENT0+yt),q.depthBuffer&&q.resolveDepthBuffer===!1&&(ge.push(be),ye.push(be),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,ye)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,ge))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),tt)for(let yt=0;yt<V.length;yt++){t.bindFramebuffer(i.FRAMEBUFFER,it.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+yt,i.RENDERBUFFER,it.__webglColorRenderbuffer[yt]);const He=n.get(V[yt]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,it.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+yt,i.TEXTURE_2D,He,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,it.__webglMultisampledFramebuffer)}else if(q.depthBuffer&&q.resolveDepthBuffer===!1&&u){const V=q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[V])}}}function Y(q){return Math.min(s.maxSamples,q.samples)}function Be(q){const V=n.get(q);return q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&V.__useRenderToTexture!==!1}function Ne(q){const V=o.render.frame;p.get(q)!==V&&(p.set(q,V),q.update())}function Me(q,V){const ue=q.colorSpace,Re=q.format,we=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||ue!==Gh&&ue!==xu&&(On.getTransfer(ue)===Jn?(Re!==Ur||we!==ra)&&Tt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):kt("WebGLTextures: Unsupported texture color space:",ue)),V}function Oe(q){return typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement?(f.width=q.naturalWidth||q.width,f.height=q.naturalHeight||q.height):typeof VideoFrame<"u"&&q instanceof VideoFrame?(f.width=q.displayWidth,f.height=q.displayHeight):(f.width=q.width,f.height=q.height),f}this.allocateTextureUnit=j,this.resetTextureUnits=G,this.setTexture2D=te,this.setTexture2DArray=W,this.setTexture3D=X,this.setTextureCube=oe,this.rebindTextures=qe,this.setupRenderTarget=dt,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=Ge,this.setupDepthRenderbuffer=et,this.setupFrameBufferTexture=pe,this.useMultisampledRTT=Be,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function _U(i,e){function t(n,s=xu){let r;const o=On.getTransfer(s);if(n===ra)return i.UNSIGNED_BYTE;if(n===D1)return i.UNSIGNED_SHORT_4_4_4_4;if(n===N1)return i.UNSIGNED_SHORT_5_5_5_1;if(n===OA)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===PA)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===NA)return i.BYTE;if(n===IA)return i.SHORT;if(n===Cm)return i.UNSIGNED_SHORT;if(n===R1)return i.INT;if(n===Ko)return i.UNSIGNED_INT;if(n===Pr)return i.FLOAT;if(n===El)return i.HALF_FLOAT;if(n===UA)return i.ALPHA;if(n===LA)return i.RGB;if(n===Ur)return i.RGBA;if(n===Mc)return i.DEPTH_COMPONENT;if(n===Ph)return i.DEPTH_STENCIL;if(n===I1)return i.RED;if(n===Hv)return i.RED_INTEGER;if(n===bd)return i.RG;if(n===O1)return i.RG_INTEGER;if(n===P1)return i.RGBA_INTEGER;if(n===J0||n===$0||n===ev||n===tv)if(o===Jn)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===J0)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===$0)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===ev)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===tv)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===J0)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===$0)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===ev)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===tv)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===_b||n===xb||n===bb||n===Sb)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===_b)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===xb)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===bb)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Sb)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Mb||n===Tb||n===wb||n===Ab||n===Eb||n===Cb||n===Rb)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===Mb||n===Tb)return o===Jn?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===wb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC;if(n===Ab)return r.COMPRESSED_R11_EAC;if(n===Eb)return r.COMPRESSED_SIGNED_R11_EAC;if(n===Cb)return r.COMPRESSED_RG11_EAC;if(n===Rb)return r.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===Db||n===Nb||n===Ib||n===Ob||n===Pb||n===Ub||n===Lb||n===Fb||n===kb||n===Bb||n===zb||n===Vb||n===Gb||n===Hb)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===Db)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Nb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Ib)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Ob)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Pb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Ub)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Lb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Fb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===kb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Bb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===zb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Vb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Gb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Hb)return o===Jn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Wb||n===jb||n===qb)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===Wb)return o===Jn?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===jb)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===qb)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Xb||n===Yb||n===Zb||n===Kb)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===Xb)return r.COMPRESSED_RED_RGTC1_EXT;if(n===Yb)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Zb)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Kb)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Rm?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const n7=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,i7=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class s7{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new XA(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new ho({vertexShader:n7,fragmentShader:i7,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Qi(new Ou(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class r7 extends Ec{constructor(e,t){super();const n=this;let s=null,r=1,o=null,l="local-floor",u=1,f=null,p=null,g=null,v=null,x=null,b=null;const w=typeof XRWebGLBinding<"u",M=new s7,S={},C=t.getContextAttributes();let R=null,I=null;const D=[],O=[],U=new st;let k=null;const P=new ps;P.viewport=new $n;const F=new ps;F.viewport=new $n;const H=[P,F],G=new lU;let j=null,K=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(se){let ce=D[se];return ce===void 0&&(ce=new Kx,D[se]=ce),ce.getTargetRaySpace()},this.getControllerGrip=function(se){let ce=D[se];return ce===void 0&&(ce=new Kx,D[se]=ce),ce.getGripSpace()},this.getHand=function(se){let ce=D[se];return ce===void 0&&(ce=new Kx,D[se]=ce),ce.getHandSpace()};function te(se){const ce=O.indexOf(se.inputSource);if(ce===-1)return;const pe=D[ce];pe!==void 0&&(pe.update(se.inputSource,se.frame,f||o),pe.dispatchEvent({type:se.type,data:se.inputSource}))}function W(){s.removeEventListener("select",te),s.removeEventListener("selectstart",te),s.removeEventListener("selectend",te),s.removeEventListener("squeeze",te),s.removeEventListener("squeezestart",te),s.removeEventListener("squeezeend",te),s.removeEventListener("end",W),s.removeEventListener("inputsourceschange",X);for(let se=0;se<D.length;se++){const ce=O[se];ce!==null&&(O[se]=null,D[se].disconnect(ce))}j=null,K=null,M.reset();for(const se in S)delete S[se];e.setRenderTarget(R),x=null,v=null,g=null,s=null,I=null,de.stop(),n.isPresenting=!1,e.setPixelRatio(k),e.setSize(U.width,U.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(se){r=se,n.isPresenting===!0&&Tt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(se){l=se,n.isPresenting===!0&&Tt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return f||o},this.setReferenceSpace=function(se){f=se},this.getBaseLayer=function(){return v!==null?v:x},this.getBinding=function(){return g===null&&w&&(g=new XRWebGLBinding(s,t)),g},this.getFrame=function(){return b},this.getSession=function(){return s},this.setSession=async function(se){if(s=se,s!==null){if(R=e.getRenderTarget(),s.addEventListener("select",te),s.addEventListener("selectstart",te),s.addEventListener("selectend",te),s.addEventListener("squeeze",te),s.addEventListener("squeezestart",te),s.addEventListener("squeezeend",te),s.addEventListener("end",W),s.addEventListener("inputsourceschange",X),C.xrCompatible!==!0&&await t.makeXRCompatible(),k=e.getPixelRatio(),e.getSize(U),w&&"createProjectionLayer"in XRWebGLBinding.prototype){let pe=null,Ie=null,Ye=null;C.depth&&(Ye=C.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,pe=C.stencil?Ph:Mc,Ie=C.stencil?Rm:Ko);const et={colorFormat:t.RGBA8,depthFormat:Ye,scaleFactor:r};g=this.getBinding(),v=g.createProjectionLayer(et),s.updateRenderState({layers:[v]}),e.setPixelRatio(1),e.setSize(v.textureWidth,v.textureHeight,!1),I=new Ha(v.textureWidth,v.textureHeight,{format:Ur,type:ra,depthTexture:new Td(v.textureWidth,v.textureHeight,Ie,void 0,void 0,void 0,void 0,void 0,void 0,pe),stencilBuffer:C.stencil,colorSpace:e.outputColorSpace,samples:C.antialias?4:0,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}else{const pe={antialias:C.antialias,alpha:!0,depth:C.depth,stencil:C.stencil,framebufferScaleFactor:r};x=new XRWebGLLayer(s,t,pe),s.updateRenderState({baseLayer:x}),e.setPixelRatio(1),e.setSize(x.framebufferWidth,x.framebufferHeight,!1),I=new Ha(x.framebufferWidth,x.framebufferHeight,{format:Ur,type:ra,colorSpace:e.outputColorSpace,stencilBuffer:C.stencil,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}I.isXRRenderTarget=!0,this.setFoveation(u),f=null,o=await s.requestReferenceSpace(l),de.setContext(s),de.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return M.getDepthTexture()};function X(se){for(let ce=0;ce<se.removed.length;ce++){const pe=se.removed[ce],Ie=O.indexOf(pe);Ie>=0&&(O[Ie]=null,D[Ie].disconnect(pe))}for(let ce=0;ce<se.added.length;ce++){const pe=se.added[ce];let Ie=O.indexOf(pe);if(Ie===-1){for(let et=0;et<D.length;et++)if(et>=O.length){O.push(pe),Ie=et;break}else if(O[et]===null){O[et]=pe,Ie=et;break}if(Ie===-1)break}const Ye=D[Ie];Ye&&Ye.connect(pe)}}const oe=new re,ne=new re;function ie(se,ce,pe){oe.setFromMatrixPosition(ce.matrixWorld),ne.setFromMatrixPosition(pe.matrixWorld);const Ie=oe.distanceTo(ne),Ye=ce.projectionMatrix.elements,et=pe.projectionMatrix.elements,qe=Ye[14]/(Ye[10]-1),dt=Ye[14]/(Ye[10]+1),De=(Ye[9]+1)/Ye[5],ge=(Ye[9]-1)/Ye[5],ye=(Ye[8]-1)/Ye[0],Ge=(et[8]+1)/et[0],Y=qe*ye,Be=qe*Ge,Ne=Ie/(-ye+Ge),Me=Ne*-ye;if(ce.matrixWorld.decompose(se.position,se.quaternion,se.scale),se.translateX(Me),se.translateZ(Ne),se.matrixWorld.compose(se.position,se.quaternion,se.scale),se.matrixWorldInverse.copy(se.matrixWorld).invert(),Ye[10]===-1)se.projectionMatrix.copy(ce.projectionMatrix),se.projectionMatrixInverse.copy(ce.projectionMatrixInverse);else{const Oe=qe+Ne,q=dt+Ne,V=Y-Me,ue=Be+(Ie-Me),Re=De*dt/q*Oe,we=ge*dt/q*Oe;se.projectionMatrix.makePerspective(V,ue,Re,we,Oe,q),se.projectionMatrixInverse.copy(se.projectionMatrix).invert()}}function B(se,ce){ce===null?se.matrixWorld.copy(se.matrix):se.matrixWorld.multiplyMatrices(ce.matrixWorld,se.matrix),se.matrixWorldInverse.copy(se.matrixWorld).invert()}this.updateCamera=function(se){if(s===null)return;let ce=se.near,pe=se.far;M.texture!==null&&(M.depthNear>0&&(ce=M.depthNear),M.depthFar>0&&(pe=M.depthFar)),G.near=F.near=P.near=ce,G.far=F.far=P.far=pe,(j!==G.near||K!==G.far)&&(s.updateRenderState({depthNear:G.near,depthFar:G.far}),j=G.near,K=G.far),G.layers.mask=se.layers.mask|6,P.layers.mask=G.layers.mask&3,F.layers.mask=G.layers.mask&5;const Ie=se.parent,Ye=G.cameras;B(G,Ie);for(let et=0;et<Ye.length;et++)B(Ye[et],Ie);Ye.length===2?ie(G,P,F):G.projectionMatrix.copy(P.projectionMatrix),Q(se,G,Ie)};function Q(se,ce,pe){pe===null?se.matrix.copy(ce.matrixWorld):(se.matrix.copy(pe.matrixWorld),se.matrix.invert(),se.matrix.multiply(ce.matrixWorld)),se.matrix.decompose(se.position,se.quaternion,se.scale),se.updateMatrixWorld(!0),se.projectionMatrix.copy(ce.projectionMatrix),se.projectionMatrixInverse.copy(ce.projectionMatrixInverse),se.isPerspectiveCamera&&(se.fov=Im*2*Math.atan(1/se.projectionMatrix.elements[5]),se.zoom=1)}this.getCamera=function(){return G},this.getFoveation=function(){if(!(v===null&&x===null))return u},this.setFoveation=function(se){u=se,v!==null&&(v.fixedFoveation=se),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=se)},this.hasDepthSensing=function(){return M.texture!==null},this.getDepthSensingMesh=function(){return M.getMesh(G)},this.getCameraTexture=function(se){return S[se]};let ae=null;function fe(se,ce){if(p=ce.getViewerPose(f||o),b=ce,p!==null){const pe=p.views;x!==null&&(e.setRenderTargetFramebuffer(I,x.framebuffer),e.setRenderTarget(I));let Ie=!1;pe.length!==G.cameras.length&&(G.cameras.length=0,Ie=!0);for(let dt=0;dt<pe.length;dt++){const De=pe[dt];let ge=null;if(x!==null)ge=x.getViewport(De);else{const Ge=g.getViewSubImage(v,De);ge=Ge.viewport,dt===0&&(e.setRenderTargetTextures(I,Ge.colorTexture,Ge.depthStencilTexture),e.setRenderTarget(I))}let ye=H[dt];ye===void 0&&(ye=new ps,ye.layers.enable(dt),ye.viewport=new $n,H[dt]=ye),ye.matrix.fromArray(De.transform.matrix),ye.matrix.decompose(ye.position,ye.quaternion,ye.scale),ye.projectionMatrix.fromArray(De.projectionMatrix),ye.projectionMatrixInverse.copy(ye.projectionMatrix).invert(),ye.viewport.set(ge.x,ge.y,ge.width,ge.height),dt===0&&(G.matrix.copy(ye.matrix),G.matrix.decompose(G.position,G.quaternion,G.scale)),Ie===!0&&G.cameras.push(ye)}const Ye=s.enabledFeatures;if(Ye&&Ye.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&w){g=n.getBinding();const dt=g.getDepthInformation(pe[0]);dt&&dt.isValid&&dt.texture&&M.init(dt,s.renderState)}if(Ye&&Ye.includes("camera-access")&&w){e.state.unbindTexture(),g=n.getBinding();for(let dt=0;dt<pe.length;dt++){const De=pe[dt].camera;if(De){let ge=S[De];ge||(ge=new XA,S[De]=ge);const ye=g.getCameraImage(De);ge.sourceTexture=ye}}}}for(let pe=0;pe<D.length;pe++){const Ie=O[pe],Ye=D[pe];Ie!==null&&Ye!==void 0&&Ye.update(Ie,ce,f||o)}ae&&ae(se,ce),ce.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:ce}),b=null}const de=new pU;de.setAnimationLoop(fe),this.setAnimationLoop=function(se){ae=se},this.dispose=function(){}}}const Kf=new uo,a7=new Kt;function o7(i,e){function t(M,S){M.matrixAutoUpdate===!0&&M.updateMatrix(),S.value.copy(M.matrix)}function n(M,S){S.color.getRGB(M.fogColor.value,yP(i)),S.isFog?(M.fogNear.value=S.near,M.fogFar.value=S.far):S.isFogExp2&&(M.fogDensity.value=S.density)}function s(M,S,C,R,I){S.isMeshBasicMaterial||S.isMeshLambertMaterial?r(M,S):S.isMeshToonMaterial?(r(M,S),g(M,S)):S.isMeshPhongMaterial?(r(M,S),p(M,S)):S.isMeshStandardMaterial?(r(M,S),v(M,S),S.isMeshPhysicalMaterial&&x(M,S,I)):S.isMeshMatcapMaterial?(r(M,S),b(M,S)):S.isMeshDepthMaterial?r(M,S):S.isMeshDistanceMaterial?(r(M,S),w(M,S)):S.isMeshNormalMaterial?r(M,S):S.isLineBasicMaterial?(o(M,S),S.isLineDashedMaterial&&l(M,S)):S.isPointsMaterial?u(M,S,C,R):S.isSpriteMaterial?f(M,S):S.isShadowMaterial?(M.color.value.copy(S.color),M.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function r(M,S){M.opacity.value=S.opacity,S.color&&M.diffuse.value.copy(S.color),S.emissive&&M.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(M.map.value=S.map,t(S.map,M.mapTransform)),S.alphaMap&&(M.alphaMap.value=S.alphaMap,t(S.alphaMap,M.alphaMapTransform)),S.bumpMap&&(M.bumpMap.value=S.bumpMap,t(S.bumpMap,M.bumpMapTransform),M.bumpScale.value=S.bumpScale,S.side===Lr&&(M.bumpScale.value*=-1)),S.normalMap&&(M.normalMap.value=S.normalMap,t(S.normalMap,M.normalMapTransform),M.normalScale.value.copy(S.normalScale),S.side===Lr&&M.normalScale.value.negate()),S.displacementMap&&(M.displacementMap.value=S.displacementMap,t(S.displacementMap,M.displacementMapTransform),M.displacementScale.value=S.displacementScale,M.displacementBias.value=S.displacementBias),S.emissiveMap&&(M.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,M.emissiveMapTransform)),S.specularMap&&(M.specularMap.value=S.specularMap,t(S.specularMap,M.specularMapTransform)),S.alphaTest>0&&(M.alphaTest.value=S.alphaTest);const C=e.get(S),R=C.envMap,I=C.envMapRotation;R&&(M.envMap.value=R,Kf.copy(I),Kf.x*=-1,Kf.y*=-1,Kf.z*=-1,R.isCubeTexture&&R.isRenderTargetTexture===!1&&(Kf.y*=-1,Kf.z*=-1),M.envMapRotation.value.setFromMatrix4(a7.makeRotationFromEuler(Kf)),M.flipEnvMap.value=R.isCubeTexture&&R.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=S.reflectivity,M.ior.value=S.ior,M.refractionRatio.value=S.refractionRatio),S.lightMap&&(M.lightMap.value=S.lightMap,M.lightMapIntensity.value=S.lightMapIntensity,t(S.lightMap,M.lightMapTransform)),S.aoMap&&(M.aoMap.value=S.aoMap,M.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,M.aoMapTransform))}function o(M,S){M.diffuse.value.copy(S.color),M.opacity.value=S.opacity,S.map&&(M.map.value=S.map,t(S.map,M.mapTransform))}function l(M,S){M.dashSize.value=S.dashSize,M.totalSize.value=S.dashSize+S.gapSize,M.scale.value=S.scale}function u(M,S,C,R){M.diffuse.value.copy(S.color),M.opacity.value=S.opacity,M.size.value=S.size*C,M.scale.value=R*.5,S.map&&(M.map.value=S.map,t(S.map,M.uvTransform)),S.alphaMap&&(M.alphaMap.value=S.alphaMap,t(S.alphaMap,M.alphaMapTransform)),S.alphaTest>0&&(M.alphaTest.value=S.alphaTest)}function f(M,S){M.diffuse.value.copy(S.color),M.opacity.value=S.opacity,M.rotation.value=S.rotation,S.map&&(M.map.value=S.map,t(S.map,M.mapTransform)),S.alphaMap&&(M.alphaMap.value=S.alphaMap,t(S.alphaMap,M.alphaMapTransform)),S.alphaTest>0&&(M.alphaTest.value=S.alphaTest)}function p(M,S){M.specular.value.copy(S.specular),M.shininess.value=Math.max(S.shininess,1e-4)}function g(M,S){S.gradientMap&&(M.gradientMap.value=S.gradientMap)}function v(M,S){M.metalness.value=S.metalness,S.metalnessMap&&(M.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,M.metalnessMapTransform)),M.roughness.value=S.roughness,S.roughnessMap&&(M.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,M.roughnessMapTransform)),S.envMap&&(M.envMapIntensity.value=S.envMapIntensity)}function x(M,S,C){M.ior.value=S.ior,S.sheen>0&&(M.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),M.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(M.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,M.sheenColorMapTransform)),S.sheenRoughnessMap&&(M.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,M.sheenRoughnessMapTransform))),S.clearcoat>0&&(M.clearcoat.value=S.clearcoat,M.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(M.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,M.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(M.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===Lr&&M.clearcoatNormalScale.value.negate())),S.dispersion>0&&(M.dispersion.value=S.dispersion),S.iridescence>0&&(M.iridescence.value=S.iridescence,M.iridescenceIOR.value=S.iridescenceIOR,M.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(M.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,M.iridescenceMapTransform)),S.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),S.transmission>0&&(M.transmission.value=S.transmission,M.transmissionSamplerMap.value=C.texture,M.transmissionSamplerSize.value.set(C.width,C.height),S.transmissionMap&&(M.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,M.transmissionMapTransform)),M.thickness.value=S.thickness,S.thicknessMap&&(M.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=S.attenuationDistance,M.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(M.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(M.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=S.specularIntensity,M.specularColor.value.copy(S.specularColor),S.specularColorMap&&(M.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,M.specularColorMapTransform)),S.specularIntensityMap&&(M.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,M.specularIntensityMapTransform))}function b(M,S){S.matcap&&(M.matcap.value=S.matcap)}function w(M,S){const C=e.get(S).light;M.referencePosition.value.setFromMatrixPosition(C.matrixWorld),M.nearDistance.value=C.shadow.camera.near,M.farDistance.value=C.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function l7(i,e,t,n){let s={},r={},o=[];const l=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function u(C,R){const I=R.program;n.uniformBlockBinding(C,I)}function f(C,R){let I=s[C.id];I===void 0&&(b(C),I=p(C),s[C.id]=I,C.addEventListener("dispose",M));const D=R.program;n.updateUBOMapping(C,D);const O=e.render.frame;r[C.id]!==O&&(v(C),r[C.id]=O)}function p(C){const R=g();C.__bindingPointIndex=R;const I=i.createBuffer(),D=C.__size,O=C.usage;return i.bindBuffer(i.UNIFORM_BUFFER,I),i.bufferData(i.UNIFORM_BUFFER,D,O),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,R,I),I}function g(){for(let C=0;C<l;C++)if(o.indexOf(C)===-1)return o.push(C),C;return kt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function v(C){const R=s[C.id],I=C.uniforms,D=C.__cache;i.bindBuffer(i.UNIFORM_BUFFER,R);for(let O=0,U=I.length;O<U;O++){const k=Array.isArray(I[O])?I[O]:[I[O]];for(let P=0,F=k.length;P<F;P++){const H=k[P];if(x(H,O,P,D)===!0){const G=H.__offset,j=Array.isArray(H.value)?H.value:[H.value];let K=0;for(let te=0;te<j.length;te++){const W=j[te],X=w(W);typeof W=="number"||typeof W=="boolean"?(H.__data[0]=W,i.bufferSubData(i.UNIFORM_BUFFER,G+K,H.__data)):W.isMatrix3?(H.__data[0]=W.elements[0],H.__data[1]=W.elements[1],H.__data[2]=W.elements[2],H.__data[3]=0,H.__data[4]=W.elements[3],H.__data[5]=W.elements[4],H.__data[6]=W.elements[5],H.__data[7]=0,H.__data[8]=W.elements[6],H.__data[9]=W.elements[7],H.__data[10]=W.elements[8],H.__data[11]=0):(W.toArray(H.__data,K),K+=X.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,G,H.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function x(C,R,I,D){const O=C.value,U=R+"_"+I;if(D[U]===void 0)return typeof O=="number"||typeof O=="boolean"?D[U]=O:D[U]=O.clone(),!0;{const k=D[U];if(typeof O=="number"||typeof O=="boolean"){if(k!==O)return D[U]=O,!0}else if(k.equals(O)===!1)return k.copy(O),!0}return!1}function b(C){const R=C.uniforms;let I=0;const D=16;for(let U=0,k=R.length;U<k;U++){const P=Array.isArray(R[U])?R[U]:[R[U]];for(let F=0,H=P.length;F<H;F++){const G=P[F],j=Array.isArray(G.value)?G.value:[G.value];for(let K=0,te=j.length;K<te;K++){const W=j[K],X=w(W),oe=I%D,ne=oe%X.boundary,ie=oe+ne;I+=ne,ie!==0&&D-ie<X.storage&&(I+=D-ie),G.__data=new Float32Array(X.storage/Float32Array.BYTES_PER_ELEMENT),G.__offset=I,I+=X.storage}}}const O=I%D;return O>0&&(I+=D-O),C.__size=I,C.__cache={},this}function w(C){const R={boundary:0,storage:0};return typeof C=="number"||typeof C=="boolean"?(R.boundary=4,R.storage=4):C.isVector2?(R.boundary=8,R.storage=8):C.isVector3||C.isColor?(R.boundary=16,R.storage=12):C.isVector4?(R.boundary=16,R.storage=16):C.isMatrix3?(R.boundary=48,R.storage=48):C.isMatrix4?(R.boundary=64,R.storage=64):C.isTexture?Tt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Tt("WebGLRenderer: Unsupported uniform value type.",C),R}function M(C){const R=C.target;R.removeEventListener("dispose",M);const I=o.indexOf(R.__bindingPointIndex);o.splice(I,1),i.deleteBuffer(s[R.id]),delete s[R.id],delete r[R.id]}function S(){for(const C in s)i.deleteBuffer(s[C]);o=[],s={},r={}}return{bind:u,update:f,dispose:S}}const c7=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let gc=null;function u7(){return gc===null&&(gc=new Al(c7,16,16,bd,El),gc.name="DFG_LUT",gc.minFilter=ti,gc.magFilter=ti,gc.wrapS=Ga,gc.wrapT=Ga,gc.generateMipmaps=!1,gc.needsUpdate=!0),gc}class xU{constructor(e={}){const{canvas:t=mP(),context:n=null,depth:s=!0,stencil:r=!1,alpha:o=!1,antialias:l=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:f=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:g=!1,reversedDepthBuffer:v=!1,outputBufferType:x=ra}=e;this.isWebGLRenderer=!0;let b;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");b=n.getContextAttributes().alpha}else b=o;const w=x,M=new Set([P1,O1,Hv]),S=new Set([ra,Ko,Cm,Rm,D1,N1]),C=new Uint32Array(4),R=new Int32Array(4);let I=null,D=null;const O=[],U=[];let k=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Xo,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const P=this;let F=!1;this._outputColorSpace=Ir;let H=0,G=0,j=null,K=-1,te=null;const W=new $n,X=new $n;let oe=null;const ne=new St(0);let ie=0,B=t.width,Q=t.height,ae=1,fe=null,de=null;const se=new $n(0,0,B,Q),ce=new $n(0,0,B,Q);let pe=!1;const Ie=new Xm;let Ye=!1,et=!1;const qe=new Kt,dt=new re,De=new $n,ge={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ye=!1;function Ge(){return j===null?ae:1}let Y=n;function Be(J,Se){return t.getContext(J,Se)}try{const J={alpha:!0,depth:s,stencil:r,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:f,powerPreference:p,failIfMajorPerformanceCaveat:g};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Vv}`),t.addEventListener("webglcontextlost",xt,!1),t.addEventListener("webglcontextrestored",_t,!1),t.addEventListener("webglcontextcreationerror",Nt,!1),Y===null){const Se="webgl2";if(Y=Be(Se,J),Y===null)throw Be(Se)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(J){throw kt("WebGLRenderer: "+J.message),J}let Ne,Me,Oe,q,V,ue,Re,we,be,it,tt,ht,yt,He,Xe,Qe,le,Te,ct,he,We,Je,pt,$e;function Le(){Ne=new h9(Y),Ne.init(),Je=new _U(Y,Ne),Me=new n9(Y,Ne,e,Je),Oe=new e7(Y,Ne),Me.reversedDepthBuffer&&v&&Oe.buffers.depth.setReversed(!0),q=new p9(Y),V=new BW,ue=new t7(Y,Ne,Oe,V,Me,Je,q),Re=new s9(P),we=new u9(P),be=new y8(Y),pt=new e9(Y,be),it=new f9(Y,be,q,pt),tt=new g9(Y,it,be,q),ct=new m9(Y,Me,ue),Qe=new i9(V),ht=new kW(P,Re,we,Ne,Me,pt,Qe),yt=new o7(P,V),He=new VW,Xe=new XW(Ne),Te=new $H(P,Re,we,Oe,tt,b,u),le=new JW(P,tt,Me),$e=new l7(Y,q,Me,Oe),he=new t9(Y,Ne,q),We=new d9(Y,Ne,q),q.programs=ht.programs,P.capabilities=Me,P.extensions=Ne,P.properties=V,P.renderLists=He,P.shadowMap=le,P.state=Oe,P.info=q}Le(),w!==ra&&(k=new y9(w,t.width,t.height,s,r));const rt=new r7(P,Y);this.xr=rt,this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.forceContextLoss=function(){const J=Ne.get("WEBGL_lose_context");J&&J.loseContext()},this.forceContextRestore=function(){const J=Ne.get("WEBGL_lose_context");J&&J.restoreContext()},this.getPixelRatio=function(){return ae},this.setPixelRatio=function(J){J!==void 0&&(ae=J,this.setSize(B,Q,!1))},this.getSize=function(J){return J.set(B,Q)},this.setSize=function(J,Se,ze=!0){if(rt.isPresenting){Tt("WebGLRenderer: Can't change size while VR device is presenting.");return}B=J,Q=Se,t.width=Math.floor(J*ae),t.height=Math.floor(Se*ae),ze===!0&&(t.style.width=J+"px",t.style.height=Se+"px"),k!==null&&k.setSize(t.width,t.height),this.setViewport(0,0,J,Se)},this.getDrawingBufferSize=function(J){return J.set(B*ae,Q*ae).floor()},this.setDrawingBufferSize=function(J,Se,ze){B=J,Q=Se,ae=ze,t.width=Math.floor(J*ze),t.height=Math.floor(Se*ze),this.setViewport(0,0,J,Se)},this.setEffects=function(J){if(w===ra){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(J){for(let Se=0;Se<J.length;Se++)if(J[Se].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}k.setEffects(J||[])},this.getCurrentViewport=function(J){return J.copy(W)},this.getViewport=function(J){return J.copy(se)},this.setViewport=function(J,Se,ze,Pe){J.isVector4?se.set(J.x,J.y,J.z,J.w):se.set(J,Se,ze,Pe),Oe.viewport(W.copy(se).multiplyScalar(ae).round())},this.getScissor=function(J){return J.copy(ce)},this.setScissor=function(J,Se,ze,Pe){J.isVector4?ce.set(J.x,J.y,J.z,J.w):ce.set(J,Se,ze,Pe),Oe.scissor(X.copy(ce).multiplyScalar(ae).round())},this.getScissorTest=function(){return pe},this.setScissorTest=function(J){Oe.setScissorTest(pe=J)},this.setOpaqueSort=function(J){fe=J},this.setTransparentSort=function(J){de=J},this.getClearColor=function(J){return J.copy(Te.getClearColor())},this.setClearColor=function(){Te.setClearColor(...arguments)},this.getClearAlpha=function(){return Te.getClearAlpha()},this.setClearAlpha=function(){Te.setClearAlpha(...arguments)},this.clear=function(J=!0,Se=!0,ze=!0){let Pe=0;if(J){let Ae=!1;if(j!==null){const mt=j.texture.format;Ae=M.has(mt)}if(Ae){const mt=j.texture.type,Mt=S.has(mt),ut=Te.getClearColor(),Et=Te.getClearAlpha(),Ct=ut.r,Ft=ut.g,Rt=ut.b;Mt?(C[0]=Ct,C[1]=Ft,C[2]=Rt,C[3]=Et,Y.clearBufferuiv(Y.COLOR,0,C)):(R[0]=Ct,R[1]=Ft,R[2]=Rt,R[3]=Et,Y.clearBufferiv(Y.COLOR,0,R))}else Pe|=Y.COLOR_BUFFER_BIT}Se&&(Pe|=Y.DEPTH_BUFFER_BIT),ze&&(Pe|=Y.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Y.clear(Pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",xt,!1),t.removeEventListener("webglcontextrestored",_t,!1),t.removeEventListener("webglcontextcreationerror",Nt,!1),Te.dispose(),He.dispose(),Xe.dispose(),V.dispose(),Re.dispose(),we.dispose(),tt.dispose(),pt.dispose(),$e.dispose(),ht.dispose(),rt.dispose(),rt.removeEventListener("sessionstart",_s),rt.removeEventListener("sessionend",nr),ni.stop()};function xt(J){J.preventDefault(),Mv("WebGLRenderer: Context Lost."),F=!0}function _t(){Mv("WebGLRenderer: Context Restored."),F=!1;const J=q.autoReset,Se=le.enabled,ze=le.autoUpdate,Pe=le.needsUpdate,Ae=le.type;Le(),q.autoReset=J,le.enabled=Se,le.autoUpdate=ze,le.needsUpdate=Pe,le.type=Ae}function Nt(J){kt("WebGLRenderer: A WebGL context could not be created. Reason: ",J.statusMessage)}function pn(J){const Se=J.target;Se.removeEventListener("dispose",pn),Mn(Se)}function Mn(J){Zn(J),V.remove(J)}function Zn(J){const Se=V.get(J).programs;Se!==void 0&&(Se.forEach(function(ze){ht.releaseProgram(ze)}),J.isShaderMaterial&&ht.releaseShaderCache(J))}this.renderBufferDirect=function(J,Se,ze,Pe,Ae,mt){Se===null&&(Se=ge);const Mt=Ae.isMesh&&Ae.matrixWorld.determinant()<0,ut=Vr(J,Se,ze,Pe,Ae);Oe.setMaterial(Pe,Mt);let Et=ze.index,Ct=1;if(Pe.wireframe===!0){if(Et=it.getWireframeAttribute(ze),Et===void 0)return;Ct=2}const Ft=ze.drawRange,Rt=ze.attributes.position;let Bt=Ft.start*Ct,mn=(Ft.start+Ft.count)*Ct;mt!==null&&(Bt=Math.max(Bt,mt.start*Ct),mn=Math.min(mn,(mt.start+mt.count)*Ct)),Et!==null?(Bt=Math.max(Bt,0),mn=Math.min(mn,Et.count)):Rt!=null&&(Bt=Math.max(Bt,0),mn=Math.min(mn,Rt.count));const Vn=mn-Bt;if(Vn<0||Vn===1/0)return;pt.setup(Ae,Pe,ut,ze,Et);let Cn,Xt=he;if(Et!==null&&(Cn=be.get(Et),Xt=We,Xt.setIndex(Cn)),Ae.isMesh)Pe.wireframe===!0?(Oe.setLineWidth(Pe.wireframeLinewidth*Ge()),Xt.setMode(Y.LINES)):Xt.setMode(Y.TRIANGLES);else if(Ae.isLine){let bt=Pe.linewidth;bt===void 0&&(bt=1),Oe.setLineWidth(bt*Ge()),Ae.isLineSegments?Xt.setMode(Y.LINES):Ae.isLineLoop?Xt.setMode(Y.LINE_LOOP):Xt.setMode(Y.LINE_STRIP)}else Ae.isPoints?Xt.setMode(Y.POINTS):Ae.isSprite&&Xt.setMode(Y.TRIANGLES);if(Ae.isBatchedMesh)if(Ae._multiDrawInstances!==null)Nm("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Xt.renderMultiDrawInstances(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount,Ae._multiDrawInstances);else if(Ne.get("WEBGL_multi_draw"))Xt.renderMultiDraw(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount);else{const bt=Ae._multiDrawStarts,vn=Ae._multiDrawCounts,Pt=Ae._multiDrawCount,Ii=Et?be.get(Et).bytesPerElement:1,Ws=V.get(Pe).currentProgram.getUniforms();for(let kn=0;kn<Pt;kn++)Ws.setValue(Y,"_gl_DrawID",kn),Xt.render(bt[kn]/Ii,vn[kn])}else if(Ae.isInstancedMesh)Xt.renderInstances(Bt,Vn,Ae.count);else if(ze.isInstancedBufferGeometry){const bt=ze._maxInstanceCount!==void 0?ze._maxInstanceCount:1/0,vn=Math.min(ze.instanceCount,bt);Xt.renderInstances(Bt,Vn,vn)}else Xt.render(Bt,Vn)};function Ji(J,Se,ze){J.transparent===!0&&J.side===sa&&J.forceSinglePass===!1?(J.side=Lr,J.needsUpdate=!0,Hs(J,Se,ze),J.side=Eu,J.needsUpdate=!0,Hs(J,Se,ze),J.side=sa):Hs(J,Se,ze)}this.compile=function(J,Se,ze=null){ze===null&&(ze=J),D=Xe.get(ze),D.init(Se),U.push(D),ze.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(Se.layers)&&(D.pushLight(Ae),Ae.castShadow&&D.pushShadow(Ae))}),J!==ze&&J.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(Se.layers)&&(D.pushLight(Ae),Ae.castShadow&&D.pushShadow(Ae))}),D.setupLights();const Pe=new Set;return J.traverse(function(Ae){if(!(Ae.isMesh||Ae.isPoints||Ae.isLine||Ae.isSprite))return;const mt=Ae.material;if(mt)if(Array.isArray(mt))for(let Mt=0;Mt<mt.length;Mt++){const ut=mt[Mt];Ji(ut,ze,Ae),Pe.add(ut)}else Ji(mt,ze,Ae),Pe.add(mt)}),D=U.pop(),Pe},this.compileAsync=function(J,Se,ze=null){const Pe=this.compile(J,Se,ze);return new Promise(Ae=>{function mt(){if(Pe.forEach(function(Mt){V.get(Mt).currentProgram.isReady()&&Pe.delete(Mt)}),Pe.size===0){Ae(J);return}setTimeout(mt,10)}Ne.get("KHR_parallel_shader_compile")!==null?mt():setTimeout(mt,10)})};let Gs=null;function ys(J){Gs&&Gs(J)}function _s(){ni.stop()}function nr(){ni.start()}const ni=new pU;ni.setAnimationLoop(ys),typeof self<"u"&&ni.setContext(self),this.setAnimationLoop=function(J){Gs=J,rt.setAnimationLoop(J),J===null?ni.stop():ni.start()},rt.addEventListener("sessionstart",_s),rt.addEventListener("sessionend",nr),this.render=function(J,Se){if(Se!==void 0&&Se.isCamera!==!0){kt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(F===!0)return;const ze=rt.enabled===!0&&rt.isPresenting===!0,Pe=k!==null&&(j===null||ze)&&k.begin(P,j);if(J.matrixWorldAutoUpdate===!0&&J.updateMatrixWorld(),Se.parent===null&&Se.matrixWorldAutoUpdate===!0&&Se.updateMatrixWorld(),rt.enabled===!0&&rt.isPresenting===!0&&(k===null||k.isCompositing()===!1)&&(rt.cameraAutoUpdate===!0&&rt.updateCamera(Se),Se=rt.getCamera()),J.isScene===!0&&J.onBeforeRender(P,J,Se,j),D=Xe.get(J,U.length),D.init(Se),U.push(D),qe.multiplyMatrices(Se.projectionMatrix,Se.matrixWorldInverse),Ie.setFromProjectionMatrix(qe,ao,Se.reversedDepth),et=this.localClippingEnabled,Ye=Qe.init(this.clippingPlanes,et),I=He.get(J,O.length),I.init(),O.push(I),rt.enabled===!0&&rt.isPresenting===!0){const Mt=P.xr.getDepthSensingMesh();Mt!==null&&jn(Mt,Se,-1/0,P.sortObjects)}jn(J,Se,0,P.sortObjects),I.finish(),P.sortObjects===!0&&I.sort(fe,de),ye=rt.enabled===!1||rt.isPresenting===!1||rt.hasDepthSensing()===!1,ye&&Te.addToRenderList(I,J),this.info.render.frame++,Ye===!0&&Qe.beginShadows();const Ae=D.state.shadowsArray;if(le.render(Ae,J,Se),Ye===!0&&Qe.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Pe&&k.hasRenderPass())===!1){const Mt=I.opaque,ut=I.transmissive;if(D.setupLights(),Se.isArrayCamera){const Et=Se.cameras;if(ut.length>0)for(let Ct=0,Ft=Et.length;Ct<Ft;Ct++){const Rt=Et[Ct];Ni(Mt,ut,J,Rt)}ye&&Te.render(J);for(let Ct=0,Ft=Et.length;Ct<Ft;Ct++){const Rt=Et[Ct];Fn(I,J,Rt,Rt.viewport)}}else ut.length>0&&Ni(Mt,ut,J,Se),ye&&Te.render(J),Fn(I,J,Se)}j!==null&&G===0&&(ue.updateMultisampleRenderTarget(j),ue.updateRenderTargetMipmap(j)),Pe&&k.end(P),J.isScene===!0&&J.onAfterRender(P,J,Se),pt.resetDefaultState(),K=-1,te=null,U.pop(),U.length>0?(D=U[U.length-1],Ye===!0&&Qe.setGlobalState(P.clippingPlanes,D.state.camera)):D=null,O.pop(),O.length>0?I=O[O.length-1]:I=null};function jn(J,Se,ze,Pe){if(J.visible===!1)return;if(J.layers.test(Se.layers)){if(J.isGroup)ze=J.renderOrder;else if(J.isLOD)J.autoUpdate===!0&&J.update(Se);else if(J.isLight)D.pushLight(J),J.castShadow&&D.pushShadow(J);else if(J.isSprite){if(!J.frustumCulled||Ie.intersectsSprite(J)){Pe&&De.setFromMatrixPosition(J.matrixWorld).applyMatrix4(qe);const Mt=tt.update(J),ut=J.material;ut.visible&&I.push(J,Mt,ut,ze,De.z,null)}}else if((J.isMesh||J.isLine||J.isPoints)&&(!J.frustumCulled||Ie.intersectsObject(J))){const Mt=tt.update(J),ut=J.material;if(Pe&&(J.boundingSphere!==void 0?(J.boundingSphere===null&&J.computeBoundingSphere(),De.copy(J.boundingSphere.center)):(Mt.boundingSphere===null&&Mt.computeBoundingSphere(),De.copy(Mt.boundingSphere.center)),De.applyMatrix4(J.matrixWorld).applyMatrix4(qe)),Array.isArray(ut)){const Et=Mt.groups;for(let Ct=0,Ft=Et.length;Ct<Ft;Ct++){const Rt=Et[Ct],Bt=ut[Rt.materialIndex];Bt&&Bt.visible&&I.push(J,Mt,Bt,ze,De.z,Rt)}}else ut.visible&&I.push(J,Mt,ut,ze,De.z,null)}}const mt=J.children;for(let Mt=0,ut=mt.length;Mt<ut;Mt++)jn(mt[Mt],Se,ze,Pe)}function Fn(J,Se,ze,Pe){const{opaque:Ae,transmissive:mt,transparent:Mt}=J;D.setupLightsView(ze),Ye===!0&&Qe.setGlobalState(P.clippingPlanes,ze),Pe&&Oe.viewport(W.copy(Pe)),Ae.length>0&&Ns(Ae,Se,ze),mt.length>0&&Ns(mt,Se,ze),Mt.length>0&&Ns(Mt,Se,ze),Oe.buffers.depth.setTest(!0),Oe.buffers.depth.setMask(!0),Oe.buffers.color.setMask(!0),Oe.setPolygonOffset(!1)}function Ni(J,Se,ze,Pe){if((ze.isScene===!0?ze.overrideMaterial:null)!==null)return;if(D.state.transmissionRenderTarget[Pe.id]===void 0){const Bt=Ne.has("EXT_color_buffer_half_float")||Ne.has("EXT_color_buffer_float");D.state.transmissionRenderTarget[Pe.id]=new Ha(1,1,{generateMipmaps:!0,type:Bt?El:ra,minFilter:vc,samples:Me.samples,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:On.workingColorSpace})}const mt=D.state.transmissionRenderTarget[Pe.id],Mt=Pe.viewport||W;mt.setSize(Mt.z*P.transmissionResolutionScale,Mt.w*P.transmissionResolutionScale);const ut=P.getRenderTarget(),Et=P.getActiveCubeFace(),Ct=P.getActiveMipmapLevel();P.setRenderTarget(mt),P.getClearColor(ne),ie=P.getClearAlpha(),ie<1&&P.setClearColor(16777215,.5),P.clear(),ye&&Te.render(ze);const Ft=P.toneMapping;P.toneMapping=Xo;const Rt=Pe.viewport;if(Pe.viewport!==void 0&&(Pe.viewport=void 0),D.setupLightsView(Pe),Ye===!0&&Qe.setGlobalState(P.clippingPlanes,Pe),Ns(J,ze,Pe),ue.updateMultisampleRenderTarget(mt),ue.updateRenderTargetMipmap(mt),Ne.has("WEBGL_multisampled_render_to_texture")===!1){let Bt=!1;for(let mn=0,Vn=Se.length;mn<Vn;mn++){const Cn=Se[mn],{object:Xt,geometry:bt,material:vn,group:Pt}=Cn;if(vn.side===sa&&Xt.layers.test(Pe.layers)){const Ii=vn.side;vn.side=Lr,vn.needsUpdate=!0,ir(Xt,ze,Pe,bt,vn,Pt),vn.side=Ii,vn.needsUpdate=!0,Bt=!0}}Bt===!0&&(ue.updateMultisampleRenderTarget(mt),ue.updateRenderTargetMipmap(mt))}P.setRenderTarget(ut,Et,Ct),P.setClearColor(ne,ie),Rt!==void 0&&(Pe.viewport=Rt),P.toneMapping=Ft}function Ns(J,Se,ze){const Pe=Se.isScene===!0?Se.overrideMaterial:null;for(let Ae=0,mt=J.length;Ae<mt;Ae++){const Mt=J[Ae],{object:ut,geometry:Et,group:Ct}=Mt;let Ft=Mt.material;Ft.allowOverride===!0&&Pe!==null&&(Ft=Pe),ut.layers.test(ze.layers)&&ir(ut,Se,ze,Et,Ft,Ct)}}function ir(J,Se,ze,Pe,Ae,mt){J.onBeforeRender(P,Se,ze,Pe,Ae,mt),J.modelViewMatrix.multiplyMatrices(ze.matrixWorldInverse,J.matrixWorld),J.normalMatrix.getNormalMatrix(J.modelViewMatrix),Ae.onBeforeRender(P,Se,ze,Pe,J,mt),Ae.transparent===!0&&Ae.side===sa&&Ae.forceSinglePass===!1?(Ae.side=Lr,Ae.needsUpdate=!0,P.renderBufferDirect(ze,Se,Pe,Ae,J,mt),Ae.side=Eu,Ae.needsUpdate=!0,P.renderBufferDirect(ze,Se,Pe,Ae,J,mt),Ae.side=sa):P.renderBufferDirect(ze,Se,Pe,Ae,J,mt),J.onAfterRender(P,Se,ze,Pe,Ae,mt)}function Hs(J,Se,ze){Se.isScene!==!0&&(Se=ge);const Pe=V.get(J),Ae=D.state.lights,mt=D.state.shadowsArray,Mt=Ae.state.version,ut=ht.getParameters(J,Ae.state,mt,Se,ze),Et=ht.getProgramCacheKey(ut);let Ct=Pe.programs;Pe.environment=J.isMeshStandardMaterial?Se.environment:null,Pe.fog=Se.fog,Pe.envMap=(J.isMeshStandardMaterial?we:Re).get(J.envMap||Pe.environment),Pe.envMapRotation=Pe.environment!==null&&J.envMap===null?Se.environmentRotation:J.envMapRotation,Ct===void 0&&(J.addEventListener("dispose",pn),Ct=new Map,Pe.programs=Ct);let Ft=Ct.get(Et);if(Ft!==void 0){if(Pe.currentProgram===Ft&&Pe.lightsStateVersion===Mt)return Xa(J,ut),Ft}else ut.uniforms=ht.getUniforms(J),J.onBeforeCompile(ut,P),Ft=ht.acquireProgram(ut,Et),Ct.set(Et,Ft),Pe.uniforms=ut.uniforms;const Rt=Pe.uniforms;return(!J.isShaderMaterial&&!J.isRawShaderMaterial||J.clipping===!0)&&(Rt.clippingPlanes=Qe.uniform),Xa(J,ut),Pe.needsLights=vr(J),Pe.lightsStateVersion=Mt,Pe.needsLights&&(Rt.ambientLightColor.value=Ae.state.ambient,Rt.lightProbe.value=Ae.state.probe,Rt.directionalLights.value=Ae.state.directional,Rt.directionalLightShadows.value=Ae.state.directionalShadow,Rt.spotLights.value=Ae.state.spot,Rt.spotLightShadows.value=Ae.state.spotShadow,Rt.rectAreaLights.value=Ae.state.rectArea,Rt.ltc_1.value=Ae.state.rectAreaLTC1,Rt.ltc_2.value=Ae.state.rectAreaLTC2,Rt.pointLights.value=Ae.state.point,Rt.pointLightShadows.value=Ae.state.pointShadow,Rt.hemisphereLights.value=Ae.state.hemi,Rt.directionalShadowMap.value=Ae.state.directionalShadowMap,Rt.directionalShadowMatrix.value=Ae.state.directionalShadowMatrix,Rt.spotShadowMap.value=Ae.state.spotShadowMap,Rt.spotLightMatrix.value=Ae.state.spotLightMatrix,Rt.spotLightMap.value=Ae.state.spotLightMap,Rt.pointShadowMap.value=Ae.state.pointShadowMap,Rt.pointShadowMatrix.value=Ae.state.pointShadowMatrix),Pe.currentProgram=Ft,Pe.uniformsList=null,Ft}function zr(J){if(J.uniformsList===null){const Se=J.currentProgram.getUniforms();J.uniformsList=Qx.seqWithValue(Se.seq,J.uniforms)}return J.uniformsList}function Xa(J,Se){const ze=V.get(J);ze.outputColorSpace=Se.outputColorSpace,ze.batching=Se.batching,ze.batchingColor=Se.batchingColor,ze.instancing=Se.instancing,ze.instancingColor=Se.instancingColor,ze.instancingMorph=Se.instancingMorph,ze.skinning=Se.skinning,ze.morphTargets=Se.morphTargets,ze.morphNormals=Se.morphNormals,ze.morphColors=Se.morphColors,ze.morphTargetsCount=Se.morphTargetsCount,ze.numClippingPlanes=Se.numClippingPlanes,ze.numIntersection=Se.numClipIntersection,ze.vertexAlphas=Se.vertexAlphas,ze.vertexTangents=Se.vertexTangents,ze.toneMapping=Se.toneMapping}function Vr(J,Se,ze,Pe,Ae){Se.isScene!==!0&&(Se=ge),ue.resetTextureUnits();const mt=Se.fog,Mt=Pe.isMeshStandardMaterial?Se.environment:null,ut=j===null?P.outputColorSpace:j.isXRRenderTarget===!0?j.texture.colorSpace:Gh,Et=(Pe.isMeshStandardMaterial?we:Re).get(Pe.envMap||Mt),Ct=Pe.vertexColors===!0&&!!ze.attributes.color&&ze.attributes.color.itemSize===4,Ft=!!ze.attributes.tangent&&(!!Pe.normalMap||Pe.anisotropy>0),Rt=!!ze.morphAttributes.position,Bt=!!ze.morphAttributes.normal,mn=!!ze.morphAttributes.color;let Vn=Xo;Pe.toneMapped&&(j===null||j.isXRRenderTarget===!0)&&(Vn=P.toneMapping);const Cn=ze.morphAttributes.position||ze.morphAttributes.normal||ze.morphAttributes.color,Xt=Cn!==void 0?Cn.length:0,bt=V.get(Pe),vn=D.state.lights;if(Ye===!0&&(et===!0||J!==te)){const Bi=J===te&&Pe.id===K;Qe.setState(Pe,J,Bi)}let Pt=!1;Pe.version===bt.__version?(bt.needsLights&&bt.lightsStateVersion!==vn.state.version||bt.outputColorSpace!==ut||Ae.isBatchedMesh&&bt.batching===!1||!Ae.isBatchedMesh&&bt.batching===!0||Ae.isBatchedMesh&&bt.batchingColor===!0&&Ae.colorTexture===null||Ae.isBatchedMesh&&bt.batchingColor===!1&&Ae.colorTexture!==null||Ae.isInstancedMesh&&bt.instancing===!1||!Ae.isInstancedMesh&&bt.instancing===!0||Ae.isSkinnedMesh&&bt.skinning===!1||!Ae.isSkinnedMesh&&bt.skinning===!0||Ae.isInstancedMesh&&bt.instancingColor===!0&&Ae.instanceColor===null||Ae.isInstancedMesh&&bt.instancingColor===!1&&Ae.instanceColor!==null||Ae.isInstancedMesh&&bt.instancingMorph===!0&&Ae.morphTexture===null||Ae.isInstancedMesh&&bt.instancingMorph===!1&&Ae.morphTexture!==null||bt.envMap!==Et||Pe.fog===!0&&bt.fog!==mt||bt.numClippingPlanes!==void 0&&(bt.numClippingPlanes!==Qe.numPlanes||bt.numIntersection!==Qe.numIntersection)||bt.vertexAlphas!==Ct||bt.vertexTangents!==Ft||bt.morphTargets!==Rt||bt.morphNormals!==Bt||bt.morphColors!==mn||bt.toneMapping!==Vn||bt.morphTargetsCount!==Xt)&&(Pt=!0):(Pt=!0,bt.__version=Pe.version);let Ii=bt.currentProgram;Pt===!0&&(Ii=Hs(Pe,Se,Ae));let Ws=!1,kn=!1,xs=!1;const Tn=Ii.getUniforms(),mi=bt.uniforms;if(Oe.useProgram(Ii.program)&&(Ws=!0,kn=!0,xs=!0),Pe.id!==K&&(K=Pe.id,kn=!0),Ws||te!==J){Oe.buffers.depth.getReversed()&&J.reversedDepth!==!0&&(J._reversedDepth=!0,J.updateProjectionMatrix()),Tn.setValue(Y,"projectionMatrix",J.projectionMatrix),Tn.setValue(Y,"viewMatrix",J.matrixWorldInverse);const zi=Tn.map.cameraPosition;zi!==void 0&&zi.setValue(Y,dt.setFromMatrixPosition(J.matrixWorld)),Me.logarithmicDepthBuffer&&Tn.setValue(Y,"logDepthBufFC",2/(Math.log(J.far+1)/Math.LN2)),(Pe.isMeshPhongMaterial||Pe.isMeshToonMaterial||Pe.isMeshLambertMaterial||Pe.isMeshBasicMaterial||Pe.isMeshStandardMaterial||Pe.isShaderMaterial)&&Tn.setValue(Y,"isOrthographic",J.isOrthographicCamera===!0),te!==J&&(te=J,kn=!0,xs=!0)}if(bt.needsLights&&(vn.state.directionalShadowMap.length>0&&Tn.setValue(Y,"directionalShadowMap",vn.state.directionalShadowMap,ue),vn.state.spotShadowMap.length>0&&Tn.setValue(Y,"spotShadowMap",vn.state.spotShadowMap,ue),vn.state.pointShadowMap.length>0&&Tn.setValue(Y,"pointShadowMap",vn.state.pointShadowMap,ue)),Ae.isSkinnedMesh){Tn.setOptional(Y,Ae,"bindMatrix"),Tn.setOptional(Y,Ae,"bindMatrixInverse");const Bi=Ae.skeleton;Bi&&(Bi.boneTexture===null&&Bi.computeBoneTexture(),Tn.setValue(Y,"boneTexture",Bi.boneTexture,ue))}Ae.isBatchedMesh&&(Tn.setOptional(Y,Ae,"batchingTexture"),Tn.setValue(Y,"batchingTexture",Ae._matricesTexture,ue),Tn.setOptional(Y,Ae,"batchingIdTexture"),Tn.setValue(Y,"batchingIdTexture",Ae._indirectTexture,ue),Tn.setOptional(Y,Ae,"batchingColorTexture"),Ae._colorsTexture!==null&&Tn.setValue(Y,"batchingColorTexture",Ae._colorsTexture,ue));const gi=ze.morphAttributes;if((gi.position!==void 0||gi.normal!==void 0||gi.color!==void 0)&&ct.update(Ae,ze,Ii),(kn||bt.receiveShadow!==Ae.receiveShadow)&&(bt.receiveShadow=Ae.receiveShadow,Tn.setValue(Y,"receiveShadow",Ae.receiveShadow)),Pe.isMeshGouraudMaterial&&Pe.envMap!==null&&(mi.envMap.value=Et,mi.flipEnvMap.value=Et.isCubeTexture&&Et.isRenderTargetTexture===!1?-1:1),Pe.isMeshStandardMaterial&&Pe.envMap===null&&Se.environment!==null&&(mi.envMapIntensity.value=Se.environmentIntensity),mi.dfgLUT!==void 0&&(mi.dfgLUT.value=u7()),kn&&(Tn.setValue(Y,"toneMappingExposure",P.toneMappingExposure),bt.needsLights&&fa(mi,xs),mt&&Pe.fog===!0&&yt.refreshFogUniforms(mi,mt),yt.refreshMaterialUniforms(mi,Pe,ae,Q,D.state.transmissionRenderTarget[J.id]),Qx.upload(Y,zr(bt),mi,ue)),Pe.isShaderMaterial&&Pe.uniformsNeedUpdate===!0&&(Qx.upload(Y,zr(bt),mi,ue),Pe.uniformsNeedUpdate=!1),Pe.isSpriteMaterial&&Tn.setValue(Y,"center",Ae.center),Tn.setValue(Y,"modelViewMatrix",Ae.modelViewMatrix),Tn.setValue(Y,"normalMatrix",Ae.normalMatrix),Tn.setValue(Y,"modelMatrix",Ae.matrixWorld),Pe.isShaderMaterial||Pe.isRawShaderMaterial){const Bi=Pe.uniformsGroups;for(let zi=0,Ya=Bi.length;zi<Ya;zi++){const bs=Bi[zi];$e.update(bs,Ii),$e.bind(bs,Ii)}}return Ii}function fa(J,Se){J.ambientLightColor.needsUpdate=Se,J.lightProbe.needsUpdate=Se,J.directionalLights.needsUpdate=Se,J.directionalLightShadows.needsUpdate=Se,J.pointLights.needsUpdate=Se,J.pointLightShadows.needsUpdate=Se,J.spotLights.needsUpdate=Se,J.spotLightShadows.needsUpdate=Se,J.rectAreaLights.needsUpdate=Se,J.hemisphereLights.needsUpdate=Se}function vr(J){return J.isMeshLambertMaterial||J.isMeshToonMaterial||J.isMeshPhongMaterial||J.isMeshStandardMaterial||J.isShadowMaterial||J.isShaderMaterial&&J.lights===!0}this.getActiveCubeFace=function(){return H},this.getActiveMipmapLevel=function(){return G},this.getRenderTarget=function(){return j},this.setRenderTargetTextures=function(J,Se,ze){const Pe=V.get(J);Pe.__autoAllocateDepthBuffer=J.resolveDepthBuffer===!1,Pe.__autoAllocateDepthBuffer===!1&&(Pe.__useRenderToTexture=!1),V.get(J.texture).__webglTexture=Se,V.get(J.depthTexture).__webglTexture=Pe.__autoAllocateDepthBuffer?void 0:ze,Pe.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(J,Se){const ze=V.get(J);ze.__webglFramebuffer=Se,ze.__useDefaultFramebuffer=Se===void 0};const Gr=Y.createFramebuffer();this.setRenderTarget=function(J,Se=0,ze=0){j=J,H=Se,G=ze;let Pe=null,Ae=!1,mt=!1;if(J){const ut=V.get(J);if(ut.__useDefaultFramebuffer!==void 0){Oe.bindFramebuffer(Y.FRAMEBUFFER,ut.__webglFramebuffer),W.copy(J.viewport),X.copy(J.scissor),oe=J.scissorTest,Oe.viewport(W),Oe.scissor(X),Oe.setScissorTest(oe),K=-1;return}else if(ut.__webglFramebuffer===void 0)ue.setupRenderTarget(J);else if(ut.__hasExternalTextures)ue.rebindTextures(J,V.get(J.texture).__webglTexture,V.get(J.depthTexture).__webglTexture);else if(J.depthBuffer){const Ft=J.depthTexture;if(ut.__boundDepthTexture!==Ft){if(Ft!==null&&V.has(Ft)&&(J.width!==Ft.image.width||J.height!==Ft.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ue.setupDepthRenderbuffer(J)}}const Et=J.texture;(Et.isData3DTexture||Et.isDataArrayTexture||Et.isCompressedArrayTexture)&&(mt=!0);const Ct=V.get(J).__webglFramebuffer;J.isWebGLCubeRenderTarget?(Array.isArray(Ct[Se])?Pe=Ct[Se][ze]:Pe=Ct[Se],Ae=!0):J.samples>0&&ue.useMultisampledRTT(J)===!1?Pe=V.get(J).__webglMultisampledFramebuffer:Array.isArray(Ct)?Pe=Ct[ze]:Pe=Ct,W.copy(J.viewport),X.copy(J.scissor),oe=J.scissorTest}else W.copy(se).multiplyScalar(ae).floor(),X.copy(ce).multiplyScalar(ae).floor(),oe=pe;if(ze!==0&&(Pe=Gr),Oe.bindFramebuffer(Y.FRAMEBUFFER,Pe)&&Oe.drawBuffers(J,Pe),Oe.viewport(W),Oe.scissor(X),Oe.setScissorTest(oe),Ae){const ut=V.get(J.texture);Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_CUBE_MAP_POSITIVE_X+Se,ut.__webglTexture,ze)}else if(mt){const ut=Se;for(let Et=0;Et<J.textures.length;Et++){const Ct=V.get(J.textures[Et]);Y.framebufferTextureLayer(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0+Et,Ct.__webglTexture,ze,ut)}}else if(J!==null&&ze!==0){const ut=V.get(J.texture);Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,ut.__webglTexture,ze)}K=-1},this.readRenderTargetPixels=function(J,Se,ze,Pe,Ae,mt,Mt,ut=0){if(!(J&&J.isWebGLRenderTarget)){kt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Et=V.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&Mt!==void 0&&(Et=Et[Mt]),Et){Oe.bindFramebuffer(Y.FRAMEBUFFER,Et);try{const Ct=J.textures[ut],Ft=Ct.format,Rt=Ct.type;if(!Me.textureFormatReadable(Ft)){kt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Me.textureTypeReadable(Rt)){kt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Se>=0&&Se<=J.width-Pe&&ze>=0&&ze<=J.height-Ae&&(J.textures.length>1&&Y.readBuffer(Y.COLOR_ATTACHMENT0+ut),Y.readPixels(Se,ze,Pe,Ae,Je.convert(Ft),Je.convert(Rt),mt))}finally{const Ct=j!==null?V.get(j).__webglFramebuffer:null;Oe.bindFramebuffer(Y.FRAMEBUFFER,Ct)}}},this.readRenderTargetPixelsAsync=async function(J,Se,ze,Pe,Ae,mt,Mt,ut=0){if(!(J&&J.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Et=V.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&Mt!==void 0&&(Et=Et[Mt]),Et)if(Se>=0&&Se<=J.width-Pe&&ze>=0&&ze<=J.height-Ae){Oe.bindFramebuffer(Y.FRAMEBUFFER,Et);const Ct=J.textures[ut],Ft=Ct.format,Rt=Ct.type;if(!Me.textureFormatReadable(Ft))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Me.textureTypeReadable(Rt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Bt=Y.createBuffer();Y.bindBuffer(Y.PIXEL_PACK_BUFFER,Bt),Y.bufferData(Y.PIXEL_PACK_BUFFER,mt.byteLength,Y.STREAM_READ),J.textures.length>1&&Y.readBuffer(Y.COLOR_ATTACHMENT0+ut),Y.readPixels(Se,ze,Pe,Ae,Je.convert(Ft),Je.convert(Rt),0);const mn=j!==null?V.get(j).__webglFramebuffer:null;Oe.bindFramebuffer(Y.FRAMEBUFFER,mn);const Vn=Y.fenceSync(Y.SYNC_GPU_COMMANDS_COMPLETE,0);return Y.flush(),await _2(Y,Vn,4),Y.bindBuffer(Y.PIXEL_PACK_BUFFER,Bt),Y.getBufferSubData(Y.PIXEL_PACK_BUFFER,0,mt),Y.deleteBuffer(Bt),Y.deleteSync(Vn),mt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(J,Se=null,ze=0){const Pe=Math.pow(2,-ze),Ae=Math.floor(J.image.width*Pe),mt=Math.floor(J.image.height*Pe),Mt=Se!==null?Se.x:0,ut=Se!==null?Se.y:0;ue.setTexture2D(J,0),Y.copyTexSubImage2D(Y.TEXTURE_2D,ze,0,0,Mt,ut,Ae,mt),Oe.unbindTexture()};const da=Y.createFramebuffer(),Dt=Y.createFramebuffer();this.copyTextureToTexture=function(J,Se,ze=null,Pe=null,Ae=0,mt=null){mt===null&&(Ae!==0?(Nm("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),mt=Ae,Ae=0):mt=0);let Mt,ut,Et,Ct,Ft,Rt,Bt,mn,Vn;const Cn=J.isCompressedTexture?J.mipmaps[mt]:J.image;if(ze!==null)Mt=ze.max.x-ze.min.x,ut=ze.max.y-ze.min.y,Et=ze.isBox3?ze.max.z-ze.min.z:1,Ct=ze.min.x,Ft=ze.min.y,Rt=ze.isBox3?ze.min.z:0;else{const gi=Math.pow(2,-Ae);Mt=Math.floor(Cn.width*gi),ut=Math.floor(Cn.height*gi),J.isDataArrayTexture?Et=Cn.depth:J.isData3DTexture?Et=Math.floor(Cn.depth*gi):Et=1,Ct=0,Ft=0,Rt=0}Pe!==null?(Bt=Pe.x,mn=Pe.y,Vn=Pe.z):(Bt=0,mn=0,Vn=0);const Xt=Je.convert(Se.format),bt=Je.convert(Se.type);let vn;Se.isData3DTexture?(ue.setTexture3D(Se,0),vn=Y.TEXTURE_3D):Se.isDataArrayTexture||Se.isCompressedArrayTexture?(ue.setTexture2DArray(Se,0),vn=Y.TEXTURE_2D_ARRAY):(ue.setTexture2D(Se,0),vn=Y.TEXTURE_2D),Y.pixelStorei(Y.UNPACK_FLIP_Y_WEBGL,Se.flipY),Y.pixelStorei(Y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),Y.pixelStorei(Y.UNPACK_ALIGNMENT,Se.unpackAlignment);const Pt=Y.getParameter(Y.UNPACK_ROW_LENGTH),Ii=Y.getParameter(Y.UNPACK_IMAGE_HEIGHT),Ws=Y.getParameter(Y.UNPACK_SKIP_PIXELS),kn=Y.getParameter(Y.UNPACK_SKIP_ROWS),xs=Y.getParameter(Y.UNPACK_SKIP_IMAGES);Y.pixelStorei(Y.UNPACK_ROW_LENGTH,Cn.width),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,Cn.height),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,Ct),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Ft),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,Rt);const Tn=J.isDataArrayTexture||J.isData3DTexture,mi=Se.isDataArrayTexture||Se.isData3DTexture;if(J.isDepthTexture){const gi=V.get(J),Bi=V.get(Se),zi=V.get(gi.__renderTarget),Ya=V.get(Bi.__renderTarget);Oe.bindFramebuffer(Y.READ_FRAMEBUFFER,zi.__webglFramebuffer),Oe.bindFramebuffer(Y.DRAW_FRAMEBUFFER,Ya.__webglFramebuffer);for(let bs=0;bs<Et;bs++)Tn&&(Y.framebufferTextureLayer(Y.READ_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,V.get(J).__webglTexture,Ae,Rt+bs),Y.framebufferTextureLayer(Y.DRAW_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,V.get(Se).__webglTexture,mt,Vn+bs)),Y.blitFramebuffer(Ct,Ft,Mt,ut,Bt,mn,Mt,ut,Y.DEPTH_BUFFER_BIT,Y.NEAREST);Oe.bindFramebuffer(Y.READ_FRAMEBUFFER,null),Oe.bindFramebuffer(Y.DRAW_FRAMEBUFFER,null)}else if(Ae!==0||J.isRenderTargetTexture||V.has(J)){const gi=V.get(J),Bi=V.get(Se);Oe.bindFramebuffer(Y.READ_FRAMEBUFFER,da),Oe.bindFramebuffer(Y.DRAW_FRAMEBUFFER,Dt);for(let zi=0;zi<Et;zi++)Tn?Y.framebufferTextureLayer(Y.READ_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,gi.__webglTexture,Ae,Rt+zi):Y.framebufferTexture2D(Y.READ_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,gi.__webglTexture,Ae),mi?Y.framebufferTextureLayer(Y.DRAW_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Bi.__webglTexture,mt,Vn+zi):Y.framebufferTexture2D(Y.DRAW_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,Bi.__webglTexture,mt),Ae!==0?Y.blitFramebuffer(Ct,Ft,Mt,ut,Bt,mn,Mt,ut,Y.COLOR_BUFFER_BIT,Y.NEAREST):mi?Y.copyTexSubImage3D(vn,mt,Bt,mn,Vn+zi,Ct,Ft,Mt,ut):Y.copyTexSubImage2D(vn,mt,Bt,mn,Ct,Ft,Mt,ut);Oe.bindFramebuffer(Y.READ_FRAMEBUFFER,null),Oe.bindFramebuffer(Y.DRAW_FRAMEBUFFER,null)}else mi?J.isDataTexture||J.isData3DTexture?Y.texSubImage3D(vn,mt,Bt,mn,Vn,Mt,ut,Et,Xt,bt,Cn.data):Se.isCompressedArrayTexture?Y.compressedTexSubImage3D(vn,mt,Bt,mn,Vn,Mt,ut,Et,Xt,Cn.data):Y.texSubImage3D(vn,mt,Bt,mn,Vn,Mt,ut,Et,Xt,bt,Cn):J.isDataTexture?Y.texSubImage2D(Y.TEXTURE_2D,mt,Bt,mn,Mt,ut,Xt,bt,Cn.data):J.isCompressedTexture?Y.compressedTexSubImage2D(Y.TEXTURE_2D,mt,Bt,mn,Cn.width,Cn.height,Xt,Cn.data):Y.texSubImage2D(Y.TEXTURE_2D,mt,Bt,mn,Mt,ut,Xt,bt,Cn);Y.pixelStorei(Y.UNPACK_ROW_LENGTH,Pt),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,Ii),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,Ws),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,kn),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,xs),mt===0&&Se.generateMipmaps&&Y.generateMipmap(vn),Oe.unbindTexture()},this.initRenderTarget=function(J){V.get(J).__webglFramebuffer===void 0&&ue.setupRenderTarget(J)},this.initTexture=function(J){J.isCubeTexture?ue.setTextureCube(J,0):J.isData3DTexture?ue.setTexture3D(J,0):J.isDataArrayTexture||J.isCompressedArrayTexture?ue.setTexture2DArray(J,0):ue.setTexture2D(J,0),Oe.unbindTexture()},this.resetState=function(){H=0,G=0,j=null,Oe.reset(),pt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ao}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=On._getDrawingBufferColorSpace(e),t.unpackColorSpace=On._getUnpackColorSpace()}}const h7=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:E1,AddEquation:Ih,AddOperation:$O,AdditiveAnimationBlendMode:FA,AdditiveBlending:cb,AgXToneMapping:CA,AlphaFormat:UA,AlwaysCompare:fP,AlwaysDepth:db,AlwaysStencilFunc:hw,AmbientLight:sU,AnimationAction:hU,AnimationClip:Rv,AnimationLoader:c6,AnimationMixer:k6,AnimationObjectGroup:L6,AnimationUtils:r6,ArcCurve:NP,ArrayCamera:lU,ArrowHelper:c8,AttachedBindMode:uw,Audio:cU,AudioAnalyser:A6,AudioContext:cE,AudioListener:M6,AudioLoader:x6,AxesHelper:u8,BackSide:Lr,BasicDepthPacking:sP,BasicShadowMap:OO,BatchedMesh:wP,Bone:qA,BooleanKeyframeTrack:Od,Box2:X6,Box3:$s,Box3Helper:o8,BoxGeometry:Id,BoxHelper:a8,BufferAttribute:li,BufferGeometry:nn,BufferGeometryLoader:oU,ByteType:NA,Cache:yc,Camera:z1,CameraHelper:r8,CanvasTexture:C5,CapsuleGeometry:Y1,CatmullRomCurve3:IP,CineonToneMapping:AA,CircleGeometry:Z1,ClampToEdgeWrapping:Ga,Clock:uE,Color:St,ColorKeyframeTrack:sE,ColorManagement:On,CompressedArrayTexture:A5,CompressedCubeTexture:E5,CompressedTexture:X1,CompressedTextureLoader:u6,ConeGeometry:qv,ConstantAlphaFactor:KO,ConstantColorFactor:YO,Controls:f8,CubeCamera:_P,CubeDepthTexture:RP,CubeReflectionMapping:Sc,CubeRefractionMapping:Vh,CubeTexture:Wv,CubeTextureLoader:h6,CubeUVReflectionMapping:qm,CubicBezierCurve:ZA,CubicBezierCurve3:OP,CubicInterpolant:KP,CullFaceBack:ow,CullFaceFront:IO,CullFaceFrontBack:NV,CullFaceNone:NO,Curve:Rl,CurvePath:UP,CustomBlending:PO,CustomToneMapping:EA,CylinderGeometry:jv,Cylindrical:q6,Data3DTexture:B1,DataArrayTexture:k1,DataTexture:Al,DataTextureLoader:f6,DataUtils:Q2,DecrementStencilOp:YV,DecrementWrapStencilOp:KV,DefaultLoadingManager:$P,DepthFormat:Mc,DepthStencilFormat:Ph,DepthTexture:Td,DetachedBindMode:eP,DirectionalLight:iU,DirectionalLightHelper:s8,DiscreteInterpolant:QP,DodecahedronGeometry:K1,DoubleSide:sa,DstAlphaFactor:HO,DstColorFactor:jO,DynamicCopyUsage:u2,DynamicDrawUsage:md,DynamicReadUsage:o2,EdgesGeometry:DP,EllipseCurve:Q1,EqualCompare:cP,EqualDepth:mb,EqualStencilFunc:e2,EquirectangularReflectionMapping:pv,EquirectangularRefractionMapping:mv,Euler:uo,EventDispatcher:Ec,ExternalTexture:XA,ExtrudeGeometry:J1,FileLoader:Cu,Float16BufferAttribute:s5,Float32BufferAttribute:It,FloatType:Pr,Fog:G1,FogExp2:V1,FramebufferTexture:w5,FrontSide:Eu,Frustum:Xm,FrustumArray:j1,GLBufferAttribute:H6,GLSL1:f2,GLSL3:fw,GreaterCompare:uP,GreaterDepth:vb,GreaterEqualCompare:F1,GreaterEqualDepth:gb,GreaterEqualStencilFunc:s2,GreaterStencilFunc:n2,GridHelper:n8,Group:ym,HalfFloatType:El,HemisphereLight:eU,HemisphereLightHelper:t8,IcosahedronGeometry:$1,ImageBitmapLoader:_6,ImageLoader:Dv,ImageUtils:gP,IncrementStencilOp:XV,IncrementWrapStencilOp:ZV,InstancedBufferAttribute:Md,InstancedBufferGeometry:lE,InstancedInterleavedBuffer:G6,InstancedMesh:TP,Int16BufferAttribute:n5,Int32BufferAttribute:i5,Int8BufferAttribute:$2,IntType:R1,InterleavedBuffer:H1,InterleavedBufferAttribute:Sd,Interpolant:Kv,InterpolateDiscrete:yv,InterpolateLinear:Qb,InterpolateSmooth:Zx,InterpolationSamplingMode:m2,InterpolationSamplingType:p2,InvertStencilOp:QV,KeepStencilOp:nd,KeyframeTrack:Qo,LOD:SP,LatheGeometry:eS,Layers:Om,LessCompare:lP,LessDepth:pb,LessEqualCompare:L1,LessEqualDepth:xd,LessEqualStencilFunc:t2,LessStencilFunc:$V,Light:Kh,LightProbe:aU,Line:Wh,Line3:K6,LineBasicMaterial:ua,LineCurve:KA,LineCurve3:PP,LineDashedMaterial:YP,LineLoop:AP,LineSegments:Cc,LinearFilter:ti,LinearInterpolant:iE,LinearMipMapLinearFilter:UV,LinearMipMapNearestFilter:PV,LinearMipmapLinearFilter:vc,LinearMipmapNearestFilter:Q0,LinearSRGBColorSpace:Gh,LinearToneMapping:TA,LinearTransfer:xv,Loader:qa,LoaderUtils:vw,LoadingManager:rE,LoopOnce:tP,LoopPingPong:iP,LoopRepeat:nP,MOUSE:ed,Material:kr,MaterialLoader:oS,MathUtils:L2,Matrix2:pE,Matrix3:on,Matrix4:Kt,MaxEquation:kO,Mesh:Qi,MeshBasicMaterial:Iu,MeshDepthMaterial:rS,MeshDistanceMaterial:aS,MeshLambertMaterial:qP,MeshMatcapMaterial:XP,MeshNormalMaterial:jP,MeshPhongMaterial:HP,MeshPhysicalMaterial:GP,MeshStandardMaterial:tE,MeshToonMaterial:WP,MinEquation:FO,MirroredRepeatWrapping:vv,MixOperation:JO,MultiplyBlending:cw,MultiplyOperation:Gv,NearestFilter:ms,NearestMipMapLinearFilter:OV,NearestMipMapNearestFilter:IV,NearestMipmapLinearFilter:gm,NearestMipmapNearestFilter:DA,NeutralToneMapping:RA,NeverCompare:oP,NeverDepth:fb,NeverStencilFunc:JV,NoBlending:bc,NoColorSpace:xu,NoNormalPacking:GV,NoToneMapping:Xo,NormalAnimationBlendMode:U1,NormalBlending:pd,NormalGAPacking:WV,NormalRGPacking:HV,NotEqualCompare:hP,NotEqualDepth:yb,NotEqualStencilFunc:i2,NumberKeyframeTrack:Ev,Object3D:zn,ObjectLoader:v6,ObjectSpaceNormalMap:aP,OctahedronGeometry:Ym,OneFactor:zO,OneMinusConstantAlphaFactor:QO,OneMinusConstantColorFactor:ZO,OneMinusDstAlphaFactor:WO,OneMinusDstColorFactor:qO,OneMinusSrcAlphaFactor:hb,OneMinusSrcColorFactor:GO,OrthographicCamera:Mu,PCFShadowMap:Mm,PCFSoftShadowMap:K0,PMREMGenerator:xw,Path:t1,PerspectiveCamera:ps,Plane:_u,PlaneGeometry:Ou,PlaneHelper:l8,PointLight:nU,PointLightHelper:$6,Points:EP,PointsMaterial:q1,PolarGridHelper:i8,PolyhedronGeometry:Zh,PositionalAudio:w6,PropertyBinding:Bn,PropertyMixer:uU,QuadraticBezierCurve:QA,QuadraticBezierCurve3:JA,Quaternion:Fr,QuaternionKeyframeTrack:Qv,QuaternionLinearInterpolant:JP,R11_EAC_Format:Ab,RED_GREEN_RGTC2_Format:Zb,RED_RGTC1_Format:Xb,REVISION:Vv,RG11_EAC_Format:Cb,RGBADepthPacking:rP,RGBAFormat:Ur,RGBAIntegerFormat:P1,RGBA_ASTC_10x10_Format:Vb,RGBA_ASTC_10x5_Format:kb,RGBA_ASTC_10x6_Format:Bb,RGBA_ASTC_10x8_Format:zb,RGBA_ASTC_12x10_Format:Gb,RGBA_ASTC_12x12_Format:Hb,RGBA_ASTC_4x4_Format:Db,RGBA_ASTC_5x4_Format:Nb,RGBA_ASTC_5x5_Format:Ib,RGBA_ASTC_6x5_Format:Ob,RGBA_ASTC_6x6_Format:Pb,RGBA_ASTC_8x5_Format:Ub,RGBA_ASTC_8x6_Format:Lb,RGBA_ASTC_8x8_Format:Fb,RGBA_BPTC_Format:Wb,RGBA_ETC2_EAC_Format:wb,RGBA_PVRTC_2BPPV1_Format:Sb,RGBA_PVRTC_4BPPV1_Format:bb,RGBA_S3TC_DXT1_Format:$0,RGBA_S3TC_DXT3_Format:ev,RGBA_S3TC_DXT5_Format:tv,RGBDepthPacking:zV,RGBFormat:LA,RGBIntegerFormat:LV,RGB_BPTC_SIGNED_Format:jb,RGB_BPTC_UNSIGNED_Format:qb,RGB_ETC1_Format:Mb,RGB_ETC2_Format:Tb,RGB_PVRTC_2BPPV1_Format:xb,RGB_PVRTC_4BPPV1_Format:_b,RGB_S3TC_DXT1_Format:J0,RGDepthPacking:VV,RGFormat:bd,RGIntegerFormat:O1,RawShaderMaterial:eE,Ray:Nd,Raycaster:fU,RectAreaLight:rU,RedFormat:I1,RedIntegerFormat:Hv,ReinhardToneMapping:wA,RenderTarget:BA,RenderTarget3D:B6,RepeatWrapping:gv,ReplaceStencilOp:qV,ReverseSubtractEquation:LO,RingGeometry:tS,SIGNED_R11_EAC_Format:Eb,SIGNED_RED_GREEN_RGTC2_Format:Kb,SIGNED_RED_RGTC1_Format:Yb,SIGNED_RG11_EAC_Format:Rb,SRGBColorSpace:Ir,SRGBTransfer:Jn,Scene:WA,ShaderChunk:fn,ShaderLib:bl,ShaderMaterial:ho,ShadowMaterial:VP,Shape:Fh,ShapeGeometry:Xv,ShapePath:h8,ShapeUtils:Ml,ShortType:IA,Skeleton:W1,SkeletonHelper:J6,SkinnedMesh:MP,Source:Uh,Sphere:er,SphereGeometry:Yv,Spherical:n1,SphericalHarmonics3:oE,SplineCurve:$A,SpotLight:tU,SpotLightHelper:Q6,Sprite:bP,SpriteMaterial:jA,SrcAlphaFactor:ub,SrcAlphaSaturateFactor:XO,SrcColorFactor:VO,StaticCopyUsage:c2,StaticDrawUsage:bv,StaticReadUsage:a2,StereoCamera:b6,StreamCopyUsage:h2,StreamDrawUsage:r2,StreamReadUsage:l2,StringKeyframeTrack:Pd,SubtractEquation:UO,SubtractiveBlending:lw,TOUCH:td,TangentSpaceNormalMap:Yh,TetrahedronGeometry:Zv,Texture:Ki,TextureLoader:d6,TextureUtils:v8,Timer:W6,TimestampQuery:d2,TorusGeometry:nS,TorusKnotGeometry:iS,Triangle:za,TriangleFanDrawMode:BV,TriangleStripDrawMode:kV,TrianglesDrawMode:FV,TubeGeometry:sS,UVMapping:C1,Uint16BufferAttribute:zA,Uint32BufferAttribute:VA,Uint8BufferAttribute:e5,Uint8ClampedBufferAttribute:t5,Uniform:dE,UniformsGroup:V6,UniformsLib:wt,UniformsUtils:GA,UnsignedByteType:ra,UnsignedInt101111Type:PA,UnsignedInt248Type:Rm,UnsignedInt5999Type:OA,UnsignedIntType:Ko,UnsignedShort4444Type:D1,UnsignedShort5551Type:N1,UnsignedShortType:Cm,VSMShadowMap:ad,Vector2:st,Vector3:re,Vector4:$n,VectorKeyframeTrack:Cv,VideoFrameTexture:T5,VideoTexture:CP,WebGL3DRenderTarget:V2,WebGLArrayRenderTarget:z2,WebGLCoordinateSystem:ao,WebGLCubeRenderTarget:HA,WebGLRenderTarget:Ha,WebGLRenderer:xU,WebGLUtils:_U,WebGPUCoordinateSystem:Dm,WebXRController:Kx,WireframeGeometry:zP,WrapAroundEnding:_v,ZeroCurvatureEnding:od,ZeroFactor:BO,ZeroSlopeEnding:ld,ZeroStencilOp:jV,createCanvasElement:mP,error:kt,getConsoleFunction:y2,log:Mv,setConsoleFunction:v2,warn:Tt,warnOnce:Nm},Symbol.toStringTag,{value:"Module"}));var ST={exports:{}},MT={},TT={exports:{}},wT={};var qD;function f7(){if(qD)return wT;qD=1;var i=Lv();function e(g,v){return g===v&&(g!==0||1/g===1/v)||g!==g&&v!==v}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,s=i.useEffect,r=i.useLayoutEffect,o=i.useDebugValue;function l(g,v){var x=v(),b=n({inst:{value:x,getSnapshot:v}}),w=b[0].inst,M=b[1];return r(function(){w.value=x,w.getSnapshot=v,u(w)&&M({inst:w})},[g,x,v]),s(function(){return u(w)&&M({inst:w}),g(function(){u(w)&&M({inst:w})})},[g]),o(x),x}function u(g){var v=g.getSnapshot;g=g.value;try{var x=v();return!t(g,x)}catch{return!0}}function f(g,v){return v()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:l;return wT.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:p,wT}var XD;function d7(){return XD||(XD=1,TT.exports=f7()),TT.exports}var YD;function p7(){if(YD)return MT;YD=1;var i=Lv(),e=d7();function t(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=i.useRef,o=i.useEffect,l=i.useMemo,u=i.useDebugValue;return MT.useSyncExternalStoreWithSelector=function(f,p,g,v,x){var b=r(null);if(b.current===null){var w={hasValue:!1,value:null};b.current=w}else w=b.current;b=l(function(){function S(O){if(!C){if(C=!0,R=O,O=v(O),x!==void 0&&w.hasValue){var U=w.value;if(x(U,O))return I=U}return I=O}if(U=I,n(R,O))return U;var k=v(O);return x!==void 0&&x(U,k)?(R=O,U):(R=O,I=k)}var C=!1,R,I,D=g===void 0?null:g;return[function(){return S(p())},D===null?void 0:function(){return S(D())}]},[p,g,v,x]);var M=s(f,b[0],b[1]);return o(function(){w.hasValue=!0,w.value=M},[M]),u(M),M},MT}var ZD;function m7(){return ZD||(ZD=1,ST.exports=p7()),ST.exports}var g7=m7();const v7=Ww(g7),KD=i=>{let e;const t=new Set,n=(f,p)=>{const g=typeof f=="function"?f(e):f;if(!Object.is(g,e)){const v=e;e=p??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(x=>x(e,v))}},s=()=>e,l={setState:n,getState:s,getInitialState:()=>u,subscribe:f=>(t.add(f),()=>t.delete(f))},u=e=i(n,s,l);return l},y7=(i=>i?KD(i):KD),{useSyncExternalStoreWithSelector:_7}=v7,x7=i=>i;function b7(i,e=x7,t){const n=_7(i.subscribe,i.getState,i.getInitialState,e,t);return KN.useDebugValue(n),n}const QD=(i,e)=>{const t=y7(i),n=(s,r=e)=>b7(t,s,r);return Object.assign(n,t),n},S7=((i,e)=>i?QD(i,e):QD),M7=i=>typeof i=="object"&&typeof i.then=="function",Ux=[];function T7(i,e,t=(n,s)=>n===s){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let s=0;s<n;s++)if(!t(i[s],e[s]))return!1;return!0}function w7(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const r of Ux)if(T7(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return n.lifespan&&n.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,n.lifespan)),r.response;if(!t)throw r.promise}const s={keys:e,equal:n.equal,remove:()=>{const r=Ux.indexOf(s);r!==-1&&Ux.splice(r,1)},promise:(M7(i)?i:i(...e)).then(r=>{s.response=r,n.lifespan&&n.lifespan>0&&(s.timeout=setTimeout(s.remove,n.lifespan))}).catch(r=>s.error=r)};if(Ux.push(s),!t)throw s.promise}const A7=(i,e,t)=>w7(i,e,!1,t);var Mw=QN();const E7=Ww(Mw);function mE(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const s=mE(n,e,t);if(s)return s;n=e?null:n.sibling}}function bU(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const gE=bU(_e.createContext(null));class SU extends _e.Component{render(){return _e.createElement(gE.Provider,{value:this._reactInternals},this.props.children)}}function MU(){const i=_e.useContext(gE);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=_e.useId();return _e.useMemo(()=>{for(const t of[i,i?.alternate]){if(!t)continue;const n=mE(t,!1,s=>{let r=s.memoizedState;for(;r;){if(r.memoizedState===e)return!0;r=r.next}});if(n)return n}},[i,e])}const C7=Symbol.for("react.context"),R7=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===C7;function D7(){const i=MU(),[e]=_e.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;R7(n)&&n!==gE&&!e.has(n)&&e.set(n,_e.use(bU(n))),t=t.return}return e}function N7(){const i=D7();return _e.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>_e.createElement(e,null,_e.createElement(t.Provider,{...n,value:i.get(t)})),e=>_e.createElement(SU,{...e})),[i])}function TU(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const wU=i=>i&&i.isOrthographicCamera,I7=i=>i&&i.hasOwnProperty("current"),O7=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),Jv=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?_e.useLayoutEffect:_e.useEffect;function AU(i){const e=_e.useRef(i);return Jv(()=>{e.current=i},[i]),e}function P7(){const i=MU(),e=N7();return _e.useMemo(()=>({children:t})=>{const s=!!mE(i,!0,r=>r.type===_e.StrictMode)?_e.StrictMode:_e.Fragment;return ee.jsx(s,{children:ee.jsx(e,{children:t})})},[i,e])}function U7({set:i}){return Jv(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const L7=(i=>(i=class extends _e.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function EU(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function rm(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const Xi={obj:i=>i===Object(i)&&!Xi.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:s=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Xi.str(i)||Xi.num(i)||Xi.boo(i))return i===e;const r=Xi.obj(i);if(r&&n==="reference")return i===e;const o=Xi.arr(i);if(o&&t==="reference")return i===e;if((o||r)&&i===e)return!0;let l;for(l in i)if(!(l in e))return!1;if(r&&t==="shallow"&&n==="shallow"){for(l in s?e:i)if(!Xi.equ(i[l],e[l],{strict:s,objects:"reference"}))return!1}else for(l in s?e:i)if(i[l]!==e[l])return!1;if(Xi.und(l)){if(o&&i.length===0&&e.length===0||r&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function F7(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const CU=["children","key","ref"];function k7(i){const e={};for(const t in i)CU.includes(t)||(e[t]=i[t]);return e}function i1(i,e,t,n){const s=i;let r=s?.__r3f;return r||(r={root:e,type:t,parent:null,children:[],props:k7(n),object:s,eventCount:0,handlers:{},isHidden:!1},s&&(s.__r3f=r)),r}function Nv(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const s of n){if(typeof t!="object"||t===null){if(t!==void 0){const r=n.slice(n.indexOf(s)).join("-");return{root:t,key:r,target:void 0}}return{root:i,key:e,target:void 0}}e=s,i=t,t=t[e]}return{root:i,key:e,target:t}}const JD=/-\d+$/;function s1(i,e){if(Xi.str(e.props.attach)){if(JD.test(e.props.attach)){const s=e.props.attach.replace(JD,""),{root:r,key:o}=Nv(i.object,s);Array.isArray(r[o])||(r[o]=[])}const{root:t,key:n}=Nv(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Xi.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function r1(i,e){if(Xi.str(e.props.attach)){const{root:t,key:n}=Nv(i.object,e.props.attach),s=e.previousAttach;s===void 0?delete t[n]:t[n]=s}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const Tw=[...CU,"args","dispose","attach","object","onUpdate","dispose"],$D=new Map;function B7(i){let e=$D.get(i.constructor);try{e||(e=new i.constructor,$D.set(i.constructor,e))}catch{}return e}function z7(i,e){const t={};for(const n in e)if(!Tw.includes(n)&&!Xi.equ(e[n],i.props[n])){t[n]=e[n];for(const s in e)s.startsWith(`${n}-`)&&(t[s]=e[s])}for(const n in i.props){if(Tw.includes(n)||e.hasOwnProperty(n))continue;const{root:s,key:r}=Nv(i.object,n);if(s.constructor&&s.constructor.length===0){const o=B7(s);Xi.und(o)||(t[r]=o[r])}else t[r]=0}return t}const V7=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],G7=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Oh(i,e){var t;const n=i.__r3f,s=n&&TU(n).getState(),r=n?.eventCount;for(const l in e){let u=e[l];if(Tw.includes(l))continue;if(n&&G7.test(l)){typeof u=="function"?n.handlers[l]=u:delete n.handlers[l],n.eventCount=Object.keys(n.handlers).length;continue}if(u===void 0)continue;let{root:f,key:p,target:g}=Nv(i,l);if(g===void 0&&(typeof f!="object"||f===null))throw Error(`R3F: Cannot set "${l}". Ensure it is an object before setting "${p}".`);if(g instanceof Om&&u instanceof Om)g.mask=u.mask;else if(g instanceof St&&O7(u))g.set(u);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof g.copy=="function"&&u!=null&&u.constructor&&g.constructor===u.constructor)g.copy(u);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&Array.isArray(u))typeof g.fromArray=="function"?g.fromArray(u):g.set(...u);else if(g!==null&&typeof g=="object"&&typeof g.set=="function"&&typeof u=="number")typeof g.setScalar=="function"?g.setScalar(u):g.set(u);else{var o;f[p]=u,s&&!s.linear&&V7.includes(p)&&(o=f[p])!=null&&o.isTexture&&f[p].format===Ur&&f[p].type===ra&&(f[p].colorSpace=Ir)}}if(n!=null&&n.parent&&s!=null&&s.internal&&(t=n.object)!=null&&t.isObject3D&&r!==n.eventCount){const l=n.object,u=s.internal.interaction.indexOf(l);u>-1&&s.internal.interaction.splice(u,1),n.eventCount&&l.raycast!==null&&s.internal.interaction.push(l)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Km(n),i}function Km(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function H7(i,e){i.manual||(wU(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const Fa=i=>i?.isObject3D;function Lx(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function RU(i,e,t,n){const s=t.get(e);s&&(t.delete(e),t.size===0&&(i.delete(n),s.target.releasePointerCapture(n)))}function W7(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,s)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((n,s)=>{RU(t.capturedMap,e,n,s)})}function j7(i){function e(u){const{internal:f}=i.getState(),p=u.offsetX-f.initialClick[0],g=u.offsetY-f.initialClick[1];return Math.round(Math.sqrt(p*p+g*g))}function t(u){return u.filter(f=>["Move","Over","Enter","Out","Leave"].some(p=>{var g;return(g=f.__r3f)==null?void 0:g.handlers["onPointer"+p]}))}function n(u,f){const p=i.getState(),g=new Set,v=[],x=f?f(p.internal.interaction):p.internal.interaction;for(let S=0;S<x.length;S++){const C=rm(x[S]);C&&(C.raycaster.camera=void 0)}p.previousRoot||p.events.compute==null||p.events.compute(u,p);function b(S){const C=rm(S);if(!C||!C.events.enabled||C.raycaster.camera===null)return[];if(C.raycaster.camera===void 0){var R;C.events.compute==null||C.events.compute(u,C,(R=C.previousRoot)==null?void 0:R.getState()),C.raycaster.camera===void 0&&(C.raycaster.camera=null)}return C.raycaster.camera?C.raycaster.intersectObject(S,!0):[]}let w=x.flatMap(b).sort((S,C)=>{const R=rm(S.object),I=rm(C.object);return!R||!I?S.distance-C.distance:I.events.priority-R.events.priority||S.distance-C.distance}).filter(S=>{const C=Lx(S);return g.has(C)?!1:(g.add(C),!0)});p.events.filter&&(w=p.events.filter(w,p));for(const S of w){let C=S.object;for(;C;){var M;(M=C.__r3f)!=null&&M.eventCount&&v.push({...S,eventObject:C}),C=C.parent}}if("pointerId"in u&&p.internal.capturedMap.has(u.pointerId))for(let S of p.internal.capturedMap.get(u.pointerId).values())g.has(Lx(S.intersection))||v.push(S.intersection);return v}function s(u,f,p,g){if(u.length){const v={stopped:!1};for(const x of u){let b=rm(x.object);if(b||x.object.traverseAncestors(w=>{const M=rm(w);if(M)return b=M,!1}),b){const{raycaster:w,pointer:M,camera:S,internal:C}=b,R=new re(M.x,M.y,0).unproject(S),I=P=>{var F,H;return(F=(H=C.capturedMap.get(P))==null?void 0:H.has(x.eventObject))!=null?F:!1},D=P=>{const F={intersection:x,target:f.target};C.capturedMap.has(P)?C.capturedMap.get(P).set(x.eventObject,F):C.capturedMap.set(P,new Map([[x.eventObject,F]])),f.target.setPointerCapture(P)},O=P=>{const F=C.capturedMap.get(P);F&&RU(C.capturedMap,x.eventObject,F,P)};let U={};for(let P in f){let F=f[P];typeof F!="function"&&(U[P]=F)}let k={...x,...U,pointer:M,intersections:u,stopped:v.stopped,delta:p,unprojectedPoint:R,ray:w.ray,camera:S,stopPropagation(){const P="pointerId"in f&&C.capturedMap.get(f.pointerId);if((!P||P.has(x.eventObject))&&(k.stopped=v.stopped=!0,C.hovered.size&&Array.from(C.hovered.values()).find(F=>F.eventObject===x.eventObject))){const F=u.slice(0,u.indexOf(x));r([...F,x])}},target:{hasPointerCapture:I,setPointerCapture:D,releasePointerCapture:O},currentTarget:{hasPointerCapture:I,setPointerCapture:D,releasePointerCapture:O},nativeEvent:f};if(g(k),v.stopped===!0)break}}}return u}function r(u){const{internal:f}=i.getState();for(const p of f.hovered.values())if(!u.length||!u.find(g=>g.object===p.object&&g.index===p.index&&g.instanceId===p.instanceId)){const v=p.eventObject.__r3f;if(f.hovered.delete(Lx(p)),v!=null&&v.eventCount){const x=v.handlers,b={...p,intersections:u};x.onPointerOut==null||x.onPointerOut(b),x.onPointerLeave==null||x.onPointerLeave(b)}}}function o(u,f){for(let p=0;p<f.length;p++){const g=f[p].__r3f;g==null||g.handlers.onPointerMissed==null||g.handlers.onPointerMissed(u)}}function l(u){switch(u){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return f=>{const{internal:p}=i.getState();"pointerId"in f&&p.capturedMap.has(f.pointerId)&&requestAnimationFrame(()=>{p.capturedMap.has(f.pointerId)&&(p.capturedMap.delete(f.pointerId),r([]))})}}return function(p){const{onPointerMissed:g,internal:v}=i.getState();v.lastEvent.current=p;const x=u==="onPointerMove",b=u==="onClick"||u==="onContextMenu"||u==="onDoubleClick",M=n(p,x?t:void 0),S=b?e(p):0;u==="onPointerDown"&&(v.initialClick=[p.offsetX,p.offsetY],v.initialHits=M.map(R=>R.eventObject)),b&&!M.length&&S<=2&&(o(p,v.interaction),g&&g(p)),x&&r(M);function C(R){const I=R.eventObject,D=I.__r3f;if(!(D!=null&&D.eventCount))return;const O=D.handlers;if(x){if(O.onPointerOver||O.onPointerEnter||O.onPointerOut||O.onPointerLeave){const U=Lx(R),k=v.hovered.get(U);k?k.stopped&&R.stopPropagation():(v.hovered.set(U,R),O.onPointerOver==null||O.onPointerOver(R),O.onPointerEnter==null||O.onPointerEnter(R))}O.onPointerMove==null||O.onPointerMove(R)}else{const U=O[u];U?(!b||v.initialHits.includes(I))&&(o(p,v.interaction.filter(k=>!v.initialHits.includes(k))),U(R)):b&&v.initialHits.includes(I)&&o(p,v.interaction.filter(k=>!v.initialHits.includes(k)))}}s(M,p,S,C)}}return{handlePointer:l}}const eN=i=>!!(i!=null&&i.render),DU=_e.createContext(null),q7=(i,e)=>{const t=S7((l,u)=>{const f=new re,p=new re,g=new re;function v(S=u().camera,C=p,R=u().size){const{width:I,height:D,top:O,left:U}=R,k=I/D;C.isVector3?g.copy(C):g.set(...C);const P=S.getWorldPosition(f).distanceTo(g);if(wU(S))return{width:I/S.zoom,height:D/S.zoom,top:O,left:U,factor:1,distance:P,aspect:k};{const F=S.fov*Math.PI/180,H=2*Math.tan(F/2)*P,G=H*(I/D);return{width:G,height:H,top:O,left:U,factor:I/G,distance:P,aspect:k}}}let x;const b=S=>l(C=>({performance:{...C.performance,current:S}})),w=new st;return{set:l,get:u,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(S=1)=>i(u(),S),advance:(S,C)=>e(S,C,u()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new uE,pointer:w,mouse:w,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const S=u();x&&clearTimeout(x),S.performance.current!==S.performance.min&&b(S.performance.min),x=setTimeout(()=>b(u().performance.max),S.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:S=>l(C=>({...C,events:{...C.events,...S}})),setSize:(S,C,R=0,I=0)=>{const D=u().camera,O={width:S,height:C,top:R,left:I};l(U=>({size:O,viewport:{...U.viewport,...v(D,p,O)}}))},setDpr:S=>l(C=>{const R=EU(S);return{viewport:{...C.viewport,dpr:R,initialDpr:C.viewport.initialDpr||R}}}),setFrameloop:(S="always")=>{const C=u().clock;C.stop(),C.elapsedTime=0,S!=="never"&&(C.start(),C.elapsedTime=0),l(()=>({frameloop:S}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:_e.createRef(),active:!1,frames:0,priority:0,subscribe:(S,C,R)=>{const I=u().internal;return I.priority=I.priority+(C>0?1:0),I.subscribers.push({ref:S,priority:C,store:R}),I.subscribers=I.subscribers.sort((D,O)=>D.priority-O.priority),()=>{const D=u().internal;D!=null&&D.subscribers&&(D.priority=D.priority-(C>0?1:0),D.subscribers=D.subscribers.filter(O=>O.ref!==S))}}}}}),n=t.getState();let s=n.size,r=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:l,size:u,viewport:f,gl:p,set:g}=t.getState();if(u.width!==s.width||u.height!==s.height||f.dpr!==r){s=u,r=f.dpr,H7(l,u),f.dpr>0&&p.setPixelRatio(f.dpr);const v=typeof HTMLCanvasElement<"u"&&p.domElement instanceof HTMLCanvasElement;p.setSize(u.width,u.height,v)}l!==o&&(o=l,g(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(l)}})))}),t.subscribe(l=>i(l)),t};function NU(){const i=_e.useContext(DU);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function ka(i=t=>t,e){return NU()(i,e)}function Dl(i,e=0){const t=NU(),n=t.getState().internal.subscribe,s=AU(i);return Jv(()=>n(s,e,t),[e,n,t]),null}const X7=1,Y7=8,Z7=32,K7=2;var Q7={version:"9.5.0"};function J7(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var tN={exports:{}},nN={exports:{}},iN;function $7(){return iN||(iN=1,(function(i){i.exports=function(e){function t(h,d,_,T){return new Mg(h,d,_,T)}function n(){}function s(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)d+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(h){var d=h,_=h;if(h.alternate)for(;d.return;)d=d.return;else{h=d;do d=h,(d.flags&4098)!==0&&(_=d.return),h=d.return;while(h)}return d.tag===3?_:null}function o(h){if(r(h)!==h)throw Error(s(188))}function l(h){var d=h.alternate;if(!d){if(d=r(h),d===null)throw Error(s(188));return d!==h?null:h}for(var _=h,T=d;;){var N=_.return;if(N===null)break;var L=N.alternate;if(L===null){if(T=N.return,T!==null){_=T;continue}break}if(N.child===L.child){for(L=N.child;L;){if(L===_)return o(N),h;if(L===T)return o(N),d;L=L.sibling}throw Error(s(188))}if(_.return!==T.return)_=N,T=L;else{for(var Z=!1,ve=N.child;ve;){if(ve===_){Z=!0,_=N,T=L;break}if(ve===T){Z=!0,T=N,_=L;break}ve=ve.sibling}if(!Z){for(ve=L.child;ve;){if(ve===_){Z=!0,_=L,T=N;break}if(ve===T){Z=!0,T=L,_=N;break}ve=ve.sibling}if(!Z)throw Error(s(189))}}if(_.alternate!==T)throw Error(s(190))}if(_.tag!==3)throw Error(s(188));return _.stateNode.current===_?h:d}function u(h){var d=h.tag;if(d===5||d===26||d===27||d===6)return h;for(h=h.child;h!==null;){if(d=u(h),d!==null)return d;h=h.sibling}return null}function f(h){var d=h.tag;if(d===5||d===26||d===27||d===6)return h;for(h=h.child;h!==null;){if(h.tag!==4&&(d=f(h),d!==null))return d;h=h.sibling}return null}function p(h){return h===null||typeof h!="object"?null:(h=al&&h[al]||h["@@iterator"],typeof h=="function"?h:null)}function g(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===Jl?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case Xc:return"Fragment";case Zc:return"Profiler";case Yc:return"StrictMode";case ap:return"Suspense";case rl:return"SuspenseList";case vf:return"Activity"}if(typeof h=="object")switch(h.$$typeof){case qc:return"Portal";case Ma:return h.displayName||"Context";case gf:return(h._context.displayName||"Context")+".Consumer";case $u:var d=h.render;return h=h.displayName,h||(h=d.displayName||d.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case op:return d=h.displayName||null,d!==null?d:g(h.type)||"Memo";case or:d=h._payload,h=h._init;try{return g(h(d))}catch{}}return null}function v(h){return{current:h}}function x(h){0>eu||(h.current=xp[eu],xp[eu]=null,eu--)}function b(h,d){eu++,xp[eu]=h.current,h.current=d}function w(h){return h>>>=0,h===0?32:31-(bp(h)/x_|0)|0}function M(h){var d=h&42;if(d!==0)return d;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return h&261888;case 262144:case 524288:case 1048576:case 2097152:return h&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function S(h,d,_){var T=h.pendingLanes;if(T===0)return 0;var N=0,L=h.suspendedLanes,Z=h.pingedLanes;h=h.warmLanes;var ve=T&134217727;return ve!==0?(T=ve&~L,T!==0?N=M(T):(Z&=ve,Z!==0?N=M(Z):_||(_=ve&~h,_!==0&&(N=M(_))))):(ve=T&~L,ve!==0?N=M(ve):Z!==0?N=M(Z):_||(_=T&~h,_!==0&&(N=M(_)))),N===0?0:d!==0&&d!==N&&(d&L)===0&&(L=N&-N,_=d&-d,L>=_||L===32&&(_&4194048)!==0)?d:N}function C(h,d){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&d)===0}function R(h,d){switch(h){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I(){var h=ah;return ah<<=1,(ah&62914560)===0&&(ah=4194304),h}function D(h){for(var d=[],_=0;31>_;_++)d.push(h);return d}function O(h,d){h.pendingLanes|=d,d!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function U(h,d,_,T,N,L){var Z=h.pendingLanes;h.pendingLanes=_,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=_,h.entangledLanes&=_,h.errorRecoveryDisabledLanes&=_,h.shellSuspendCounter=0;var ve=h.entanglements,Ze=h.expirationTimes,lt=h.hiddenUpdates;for(_=Z&~_;0<_;){var vt=31-Mr(_),ft=1<<vt;ve[vt]=0,Ze[vt]=-1;var At=lt[vt];if(At!==null)for(lt[vt]=null,vt=0;vt<At.length;vt++){var tn=At[vt];tn!==null&&(tn.lane&=-536870913)}_&=~ft}T!==0&&k(h,T,0),L!==0&&N===0&&h.tag!==0&&(h.suspendedLanes|=L&~(Z&~d))}function k(h,d,_){h.pendingLanes|=d,h.suspendedLanes&=~d;var T=31-Mr(d);h.entangledLanes|=d,h.entanglements[T]=h.entanglements[T]|1073741824|_&261930}function P(h,d){var _=h.entangledLanes|=d;for(h=h.entanglements;_;){var T=31-Mr(_),N=1<<T;N&d|h[T]&d&&(h[T]|=d),_&=~N}}function F(h,d){var _=d&-d;return _=(_&42)!==0?1:H(_),(_&(h.suspendedLanes|d))!==0?0:_}function H(h){switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=128;break;case 268435456:h=134217728;break;default:h=0}return h}function G(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function j(h){if(typeof l0=="function"&&M_(h),Tr&&typeof Tr.setStrictMode=="function")try{Tr.setStrictMode(nu,h)}catch{}}function K(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}function te(h){if(Ep===void 0)try{throw Error()}catch(_){var d=_.stack.trim().match(/\n( *(at )?)/);Ep=d&&d[1]||"",Io=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ep+h+Io}function W(h,d){if(!h||Af)return"";Af=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(d){var ft=function(){throw Error()};if(Object.defineProperty(ft.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ft,[])}catch(tn){var At=tn}Reflect.construct(h,[],ft)}else{try{ft.call()}catch(tn){At=tn}h.call(ft.prototype)}}else{try{throw Error()}catch(tn){At=tn}(ft=h())&&typeof ft.catch=="function"&&ft.catch(function(){})}}catch(tn){if(tn&&At&&typeof tn.stack=="string")return[tn.stack,At.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=T.DetermineComponentFrameRoot(),Z=L[0],ve=L[1];if(Z&&ve){var Ze=Z.split(`
`),lt=ve.split(`
`);for(N=T=0;T<Ze.length&&!Ze[T].includes("DetermineComponentFrameRoot");)T++;for(;N<lt.length&&!lt[N].includes("DetermineComponentFrameRoot");)N++;if(T===Ze.length||N===lt.length)for(T=Ze.length-1,N=lt.length-1;1<=T&&0<=N&&Ze[T]!==lt[N];)N--;for(;1<=T&&0<=N;T--,N--)if(Ze[T]!==lt[N]){if(T!==1||N!==1)do if(T--,N--,0>N||Ze[T]!==lt[N]){var vt=`
`+Ze[T].replace(" at new "," at ");return h.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",h.displayName)),vt}while(1<=T&&0<=N);break}}}finally{Af=!1,Error.prepareStackTrace=_}return(_=h?h.displayName||h.name:"")?te(_):""}function X(h,d){switch(h.tag){case 26:case 27:case 5:return te(h.type);case 16:return te("Lazy");case 13:return h.child!==d&&d!==null?te("Suspense Fallback"):te("Suspense");case 19:return te("SuspenseList");case 0:case 15:return W(h.type,!1);case 11:return W(h.type.render,!1);case 1:return W(h.type,!0);case 31:return te("Activity");default:return""}}function oe(h){try{var d="",_=null;do d+=X(h,_),_=h,h=h.return;while(h);return d}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}function ne(h,d){if(typeof h=="object"&&h!==null){var _=c0.get(h);return _!==void 0?_:(d={value:h,source:d,stack:oe(d)},c0.set(h,d),d)}return{value:h,source:d,stack:oe(d)}}function ie(h,d){cl[Oo++]=Ef,cl[Oo++]=Qn,Qn=h,Ef=d}function B(h,d,_){Aa[Kr++]=Ps,Aa[Kr++]=$a,Aa[Kr++]=Ea,Ea=h;var T=Ps;h=$a;var N=32-Mr(T)-1;T&=~(1<<N),_+=1;var L=32-Mr(d)+N;if(30<L){var Z=N-N%5;L=(T&(1<<Z)-1).toString(32),T>>=Z,N-=Z,Ps=1<<32-Mr(d)+N|_<<N|T,$a=L+h}else Ps=1<<L|_<<N|T,$a=h}function Q(h){h.return!==null&&(ie(h,1),B(h,1,0))}function ae(h){for(;h===Qn;)Qn=cl[--Oo],cl[Oo]=null,Ef=cl[--Oo],cl[Oo]=null;for(;h===Ea;)Ea=Aa[--Kr],Aa[Kr]=null,$a=Aa[--Kr],Aa[Kr]=null,Ps=Aa[--Kr],Aa[Kr]=null}function fe(h,d){Aa[Kr++]=Ps,Aa[Kr++]=$a,Aa[Kr++]=Ea,Ps=d.id,$a=d.overflow,Ea=h}function de(h,d){b(Us,d),b(ul,h),b(ws,null),h=Ly(d),x(ws),b(ws,h)}function se(){x(ws),x(ul),x(Us)}function ce(h){h.memoizedState!==null&&b(Cf,h);var d=ws.current,_=nh(d,h.type);d!==_&&(b(ul,h),b(ws,_))}function pe(h){ul.current===h&&(x(ws),x(ul)),Cf.current===h&&(x(Cf),Vi?Jc._currentValue=Qc:Jc._currentValue2=Qc)}function Ie(h){var d=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ge(ne(d,h)),Cp}function Ye(h,d){if(!_i)throw Error(s(175));l_(h.stateNode,h.type,h.memoizedProps,d,h)||Ie(h,!0)}function et(h){for(us=h.return;us;)switch(us.tag){case 5:case 31:case 13:cr=!1;return;case 27:case 3:cr=!0;return;default:us=us.return}}function qe(h){if(!_i||h!==us)return!1;if(!bn)return et(h),bn=!0,!1;var d=h.tag;if(cs?d!==3&&d!==27&&(d!==5||rh(h.type)&&!lr(h.type,h.memoizedProps))&&xi&&Ie(h):d!==3&&(d!==5||rh(h.type)&&!lr(h.type,h.memoizedProps))&&xi&&Ie(h),et(h),d===13){if(!_i)throw Error(s(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));xi=Qg(h)}else if(d===31){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));xi=u_(h)}else xi=cs&&d===27?e_(h.type,xi):us?$y(h.stateNode):null;return!0}function dt(){_i&&(xi=us=null,bn=!1)}function De(){var h=Po;return h!==null&&(Er===null?Er=h:Er.push.apply(Er,h),Po=null),h}function ge(h){Po===null?Po=[h]:Po.push(h)}function ye(h,d,_){Vi?(b(Ca,d._currentValue),d._currentValue=_):(b(Ca,d._currentValue2),d._currentValue2=_)}function Ge(h){var d=Ca.current;Vi?h._currentValue=d:h._currentValue2=d,x(Ca)}function Y(h,d,_){for(;h!==null;){var T=h.alternate;if((h.childLanes&d)!==d?(h.childLanes|=d,T!==null&&(T.childLanes|=d)):T!==null&&(T.childLanes&d)!==d&&(T.childLanes|=d),h===_)break;h=h.return}}function Be(h,d,_,T){var N=h.child;for(N!==null&&(N.return=h);N!==null;){var L=N.dependencies;if(L!==null){var Z=N.child;L=L.firstContext;e:for(;L!==null;){var ve=L;L=N;for(var Ze=0;Ze<d.length;Ze++)if(ve.context===d[Ze]){L.lanes|=_,ve=L.alternate,ve!==null&&(ve.lanes|=_),Y(L.return,_,h),T||(Z=null);break e}L=ve.next}}else if(N.tag===18){if(Z=N.return,Z===null)throw Error(s(341));Z.lanes|=_,L=Z.alternate,L!==null&&(L.lanes|=_),Y(Z,_,h),Z=null}else Z=N.child;if(Z!==null)Z.return=N;else for(Z=N;Z!==null;){if(Z===h){Z=null;break}if(N=Z.sibling,N!==null){N.return=Z.return,Z=N;break}Z=Z.return}N=Z}}function Ne(h,d,_,T){h=null;for(var N=d,L=!1;N!==null;){if(!L){if((N.flags&524288)!==0)L=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var Z=N.alternate;if(Z===null)throw Error(s(387));if(Z=Z.memoizedProps,Z!==null){var ve=N.type;Hi(N.pendingProps.value,Z.value)||(h!==null?h.push(ve):h=[ve])}}else if(N===Cf.current){if(Z=N.alternate,Z===null)throw Error(s(387));Z.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(h!==null?h.push(Jc):h=[Jc])}N=N.return}h!==null&&Be(d,h,_,T),d.flags|=262144}function Me(h){for(h=h.firstContext;h!==null;){var d=h.context;if(!Hi(Vi?d._currentValue:d._currentValue2,h.memoizedValue))return!0;h=h.next}return!1}function Oe(h){ri=h,eo=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function q(h){return ue(ri,h)}function V(h,d){return ri===null&&Oe(h),ue(h,d)}function ue(h,d){var _=Vi?d._currentValue:d._currentValue2;if(d={context:d,memoizedValue:_,next:null},eo===null){if(h===null)throw Error(s(308));eo=d,h.dependencies={lanes:0,firstContext:d},h.flags|=524288}else eo=eo.next=d;return _}function Re(){return{controller:new T_,data:new Map,refCount:0}}function we(h){h.refCount--,h.refCount===0&&As(HS,function(){h.controller.abort()})}function be(){}function it(h){h!==qn&&h.next===null&&(qn===null?Rf=qn=h:qn=qn.next=h),Ra=!0,Ks||(Ks=!0,le())}function tt(h,d){if(!Rp&&Ra){Rp=!0;do for(var _=!1,T=Rf;T!==null;){if(h!==0){var N=T.pendingLanes;if(N===0)var L=0;else{var Z=T.suspendedLanes,ve=T.pingedLanes;L=(1<<31-Mr(42|h)+1)-1,L&=N&~(Z&~ve),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(_=!0,Qe(T,L))}else L=Sn,L=S(T,T===hn?L:0,T.cancelPendingCommit!==null||T.timeoutHandle!==Sr),(L&3)===0||C(T,L)||(_=!0,Qe(T,L));T=T.next}while(_);Rp=!1}}function ht(){yt()}function yt(){Ra=Ks=!1;var h=0;ic!==0&&Kc()&&(h=ic);for(var d=Zs(),_=null,T=Rf;T!==null;){var N=T.next,L=He(T,d);L===0?(T.next=null,_===null?Rf=N:_.next=N,N===null&&(qn=_)):(_=T,(h!==0||(L&3)!==0)&&(Ra=!0)),T=N}is!==0&&is!==5||tt(h),ic!==0&&(ic=0)}function He(h,d){for(var _=h.suspendedLanes,T=h.pingedLanes,N=h.expirationTimes,L=h.pendingLanes&-62914561;0<L;){var Z=31-Mr(L),ve=1<<Z,Ze=N[Z];Ze===-1?((ve&_)===0||(ve&T)!==0)&&(N[Z]=R(ve,d)):Ze<=d&&(h.expiredLanes|=ve),L&=~ve}if(d=hn,_=Sn,_=S(h,h===d?_:0,h.cancelPendingCommit!==null||h.timeoutHandle!==Sr),T=h.callbackNode,_===0||h===d&&(Yn===2||Yn===9)||h.cancelPendingCommit!==null)return T!==null&&T!==null&&Mp(T),h.callbackNode=null,h.callbackPriority=0;if((_&3)===0||C(h,_)){if(d=_&-_,d===h.callbackPriority)return d;switch(T!==null&&Mp(T),G(_)){case 2:case 8:_=S_;break;case 32:_=wf;break;case 268435456:_=wp;break;default:_=wf}return T=Xe.bind(null,h),_=Tf(_,T),h.callbackPriority=d,h.callbackNode=_,d}return T!==null&&T!==null&&Mp(T),h.callbackPriority=2,h.callbackNode=null,2}function Xe(h,d){if(is!==0&&is!==5)return h.callbackNode=null,h.callbackPriority=0,null;var _=h.callbackNode;if(Ro()&&h.callbackNode!==_)return null;var T=Sn;return T=S(h,h===hn?T:0,h.cancelPendingCommit!==null||h.timeoutHandle!==Sr),T===0?null:(Ja(h,T,d),He(h,Zs()),h.callbackNode!=null&&h.callbackNode===_?Xe.bind(null,h):null)}function Qe(h,d){if(Ro())return null;Ja(h,d,!0)}function le(){Ug?Lg(function(){(yn&6)!==0?Tf(Tp,ht):yt()}):Tf(Tp,ht)}function Te(){if(ic===0){var h=hl;h===0&&(h=Sp,Sp<<=1,(Sp&261888)===0&&(Sp=256)),ic=h}return ic}function ct(h,d){if(oh===null){var _=oh=[];u0=0,hl=Te(),hs={status:"pending",value:void 0,then:function(T){_.push(T)}}}return u0++,d.then(he,he),d}function he(){if(--u0===0&&oh!==null){hs!==null&&(hs.status="fulfilled");var h=oh;oh=null,hl=0,hs=null;for(var d=0;d<h.length;d++)(0,h[d])()}}function We(h,d){var _=[],T={status:"pending",value:null,reason:null,then:function(N){_.push(N)}};return h.then(function(){T.status="fulfilled",T.value=d;for(var N=0;N<_.length;N++)(0,_[N])(d)},function(N){for(T.status="rejected",T.reason=N,N=0;N<_.length;N++)(0,_[N])(void 0)}),T}function Je(){var h=sc.current;return h!==null?h:hn.pooledCache}function pt(h,d){d===null?b(sc,sc.current):b(sc,d.pool)}function $e(){var h=Je();return h===null?null:{parent:Vi?bi._currentValue:bi._currentValue2,pool:h}}function Le(h,d){if(Hi(h,d))return!0;if(typeof h!="object"||h===null||typeof d!="object"||d===null)return!1;var _=Object.keys(h),T=Object.keys(d);if(_.length!==T.length)return!1;for(T=0;T<_.length;T++){var N=_[T];if(!GS.call(d,N)||!Hi(h[N],d[N]))return!1}return!0}function rt(h){return h=h.status,h==="fulfilled"||h==="rejected"}function xt(h,d,_){switch(_=h[_],_===void 0?h.push(d):_!==d&&(d.then(be,be),d=_),d.status){case"fulfilled":return d.value;case"rejected":throw h=d.reason,pn(h),h;default:if(typeof d.status=="string")d.then(be,be);else{if(h=hn,h!==null&&100<h.shellSuspendCounter)throw Error(s(482));h=d,h.status="pending",h.then(function(T){if(d.status==="pending"){var N=d;N.status="fulfilled",N.value=T}},function(T){if(d.status==="pending"){var N=d;N.status="rejected",N.reason=T}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw h=d.reason,pn(h),h}throw ur=d,fs}}function _t(h){try{var d=h._init;return d(h._payload)}catch(_){throw _!==null&&typeof _=="object"&&typeof _.then=="function"?(ur=_,fs):_}}function Nt(){if(ur===null)throw Error(s(459));var h=ur;return ur=null,h}function pn(h){if(h===fs||h===Na)throw Error(s(483))}function Mn(h){var d=iu;return iu+=1,rc===null&&(rc=[]),xt(rc,h,d)}function Zn(h,d){d=d.props.ref,h.ref=d!==void 0?d:null}function Ji(h,d){throw d.$$typeof===jc?Error(s(525)):(h=Object.prototype.toString.call(d),Error(s(31,h==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":h)))}function Gs(h){function d(ke,Ce){if(h){var je=ke.deletions;je===null?(ke.deletions=[Ce],ke.flags|=16):je.push(Ce)}}function _(ke,Ce){if(!h)return null;for(;Ce!==null;)d(ke,Ce),Ce=Ce.sibling;return null}function T(ke){for(var Ce=new Map;ke!==null;)ke.key!==null?Ce.set(ke.key,ke):Ce.set(ke.index,ke),ke=ke.sibling;return Ce}function N(ke,Ce){return ke=Yr(ke,Ce),ke.index=0,ke.sibling=null,ke}function L(ke,Ce,je){return ke.index=je,h?(je=ke.alternate,je!==null?(je=je.index,je<Ce?(ke.flags|=67108866,Ce):je):(ke.flags|=67108866,Ce)):(ke.flags|=1048576,Ce)}function Z(ke){return h&&ke.alternate===null&&(ke.flags|=67108866),ke}function ve(ke,Ce,je,gt){return Ce===null||Ce.tag!==6?(Ce=Tg(je,ke.mode,gt),Ce.return=ke,Ce):(Ce=N(Ce,je),Ce.return=ke,Ce)}function Ze(ke,Ce,je,gt){var Gt=je.type;return Gt===Xc?vt(ke,Ce,je.props.children,gt,je.key):Ce!==null&&(Ce.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===or&&_t(Gt)===Ce.type)?(Ce=N(Ce,je.props),Zn(Ce,je),Ce.return=ke,Ce):(Ce=sl(je.type,je.key,je.props,null,ke.mode,gt),Zn(Ce,je),Ce.return=ke,Ce)}function lt(ke,Ce,je,gt){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==je.containerInfo||Ce.stateNode.implementation!==je.implementation?(Ce=Ag(je,ke.mode,gt),Ce.return=ke,Ce):(Ce=N(Ce,je.children||[]),Ce.return=ke,Ce)}function vt(ke,Ce,je,gt,Gt){return Ce===null||Ce.tag!==7?(Ce=Sa(je,ke.mode,gt,Gt),Ce.return=ke,Ce):(Ce=N(Ce,je),Ce.return=ke,Ce)}function ft(ke,Ce,je){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=Tg(""+Ce,ke.mode,je),Ce.return=ke,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case Do:return je=sl(Ce.type,Ce.key,Ce.props,null,ke.mode,je),Zn(je,Ce),je.return=ke,je;case qc:return Ce=Ag(Ce,ke.mode,je),Ce.return=ke,Ce;case or:return Ce=_t(Ce),ft(ke,Ce,je)}if($l(Ce)||p(Ce))return Ce=Sa(Ce,ke.mode,je,null),Ce.return=ke,Ce;if(typeof Ce.then=="function")return ft(ke,Mn(Ce),je);if(Ce.$$typeof===Ma)return ft(ke,V(ke,Ce),je);Ji(ke,Ce)}return null}function At(ke,Ce,je,gt){var Gt=Ce!==null?Ce.key:null;if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return Gt!==null?null:ve(ke,Ce,""+je,gt);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case Do:return je.key===Gt?Ze(ke,Ce,je,gt):null;case qc:return je.key===Gt?lt(ke,Ce,je,gt):null;case or:return je=_t(je),At(ke,Ce,je,gt)}if($l(je)||p(je))return Gt!==null?null:vt(ke,Ce,je,gt,null);if(typeof je.then=="function")return At(ke,Ce,Mn(je),gt);if(je.$$typeof===Ma)return At(ke,Ce,V(ke,je),gt);Ji(ke,je)}return null}function tn(ke,Ce,je,gt,Gt){if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return ke=ke.get(je)||null,ve(Ce,ke,""+gt,Gt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case Do:return ke=ke.get(gt.key===null?je:gt.key)||null,Ze(Ce,ke,gt,Gt);case qc:return ke=ke.get(gt.key===null?je:gt.key)||null,lt(Ce,ke,gt,Gt);case or:return gt=_t(gt),tn(ke,Ce,je,gt,Gt)}if($l(gt)||p(gt))return ke=ke.get(je)||null,vt(Ce,ke,gt,Gt,null);if(typeof gt.then=="function")return tn(ke,Ce,je,Mn(gt),Gt);if(gt.$$typeof===Ma)return tn(ke,Ce,je,V(Ce,gt),Gt);Ji(Ce,gt)}return null}function qi(ke,Ce,je,gt){for(var Gt=null,Ri=null,Wt=Ce,Nn=Ce=0,Es=null;Wt!==null&&Nn<je.length;Nn++){Wt.index>Nn?(Es=Wt,Wt=null):Es=Wt.sibling;var Ln=At(ke,Wt,je[Nn],gt);if(Ln===null){Wt===null&&(Wt=Es);break}h&&Wt&&Ln.alternate===null&&d(ke,Wt),Ce=L(Ln,Ce,Nn),Ri===null?Gt=Ln:Ri.sibling=Ln,Ri=Ln,Wt=Es}if(Nn===je.length)return _(ke,Wt),bn&&ie(ke,Nn),Gt;if(Wt===null){for(;Nn<je.length;Nn++)Wt=ft(ke,je[Nn],gt),Wt!==null&&(Ce=L(Wt,Ce,Nn),Ri===null?Gt=Wt:Ri.sibling=Wt,Ri=Wt);return bn&&ie(ke,Nn),Gt}for(Wt=T(Wt);Nn<je.length;Nn++)Es=tn(Wt,ke,Nn,je[Nn],gt),Es!==null&&(h&&Es.alternate!==null&&Wt.delete(Es.key===null?Nn:Es.key),Ce=L(Es,Ce,Nn),Ri===null?Gt=Es:Ri.sibling=Es,Ri=Es);return h&&Wt.forEach(function(Pa){return d(ke,Pa)}),bn&&ie(ke,Nn),Gt}function mh(ke,Ce,je,gt){if(je==null)throw Error(s(151));for(var Gt=null,Ri=null,Wt=Ce,Nn=Ce=0,Es=null,Ln=je.next();Wt!==null&&!Ln.done;Nn++,Ln=je.next()){Wt.index>Nn?(Es=Wt,Wt=null):Es=Wt.sibling;var Pa=At(ke,Wt,Ln.value,gt);if(Pa===null){Wt===null&&(Wt=Es);break}h&&Wt&&Pa.alternate===null&&d(ke,Wt),Ce=L(Pa,Ce,Nn),Ri===null?Gt=Pa:Ri.sibling=Pa,Ri=Pa,Wt=Es}if(Ln.done)return _(ke,Wt),bn&&ie(ke,Nn),Gt;if(Wt===null){for(;!Ln.done;Nn++,Ln=je.next())Ln=ft(ke,Ln.value,gt),Ln!==null&&(Ce=L(Ln,Ce,Nn),Ri===null?Gt=Ln:Ri.sibling=Ln,Ri=Ln);return bn&&ie(ke,Nn),Gt}for(Wt=T(Wt);!Ln.done;Nn++,Ln=je.next())Ln=tn(Wt,ke,Nn,Ln.value,gt),Ln!==null&&(h&&Ln.alternate!==null&&Wt.delete(Ln.key===null?Nn:Ln.key),Ce=L(Ln,Ce,Nn),Ri===null?Gt=Ln:Ri.sibling=Ln,Ri=Ln);return h&&Wt.forEach(function(WS){return d(ke,WS)}),bn&&ie(ke,Nn),Gt}function dc(ke,Ce,je,gt){if(typeof je=="object"&&je!==null&&je.type===Xc&&je.key===null&&(je=je.props.children),typeof je=="object"&&je!==null){switch(je.$$typeof){case Do:e:{for(var Gt=je.key;Ce!==null;){if(Ce.key===Gt){if(Gt=je.type,Gt===Xc){if(Ce.tag===7){_(ke,Ce.sibling),gt=N(Ce,je.props.children),gt.return=ke,ke=gt;break e}}else if(Ce.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===or&&_t(Gt)===Ce.type){_(ke,Ce.sibling),gt=N(Ce,je.props),Zn(gt,je),gt.return=ke,ke=gt;break e}_(ke,Ce);break}else d(ke,Ce);Ce=Ce.sibling}je.type===Xc?(gt=Sa(je.props.children,ke.mode,gt,je.key),gt.return=ke,ke=gt):(gt=sl(je.type,je.key,je.props,null,ke.mode,gt),Zn(gt,je),gt.return=ke,ke=gt)}return Z(ke);case qc:e:{for(Gt=je.key;Ce!==null;){if(Ce.key===Gt)if(Ce.tag===4&&Ce.stateNode.containerInfo===je.containerInfo&&Ce.stateNode.implementation===je.implementation){_(ke,Ce.sibling),gt=N(Ce,je.children||[]),gt.return=ke,ke=gt;break e}else{_(ke,Ce);break}else d(ke,Ce);Ce=Ce.sibling}gt=Ag(je,ke.mode,gt),gt.return=ke,ke=gt}return Z(ke);case or:return je=_t(je),dc(ke,Ce,je,gt)}if($l(je))return qi(ke,Ce,je,gt);if(p(je)){if(Gt=p(je),typeof Gt!="function")throw Error(s(150));return je=Gt.call(je),mh(ke,Ce,je,gt)}if(typeof je.then=="function")return dc(ke,Ce,Mn(je),gt);if(je.$$typeof===Ma)return dc(ke,Ce,V(ke,je),gt);Ji(ke,je)}return typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint"?(je=""+je,Ce!==null&&Ce.tag===6?(_(ke,Ce.sibling),gt=N(Ce,je),gt.return=ke,ke=gt):(_(ke,Ce),gt=Tg(je,ke.mode,gt),gt.return=ke,ke=gt),Z(ke)):_(ke,Ce)}return function(ke,Ce,je,gt){try{iu=0;var Gt=dc(ke,Ce,je,gt);return rc=null,Gt}catch(Wt){if(Wt===fs||Wt===Na)throw Wt;var Ri=t(29,Wt,null,ke.mode);return Ri.lanes=gt,Ri.return=ke,Ri}}}function ys(){for(var h=Lo,d=su=Lo=0;d<h;){var _=Fs[d];Fs[d++]=null;var T=Fs[d];Fs[d++]=null;var N=Fs[d];Fs[d++]=null;var L=Fs[d];if(Fs[d++]=null,T!==null&&N!==null){var Z=T.pending;Z===null?N.next=N:(N.next=Z.next,Z.next=N),T.pending=N}L!==0&&jn(_,N,L)}}function _s(h,d,_,T){Fs[Lo++]=h,Fs[Lo++]=d,Fs[Lo++]=_,Fs[Lo++]=T,su|=T,h.lanes|=T,h=h.alternate,h!==null&&(h.lanes|=T)}function nr(h,d,_,T){return _s(h,d,_,T),Fn(h)}function ni(h,d){return _s(h,null,null,d),Fn(h)}function jn(h,d,_){h.lanes|=_;var T=h.alternate;T!==null&&(T.lanes|=_);for(var N=!1,L=h.return;L!==null;)L.childLanes|=_,T=L.alternate,T!==null&&(T.childLanes|=_),L.tag===22&&(h=L.stateNode,h===null||h._visibility&1||(N=!0)),h=L,L=L.return;return h.tag===3?(L=h.stateNode,N&&d!==null&&(N=31-Mr(_),h=L.hiddenUpdates,T=h[N],T===null?h[N]=[d]:T.push(d),d.lane=_|536870912),L):null}function Fn(h){if(50<Un)throw Un=0,Uf=null,Error(s(185));for(var d=h.return;d!==null;)h=d,d=h.return;return h.tag===3?h.stateNode:null}function Ni(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ns(h,d){h=h.updateQueue,d.updateQueue===h&&(d.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function ir(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function Hs(h,d,_){var T=h.updateQueue;if(T===null)return null;if(T=T.shared,(yn&2)!==0){var N=T.pending;return N===null?d.next=d:(d.next=N.next,N.next=d),T.pending=d,d=Fn(h),jn(h,null,_),d}return _s(h,T,d,_),Fn(h)}function zr(h,d,_){if(d=d.updateQueue,d!==null&&(d=d.shared,(_&4194048)!==0)){var T=d.lanes;T&=h.pendingLanes,_|=T,d.lanes=_,P(h,_)}}function Xa(h,d){var _=h.updateQueue,T=h.alternate;if(T!==null&&(T=T.updateQueue,_===T)){var N=null,L=null;if(_=_.firstBaseUpdate,_!==null){do{var Z={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};L===null?N=L=Z:L=L.next=Z,_=_.next}while(_!==null);L===null?N=L=d:L=L.next=d}else N=L=d;_={baseState:T.baseState,firstBaseUpdate:N,lastBaseUpdate:L,shared:T.shared,callbacks:T.callbacks},h.updateQueue=_;return}h=_.lastBaseUpdate,h===null?_.firstBaseUpdate=d:h.next=d,_.lastBaseUpdate=d}function Vr(){if(Np){var h=hs;if(h!==null)throw h}}function fa(h,d,_,T){Np=!1;var N=h.updateQueue;Qr=!1;var L=N.firstBaseUpdate,Z=N.lastBaseUpdate,ve=N.shared.pending;if(ve!==null){N.shared.pending=null;var Ze=ve,lt=Ze.next;Ze.next=null,Z===null?L=lt:Z.next=lt,Z=Ze;var vt=h.alternate;vt!==null&&(vt=vt.updateQueue,ve=vt.lastBaseUpdate,ve!==Z&&(ve===null?vt.firstBaseUpdate=lt:ve.next=lt,vt.lastBaseUpdate=Ze))}if(L!==null){var ft=N.baseState;Z=0,vt=lt=Ze=null,ve=L;do{var At=ve.lane&-536870913,tn=At!==ve.lane;if(tn?(Sn&At)===At:(T&At)===At){At!==0&&At===hl&&(Np=!0),vt!==null&&(vt=vt.next={lane:0,tag:ve.tag,payload:ve.payload,callback:null,next:null});e:{var qi=h,mh=ve;At=d;var dc=_;switch(mh.tag){case 1:if(qi=mh.payload,typeof qi=="function"){ft=qi.call(dc,ft,At);break e}ft=qi;break e;case 3:qi.flags=qi.flags&-65537|128;case 0:if(qi=mh.payload,At=typeof qi=="function"?qi.call(dc,ft,At):qi,At==null)break e;ft=rp({},ft,At);break e;case 2:Qr=!0}}At=ve.callback,At!==null&&(h.flags|=64,tn&&(h.flags|=8192),tn=N.callbacks,tn===null?N.callbacks=[At]:tn.push(At))}else tn={lane:At,tag:ve.tag,payload:ve.payload,callback:ve.callback,next:null},vt===null?(lt=vt=tn,Ze=ft):vt=vt.next=tn,Z|=At;if(ve=ve.next,ve===null){if(ve=N.shared.pending,ve===null)break;tn=ve,ve=tn.next,tn.next=null,N.lastBaseUpdate=tn,N.shared.pending=null}}while(!0);vt===null&&(Ze=ft),N.baseState=Ze,N.firstBaseUpdate=lt,N.lastBaseUpdate=vt,L===null&&(N.shared.lanes=0),dl|=Z,h.lanes=Z,h.memoizedState=ft}}function vr(h,d){if(typeof h!="function")throw Error(s(191,h));h.call(d)}function Gr(h,d){var _=h.callbacks;if(_!==null)for(h.callbacks=null,h=0;h<_.length;h++)vr(_[h],d)}function da(h,d){h=ko,b(ac,h),b(ru,d),ko=h|d.baseLanes}function Dt(){b(ac,ko),b(ru,ru.current)}function J(){ko=ac.current,x(ru),x(ac)}function Se(h){var d=h.alternate;b(Pi,Pi.current&1),b(wr,h),Ar===null&&(d===null||ru.current!==null||d.memoizedState!==null)&&(Ar=h)}function ze(h){b(Pi,Pi.current),b(wr,h),Ar===null&&(Ar=h)}function Pe(h){h.tag===22?(b(Pi,Pi.current),b(wr,h),Ar===null&&(Ar=h)):Ae()}function Ae(){b(Pi,Pi.current),b(wr,wr.current)}function mt(h){x(wr),Ar===h&&(Ar=null),x(Pi)}function Mt(h){for(var d=h;d!==null;){if(d.tag===13){var _=d.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||tc(_)||dp(_)))return d}else if(d.tag===19&&(d.memoizedProps.revealOrder==="forwards"||d.memoizedProps.revealOrder==="backwards"||d.memoizedProps.revealOrder==="unstable_legacy-backwards"||d.memoizedProps.revealOrder==="together")){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===h)break;for(;d.sibling===null;){if(d.return===null||d.return===h)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function ut(){throw Error(s(321))}function Et(h,d){if(d===null)return!1;for(var _=0;_<d.length&&_<h.length;_++)if(!Hi(h[_],d[_]))return!1;return!0}function Ct(h,d,_,T,N,L){return fl=L,rn=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,zt.H=h===null||h.memoizedState===null?Ai:Fo,Rn=!1,L=_(T,N),Rn=!1,ln&&(L=Rt(d,_,T,N)),Ft(h),L}function Ft(h){zt.H=Jr;var d=Lt!==null&&Lt.next!==null;if(fl=0,Jt=Lt=rn=null,un=!1,Ia=0,to=null,d)throw Error(s(300));h===null||hi||(h=h.dependencies,h!==null&&Me(h)&&(hi=!0))}function Rt(h,d,_,T){rn=h;var N=0;do{if(ln&&(to=null),Ia=0,ln=!1,25<=N)throw Error(s(301));if(N+=1,Jt=Lt=null,h.updateQueue!=null){var L=h.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}zt.H=oc,L=d(_,T)}while(ln);return L}function Bt(){var h=zt.H,d=h.useState()[0];return d=typeof d.then=="function"?Pt(d):d,h=h.useState()[0],(Lt!==null?Lt.memoizedState:null)!==h&&(rn.flags|=1024),d}function mn(){var h=Qs!==0;return Qs=0,h}function Vn(h,d,_){d.updateQueue=h.updateQueue,d.flags&=-2053,h.lanes&=~_}function Cn(h){if(un){for(h=h.memoizedState;h!==null;){var d=h.queue;d!==null&&(d.pending=null),h=h.next}un=!1}fl=0,Jt=Lt=rn=null,ln=!1,Ia=Qs=0,to=null}function Xt(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?rn.memoizedState=Jt=h:Jt=Jt.next=h,Jt}function bt(){if(Lt===null){var h=rn.alternate;h=h!==null?h.memoizedState:null}else h=Lt.next;var d=Jt===null?rn.memoizedState:Jt.next;if(d!==null)Jt=d,Lt=h;else{if(h===null)throw rn.alternate===null?Error(s(467)):Error(s(310));Lt=h,h={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},Jt===null?rn.memoizedState=Jt=h:Jt=Jt.next=h}return Jt}function vn(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pt(h){var d=Ia;return Ia+=1,to===null&&(to=[]),h=xt(to,h,d),d=rn,(Jt===null?d.memoizedState:Jt.next)===null&&(d=d.alternate,zt.H=d===null||d.memoizedState===null?Ai:Fo),h}function Ii(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return Pt(h);if(h.$$typeof===Ma)return q(h)}throw Error(s(438,String(h)))}function Ws(h){var d=null,_=rn.updateQueue;if(_!==null&&(d=_.memoCache),d==null){var T=rn.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(d={data:T.data.map(function(N){return N.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),_===null&&(_=vn(),rn.updateQueue=_),_.memoCache=d,_=d.data[d.index],_===void 0)for(_=d.data[d.index]=Array(h),T=0;T<h;T++)_[T]=Cg;return d.index++,_}function kn(h,d){return typeof d=="function"?d(h):d}function xs(h){var d=bt();return Tn(d,Lt,h)}function Tn(h,d,_){var T=h.queue;if(T===null)throw Error(s(311));T.lastRenderedReducer=_;var N=h.baseQueue,L=T.pending;if(L!==null){if(N!==null){var Z=N.next;N.next=L.next,L.next=Z}d.baseQueue=N=L,T.pending=null}if(L=h.baseState,N===null)h.memoizedState=L;else{d=N.next;var ve=Z=null,Ze=null,lt=d,vt=!1;do{var ft=lt.lane&-536870913;if(ft!==lt.lane?(Sn&ft)===ft:(fl&ft)===ft){var At=lt.revertLane;if(At===0)Ze!==null&&(Ze=Ze.next={lane:0,revertLane:0,gesture:null,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null}),ft===hl&&(vt=!0);else if((fl&At)===At){lt=lt.next,At===hl&&(vt=!0);continue}else ft={lane:0,revertLane:lt.revertLane,gesture:null,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Ze===null?(ve=Ze=ft,Z=L):Ze=Ze.next=ft,rn.lanes|=At,dl|=At;ft=lt.action,Rn&&_(L,ft),L=lt.hasEagerState?lt.eagerState:_(L,ft)}else At={lane:ft,revertLane:lt.revertLane,gesture:lt.gesture,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Ze===null?(ve=Ze=At,Z=L):Ze=Ze.next=At,rn.lanes|=ft,dl|=ft;lt=lt.next}while(lt!==null&&lt!==d);if(Ze===null?Z=L:Ze.next=ve,!Hi(L,h.memoizedState)&&(hi=!0,vt&&(_=hs,_!==null)))throw _;h.memoizedState=L,h.baseState=Z,h.baseQueue=Ze,T.lastRenderedState=L}return N===null&&(T.lanes=0),[h.memoizedState,T.dispatch]}function mi(h){var d=bt(),_=d.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=h;var T=_.dispatch,N=_.pending,L=d.memoizedState;if(N!==null){_.pending=null;var Z=N=N.next;do L=h(L,Z.action),Z=Z.next;while(Z!==N);Hi(L,d.memoizedState)||(hi=!0),d.memoizedState=L,d.baseQueue===null&&(d.baseState=L),_.lastRenderedState=L}return[L,T]}function gi(h,d,_){var T=rn,N=bt(),L=bn;if(L){if(_===void 0)throw Error(s(407));_=_()}else _=d();var Z=!Hi((Lt||N).memoizedState,_);if(Z&&(N.memoizedState=_,hi=!0),N=N.queue,ga(Ya.bind(null,T,N,h),[h]),N.getSnapshot!==d||Z||Jt!==null&&Jt.memoizedState.tag&1){if(T.flags|=2048,qs(9,{destroy:void 0},zi.bind(null,T,N,_,d),null),hn===null)throw Error(s(349));L||(fl&127)!==0||Bi(T,d,_)}return _}function Bi(h,d,_){h.flags|=16384,h={getSnapshot:d,value:_},d=rn.updateQueue,d===null?(d=vn(),rn.updateQueue=d,d.stores=[h]):(_=d.stores,_===null?d.stores=[h]:_.push(h))}function zi(h,d,_,T){d.value=_,d.getSnapshot=T,bs(d)&&ef(h)}function Ya(h,d,_){return _(function(){bs(d)&&ef(h)})}function bs(h){var d=h.getSnapshot;h=h.value;try{var _=d();return!Hi(h,_)}catch{return!0}}function ef(h){var d=ni(h,2);d!==null&&Ti(d,h,2)}function Pl(h){var d=Xt();if(typeof h=="function"){var _=h;if(h=_(),Rn){j(!0);try{_()}finally{j(!1)}}}return d.memoizedState=d.baseState=h,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kn,lastRenderedState:h},d}function pa(h,d,_,T){return h.baseState=_,Tn(h,Lt,typeof T=="function"?T:kn)}function js(h,d,_,T,N){if(Bd(h))throw Error(s(485));if(h=d.action,h!==null){var L={payload:N,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){L.listeners.push(Z)}};zt.T!==null?_(!0):L.isTransition=!1,T(L),_=d.pending,_===null?(L.next=d.pending=L,fo(d,L)):(L.next=_.next,d.pending=_.next=L)}}function fo(h,d){var _=d.action,T=d.payload,N=h.state;if(d.isTransition){var L=zt.T,Z={};zt.T=Z;try{var ve=_(N,T),Ze=zt.S;Ze!==null&&Ze(Z,ve),Ic(h,d,ve)}catch(lt){ma(h,d,lt)}finally{L!==null&&Z.types!==null&&(L.types=Z.types),zt.T=L}}else try{L=_(N,T),Ic(h,d,L)}catch(lt){ma(h,d,lt)}}function Ic(h,d,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(T){Hr(h,d,T)},function(T){return ma(h,d,T)}):Hr(h,d,_)}function Hr(h,d,_){d.status="fulfilled",d.value=_,Oc(d),h.state=_,d=h.pending,d!==null&&(_=d.next,_===d?h.pending=null:(_=_.next,d.next=_,fo(h,_)))}function ma(h,d,_){var T=h.pending;if(h.pending=null,T!==null){T=T.next;do d.status="rejected",d.reason=_,Oc(d),d=d.next;while(d!==T)}h.action=null}function Oc(h){h=h.listeners;for(var d=0;d<h.length;d++)(0,h[d])()}function Pc(h,d){return d}function Ul(h,d){if(bn){var _=hn.formState;if(_!==null){e:{var T=rn;if(bn){if(xi){var N=Jy(xi,cr);if(N){xi=$y(N),T=Xg(N);break e}}Ie(T)}T=!1}T&&(d=_[0])}}_=Xt(),_.memoizedState=_.baseState=d,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pc,lastRenderedState:d},_.queue=T,_=Qa.bind(null,rn,T),T.dispatch=_,T=Pl(!1);var L=kd.bind(null,rn,!1,T.queue);return T=Xt(),N={state:d,dispatch:null,action:h,pending:null},T.queue=N,_=js.bind(null,rn,N,L,_),N.dispatch=_,T.memoizedState=h,[d,_,!1]}function po(h){var d=bt();return Wr(d,Lt,h)}function Wr(h,d,_){if(d=Tn(h,d,Pc)[0],h=xs(kn)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var T=Pt(d)}catch(Z){throw Z===fs?Na:Z}else T=d;d=bt();var N=d.queue,L=N.dispatch;return _!==d.memoizedState&&(rn.flags|=2048,qs(9,{destroy:void 0},sr.bind(null,N,_),null)),[T,L,h]}function sr(h,d){h.action=d}function mo(h){var d=bt(),_=Lt;if(_!==null)return Wr(d,_,h);bt(),d=d.memoizedState,_=bt();var T=_.queue.dispatch;return _.memoizedState=h,[d,T,!1]}function qs(h,d,_,T){return h={tag:h,create:_,deps:T,inst:d,next:null},d=rn.updateQueue,d===null&&(d=vn(),rn.updateQueue=d),_=d.lastEffect,_===null?d.lastEffect=h.next=h:(T=_.next,_.next=h,h.next=T,d.lastEffect=h),h}function Uc(){return bt().memoizedState}function Za(h,d,_,T){var N=Xt();rn.flags|=h,N.memoizedState=qs(1|d,{destroy:void 0},_,T===void 0?null:T)}function Ll(h,d,_,T){var N=bt();T=T===void 0?null:T;var L=N.memoizedState.inst;Lt!==null&&T!==null&&Et(T,Lt.memoizedState.deps)?N.memoizedState=qs(d,L,_,T):(rn.flags|=h,N.memoizedState=qs(1|d,L,_,T))}function Fl(h,d){Za(8390656,8,h,d)}function ga(h,d){Ll(2048,8,h,d)}function kl(h){rn.flags|=4;var d=rn.updateQueue;if(d===null)d=vn(),rn.updateQueue=d,d.events=[h];else{var _=d.events;_===null?d.events=[h]:_.push(h)}}function vi(h){var d=bt().memoizedState;return kl({ref:d,nextImpl:h}),function(){if((yn&2)!==0)throw Error(s(440));return d.impl.apply(void 0,arguments)}}function Ka(h,d){return Ll(4,2,h,d)}function Jo(h,d){return Ll(4,4,h,d)}function go(h,d){if(typeof d=="function"){h=h();var _=d(h);return function(){typeof _=="function"?_():d(null)}}if(d!=null)return h=h(),d.current=h,function(){d.current=null}}function Bl(h,d,_){_=_!=null?_.concat([h]):null,Ll(4,4,go.bind(null,d,h),_)}function zl(){}function vo(h,d){var _=bt();d=d===void 0?null:d;var T=_.memoizedState;return d!==null&&Et(d,T[1])?T[0]:(_.memoizedState=[h,d],h)}function yo(h,d){var _=bt();d=d===void 0?null:d;var T=_.memoizedState;if(d!==null&&Et(d,T[1]))return T[0];if(T=h(),Rn){j(!0);try{h()}finally{j(!1)}}return _.memoizedState=[T,d],T}function $i(h,d,_){return _===void 0||(fl&1073741824)!==0&&(Sn&261930)===0?h.memoizedState=d:(h.memoizedState=_,h=tl(),rn.lanes|=h,dl|=h,_)}function tf(h,d,_,T){return Hi(_,d)?_:ru.current!==null?(h=$i(h,_,T),Hi(h,d)||(hi=!0),h):(fl&42)===0||(fl&1073741824)!==0&&(Sn&261930)===0?(hi=!0,h.memoizedState=_):(h=tl(),rn.lanes|=h,dl|=h,d)}function Lc(h,d,_,T,N){var L=Ta();xn(L!==0&&8>L?L:8);var Z=zt.T,ve={};zt.T=ve,kd(h,!1,d,_);try{var Ze=N(),lt=zt.S;if(lt!==null&&lt(ve,Ze),Ze!==null&&typeof Ze=="object"&&typeof Ze.then=="function"){var vt=We(Ze,T);Vl(h,d,vt,yi(h))}else Vl(h,d,T,yi(h))}catch(ft){Vl(h,d,{then:function(){},status:"rejected",reason:ft},yi())}finally{xn(L),Z!==null&&ve.types!==null&&(Z.types=ve.types),zt.T=Z}}function Fc(h){var d=h.memoizedState;if(d!==null)return d;d={memoizedState:Qc,baseState:Qc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:kn,lastRenderedState:Qc},next:null};var _={};return d.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:kn,lastRenderedState:_},next:null},h.memoizedState=d,h=h.alternate,h!==null&&(h.memoizedState=d),d}function Fu(){return q(Jc)}function ku(){return bt().memoizedState}function Is(){return bt().memoizedState}function jr(h){for(var d=h.return;d!==null;){switch(d.tag){case 24:case 3:var _=yi();h=ir(_);var T=Hs(d,h,_);T!==null&&(Ti(T,d,_),zr(T,d,_)),d={cache:Re()},h.payload=d;return}d=d.return}}function Xs(h,d,_){var T=yi();_={lane:T,revertLane:0,gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},Bd(h)?hy(d,_):(_=nr(h,d,_,T),_!==null&&(Ti(_,h,T),fy(_,d,T)))}function Qa(h,d,_){var T=yi();Vl(h,d,_,T)}function Vl(h,d,_,T){var N={lane:T,revertLane:0,gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null};if(Bd(h))hy(d,N);else{var L=h.alternate;if(h.lanes===0&&(L===null||L.lanes===0)&&(L=d.lastRenderedReducer,L!==null))try{var Z=d.lastRenderedState,ve=L(Z,_);if(N.hasEagerState=!0,N.eagerState=ve,Hi(ve,Z))return _s(h,d,N,0),hn===null&&ys(),!1}catch{}if(_=nr(h,d,N,T),_!==null)return Ti(_,h,T),fy(_,d,T),!0}return!1}function kd(h,d,_,T){if(T={lane:2,revertLane:Te(),gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},Bd(h)){if(d)throw Error(s(479))}else d=nr(h,_,T,2),d!==null&&Ti(d,h,2)}function Bd(h){var d=h.alternate;return h===rn||d!==null&&d===rn}function hy(h,d){ln=un=!0;var _=h.pending;_===null?d.next=d:(d.next=_.next,_.next=d),h.pending=d}function fy(h,d,_){if((_&4194048)!==0){var T=d.lanes;T&=h.pendingLanes,_|=T,d.lanes=_,P(h,_)}}function rg(h,d,_,T){d=h.memoizedState,_=_(T,d),_=_==null?d:rp({},d,_),h.memoizedState=_,h.lanes===0&&(h.updateQueue.baseState=_)}function zd(h,d,_,T,N,L,Z){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(T,L,Z):d.prototype&&d.prototype.isPureReactComponent?!Le(_,T)||!Le(N,L):!0}function dy(h,d,_,T){h=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(_,T),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(_,T),d.state!==h&&Df.enqueueReplaceState(d,d.state,null)}function kc(h,d){var _=d;if("ref"in d){_={};for(var T in d)T!=="ref"&&(_[T]=d[T])}if(h=h.defaultProps){_===d&&(_=rp({},_));for(var N in h)_[N]===void 0&&(_[N]=h[N])}return _}function Vd(h,d){try{var _=h.onUncaughtError;_(d.value,{componentStack:d.stack})}catch(T){setTimeout(function(){throw T})}}function ag(h,d,_){try{var T=h.onCaughtError;T(_.value,{componentStack:_.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function og(h,d,_){return _=ir(_),_.tag=3,_.payload={element:null},_.callback=function(){Vd(h,d)},_}function py(h){return h=ir(h),h.tag=3,h}function my(h,d,_,T){var N=_.type.getDerivedStateFromError;if(typeof N=="function"){var L=T.value;h.payload=function(){return N(L)},h.callback=function(){ag(d,_,T)}}var Z=_.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(h.callback=function(){ag(d,_,T),typeof N!="function"&&(pl===null?pl=new Set([this]):pl.add(this));var ve=T.stack;this.componentDidCatch(T.value,{componentStack:ve!==null?ve:""})})}function PS(h,d,_,T,N){if(_.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(d=_.alternate,d!==null&&Ne(d,_,N,!0),_=wr.current,_!==null){switch(_.tag){case 31:case 13:return Ar===null?Zu():_.alternate===null&&Ci===0&&(Ci=3),_.flags&=-257,_.flags|=65536,_.lanes=N,T===Uo?_.flags|=16384:(d=_.updateQueue,d===null?_.updateQueue=new Set([T]):d.add(T),Ju(h,T,N)),!1;case 22:return _.flags|=65536,T===Uo?_.flags|=16384:(d=_.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([T])},_.updateQueue=d):(_=d.retryQueue,_===null?d.retryQueue=new Set([T]):_.add(T)),Ju(h,T,N)),!1}throw Error(s(435,_.tag))}return Ju(h,T,N),Zu(),!1}if(bn)return d=wr.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=N,T!==Cp&&(h=Error(s(422),{cause:T}),ge(ne(h,_)))):(T!==Cp&&(d=Error(s(423),{cause:T}),ge(ne(d,_))),h=h.current.alternate,h.flags|=65536,N&=-N,h.lanes|=N,T=ne(T,_),N=og(h.stateNode,T,N),Xa(h,N),Ci!==4&&(Ci=2)),!1;var L=Error(s(520),{cause:T});if(L=ne(L,_),If===null?If=[L]:If.push(L),Ci!==4&&(Ci=2),d===null)return!0;T=ne(T,_),_=d;do{switch(_.tag){case 3:return _.flags|=65536,h=N&-N,_.lanes|=h,h=og(_.stateNode,T,h),Xa(_,h),!1;case 1:if(d=_.type,L=_.stateNode,(_.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(pl===null||!pl.has(L))))return _.flags|=65536,N&=-N,_.lanes|=N,N=py(N),my(N,h,_,T),Xa(_,N),!1}_=_.return}while(_!==null);return!1}function Os(h,d,_,T){d.child=h===null?h0(d,null,_,T):Ls(d,h.child,_,T)}function gy(h,d,_,T,N){_=_.render;var L=d.ref;if("ref"in T){var Z={};for(var ve in T)ve!=="ref"&&(Z[ve]=T[ve])}else Z=T;return Oe(d),T=Ct(h,d,_,Z,L,N),ve=mn(),h!==null&&!hi?(Vn(h,d,N),_o(h,d,N)):(bn&&ve&&Q(d),d.flags|=1,Os(h,d,T,N),d.child)}function vy(h,d,_,T,N){if(h===null){var L=_.type;return typeof L=="function"&&!Hc(L)&&L.defaultProps===void 0&&_.compare===null?(d.tag=15,d.type=L,yy(h,d,L,T,N)):(h=sl(_.type,null,T,d,d.mode,N),h.ref=d.ref,h.return=d,d.child=h)}if(L=h.child,!sf(h,N)){var Z=L.memoizedProps;if(_=_.compare,_=_!==null?_:Le,_(Z,T)&&h.ref===d.ref)return _o(h,d,N)}return d.flags|=1,h=Yr(L,T),h.ref=d.ref,h.return=d,d.child=h}function yy(h,d,_,T,N){if(h!==null){var L=h.memoizedProps;if(Le(L,T)&&h.ref===d.ref)if(hi=!1,d.pendingProps=T=L,sf(h,N))(h.flags&131072)!==0&&(hi=!0);else return d.lanes=h.lanes,_o(h,d,N)}return Hd(h,d,_,T,N)}function _y(h,d,_,T){var N=T.children,L=h!==null?h.memoizedState:null;if(h===null&&d.stateNode===null&&(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),T.mode==="hidden"){if((d.flags&128)!==0){if(L=L!==null?L.baseLanes|_:_,h!==null){for(T=d.child=h.child,N=0;T!==null;)N=N|T.lanes|T.childLanes,T=T.sibling;T=N&~L}else T=0,d.child=null;return Bu(h,d,L,_,T)}if((_&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},h!==null&&pt(d,L!==null?L.cachePool:null),L!==null?da(d,L):Dt(),Pe(d);else return T=d.lanes=536870912,Bu(h,d,L!==null?L.baseLanes|_:_,_,T)}else L!==null?(pt(d,L.cachePool),da(d,L),Ae(),d.memoizedState=null):(h!==null&&pt(d,null),Dt(),Ae());return Os(h,d,N,_),d.child}function Bc(h,d){return h!==null&&h.tag===22||d.stateNode!==null||(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.sibling}function Bu(h,d,_,T,N){var L=Je();return L=L===null?null:{parent:Vi?bi._currentValue:bi._currentValue2,pool:L},d.memoizedState={baseLanes:_,cachePool:L},h!==null&&pt(d,null),Dt(),Pe(d),h!==null&&Ne(h,d,T,!0),d.childLanes=N,null}function Gd(h,d){return d=Gl({mode:d.mode,children:d.children},h.mode),d.ref=h.ref,h.child=d,d.return=h,d}function lg(h,d,_){return Ls(d,h.child,null,_),h=Gd(d,d.pendingProps),h.flags|=2,mt(d),d.memoizedState=null,h}function xy(h,d,_){var T=d.pendingProps,N=(d.flags&128)!==0;if(d.flags&=-129,h===null){if(bn){if(T.mode==="hidden")return h=Gd(d,T),d.lanes=536870912,Bc(null,h);if(ze(d),(h=xi)?(h=Zg(h,cr),h!==null&&(d.memoizedState={dehydrated:h,treeContext:Ea!==null?{id:Ps,overflow:$a}:null,retryLane:536870912,hydrationErrors:null},_=wg(h),_.return=d,d.child=_,us=d,xi=null)):h=null,h===null)throw Ie(d);return d.lanes=536870912,null}return Gd(d,T)}var L=h.memoizedState;if(L!==null){var Z=L.dehydrated;if(ze(d),N)if(d.flags&256)d.flags&=-257,d=lg(h,d,_);else if(d.memoizedState!==null)d.child=h.child,d.flags|=128,d=null;else throw Error(s(558));else if(hi||Ne(h,d,_,!1),N=(_&h.childLanes)!==0,hi||N){if(T=hn,T!==null&&(Z=F(T,_),Z!==0&&Z!==L.retryLane))throw L.retryLane=Z,ni(h,Z),Ti(T,h,Z),hr;Zu(),d=lg(h,d,_)}else h=L.treeContext,_i&&(xi=i_(Z),us=d,bn=!0,Po=null,cr=!1,h!==null&&fe(d,h)),d=Gd(d,T),d.flags|=4096;return d}return h=Yr(h.child,{mode:T.mode,children:T.children}),h.ref=d.ref,d.child=h,h.return=d,h}function nf(h,d){var _=d.ref;if(_===null)h!==null&&h.ref!==null&&(d.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(s(284));(h===null||h.ref!==_)&&(d.flags|=4194816)}}function Hd(h,d,_,T,N){return Oe(d),_=Ct(h,d,_,T,void 0,N),T=mn(),h!==null&&!hi?(Vn(h,d,N),_o(h,d,N)):(bn&&T&&Q(d),d.flags|=1,Os(h,d,_,N),d.child)}function cg(h,d,_,T,N,L){return Oe(d),d.updateQueue=null,_=Rt(d,T,_,N),Ft(h),T=mn(),h!==null&&!hi?(Vn(h,d,L),_o(h,d,L)):(bn&&T&&Q(d),d.flags|=1,Os(h,d,_,L),d.child)}function zc(h,d,_,T,N){if(Oe(d),d.stateNode===null){var L=No,Z=_.contextType;typeof Z=="object"&&Z!==null&&(L=q(Z)),L=new _(T,L),d.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Df,d.stateNode=L,L._reactInternals=d,L=d.stateNode,L.props=T,L.state=d.memoizedState,L.refs={},Ni(d),Z=_.contextType,L.context=typeof Z=="object"&&Z!==null?q(Z):No,L.state=d.memoizedState,Z=_.getDerivedStateFromProps,typeof Z=="function"&&(rg(d,_,Z,T),L.state=d.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(Z=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),Z!==L.state&&Df.enqueueReplaceState(L,L.state,null),fa(d,T,L,N),Vr(),L.state=d.memoizedState),typeof L.componentDidMount=="function"&&(d.flags|=4194308),T=!0}else if(h===null){L=d.stateNode;var ve=d.memoizedProps,Ze=kc(_,ve);L.props=Ze;var lt=L.context,vt=_.contextType;Z=No,typeof vt=="object"&&vt!==null&&(Z=q(vt));var ft=_.getDerivedStateFromProps;vt=typeof ft=="function"||typeof L.getSnapshotBeforeUpdate=="function",ve=d.pendingProps!==ve,vt||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(ve||lt!==Z)&&dy(d,L,T,Z),Qr=!1;var At=d.memoizedState;L.state=At,fa(d,T,L,N),Vr(),lt=d.memoizedState,ve||At!==lt||Qr?(typeof ft=="function"&&(rg(d,_,ft,T),lt=d.memoizedState),(Ze=Qr||zd(d,_,Ze,T,At,lt,Z))?(vt||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(d.flags|=4194308)):(typeof L.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=T,d.memoizedState=lt),L.props=T,L.state=lt,L.context=Z,T=Ze):(typeof L.componentDidMount=="function"&&(d.flags|=4194308),T=!1)}else{L=d.stateNode,Ns(h,d),Z=d.memoizedProps,vt=kc(_,Z),L.props=vt,ft=d.pendingProps,At=L.context,lt=_.contextType,Ze=No,typeof lt=="object"&&lt!==null&&(Ze=q(lt)),ve=_.getDerivedStateFromProps,(lt=typeof ve=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(Z!==ft||At!==Ze)&&dy(d,L,T,Ze),Qr=!1,At=d.memoizedState,L.state=At,fa(d,T,L,N),Vr();var tn=d.memoizedState;Z!==ft||At!==tn||Qr||h!==null&&h.dependencies!==null&&Me(h.dependencies)?(typeof ve=="function"&&(rg(d,_,ve,T),tn=d.memoizedState),(vt=Qr||zd(d,_,vt,T,At,tn,Ze)||h!==null&&h.dependencies!==null&&Me(h.dependencies))?(lt||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(T,tn,Ze),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(T,tn,Ze)),typeof L.componentDidUpdate=="function"&&(d.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof L.componentDidUpdate!="function"||Z===h.memoizedProps&&At===h.memoizedState||(d.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||Z===h.memoizedProps&&At===h.memoizedState||(d.flags|=1024),d.memoizedProps=T,d.memoizedState=tn),L.props=T,L.state=tn,L.context=Ze,T=vt):(typeof L.componentDidUpdate!="function"||Z===h.memoizedProps&&At===h.memoizedState||(d.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||Z===h.memoizedProps&&At===h.memoizedState||(d.flags|=1024),T=!1)}return L=T,nf(h,d),T=(d.flags&128)!==0,L||T?(L=d.stateNode,_=T&&typeof _.getDerivedStateFromError!="function"?null:L.render(),d.flags|=1,h!==null&&T?(d.child=Ls(d,h.child,null,N),d.child=Ls(d,null,_,N)):Os(h,d,_,N),d.memoizedState=L.state,h=d.child):h=_o(h,d,N),h}function by(h,d,_,T){return dt(),d.flags|=256,Os(h,d,_,T),d.child}function ug(h){return{baseLanes:h,cachePool:$e()}}function hg(h,d,_){return h=h!==null?h.childLanes&~_:0,d&&(h|=fr),h}function fg(h,d,_){var T=d.pendingProps,N=!1,L=(d.flags&128)!==0,Z;if((Z=L)||(Z=h!==null&&h.memoizedState===null?!1:(Pi.current&2)!==0),Z&&(N=!0,d.flags&=-129),Z=(d.flags&32)!==0,d.flags&=-33,h===null){if(bn){if(N?Se(d):Ae(),(h=xi)?(h=o_(h,cr),h!==null&&(d.memoizedState={dehydrated:h,treeContext:Ea!==null?{id:Ps,overflow:$a}:null,retryLane:536870912,hydrationErrors:null},_=wg(h),_.return=d,d.child=_,us=d,xi=null)):h=null,h===null)throw Ie(d);return dp(h)?d.lanes=32:d.lanes=536870912,null}var ve=T.children;return T=T.fallback,N?(Ae(),N=d.mode,ve=Gl({mode:"hidden",children:ve},N),T=Sa(T,N,_,null),ve.return=d,T.return=d,ve.sibling=T,d.child=ve,T=d.child,T.memoizedState=ug(_),T.childLanes=hg(h,Z,_),d.memoizedState=au,Bc(null,T)):(Se(d),Wd(d,ve))}var Ze=h.memoizedState;if(Ze!==null&&(ve=Ze.dehydrated,ve!==null)){if(L)d.flags&256?(Se(d),d.flags&=-257,d=Vc(h,d,_)):d.memoizedState!==null?(Ae(),d.child=h.child,d.flags|=128,d=null):(Ae(),ve=T.fallback,N=d.mode,T=Gl({mode:"visible",children:T.children},N),ve=Sa(ve,N,_,null),ve.flags|=2,T.return=d,ve.return=d,T.sibling=ve,d.child=T,Ls(d,h.child,null,_),T=d.child,T.memoizedState=ug(_),T.childLanes=hg(h,Z,_),d.memoizedState=au,d=Bc(null,T));else if(Se(d),dp(ve))Z=pp(ve).digest,T=Error(s(419)),T.stack="",T.digest=Z,ge({value:T,source:null,stack:null}),d=Vc(h,d,_);else if(hi||Ne(h,d,_,!1),Z=(_&h.childLanes)!==0,hi||Z){if(Z=hn,Z!==null&&(T=F(Z,_),T!==0&&T!==Ze.retryLane))throw Ze.retryLane=T,ni(h,T),Ti(Z,h,T),hr;tc(ve)||Zu(),d=Vc(h,d,_)}else tc(ve)?(d.flags|=192,d.child=h.child,d=null):(h=Ze.treeContext,_i&&(xi=s_(ve),us=d,bn=!0,Po=null,cr=!1,h!==null&&fe(d,h)),d=Wd(d,T.children),d.flags|=4096);return d}return N?(Ae(),ve=T.fallback,N=d.mode,Ze=h.child,L=Ze.sibling,T=Yr(Ze,{mode:"hidden",children:T.children}),T.subtreeFlags=Ze.subtreeFlags&65011712,L!==null?ve=Yr(L,ve):(ve=Sa(ve,N,_,null),ve.flags|=2),ve.return=d,T.return=d,T.sibling=ve,d.child=T,Bc(null,T),T=d.child,ve=h.child.memoizedState,ve===null?ve=ug(_):(N=ve.cachePool,N!==null?(Ze=Vi?bi._currentValue:bi._currentValue2,N=N.parent!==Ze?{parent:Ze,pool:Ze}:N):N=$e(),ve={baseLanes:ve.baseLanes|_,cachePool:N}),T.memoizedState=ve,T.childLanes=hg(h,Z,_),d.memoizedState=au,Bc(h.child,T)):(Se(d),_=h.child,h=_.sibling,_=Yr(_,{mode:"visible",children:T.children}),_.return=d,_.sibling=null,h!==null&&(Z=d.deletions,Z===null?(d.deletions=[h],d.flags|=16):Z.push(h)),d.child=_,d.memoizedState=null,_)}function Wd(h,d){return d=Gl({mode:"visible",children:d},h.mode),d.return=h,h.child=d}function Gl(h,d){return h=t(22,h,null,d),h.lanes=0,h}function Vc(h,d,_){return Ls(d,h.child,null,_),h=Wd(d,d.pendingProps.children),h.flags|=2,d.memoizedState=null,h}function Sy(h,d,_){h.lanes|=d;var T=h.alternate;T!==null&&(T.lanes|=d),Y(h.return,d,_)}function zu(h,d,_,T,N,L){var Z=h.memoizedState;Z===null?h.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:T,tail:_,tailMode:N,treeForkCount:L}:(Z.isBackwards=d,Z.rendering=null,Z.renderingStartTime=0,Z.last=T,Z.tail=_,Z.tailMode=N,Z.treeForkCount=L)}function dg(h,d,_){var T=d.pendingProps,N=T.revealOrder,L=T.tail;T=T.children;var Z=Pi.current,ve=(Z&2)!==0;if(ve?(Z=Z&1|2,d.flags|=128):Z&=1,b(Pi,Z),Os(h,d,T,_),T=bn?Ef:0,!ve&&h!==null&&(h.flags&128)!==0)e:for(h=d.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&Sy(h,_,d);else if(h.tag===19)Sy(h,_,d);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===d)break e;for(;h.sibling===null;){if(h.return===null||h.return===d)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}switch(N){case"forwards":for(_=d.child,N=null;_!==null;)h=_.alternate,h!==null&&Mt(h)===null&&(N=_),_=_.sibling;_=N,_===null?(N=d.child,d.child=null):(N=_.sibling,_.sibling=null),zu(d,!1,N,_,L,T);break;case"backwards":case"unstable_legacy-backwards":for(_=null,N=d.child,d.child=null;N!==null;){if(h=N.alternate,h!==null&&Mt(h)===null){d.child=N;break}h=N.sibling,N.sibling=_,_=N,N=h}zu(d,!0,_,null,L,T);break;case"together":zu(d,!1,null,null,void 0,T);break;default:d.memoizedState=null}return d.child}function _o(h,d,_){if(h!==null&&(d.dependencies=h.dependencies),dl|=d.lanes,(_&d.childLanes)===0)if(h!==null){if(Ne(h,d,_,!1),(_&d.childLanes)===0)return null}else return null;if(h!==null&&d.child!==h.child)throw Error(s(153));if(d.child!==null){for(h=d.child,_=Yr(h,h.pendingProps),d.child=_,_.return=d;h.sibling!==null;)h=h.sibling,_=_.sibling=Yr(h,h.pendingProps),_.return=d;_.sibling=null}return d.child}function sf(h,d){return(h.lanes&d)!==0?!0:(h=h.dependencies,!!(h!==null&&Me(h)))}function pg(h,d,_){switch(d.tag){case 3:de(d,d.stateNode.containerInfo),ye(d,bi,h.memoizedState.cache),dt();break;case 27:case 5:ce(d);break;case 4:de(d,d.stateNode.containerInfo);break;case 10:ye(d,d.type,d.memoizedProps.value);break;case 31:if(d.memoizedState!==null)return d.flags|=128,ze(d),null;break;case 13:var T=d.memoizedState;if(T!==null)return T.dehydrated!==null?(Se(d),d.flags|=128,null):(_&d.child.childLanes)!==0?fg(h,d,_):(Se(d),h=_o(h,d,_),h!==null?h.sibling:null);Se(d);break;case 19:var N=(h.flags&128)!==0;if(T=(_&d.childLanes)!==0,T||(Ne(h,d,_,!1),T=(_&d.childLanes)!==0),N){if(T)return dg(h,d,_);d.flags|=128}if(N=d.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),b(Pi,Pi.current),T)break;return null;case 22:return d.lanes=0,_y(h,d,_,d.pendingProps);case 24:ye(d,bi,h.memoizedState.cache)}return _o(h,d,_)}function mg(h,d,_){if(h!==null)if(h.memoizedProps!==d.pendingProps)hi=!0;else{if(!sf(h,_)&&(d.flags&128)===0)return hi=!1,pg(h,d,_);hi=(h.flags&131072)!==0}else hi=!1,bn&&(d.flags&1048576)!==0&&B(d,Ef,d.index);switch(d.lanes=0,d.tag){case 16:e:{var T=d.pendingProps;if(h=_t(d.elementType),d.type=h,typeof h=="function")Hc(h)?(T=kc(h,T),d.tag=1,d=zc(null,d,h,T,_)):(d.tag=0,d=Hd(null,d,h,T,_));else{if(h!=null){var N=h.$$typeof;if(N===$u){d.tag=11,d=gy(null,d,h,T,_);break e}else if(N===op){d.tag=14,d=vy(null,d,h,T,_);break e}}throw d=g(h)||h,Error(s(306,d,""))}}return d;case 0:return Hd(h,d,d.type,d.pendingProps,_);case 1:return T=d.type,N=kc(T,d.pendingProps),zc(h,d,T,N,_);case 3:e:{if(de(d,d.stateNode.containerInfo),h===null)throw Error(s(387));var L=d.pendingProps;N=d.memoizedState,T=N.element,Ns(h,d),fa(d,L,null,_);var Z=d.memoizedState;if(L=Z.cache,ye(d,bi,L),L!==N.cache&&Be(d,[bi],_,!0),Vr(),L=Z.element,_i&&N.isDehydrated)if(N={element:L,isDehydrated:!1,cache:Z.cache},d.updateQueue.baseState=N,d.memoizedState=N,d.flags&256){d=by(h,d,L,_);break e}else if(L!==T){T=ne(Error(s(424)),d),ge(T),d=by(h,d,L,_);break e}else for(_i&&(xi=n_(d.stateNode.containerInfo),us=d,bn=!0,Po=null,cr=!0),_=h0(d,null,L,_),d.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(dt(),L===T){d=_o(h,d,_);break e}Os(h,d,L,_)}d=d.child}return d;case 26:if(wa)return nf(h,d),h===null?(_=e0(d.type,null,d.pendingProps,null))?d.memoizedState=_:bn||(d.stateNode=yp(d.type,d.pendingProps,Us.current,d)):d.memoizedState=e0(d.type,h.memoizedProps,d.pendingProps,h.memoizedState),null;case 27:if(cs)return ce(d),h===null&&cs&&bn&&(T=d.stateNode=_p(d.type,d.pendingProps,Us.current,ws.current,!1),us=d,cr=!0,xi=Yg(d.type,T,xi)),Os(h,d,d.pendingProps.children,_),nf(h,d),h===null&&(d.flags|=4194304),d.child;case 5:return h===null&&bn&&(g_(d.type,d.pendingProps,ws.current),(N=T=xi)&&(T=r_(T,d.type,d.pendingProps,cr),T!==null?(d.stateNode=T,us=d,xi=t_(T),cr=!1,N=!0):N=!1),N||Ie(d)),ce(d),N=d.type,L=d.pendingProps,Z=h!==null?h.memoizedProps:null,T=L.children,lr(N,L)?T=null:Z!==null&&lr(N,Z)&&(d.flags|=32),d.memoizedState!==null&&(N=Ct(h,d,Bt,null,null,_),Vi?Jc._currentValue=N:Jc._currentValue2=N),nf(h,d),Os(h,d,T,_),d.child;case 6:return h===null&&bn&&($g(d.pendingProps,ws.current),(h=_=xi)&&(_=a_(_,d.pendingProps,cr),_!==null?(d.stateNode=_,us=d,xi=null,h=!0):h=!1),h||Ie(d)),null;case 13:return fg(h,d,_);case 4:return de(d,d.stateNode.containerInfo),T=d.pendingProps,h===null?d.child=Ls(d,null,T,_):Os(h,d,T,_),d.child;case 11:return gy(h,d,d.type,d.pendingProps,_);case 7:return Os(h,d,d.pendingProps,_),d.child;case 8:return Os(h,d,d.pendingProps.children,_),d.child;case 12:return Os(h,d,d.pendingProps.children,_),d.child;case 10:return T=d.pendingProps,ye(d,d.type,T.value),Os(h,d,T.children,_),d.child;case 9:return N=d.type._context,T=d.pendingProps.children,Oe(d),N=q(N),T=T(N),d.flags|=1,Os(h,d,T,_),d.child;case 14:return vy(h,d,d.type,d.pendingProps,_);case 15:return yy(h,d,d.type,d.pendingProps,_);case 19:return dg(h,d,_);case 31:return xy(h,d,_);case 22:return _y(h,d,_,d.pendingProps);case 24:return Oe(d),T=q(bi),h===null?(N=Je(),N===null&&(N=hn,L=Re(),N.pooledCache=L,L.refCount++,L!==null&&(N.pooledCacheLanes|=_),N=L),d.memoizedState={parent:T,cache:N},Ni(d),ye(d,bi,N)):((h.lanes&_)!==0&&(Ns(h,d),fa(d,null,null,_),Vr()),N=h.memoizedState,L=d.memoizedState,N.parent!==T?(N={parent:T,cache:T},d.memoizedState=N,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=N),ye(d,bi,T)):(T=L.cache,ye(d,bi,T),T!==N.cache&&Be(d,[bi],_,!0))),Os(h,d,d.pendingProps.children,_),d.child;case 29:throw d.pendingProps}throw Error(s(156,d.tag))}function va(h){h.flags|=4}function rf(h){Zr&&(h.flags|=8)}function My(h,d){if(h!==null&&h.child===d.child)return!1;if((d.flags&16)!==0)return!0;for(h=d.child;h!==null;){if((h.flags&8218)!==0||(h.subtreeFlags&8218)!==0)return!0;h=h.sibling}return!1}function gg(h,d,_,T){if(An)for(_=d.child;_!==null;){if(_.tag===5||_.tag===6)_f(h,_.stateNode);else if(!(_.tag===4||cs&&_.tag===27)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===d)break;for(;_.sibling===null;){if(_.return===null||_.return===d)return;_=_.return}_.sibling.return=_.return,_=_.sibling}else if(Zr)for(var N=d.child;N!==null;){if(N.tag===5){var L=N.stateNode;_&&T&&(L=Qy(L,N.type,N.memoizedProps)),_f(h,L)}else if(N.tag===6)L=N.stateNode,_&&T&&(L=qg(L,N.memoizedProps)),_f(h,L);else if(N.tag!==4){if(N.tag===22&&N.memoizedState!==null)L=N.child,L!==null&&(L.return=N),gg(h,N,!0,!0);else if(N.child!==null){N.child.return=N,N=N.child;continue}}if(N===d)break;for(;N.sibling===null;){if(N.return===null||N.return===d)return;N=N.return}N.sibling.return=N.return,N=N.sibling}}function Ty(h,d,_,T){var N=!1;if(Zr)for(var L=d.child;L!==null;){if(L.tag===5){var Z=L.stateNode;_&&T&&(Z=Qy(Z,L.type,L.memoizedProps)),Wg(h,Z)}else if(L.tag===6)Z=L.stateNode,_&&T&&(Z=qg(Z,L.memoizedProps)),Wg(h,Z);else if(L.tag!==4){if(L.tag===22&&L.memoizedState!==null)N=L.child,N!==null&&(N.return=L),Ty(h,L,!0,!0),N=!0;else if(L.child!==null){L.child.return=L,L=L.child;continue}}if(L===d)break;for(;L.sibling===null;){if(L.return===null||L.return===d)return N;L=L.return}L.sibling.return=L.return,L=L.sibling}return N}function wy(h,d){if(Zr&&My(h,d)){h=d.stateNode;var _=h.containerInfo,T=Hg();Ty(T,d,!1,!1),h.pendingChildren=T,va(d),Ky(_,T)}}function vg(h,d,_,T){if(An)h.memoizedProps!==T&&va(d);else if(Zr){var N=h.stateNode,L=h.memoizedProps;if((h=My(h,d))||L!==T){var Z=ws.current;L=Zy(N,_,L,T,!h,null),L===N?d.stateNode=N:(rf(d),br(L,_,T,Z)&&va(d),d.stateNode=L,h&&gg(L,d,!1,!1))}else d.stateNode=N}}function rr(h,d,_,T,N){if((h.mode&32)!==0&&(_===null?xf(d,T):sh(d,_,T))){if(h.flags|=16777216,(N&335544128)===N||Ig(d,T))if(wi(h.stateNode,d,T))h.flags|=8192;else if(wn())h.flags|=8192;else throw ur=Uo,Dp}else h.flags&=-16777217}function Vu(h,d){if(s0(d)){if(h.flags|=16777216,!r0(d))if(wn())h.flags|=8192;else throw ur=Uo,Dp}else h.flags&=-16777217}function af(h,d){d!==null&&(h.flags|=4),h.flags&16384&&(d=h.tag!==22?I():536870912,h.lanes|=d,dh|=d)}function Gu(h,d){if(!bn)switch(h.tailMode){case"hidden":d=h.tail;for(var _=null;d!==null;)d.alternate!==null&&(_=d),d=d.sibling;_===null?h.tail=null:_.sibling=null;break;case"collapsed":_=h.tail;for(var T=null;_!==null;)_.alternate!==null&&(T=_),_=_.sibling;T===null?d||h.tail===null?h.tail=null:h.tail.sibling=null:T.sibling=null}}function ii(h){var d=h.alternate!==null&&h.alternate.child===h.child,_=0,T=0;if(d)for(var N=h.child;N!==null;)_|=N.lanes|N.childLanes,T|=N.subtreeFlags&65011712,T|=N.flags&65011712,N.return=h,N=N.sibling;else for(N=h.child;N!==null;)_|=N.lanes|N.childLanes,T|=N.subtreeFlags,T|=N.flags,N.return=h,N=N.sibling;return h.subtreeFlags|=T,h.childLanes=_,d}function Ay(h,d,_){var T=d.pendingProps;switch(ae(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ii(d),null;case 1:return ii(d),null;case 3:return _=d.stateNode,T=null,h!==null&&(T=h.memoizedState.cache),d.memoizedState.cache!==T&&(d.flags|=2048),Ge(bi),se(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(h===null||h.child===null)&&(qe(d)?va(d):h===null||h.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,De())),wy(h,d),ii(d),null;case 26:if(wa){var N=d.type,L=d.memoizedState;return h===null?(va(d),L!==null?(ii(d),Vu(d,L)):(ii(d),rr(d,N,null,T,_))):L?L!==h.memoizedState?(va(d),ii(d),Vu(d,L)):(ii(d),d.flags&=-16777217):(L=h.memoizedProps,An?L!==T&&va(d):vg(h,d,N,T),ii(d),rr(d,N,L,T,_)),null}case 27:if(cs){if(pe(d),_=Us.current,N=d.type,h!==null&&d.stateNode!=null)An?h.memoizedProps!==T&&va(d):vg(h,d,N,T);else{if(!T){if(d.stateNode===null)throw Error(s(166));return ii(d),null}h=ws.current,qe(d)?Ye(d,h):(h=_p(N,T,_,h,!0),d.stateNode=h,va(d))}return ii(d),null}case 5:if(pe(d),N=d.type,h!==null&&d.stateNode!=null)vg(h,d,N,T);else{if(!T){if(d.stateNode===null)throw Error(s(166));return ii(d),null}if(L=ws.current,qe(d))Ye(d,L),d_(d.stateNode,N,T,L)&&(d.flags|=64);else{var Z=Dg(N,T,Us.current,L,d);rf(d),gg(Z,d,!1,!1),d.stateNode=Z,br(Z,N,T,L)&&va(d)}}return ii(d),rr(d,d.type,h===null?null:h.memoizedProps,d.pendingProps,_),null;case 6:if(h&&d.stateNode!=null)_=h.memoizedProps,An?_!==T&&va(d):Zr&&(_!==T?(h=Us.current,_=ws.current,rf(d),d.stateNode=ol(T,h,_,d)):d.stateNode=h.stateNode);else{if(typeof T!="string"&&d.stateNode===null)throw Error(s(166));if(h=Us.current,_=ws.current,qe(d)){if(!_i)throw Error(s(176));if(h=d.stateNode,_=d.memoizedProps,T=null,N=us,N!==null)switch(N.tag){case 27:case 5:T=N.memoizedProps}BS(h,_,d,T)||Ie(d,!0)}else rf(d),d.stateNode=ol(T,h,_,d)}return ii(d),null;case 31:if(_=d.memoizedState,h===null||h.memoizedState!==null){if(T=qe(d),_!==null){if(h===null){if(!T)throw Error(s(318));if(!_i)throw Error(s(556));if(h=d.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(557));Kg(h,d)}else dt(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;ii(d),h=!1}else _=De(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=_),h=!0;if(!h)return d.flags&256?(mt(d),d):(mt(d),null);if((d.flags&128)!==0)throw Error(s(558))}return ii(d),null;case 13:if(T=d.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(N=qe(d),T!==null&&T.dehydrated!==null){if(h===null){if(!N)throw Error(s(318));if(!_i)throw Error(s(344));if(N=d.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(s(317));c_(N,d)}else dt(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;ii(d),N=!1}else N=De(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=N),N=!0;if(!N)return d.flags&256?(mt(d),d):(mt(d),null)}return mt(d),(d.flags&128)!==0?(d.lanes=_,d):(_=T!==null,h=h!==null&&h.memoizedState!==null,_&&(T=d.child,N=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(N=T.alternate.memoizedState.cachePool.pool),L=null,T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(L=T.memoizedState.cachePool.pool),L!==N&&(T.flags|=2048)),_!==h&&_&&(d.child.flags|=8192),af(d,d.updateQueue),ii(d),null);case 4:return se(),wy(h,d),h===null&&Kn(d.stateNode.containerInfo),ii(d),null;case 10:return Ge(d.type),ii(d),null;case 19:if(x(Pi),T=d.memoizedState,T===null)return ii(d),null;if(N=(d.flags&128)!==0,L=T.rendering,L===null)if(N)Gu(T,!1);else{if(Ci!==0||h!==null&&(h.flags&128)!==0)for(h=d.child;h!==null;){if(L=Mt(h),L!==null){for(d.flags|=128,Gu(T,!1),h=L.updateQueue,d.updateQueue=h,af(d,h),d.subtreeFlags=0,h=_,_=d.child;_!==null;)np(_,h),_=_.sibling;return b(Pi,Pi.current&1|2),bn&&ie(d,T.treeForkCount),d.child}h=h.sibling}T.tail!==null&&Zs()>fc&&(d.flags|=128,N=!0,Gu(T,!1),d.lanes=4194304)}else{if(!N)if(h=Mt(L),h!==null){if(d.flags|=128,N=!0,h=h.updateQueue,d.updateQueue=h,af(d,h),Gu(T,!0),T.tail===null&&T.tailMode==="hidden"&&!L.alternate&&!bn)return ii(d),null}else 2*Zs()-T.renderingStartTime>fc&&_!==536870912&&(d.flags|=128,N=!0,Gu(T,!1),d.lanes=4194304);T.isBackwards?(L.sibling=d.child,d.child=L):(h=T.last,h!==null?h.sibling=L:d.child=L,T.last=L)}return T.tail!==null?(h=T.tail,T.rendering=h,T.tail=h.sibling,T.renderingStartTime=Zs(),h.sibling=null,_=Pi.current,b(Pi,N?_&1|2:_&1),bn&&ie(d,T.treeForkCount),h):(ii(d),null);case 22:case 23:return mt(d),J(),T=d.memoizedState!==null,h!==null?h.memoizedState!==null!==T&&(d.flags|=8192):T&&(d.flags|=8192),T?(_&536870912)!==0&&(d.flags&128)===0&&(ii(d),d.subtreeFlags&6&&(d.flags|=8192)):ii(d),_=d.updateQueue,_!==null&&af(d,_.retryQueue),_=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(_=h.memoizedState.cachePool.pool),T=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(T=d.memoizedState.cachePool.pool),T!==_&&(d.flags|=2048),h!==null&&x(sc),null;case 24:return _=null,h!==null&&(_=h.memoizedState.cache),d.memoizedState.cache!==_&&(d.flags|=2048),Ge(bi),ii(d),null;case 25:return null;case 30:return null}throw Error(s(156,d.tag))}function yg(h,d){switch(ae(d),d.tag){case 1:return h=d.flags,h&65536?(d.flags=h&-65537|128,d):null;case 3:return Ge(bi),se(),h=d.flags,(h&65536)!==0&&(h&128)===0?(d.flags=h&-65537|128,d):null;case 26:case 27:case 5:return pe(d),null;case 31:if(d.memoizedState!==null){if(mt(d),d.alternate===null)throw Error(s(340));dt()}return h=d.flags,h&65536?(d.flags=h&-65537|128,d):null;case 13:if(mt(d),h=d.memoizedState,h!==null&&h.dehydrated!==null){if(d.alternate===null)throw Error(s(340));dt()}return h=d.flags,h&65536?(d.flags=h&-65537|128,d):null;case 19:return x(Pi),null;case 4:return se(),null;case 10:return Ge(d.type),null;case 22:case 23:return mt(d),J(),h!==null&&x(sc),h=d.flags,h&65536?(d.flags=h&-65537|128,d):null;case 24:return Ge(bi),null;case 25:return null;default:return null}}function Ey(h,d){switch(ae(d),d.tag){case 3:Ge(bi),se();break;case 26:case 27:case 5:pe(d);break;case 4:se();break;case 31:d.memoizedState!==null&&mt(d);break;case 13:mt(d);break;case 19:x(Pi);break;case 10:Ge(d.type);break;case 22:case 23:mt(d),J(),h!==null&&x(sc);break;case 24:Ge(bi)}}function xo(h,d){try{var _=d.updateQueue,T=_!==null?_.lastEffect:null;if(T!==null){var N=T.next;_=N;do{if((_.tag&h)===h){T=void 0;var L=_.create,Z=_.inst;T=L(),Z.destroy=T}_=_.next}while(_!==N)}}catch(ve){Yt(d,d.return,ve)}}function bo(h,d,_){try{var T=d.updateQueue,N=T!==null?T.lastEffect:null;if(N!==null){var L=N.next;T=L;do{if((T.tag&h)===h){var Z=T.inst,ve=Z.destroy;if(ve!==void 0){Z.destroy=void 0,N=d;var Ze=_,lt=ve;try{lt()}catch(vt){Yt(N,Ze,vt)}}}T=T.next}while(T!==L)}}catch(vt){Yt(d,d.return,vt)}}function Hu(h){var d=h.updateQueue;if(d!==null){var _=h.stateNode;try{Gr(d,_)}catch(T){Yt(h,h.return,T)}}}function jd(h,d,_){_.props=kc(h.type,h.memoizedProps),_.state=h.memoizedState;try{_.componentWillUnmount()}catch(T){Yt(h,d,T)}}function Wu(h,d){try{var _=h.ref;if(_!==null){switch(h.tag){case 26:case 27:case 5:var T=th(h.stateNode);break;case 30:T=h.stateNode;break;default:T=h.stateNode}typeof _=="function"?h.refCleanup=_(T):_.current=T}}catch(N){Yt(h,d,N)}}function Ys(h,d){var _=h.ref,T=h.refCleanup;if(_!==null)if(typeof T=="function")try{T()}catch(N){Yt(h,d,N)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(N){Yt(h,d,N)}else _.current=null}function Gc(h){var d=h.type,_=h.memoizedProps,T=h.stateNode;try{Vy(T,d,_,h)}catch(N){Yt(h,h.return,N)}}function of(h,d,_){try{Gy(h.stateNode,h.type,_,d,h)}catch(T){Yt(h,h.return,T)}}function _g(h){return h.tag===5||h.tag===3||(wa?h.tag===26:!1)||(cs?h.tag===27&&$c(h.type):!1)||h.tag===4}function $o(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||_g(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(cs&&h.tag===27&&$c(h.type)||h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function qd(h,d,_){var T=h.tag;if(T===5||T===6)h=h.stateNode,d?Wy(_,h,d):Bg(_,h);else if(T!==4&&(cs&&T===27&&$c(h.type)&&(_=h.stateNode,d=null),h=h.child,h!==null))for(qd(h,d,_),h=h.sibling;h!==null;)qd(h,d,_),h=h.sibling}function lf(h,d,_){var T=h.tag;if(T===5||T===6)h=h.stateNode,d?Hy(_,h,d):kg(_,h);else if(T!==4&&(cs&&T===27&&$c(h.type)&&(_=h.stateNode),h=h.child,h!==null))for(lf(h,d,_),h=h.sibling;h!==null;)lf(h,d,_),h=h.sibling}function xg(h,d,_){h=h.containerInfo;try{jg(h,_)}catch(T){Yt(d,d.return,T)}}function Cy(h){var d=h.stateNode,_=h.memoizedProps;try{ts(h.type,_,d,h)}catch(T){Yt(h,h.return,T)}}function US(h,d){for(lp(h.containerInfo),Wi=d;Wi!==null;)if(h=Wi,d=h.child,(h.subtreeFlags&1028)!==0&&d!==null)d.return=h,Wi=d;else for(;Wi!==null;){h=Wi;var _=h.alternate;switch(d=h.flags,h.tag){case 0:if((d&4)!==0&&(d=h.updateQueue,d=d!==null?d.events:null,d!==null))for(var T=0;T<d.length;T++){var N=d[T];N.ref.impl=N.nextImpl}break;case 11:case 15:break;case 1:if((d&1024)!==0&&_!==null){d=void 0,T=h,N=_.memoizedProps,_=_.memoizedState;var L=T.stateNode;try{var Z=kc(T.type,N);d=L.getSnapshotBeforeUpdate(Z,_),L.__reactInternalSnapshotBeforeUpdate=d}catch(ve){Yt(T,T.return,ve)}}break;case 3:(d&1024)!==0&&An&&Gg(h.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(s(163))}if(d=h.sibling,d!==null){d.return=h.return,Wi=d;break}Wi=h.return}}function Ry(h,d,_){var T=_.flags;switch(_.tag){case 0:case 11:case 15:ar(h,_),T&4&&xo(5,_);break;case 1:if(ar(h,_),T&4)if(h=_.stateNode,d===null)try{h.componentDidMount()}catch(Z){Yt(_,_.return,Z)}else{var N=kc(_.type,d.memoizedProps);d=d.memoizedState;try{h.componentDidUpdate(N,d,h.__reactInternalSnapshotBeforeUpdate)}catch(Z){Yt(_,_.return,Z)}}T&64&&Hu(_),T&512&&Wu(_,_.return);break;case 3:if(ar(h,_),T&64&&(T=_.updateQueue,T!==null)){if(h=null,_.child!==null)switch(_.child.tag){case 27:case 5:h=th(_.child.stateNode);break;case 1:h=_.child.stateNode}try{Gr(T,h)}catch(Z){Yt(_,_.return,Z)}}break;case 27:cs&&d===null&&T&4&&Cy(_);case 26:case 5:if(ar(h,_),d===null){if(T&4)Gc(_);else if(T&64){h=_.type,d=_.memoizedProps,N=_.stateNode;try{h_(N,h,d,_)}catch(Z){Yt(_,_.return,Z)}}}T&512&&Wu(_,_.return);break;case 12:ar(h,_);break;case 31:ar(h,_),T&4&&_a(h,_);break;case 13:ar(h,_),T&4&&uf(h,_),T&64&&(T=_.memoizedState,T!==null&&(T=T.dehydrated,T!==null&&(_=LS.bind(null,_),mp(T,_))));break;case 22:if(T=_.memoizedState!==null||Ui,!T){d=d!==null&&d.memoizedState!==null||Li,N=Ui;var L=Li;Ui=T,(Li=d)&&!L?ba(h,_,(_.subtreeFlags&8772)!==0):ar(h,_),Ui=N,Li=L}break;case 30:break;default:ar(h,_)}}function bg(h){var d=h.alternate;d!==null&&(h.alternate=null,bg(d)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(d=h.stateNode,d!==null&&cp(d)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function ya(h,d,_){for(_=_.child;_!==null;)cf(h,d,_),_=_.sibling}function cf(h,d,_){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(nu,_)}catch{}switch(_.tag){case 26:if(wa){Li||Ys(_,d),ya(h,d,_),_.memoizedState?nc(_.memoizedState):_.stateNode&&i0(_.stateNode);break}case 27:if(cs){Li||Ys(_,d);var T=Ei,N=ji;$c(_.type)&&(Ei=_.stateNode,ji=!1),ya(h,d,_),Ts(_.stateNode),Ei=T,ji=N;break}case 5:Li||Ys(_,d);case 6:if(An){if(T=Ei,N=ji,Ei=null,ya(h,d,_),Ei=T,ji=N,Ei!==null)if(ji)try{zg(Ei,_.stateNode)}catch(L){Yt(_,d,L)}else try{jy(Ei,_.stateNode)}catch(L){Yt(_,d,L)}}else ya(h,d,_);break;case 18:An&&Ei!==null&&(ji?gp(Ei,_.stateNode):Jg(Ei,_.stateNode));break;case 4:An?(T=Ei,N=ji,Ei=_.stateNode.containerInfo,ji=!0,ya(h,d,_),Ei=T,ji=N):(Zr&&xg(_.stateNode,_,Hg()),ya(h,d,_));break;case 0:case 11:case 14:case 15:bo(2,_,d),Li||bo(4,_,d),ya(h,d,_);break;case 1:Li||(Ys(_,d),T=_.stateNode,typeof T.componentWillUnmount=="function"&&jd(_,d,T)),ya(h,d,_);break;case 21:ya(h,d,_);break;case 22:Li=(T=Li)||_.memoizedState!==null,ya(h,d,_),Li=T;break;default:ya(h,d,_)}}function _a(h,d){if(_i&&d.memoizedState===null&&(h=d.alternate,h!==null&&(h=h.memoizedState,h!==null))){h=h.dehydrated;try{zS(h)}catch(_){Yt(d,d.return,_)}}}function uf(h,d){if(_i&&d.memoizedState===null&&(h=d.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{VS(h)}catch(_){Yt(d,d.return,_)}}function xa(h){switch(h.tag){case 31:case 13:case 19:var d=h.stateNode;return d===null&&(d=h.stateNode=new d0),d;case 22:return h=h.stateNode,d=h._retryCache,d===null&&(d=h._retryCache=new d0),d;default:throw Error(s(435,h.tag))}}function el(h,d){var _=xa(h);d.forEach(function(T){if(!_.has(T)){_.add(T);var N=FS.bind(null,h,T);T.then(N,N)}})}function Ss(h,d){var _=d.deletions;if(_!==null)for(var T=0;T<_.length;T++){var N=_[T],L=h,Z=d;if(An){var ve=Z;e:for(;ve!==null;){switch(ve.tag){case 27:if(cs){if($c(ve.type)){Ei=ve.stateNode,ji=!1;break e}break}case 5:Ei=ve.stateNode,ji=!1;break e;case 3:case 4:Ei=ve.stateNode.containerInfo,ji=!0;break e}ve=ve.return}if(Ei===null)throw Error(s(160));cf(L,Z,N),Ei=null,ji=!1}else cf(L,Z,N);L=N.alternate,L!==null&&(L.return=null),N.return=null}if(d.subtreeFlags&13886)for(d=d.child;d!==null;)hf(d,h),d=d.sibling}function hf(h,d){var _=h.alternate,T=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Ss(d,h),Ms(h),T&4&&(bo(3,h,h.return),xo(3,h),bo(5,h,h.return));break;case 1:Ss(d,h),Ms(h),T&512&&(Li||_===null||Ys(_,_.return)),T&64&&Ui&&(h=h.updateQueue,h!==null&&(T=h.callbacks,T!==null&&(_=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=_===null?T:_.concat(T))));break;case 26:if(wa){var N=Xn;if(Ss(d,h),Ms(h),T&512&&(Li||_===null||Ys(_,_.return)),T&4){T=_!==null?_.memoizedState:null;var L=h.memoizedState;_===null?L===null?h.stateNode===null?h.stateNode=v_(N,h.type,h.memoizedProps,h):n0(N,h.type,h.stateNode):h.stateNode=t0(N,L,h.memoizedProps):T!==L?(T===null?_.stateNode!==null&&i0(_.stateNode):nc(T),L===null?n0(N,h.type,h.stateNode):t0(N,L,h.memoizedProps)):L===null&&h.stateNode!==null&&of(h,h.memoizedProps,_.memoizedProps)}break}case 27:if(cs){Ss(d,h),Ms(h),T&512&&(Li||_===null||Ys(_,_.return)),_!==null&&T&4&&of(h,h.memoizedProps,_.memoizedProps);break}case 5:if(Ss(d,h),Ms(h),T&512&&(Li||_===null||Ys(_,_.return)),An){if(h.flags&32){N=h.stateNode;try{Vg(N)}catch(ft){Yt(h,h.return,ft)}}T&4&&h.stateNode!=null&&(N=h.memoizedProps,of(h,N,_!==null?_.memoizedProps:N)),T&1024&&(lh=!0)}else Zr&&h.alternate!==null&&(h.alternate.stateNode=h.stateNode);break;case 6:if(Ss(d,h),Ms(h),T&4&&An){if(h.stateNode===null)throw Error(s(162));T=h.memoizedProps,_=_!==null?_.memoizedProps:T,N=h.stateNode;try{zy(N,_,T)}catch(ft){Yt(h,h.return,ft)}}break;case 3:if(wa?(y_(),N=Xn,Xn=Mf(d.containerInfo),Ss(d,h),Xn=N):Ss(d,h),Ms(h),T&4){if(An&&_i&&_!==null&&_.memoizedState.isDehydrated)try{f_(d.containerInfo)}catch(ft){Yt(h,h.return,ft)}if(Zr){T=d.containerInfo,_=d.pendingChildren;try{jg(T,_)}catch(ft){Yt(h,h.return,ft)}}}lh&&(lh=!1,Xd(h));break;case 4:wa?(_=Xn,Xn=Mf(h.stateNode.containerInfo),Ss(d,h),Ms(h),Xn=_):(Ss(d,h),Ms(h)),T&4&&Zr&&xg(h.stateNode,h,h.stateNode.pendingChildren);break;case 12:Ss(d,h),Ms(h);break;case 31:Ss(d,h),Ms(h),T&4&&(T=h.updateQueue,T!==null&&(h.updateQueue=null,el(h,T)));break;case 13:Ss(d,h),Ms(h),h.child.flags&8192&&h.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(Of=Zs()),T&4&&(T=h.updateQueue,T!==null&&(h.updateQueue=null,el(h,T)));break;case 22:N=h.memoizedState!==null;var Z=_!==null&&_.memoizedState!==null,ve=Ui,Ze=Li;if(Ui=ve||N,Li=Ze||Z,Ss(d,h),Li=Ze,Ui=ve,Ms(h),T&8192&&(d=h.stateNode,d._visibility=N?d._visibility&-2:d._visibility|1,N&&(_===null||Z||Ui||Li||Hl(h)),An)){e:if(_=null,An)for(d=h;;){if(d.tag===5||wa&&d.tag===26){if(_===null){Z=_=d;try{L=Z.stateNode,N?kS(L):Xy(Z.stateNode,Z.memoizedProps)}catch(ft){Yt(Z,Z.return,ft)}}}else if(d.tag===6){if(_===null){Z=d;try{var lt=Z.stateNode;N?qy(lt):Yy(lt,Z.memoizedProps)}catch(ft){Yt(Z,Z.return,ft)}}}else if(d.tag===18){if(_===null){Z=d;try{var vt=Z.stateNode;N?p_(vt):m_(Z.stateNode)}catch(ft){Yt(Z,Z.return,ft)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===h)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===h)break e;for(;d.sibling===null;){if(d.return===null||d.return===h)break e;_===d&&(_=null),d=d.return}_===d&&(_=null),d.sibling.return=d.return,d=d.sibling}}T&4&&(T=h.updateQueue,T!==null&&(_=T.retryQueue,_!==null&&(T.retryQueue=null,el(h,_))));break;case 19:Ss(d,h),Ms(h),T&4&&(T=h.updateQueue,T!==null&&(h.updateQueue=null,el(h,T)));break;case 30:break;case 21:break;default:Ss(d,h),Ms(h)}}function Ms(h){var d=h.flags;if(d&2){try{for(var _,T=h.return;T!==null;){if(_g(T)){_=T;break}T=T.return}if(An){if(_==null)throw Error(s(160));switch(_.tag){case 27:if(cs){var N=_.stateNode,L=$o(h);lf(h,L,N);break}case 5:var Z=_.stateNode;_.flags&32&&(Vg(Z),_.flags&=-33);var ve=$o(h);lf(h,ve,Z);break;case 3:case 4:var Ze=_.stateNode.containerInfo,lt=$o(h);qd(h,lt,Ze);break;default:throw Error(s(161))}}}catch(vt){Yt(h,h.return,vt)}h.flags&=-3}d&4096&&(h.flags&=-4097)}function Xd(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var d=h;Xd(d),d.tag===5&&d.flags&1024&&Pg(d.stateNode),h=h.sibling}}function ar(h,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)Ry(h,d.alternate,d),d=d.sibling}function Hl(h){for(h=h.child;h!==null;){var d=h;switch(d.tag){case 0:case 11:case 14:case 15:bo(4,d,d.return),Hl(d);break;case 1:Ys(d,d.return);var _=d.stateNode;typeof _.componentWillUnmount=="function"&&jd(d,d.return,_),Hl(d);break;case 27:cs&&Ts(d.stateNode);case 26:case 5:Ys(d,d.return),Hl(d);break;case 22:d.memoizedState===null&&Hl(d);break;case 30:Hl(d);break;default:Hl(d)}h=h.sibling}}function ba(h,d,_){for(_=_&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var T=d.alternate,N=h,L=d,Z=L.flags;switch(L.tag){case 0:case 11:case 15:ba(N,L,_),xo(4,L);break;case 1:if(ba(N,L,_),T=L,N=T.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(lt){Yt(T,T.return,lt)}if(T=L,N=T.updateQueue,N!==null){var ve=T.stateNode;try{var Ze=N.shared.hiddenCallbacks;if(Ze!==null)for(N.shared.hiddenCallbacks=null,N=0;N<Ze.length;N++)vr(Ze[N],ve)}catch(lt){Yt(T,T.return,lt)}}_&&Z&64&&Hu(L),Wu(L,L.return);break;case 27:cs&&Cy(L);case 26:case 5:ba(N,L,_),_&&T===null&&Z&4&&Gc(L),Wu(L,L.return);break;case 12:ba(N,L,_);break;case 31:ba(N,L,_),_&&Z&4&&_a(N,L);break;case 13:ba(N,L,_),_&&Z&4&&uf(N,L);break;case 22:L.memoizedState===null&&ba(N,L,_),Wu(L,L.return);break;case 30:break;default:ba(N,L,_)}d=d.sibling}}function Wl(h,d){var _=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(_=h.memoizedState.cachePool.pool),h=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(h=d.memoizedState.cachePool.pool),h!==_&&(h!=null&&h.refCount++,_!=null&&we(_))}function Sg(h,d){h=null,d.alternate!==null&&(h=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==h&&(d.refCount++,h!=null&&we(h))}function Mi(h,d,_,T){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Yd(h,d,_,T),d=d.sibling}function Yd(h,d,_,T){var N=d.flags;switch(d.tag){case 0:case 11:case 15:Mi(h,d,_,T),N&2048&&xo(9,d);break;case 1:Mi(h,d,_,T);break;case 3:Mi(h,d,_,T),N&2048&&(h=null,d.alternate!==null&&(h=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==h&&(d.refCount++,h!=null&&we(h)));break;case 12:if(N&2048){Mi(h,d,_,T),h=d.stateNode;try{var L=d.memoizedProps,Z=L.id,ve=L.onPostCommit;typeof ve=="function"&&ve(Z,d.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(Ze){Yt(d,d.return,Ze)}}else Mi(h,d,_,T);break;case 31:Mi(h,d,_,T);break;case 13:Mi(h,d,_,T);break;case 23:break;case 22:L=d.stateNode,Z=d.alternate,d.memoizedState!==null?L._visibility&2?Mi(h,d,_,T):ju(h,d):L._visibility&2?Mi(h,d,_,T):(L._visibility|=2,yr(h,d,_,T,(d.subtreeFlags&10256)!==0||!1)),N&2048&&Wl(Z,d);break;case 24:Mi(h,d,_,T),N&2048&&Sg(d.alternate,d);break;default:Mi(h,d,_,T)}}function yr(h,d,_,T,N){for(N=N&&((d.subtreeFlags&10256)!==0||!1),d=d.child;d!==null;){var L=h,Z=d,ve=_,Ze=T,lt=Z.flags;switch(Z.tag){case 0:case 11:case 15:yr(L,Z,ve,Ze,N),xo(8,Z);break;case 23:break;case 22:var vt=Z.stateNode;Z.memoizedState!==null?vt._visibility&2?yr(L,Z,ve,Ze,N):ju(L,Z):(vt._visibility|=2,yr(L,Z,ve,Ze,N)),N&&lt&2048&&Wl(Z.alternate,Z);break;case 24:yr(L,Z,ve,Ze,N),N&&lt&2048&&Sg(Z.alternate,Z);break;default:yr(L,Z,ve,Ze,N)}d=d.sibling}}function ju(h,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var _=h,T=d,N=T.flags;switch(T.tag){case 22:ju(_,T),N&2048&&Wl(T.alternate,T);break;case 24:ju(_,T),N&2048&&Sg(T.alternate,T);break;default:ju(_,T)}d=d.sibling}}function So(h,d,_){if(h.subtreeFlags&$r)for(h=h.child;h!==null;)jl(h,d,_),h=h.sibling}function jl(h,d,_){switch(h.tag){case 26:if(So(h,d,_),h.flags&$r)if(h.memoizedState!==null)__(_,Xn,h.memoizedState,h.memoizedProps);else{var T=h.stateNode,N=h.type;h=h.memoizedProps,((d&335544128)===d||Ig(N,h))&&up(_,T,N,h)}break;case 5:So(h,d,_),h.flags&$r&&(T=h.stateNode,N=h.type,h=h.memoizedProps,((d&335544128)===d||Ig(N,h))&&up(_,T,N,h));break;case 3:case 4:wa?(T=Xn,Xn=Mf(h.stateNode.containerInfo),So(h,d,_),Xn=T):So(h,d,_);break;case 22:h.memoizedState===null&&(T=h.alternate,T!==null&&T.memoizedState!==null?(T=$r,$r=16777216,So(h,d,_),$r=T):So(h,d,_));break;default:So(h,d,_)}}function Zd(h){var d=h.alternate;if(d!==null&&(h=d.child,h!==null)){d.child=null;do d=h.sibling,h.sibling=null,h=d;while(h!==null)}}function qu(h){var d=h.deletions;if((h.flags&16)!==0){if(d!==null)for(var _=0;_<d.length;_++){var T=d[_];Wi=T,qr(T,h)}Zd(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)Kd(h),h=h.sibling}function Kd(h){switch(h.tag){case 0:case 11:case 15:qu(h),h.flags&2048&&bo(9,h,h.return);break;case 3:qu(h);break;case 12:qu(h);break;case 22:var d=h.stateNode;h.memoizedState!==null&&d._visibility&2&&(h.return===null||h.return.tag!==13)?(d._visibility&=-3,ff(h)):qu(h);break;default:qu(h)}}function ff(h){var d=h.deletions;if((h.flags&16)!==0){if(d!==null)for(var _=0;_<d.length;_++){var T=d[_];Wi=T,qr(T,h)}Zd(h)}for(h=h.child;h!==null;){switch(d=h,d.tag){case 0:case 11:case 15:bo(8,d,d.return),ff(d);break;case 22:_=d.stateNode,_._visibility&2&&(_._visibility&=-3,ff(d));break;default:ff(d)}h=h.sibling}}function qr(h,d){for(;Wi!==null;){var _=Wi;switch(_.tag){case 0:case 11:case 15:bo(8,_,d);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var T=_.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:we(_.memoizedState.cache)}if(T=_.child,T!==null)T.return=_,Wi=T;else e:for(_=h;Wi!==null;){T=Wi;var N=T.sibling,L=T.return;if(bg(T),T===_){Wi=null;break e}if(N!==null){N.return=L,Wi=N;break e}Wi=L}}}function ql(h){var d=sn(h);if(d!=null){if(typeof d.memoizedProps["data-testname"]!="string")throw Error(s(364));return d}if(h=Gi(h),h===null)throw Error(s(362));return h.stateNode.current}function Xl(h,d){var _=h.tag;switch(d.$$typeof){case Oa:if(h.type===d.value)return!0;break;case uh:e:{for(d=d.value,h=[h,0],_=0;_<h.length;){var T=h[_++],N=T.tag,L=h[_++],Z=d[L];if(N!==5&&N!==26&&N!==27||!ec(T)){for(;Z!=null&&Xl(T,Z);)L++,Z=d[L];if(L===d.length){d=!0;break e}else for(T=T.child;T!==null;)h.push(T,L),T=T.sibling}}d=!1}return d;case hh:if((_===5||_===26||_===27)&&Fg(h.stateNode,d.value))return!0;break;case lc:if((_===5||_===6||_===26||_===27)&&(h=bf(h),h!==null&&0<=h.indexOf(d.value)))return!0;break;case Nf:if((_===5||_===26||_===27)&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===d.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function Xu(h){switch(h.$$typeof){case Oa:return"<"+(g(h.value)||"Unknown")+">";case uh:return":has("+(Xu(h)||"")+")";case hh:return'[role="'+h.value+'"]';case lc:return'"'+h.value+'"';case Nf:return'[data-testname="'+h.value+'"]';default:throw Error(s(365))}}function Yu(h,d){var _=[];h=[h,0];for(var T=0;T<h.length;){var N=h[T++],L=N.tag,Z=h[T++],ve=d[Z];if(L!==5&&L!==26&&L!==27||!ec(N)){for(;ve!=null&&Xl(N,ve);)Z++,ve=d[Z];if(Z===d.length)_.push(N);else for(N=N.child;N!==null;)h.push(N,Z),N=N.sibling}}return _}function _r(h,d){if(!ls)throw Error(s(363));h=ql(h),h=Yu(h,d),d=[],h=Array.from(h);for(var _=0;_<h.length;){var T=h[_++],N=T.tag;if(N===5||N===26||N===27)ec(T)||d.push(T.stateNode);else for(T=T.child;T!==null;)h.push(T),T=T.sibling}return d}function yi(){return(yn&2)!==0&&Sn!==0?Sn&-Sn:zt.T!==null?Te():ih()}function tl(){if(fr===0)if((Sn&536870912)===0||bn){var h=tu;tu<<=1,(tu&3932160)===0&&(tu=262144),fr=h}else fr=536870912;return h=wr.current,h!==null&&(h.flags|=32),fr}function Ti(h,d,_){(h===hn&&(Yn===2||Yn===9)||h.cancelPendingCommit!==null)&&(Oi(h,0),To(h,Sn,fr,!1)),O(h,_),((yn&2)===0||h!==hn)&&(h===hn&&((yn&2)===0&&(hc|=_),Ci===4&&To(h,Sn,fr,!1)),it(h))}function Ja(h,d,_){if((yn&6)!==0)throw Error(s(327));var T=!_&&(d&127)===0&&(d&h.expiredLanes)===0||C(h,d),N=T?Iy(h,d):wo(h,d,!0),L=T;do{if(N===0){cc&&!T&&To(h,d,0,!1);break}else{if(_=h.current.alternate,L&&!Dy(_)){N=wo(h,d,!1),L=!1;continue}if(N===2){if(L=d,h.errorRecoveryDisabledLanes&L)var Z=0;else Z=h.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){d=Z;e:{var ve=h;N=If;var Ze=_i&&ve.current.memoizedState.isDehydrated;if(Ze&&(Oi(ve,Z).flags|=256),Z=wo(ve,Z,!1),Z!==2){if(uc&&!Ze){ve.errorRecoveryDisabledLanes|=L,hc|=L,N=4;break e}L=Er,Er=N,L!==null&&(Er===null?Er=L:Er.push.apply(Er,L))}N=Z}if(L=!1,N!==2)continue}}if(N===1){Oi(h,0),To(h,d,0,!0);break}e:{switch(T=h,L=N,L){case 0:case 1:throw Error(s(345));case 4:if((d&4194048)!==d)break;case 6:To(T,d,fr,!no);break e;case 2:Er=null;break;case 3:case 5:break;default:throw Error(s(329))}if((d&62914560)===d&&(N=Of+300-Zs(),10<N)){if(To(T,d,fr,!no),S(T,0,!0)!==0)break e;Bo=d,T.timeoutHandle=Ng(Mo.bind(null,T,_,Er,Pf,Ip,d,fr,hc,dh,no,L,"Throttled",-0,0),N);break e}Mo(T,_,Er,Pf,Ip,d,fr,hc,dh,no,L,null,-0,0)}}break}while(!0);it(h)}function Mo(h,d,_,T,N,L,Z,ve,Ze,lt,vt,ft,At,tn){if(h.timeoutHandle=Sr,ft=d.subtreeFlags,ft&8192||(ft&16785408)===16785408){ft=Og(),jl(d,L,ft);var qi=(L&62914560)===L?Of-Zs():(L&4194048)===L?lu-Zs():0;if(qi=By(ft,qi),qi!==null){Bo=L,h.cancelPendingCommit=qi(Eo.bind(null,h,d,L,_,T,N,Z,ve,Ze,vt,ft,null,At,tn)),To(h,L,Z,!lt);return}}Eo(h,d,L,_,T,N,Z,ve,Ze)}function Dy(h){for(var d=h;;){var _=d.tag;if((_===0||_===11||_===15)&&d.flags&16384&&(_=d.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var T=0;T<_.length;T++){var N=_[T],L=N.getSnapshot;N=N.value;try{if(!Hi(L(),N))return!1}catch{return!1}}if(_=d.child,d.subtreeFlags&16384&&_!==null)_.return=d,d=_;else{if(d===h)break;for(;d.sibling===null;){if(d.return===null||d.return===h)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function To(h,d,_,T){d&=~fh,d&=~hc,h.suspendedLanes|=d,h.pingedLanes&=~d,T&&(h.warmLanes|=d),T=h.expirationTimes;for(var N=d;0<N;){var L=31-Mr(N),Z=1<<L;T[L]=-1,N&=~Z}_!==0&&k(h,_,d)}function Qd(){return(yn&6)===0?(tt(0),!1):!0}function Jd(){if(_n!==null){if(Yn===0)var h=_n.return;else h=_n,eo=ri=null,Cn(h),rc=null,iu=0,h=_n;for(;h!==null;)Ey(h.alternate,h),h=h.return;_n=null}}function Oi(h,d){var _=h.timeoutHandle;_!==Sr&&(h.timeoutHandle=Sr,ky(_)),_=h.cancelPendingCommit,_!==null&&(h.cancelPendingCommit=null,_()),Bo=0,Jd(),hn=h,_n=_=Yr(h.current,null),Sn=d,Yn=0,ns=null,no=!1,cc=C(h,d),uc=!1,dh=fr=fh=hc=dl=Ci=0,Er=If=null,Ip=!1,(d&8)!==0&&(d|=d&32);var T=h.entangledLanes;if(T!==0)for(h=h.entanglements,T&=d;0<T;){var N=31-Mr(T),L=1<<N;d|=h[N],T&=~L}return ko=d,ys(),_}function si(h,d){rn=null,zt.H=Jr,d===fs||d===Na?(d=Nt(),Yn=3):d===Dp?(d=Nt(),Yn=4):Yn=d===hr?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,ns=d,_n===null&&(Ci=1,Vd(h,ne(d,h.current)))}function wn(){var h=wr.current;return h===null?!0:(Sn&4194048)===Sn?Ar===null:(Sn&62914560)===Sn||(Sn&536870912)!==0?h===Ar:!1}function nl(){var h=zt.H;return zt.H=Jr,h===null?Jr:h}function Xr(){var h=zt.A;return zt.A=ch,h}function Zu(){Ci=4,no||(Sn&4194048)!==Sn&&wr.current!==null||(cc=!0),(dl&134217727)===0&&(hc&134217727)===0||hn===null||To(hn,Sn,fr,!1)}function wo(h,d,_){var T=yn;yn|=2;var N=nl(),L=Xr();(hn!==h||Sn!==d)&&(Pf=null,Oi(h,d)),d=!1;var Z=Ci;e:do try{if(Yn!==0&&_n!==null){var ve=_n,Ze=ns;switch(Yn){case 8:Jd(),Z=6;break e;case 3:case 2:case 9:case 6:wr.current===null&&(d=!0);var lt=Yn;if(Yn=0,ns=null,Ao(h,ve,Ze,lt),_&&cc){Z=0;break e}break;default:lt=Yn,Yn=0,ns=null,Ao(h,ve,Ze,lt)}}Ny(),Z=Ci;break}catch(vt){si(h,vt)}while(!0);return d&&h.shellSuspendCounter++,eo=ri=null,yn=T,zt.H=N,zt.A=L,_n===null&&(hn=null,Sn=0,ys()),Z}function Ny(){for(;_n!==null;)Yl(_n)}function Iy(h,d){var _=yn;yn|=2;var T=nl(),N=Xr();hn!==h||Sn!==d?(Pf=null,fc=Zs()+500,Oi(h,d)):cc=C(h,d);e:do try{if(Yn!==0&&_n!==null){d=_n;var L=ns;t:switch(Yn){case 1:Yn=0,ns=null,Ao(h,d,L,1);break;case 2:case 9:if(rt(L)){Yn=0,ns=null,$d(d);break}d=function(){Yn!==2&&Yn!==9||hn!==h||(Yn=7),it(h)},L.then(d,d);break e;case 3:Yn=7;break e;case 4:Yn=5;break e;case 7:rt(L)?(Yn=0,ns=null,$d(d)):(Yn=0,ns=null,Ao(h,d,L,7));break;case 5:var Z=null;switch(_n.tag){case 26:Z=_n.memoizedState;case 5:case 27:var ve=_n,Ze=ve.type,lt=ve.pendingProps;if(Z?r0(Z):wi(ve.stateNode,Ze,lt)){Yn=0,ns=null;var vt=ve.sibling;if(vt!==null)_n=vt;else{var ft=ve.return;ft!==null?(_n=ft,Qu(ft)):_n=null}break t}}Yn=0,ns=null,Ao(h,d,L,5);break;case 6:Yn=0,ns=null,Ao(h,d,L,6);break;case 8:Jd(),Ci=6;break e;default:throw Error(s(462))}}Ku();break}catch(At){si(h,At)}while(!0);return eo=ri=null,zt.H=T,zt.A=N,yn=_,_n!==null?0:(hn=null,Sn=0,ys(),Ci)}function Ku(){for(;_n!==null&&!b_();)Yl(_n)}function Yl(h){var d=mg(h.alternate,h,ko);h.memoizedProps=h.pendingProps,d===null?Qu(h):_n=d}function $d(h){var d=h,_=d.alternate;switch(d.tag){case 15:case 0:d=cg(_,d,d.pendingProps,d.type,void 0,Sn);break;case 11:d=cg(_,d,d.pendingProps,d.type.render,d.ref,Sn);break;case 5:Cn(d);default:Ey(_,d),d=_n=np(d,ko),d=mg(_,d,ko)}h.memoizedProps=h.pendingProps,d===null?Qu(h):_n=d}function Ao(h,d,_,T){eo=ri=null,Cn(d),rc=null,iu=0;var N=d.return;try{if(PS(h,N,d,_,Sn)){Ci=1,Vd(h,ne(_,h.current)),_n=null;return}}catch(L){if(N!==null)throw _n=N,L;Ci=1,Vd(h,ne(_,h.current)),_n=null;return}d.flags&32768?(bn||T===1?h=!0:cc||(Sn&536870912)!==0?h=!1:(no=h=!0,(T===2||T===9||T===3||T===6)&&(T=wr.current,T!==null&&T.tag===13&&(T.flags|=16384))),Zl(d,h)):Qu(d)}function Qu(h){var d=h;do{if((d.flags&32768)!==0){Zl(d,no);return}h=d.return;var _=Ay(d.alternate,d,ko);if(_!==null){_n=_;return}if(d=d.sibling,d!==null){_n=d;return}_n=d=h}while(d!==null);Ci===0&&(Ci=5)}function Zl(h,d){do{var _=yg(h.alternate,h);if(_!==null){_.flags&=32767,_n=_;return}if(_=h.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!d&&(h=h.sibling,h!==null)){_n=h;return}_n=h=_}while(h!==null);Ci=6,_n=null}function Eo(h,d,_,T,N,L,Z,ve,Ze){h.cancelPendingCommit=null;do Ro();while(is!==0);if((yn&6)!==0)throw Error(s(327));if(d!==null){if(d===h.current)throw Error(s(177));if(L=d.lanes|d.childLanes,L|=su,U(h,_,L,Z,ve,Ze),h===hn&&(_n=hn=null,Sn=0),cu=d,ml=h,Bo=_,ph=L,Op=N,p0=T,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(h.callbackNode=null,h.callbackPriority=0,es(wf,function(){return df(),null})):(h.callbackNode=null,h.callbackPriority=0),T=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||T){T=zt.T,zt.T=null,N=Ta(),xn(2),Z=yn,yn|=4;try{US(h,d,_)}finally{yn=Z,xn(N),zt.T=T}}is=1,il(),Co(),ep()}}function il(){if(is===1){is=0;var h=ml,d=cu,_=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||_){_=zt.T,zt.T=null;var T=Ta();xn(2);var N=yn;yn|=4;try{hf(d,h),Fy(h.containerInfo)}finally{yn=N,xn(T),zt.T=_}}h.current=d,is=2}}function Co(){if(is===2){is=0;var h=ml,d=cu,_=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||_){_=zt.T,zt.T=null;var T=Ta();xn(2);var N=yn;yn|=4;try{Ry(h,d.alternate,d)}finally{yn=N,xn(T),zt.T=_}}is=3}}function ep(){if(is===4||is===3){is=0,o0();var h=ml,d=cu,_=Bo,T=p0;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?is=5:(is=0,cu=ml=null,tp(h,h.pendingLanes));var N=h.pendingLanes;if(N===0&&(pl=null),G(_),d=d.stateNode,Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(nu,d,void 0,(d.current.flags&128)===128)}catch{}if(T!==null){d=zt.T,N=Ta(),xn(2),zt.T=null;try{for(var L=h.onRecoverableError,Z=0;Z<T.length;Z++){var ve=T[Z];L(ve.value,{componentStack:ve.stack})}}finally{zt.T=d,xn(N)}}(Bo&3)!==0&&Ro(),it(h),N=h.pendingLanes,(_&261930)!==0&&(N&42)!==0?h===Uf?Un++:(Un=0,Uf=h):Un=0,_i&&Sf(),tt(0)}}function tp(h,d){(h.pooledCacheLanes&=d)===0&&(d=h.pooledCache,d!=null&&(h.pooledCache=null,we(d)))}function Ro(){return il(),Co(),ep(),df()}function df(){if(is!==5)return!1;var h=ml,d=ph;ph=0;var _=G(Bo),T=32>_?32:_;_=zt.T;var N=Ta();try{xn(T),zt.T=null,T=Op,Op=null;var L=ml,Z=Bo;if(is=0,cu=ml=null,Bo=0,(yn&6)!==0)throw Error(s(331));var ve=yn;if(yn|=4,Kd(L.current),Yd(L,L.current,Z,T),yn=ve,tt(0,!1),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(nu,L)}catch{}return!0}finally{xn(N),zt.T=_,tp(h,d)}}function Kl(h,d,_){d=ne(_,d),d=og(h.stateNode,d,2),h=Hs(h,d,2),h!==null&&(O(h,2),it(h))}function Yt(h,d,_){if(h.tag===3)Kl(h,h,_);else for(;d!==null;){if(d.tag===3){Kl(d,h,_);break}else if(d.tag===1){var T=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(pl===null||!pl.has(T))){h=ne(_,h),_=py(2),T=Hs(d,_,2),T!==null&&(my(_,T,d,h),O(T,2),it(T));break}}d=d.return}}function Ju(h,d,_){var T=h.pingCache;if(T===null){T=h.pingCache=new ea;var N=new Set;T.set(d,N)}else N=T.get(d),N===void 0&&(N=new Set,T.set(d,N));N.has(_)||(uc=!0,N.add(_),h=Oy.bind(null,h,d,_),d.then(h,h))}function Oy(h,d,_){var T=h.pingCache;T!==null&&T.delete(d),h.pingedLanes|=h.suspendedLanes&_,h.warmLanes&=~_,hn===h&&(Sn&_)===_&&(Ci===4||Ci===3&&(Sn&62914560)===Sn&&300>Zs()-Of?(yn&2)===0&&Oi(h,0):fh|=_,dh===Sn&&(dh=0)),it(h)}function Py(h,d){d===0&&(d=I()),h=ni(h,d),h!==null&&(O(h,d),it(h))}function LS(h){var d=h.memoizedState,_=0;d!==null&&(_=d.retryLane),Py(h,_)}function FS(h,d){var _=0;switch(h.tag){case 31:case 13:var T=h.stateNode,N=h.memoizedState;N!==null&&(_=N.retryLane);break;case 19:T=h.stateNode;break;case 22:T=h.stateNode._retryCache;break;default:throw Error(s(314))}T!==null&&T.delete(d),Py(h,_)}function es(h,d){return Tf(h,d)}function Mg(h,d,_,T){this.tag=h,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hc(h){return h=h.prototype,!(!h||!h.isReactComponent)}function Yr(h,d){var _=h.alternate;return _===null?(_=t(h.tag,d,h.key,h.mode),_.elementType=h.elementType,_.type=h.type,_.stateNode=h.stateNode,_.alternate=h,h.alternate=_):(_.pendingProps=d,_.type=h.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=h.flags&65011712,_.childLanes=h.childLanes,_.lanes=h.lanes,_.child=h.child,_.memoizedProps=h.memoizedProps,_.memoizedState=h.memoizedState,_.updateQueue=h.updateQueue,d=h.dependencies,_.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},_.sibling=h.sibling,_.index=h.index,_.ref=h.ref,_.refCleanup=h.refCleanup,_}function np(h,d){h.flags&=65011714;var _=h.alternate;return _===null?(h.childLanes=0,h.lanes=d,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=_.childLanes,h.lanes=_.lanes,h.child=_.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=_.memoizedProps,h.memoizedState=_.memoizedState,h.updateQueue=_.updateQueue,h.type=_.type,d=_.dependencies,h.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),h}function sl(h,d,_,T,N,L){var Z=0;if(T=h,typeof h=="function")Hc(h)&&(Z=1);else if(typeof h=="string")Z=wa&&cs?vp(h,_,ws.current)?26:a0(h)?27:5:wa?vp(h,_,ws.current)?26:5:cs&&a0(h)?27:5;else e:switch(h){case vf:return h=t(31,_,d,N),h.elementType=vf,h.lanes=L,h;case Xc:return Sa(_.children,N,L,d);case Yc:Z=8,N|=24;break;case Zc:return h=t(12,_,d,N|2),h.elementType=Zc,h.lanes=L,h;case ap:return h=t(13,_,d,N),h.elementType=ap,h.lanes=L,h;case rl:return h=t(19,_,d,N),h.elementType=rl,h.lanes=L,h;default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case Ma:Z=10;break e;case gf:Z=9;break e;case $u:Z=11;break e;case op:Z=14;break e;case or:Z=16,T=null;break e}Z=29,_=Error(s(130,h===null?"null":typeof h,"")),T=null}return d=t(Z,_,d,N),d.elementType=h,d.type=T,d.lanes=L,d}function Sa(h,d,_,T){return h=t(7,h,T,d),h.lanes=_,h}function Tg(h,d,_){return h=t(6,h,null,d),h.lanes=_,h}function wg(h){var d=t(18,null,null,0);return d.stateNode=h,d}function Ag(h,d,_){return d=t(4,h.children!==null?h.children:[],h.key,d),d.lanes=_,d.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},d}function Uy(h,d,_,T,N,L,Z,ve,Ze){this.tag=1,this.containerInfo=h,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Sr,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=D(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=D(0),this.hiddenUpdates=D(null),this.identifierPrefix=T,this.onUncaughtError=N,this.onCaughtError=L,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ze,this.incompleteTransitions=new Map}function Ql(h,d,_,T,N,L,Z,ve,Ze,lt,vt,ft){return h=new Uy(h,d,_,Z,Ze,lt,vt,ft,ve),d=1,L===!0&&(d|=24),L=t(3,null,null,d),h.current=L,L.stateNode=h,d=Re(),d.refCount++,h.pooledCache=d,d.refCount++,L.memoizedState={element:T,isDehydrated:_,cache:d},Ni(L),h}function ip(h){return h?(h=No,h):No}function pf(h){var d=h._reactInternals;if(d===void 0)throw typeof h.render=="function"?Error(s(188)):(h=Object.keys(h).join(","),Error(s(268,h)));return h=l(d),h=h!==null?u(h):null,h===null?null:th(h.stateNode)}function Eg(h,d,_,T,N,L){N=ip(N),T.context===null?T.context=N:T.pendingContext=N,T=ir(d),T.payload={element:_},L=L===void 0?null:L,L!==null&&(T.callback=L),_=Hs(h,T,d),_!==null&&(Ti(_,h,d),zr(_,h,d))}function Wc(h,d){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var _=h.retryLane;h.retryLane=_!==0&&_<d?_:d}}function mf(h,d){Wc(h,d),(h=h.alternate)&&Wc(h,d)}var cn={},sp=KN,xr=E7,rp=Object.assign,jc=Symbol.for("react.element"),Do=Symbol.for("react.transitional.element"),qc=Symbol.for("react.portal"),Xc=Symbol.for("react.fragment"),Yc=Symbol.for("react.strict_mode"),Zc=Symbol.for("react.profiler"),gf=Symbol.for("react.consumer"),Ma=Symbol.for("react.context"),$u=Symbol.for("react.forward_ref"),ap=Symbol.for("react.suspense"),rl=Symbol.for("react.suspense_list"),op=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),vf=Symbol.for("react.activity"),Cg=Symbol.for("react.memo_cache_sentinel"),al=Symbol.iterator,Jl=Symbol.for("react.client.reference"),$l=Array.isArray,zt=sp.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Rg=e.rendererVersion,yf=e.rendererPackageName,eh=e.extraDevToolsConfig,th=e.getPublicInstance,Ly=e.getRootHostContext,nh=e.getChildHostContext,lp=e.prepareForCommit,Fy=e.resetAfterCommit,Dg=e.createInstance;e.cloneMutableInstance;var _f=e.appendInitialChild,br=e.finalizeInitialChildren,lr=e.shouldSetTextContent,ol=e.createTextInstance;e.cloneMutableTextInstance;var Ng=e.scheduleTimeout,ky=e.cancelTimeout,Sr=e.noTimeout,Vi=e.isPrimaryRenderer;e.warnsIfNotActing;var An=e.supportsMutation,Zr=e.supportsPersistence,_i=e.supportsHydration,sn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var Kn=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var xn=e.setCurrentUpdatePriority,Ta=e.getCurrentUpdatePriority,ih=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var Kc=e.shouldAttemptEagerTransition,cp=e.detachDeletedInstance;e.requestPostPaintCallback;var xf=e.maySuspendCommit,sh=e.maySuspendCommitOnUpdate,Ig=e.maySuspendCommitInSyncRender,wi=e.preloadInstance,Og=e.startSuspendingCommit,up=e.suspendInstance;e.suspendOnActiveViewTransition;var By=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var Qc=e.NotPendingTransition,Jc=e.HostTransitionContext,Pg=e.resetFormInstance;e.bindToConsole;var Ug=e.supportsMicrotasks,Lg=e.scheduleMicrotask,ls=e.supportsTestSelectors,Gi=e.findFiberRoot,hp=e.getBoundingRect,bf=e.getTextContent,ec=e.isHiddenSubtree,Fg=e.matchAccessibilityRole,ll=e.setFocusIfFocusable,fp=e.setupIntersectionObserver,kg=e.appendChild,Bg=e.appendChildToContainer,zy=e.commitTextUpdate,Vy=e.commitMount,Gy=e.commitUpdate,Hy=e.insertBefore,Wy=e.insertInContainerBefore,jy=e.removeChild,zg=e.removeChildFromContainer,Vg=e.resetTextContent,kS=e.hideInstance,qy=e.hideTextInstance,Xy=e.unhideInstance,Yy=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var Gg=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var Zy=e.cloneInstance,Hg=e.createContainerChildSet,Wg=e.appendChildToContainerChildSet,Ky=e.finalizeContainerChildren,jg=e.replaceContainerChildren,Qy=e.cloneHiddenInstance,qg=e.cloneHiddenTextInstance,tc=e.isSuspenseInstancePending,dp=e.isSuspenseInstanceFallback,pp=e.getSuspenseInstanceFallbackErrorDetails,mp=e.registerSuspenseInstanceRetry,Jy=e.canHydrateFormStateMarker,Xg=e.isFormStateMarkerMatching,$y=e.getNextHydratableSibling,e_=e.getNextHydratableSiblingAfterSingleton,t_=e.getFirstHydratableChild,n_=e.getFirstHydratableChildWithinContainer,i_=e.getFirstHydratableChildWithinActivityInstance,s_=e.getFirstHydratableChildWithinSuspenseInstance,Yg=e.getFirstHydratableChildWithinSingleton,r_=e.canHydrateInstance,a_=e.canHydrateTextInstance,Zg=e.canHydrateActivityInstance,o_=e.canHydrateSuspenseInstance,l_=e.hydrateInstance,BS=e.hydrateTextInstance,Kg=e.hydrateActivityInstance,c_=e.hydrateSuspenseInstance,u_=e.getNextHydratableInstanceAfterActivityInstance,Qg=e.getNextHydratableInstanceAfterSuspenseInstance,h_=e.commitHydratedInstance,f_=e.commitHydratedContainer,zS=e.commitHydratedActivityInstance,VS=e.commitHydratedSuspenseInstance,d_=e.finalizeHydratedChildren,Sf=e.flushHydrationEvents;e.clearActivityBoundary;var Jg=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var gp=e.clearSuspenseBoundaryFromContainer,p_=e.hideDehydratedBoundary,m_=e.unhideDehydratedBoundary,rh=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var g_=e.validateHydratableInstance,$g=e.validateHydratableTextInstance,wa=e.supportsResources,vp=e.isHostHoistableType,Mf=e.getHoistableRoot,e0=e.getResource,t0=e.acquireResource,nc=e.releaseResource,v_=e.hydrateHoistable,n0=e.mountHoistable,i0=e.unmountHoistable,yp=e.createHoistableInstance,y_=e.prepareToCommitHoistables,s0=e.mayResourceSuspendCommit,r0=e.preloadResource,__=e.suspendResource,cs=e.supportsSingletons,_p=e.resolveSingletonInstance,ts=e.acquireSingletonInstance,Ts=e.releaseSingletonInstance,a0=e.isHostSingletonType,$c=e.isSingletonScope,xp=[],eu=-1,No={},Mr=Math.clz32?Math.clz32:w,bp=Math.log,x_=Math.LN2,Sp=256,tu=262144,ah=4194304,Tf=xr.unstable_scheduleCallback,Mp=xr.unstable_cancelCallback,b_=xr.unstable_shouldYield,o0=xr.unstable_requestPaint,Zs=xr.unstable_now,Tp=xr.unstable_ImmediatePriority,S_=xr.unstable_UserBlockingPriority,wf=xr.unstable_NormalPriority,wp=xr.unstable_IdlePriority,l0=xr.log,M_=xr.unstable_setDisableYieldValue,nu=null,Tr=null,Hi=typeof Object.is=="function"?Object.is:K,Ap=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)},GS=Object.prototype.hasOwnProperty,Ep,Io,Af=!1,c0=new WeakMap,cl=[],Oo=0,Qn=null,Ef=0,Aa=[],Kr=0,Ea=null,Ps=1,$a="",ws=v(null),ul=v(null),Us=v(null),Cf=v(null),us=null,xi=null,bn=!1,Po=null,cr=!1,Cp=Error(s(519)),Ca=v(null),ri=null,eo=null,T_=typeof AbortController<"u"?AbortController:function(){var h=[],d=this.signal={aborted:!1,addEventListener:function(_,T){h.push(T)}};this.abort=function(){d.aborted=!0,h.forEach(function(_){return _()})}},As=xr.unstable_scheduleCallback,HS=xr.unstable_NormalPriority,bi={$$typeof:Ma,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Rf=null,qn=null,Ks=!1,Ra=!1,Rp=!1,ic=0,oh=null,u0=0,hl=0,hs=null,Da=zt.S;zt.S=function(h,d){lu=Zs(),typeof d=="object"&&d!==null&&typeof d.then=="function"&&ct(h,d),Da!==null&&Da(h,d)};var sc=v(null),fs=Error(s(460)),Dp=Error(s(474)),Na=Error(s(542)),Uo={then:function(){}},ur=null,rc=null,iu=0,Ls=Gs(!0),h0=Gs(!1),Fs=[],Lo=0,su=0,Qr=!1,Np=!1,ru=v(null),ac=v(0),wr=v(null),Ar=null,Pi=v(0),fl=0,rn=null,Lt=null,Jt=null,un=!1,ln=!1,Rn=!1,Qs=0,Ia=0,to=null,f0=0,Jr={readContext:q,use:Ii,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useLayoutEffect:ut,useInsertionEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useSyncExternalStore:ut,useId:ut,useHostTransitionStatus:ut,useFormState:ut,useActionState:ut,useOptimistic:ut,useMemoCache:ut,useCacheRefresh:ut};Jr.useEffectEvent=ut;var Ai={readContext:q,use:Ii,useCallback:function(h,d){return Xt().memoizedState=[h,d===void 0?null:d],h},useContext:q,useEffect:Fl,useImperativeHandle:function(h,d,_){_=_!=null?_.concat([h]):null,Za(4194308,4,go.bind(null,d,h),_)},useLayoutEffect:function(h,d){return Za(4194308,4,h,d)},useInsertionEffect:function(h,d){Za(4,2,h,d)},useMemo:function(h,d){var _=Xt();d=d===void 0?null:d;var T=h();if(Rn){j(!0);try{h()}finally{j(!1)}}return _.memoizedState=[T,d],T},useReducer:function(h,d,_){var T=Xt();if(_!==void 0){var N=_(d);if(Rn){j(!0);try{_(d)}finally{j(!1)}}}else N=d;return T.memoizedState=T.baseState=N,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:N},T.queue=h,h=h.dispatch=Xs.bind(null,rn,h),[T.memoizedState,h]},useRef:function(h){var d=Xt();return h={current:h},d.memoizedState=h},useState:function(h){h=Pl(h);var d=h.queue,_=Qa.bind(null,rn,d);return d.dispatch=_,[h.memoizedState,_]},useDebugValue:zl,useDeferredValue:function(h,d){var _=Xt();return $i(_,h,d)},useTransition:function(){var h=Pl(!1);return h=Lc.bind(null,rn,h.queue,!0,!1),Xt().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,d,_){var T=rn,N=Xt();if(bn){if(_===void 0)throw Error(s(407));_=_()}else{if(_=d(),hn===null)throw Error(s(349));(Sn&127)!==0||Bi(T,d,_)}N.memoizedState=_;var L={value:_,getSnapshot:d};return N.queue=L,Fl(Ya.bind(null,T,L,h),[h]),T.flags|=2048,qs(9,{destroy:void 0},zi.bind(null,T,L,_,d),null),_},useId:function(){var h=Xt(),d=hn.identifierPrefix;if(bn){var _=$a,T=Ps;_=(T&~(1<<32-Mr(T)-1)).toString(32)+_,d="_"+d+"R_"+_,_=Qs++,0<_&&(d+="H"+_.toString(32)),d+="_"}else _=f0++,d="_"+d+"r_"+_.toString(32)+"_";return h.memoizedState=d},useHostTransitionStatus:Fu,useFormState:Ul,useActionState:Ul,useOptimistic:function(h){var d=Xt();d.memoizedState=d.baseState=h;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=_,d=kd.bind(null,rn,!0,_),_.dispatch=d,[h,d]},useMemoCache:Ws,useCacheRefresh:function(){return Xt().memoizedState=jr.bind(null,rn)},useEffectEvent:function(h){var d=Xt(),_={impl:h};return d.memoizedState=_,function(){if((yn&2)!==0)throw Error(s(440));return _.impl.apply(void 0,arguments)}}},Fo={readContext:q,use:Ii,useCallback:vo,useContext:q,useEffect:ga,useImperativeHandle:Bl,useInsertionEffect:Ka,useLayoutEffect:Jo,useMemo:yo,useReducer:xs,useRef:Uc,useState:function(){return xs(kn)},useDebugValue:zl,useDeferredValue:function(h,d){var _=bt();return tf(_,Lt.memoizedState,h,d)},useTransition:function(){var h=xs(kn)[0],d=bt().memoizedState;return[typeof h=="boolean"?h:Pt(h),d]},useSyncExternalStore:gi,useId:ku,useHostTransitionStatus:Fu,useFormState:po,useActionState:po,useOptimistic:function(h,d){var _=bt();return pa(_,Lt,h,d)},useMemoCache:Ws,useCacheRefresh:Is};Fo.useEffectEvent=vi;var oc={readContext:q,use:Ii,useCallback:vo,useContext:q,useEffect:ga,useImperativeHandle:Bl,useInsertionEffect:Ka,useLayoutEffect:Jo,useMemo:yo,useReducer:mi,useRef:Uc,useState:function(){return mi(kn)},useDebugValue:zl,useDeferredValue:function(h,d){var _=bt();return Lt===null?$i(_,h,d):tf(_,Lt.memoizedState,h,d)},useTransition:function(){var h=mi(kn)[0],d=bt().memoizedState;return[typeof h=="boolean"?h:Pt(h),d]},useSyncExternalStore:gi,useId:ku,useHostTransitionStatus:Fu,useFormState:mo,useActionState:mo,useOptimistic:function(h,d){var _=bt();return Lt!==null?pa(_,Lt,h,d):(_.baseState=h,[h,_.queue.dispatch])},useMemoCache:Ws,useCacheRefresh:Is};oc.useEffectEvent=vi;var Df={enqueueSetState:function(h,d,_){h=h._reactInternals;var T=yi(),N=ir(T);N.payload=d,_!=null&&(N.callback=_),d=Hs(h,N,T),d!==null&&(Ti(d,h,T),zr(d,h,T))},enqueueReplaceState:function(h,d,_){h=h._reactInternals;var T=yi(),N=ir(T);N.tag=1,N.payload=d,_!=null&&(N.callback=_),d=Hs(h,N,T),d!==null&&(Ti(d,h,T),zr(d,h,T))},enqueueForceUpdate:function(h,d){h=h._reactInternals;var _=yi(),T=ir(_);T.tag=2,d!=null&&(T.callback=d),d=Hs(h,T,_),d!==null&&(Ti(d,h,_),zr(d,h,_))}},hr=Error(s(461)),hi=!1,au={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},Ui=!1,Li=!1,lh=!1,d0=typeof WeakSet=="function"?WeakSet:Set,Wi=null,Ei=null,ji=!1,Xn=null,$r=8192,ch={getCacheForType:function(h){var d=q(bi),_=d.data.get(h);return _===void 0&&(_=h(),d.data.set(h,_)),_},cacheSignal:function(){return q(bi).controller.signal}},Oa=0,uh=1,hh=2,Nf=3,lc=4;if(typeof Symbol=="function"&&Symbol.for){var ou=Symbol.for;Oa=ou("selector.component"),uh=ou("selector.has_pseudo_class"),hh=ou("selector.role"),Nf=ou("selector.test_id"),lc=ou("selector.text")}var ea=typeof WeakMap=="function"?WeakMap:Map,yn=0,hn=null,_n=null,Sn=0,Yn=0,ns=null,no=!1,cc=!1,uc=!1,ko=0,Ci=0,dl=0,hc=0,fh=0,fr=0,dh=0,If=null,Er=null,Ip=!1,Of=0,lu=0,fc=1/0,Pf=null,pl=null,is=0,ml=null,cu=null,Bo=0,ph=0,Op=null,p0=null,Un=0,Uf=null;return cn.attemptContinuousHydration=function(h){if(h.tag===13||h.tag===31){var d=ni(h,67108864);d!==null&&Ti(d,h,67108864),mf(h,67108864)}},cn.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13||h.tag===31){var d=yi();d=H(d);var _=ni(h,d);_!==null&&Ti(_,h,d),mf(h,d)}},cn.attemptSynchronousHydration=function(h){switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var d=M(h.pendingLanes);if(d!==0){for(h.pendingLanes|=2,h.entangledLanes|=2;d;){var _=1<<31-Mr(d);h.entanglements[1]|=_,d&=~_}it(h),(yn&6)===0&&(fc=Zs()+500,tt(0))}}break;case 31:case 13:d=ni(h,2),d!==null&&Ti(d,h,2),Qd(),mf(h,2)}},cn.batchedUpdates=function(h,d){return h(d)},cn.createComponentSelector=function(h){return{$$typeof:Oa,value:h}},cn.createContainer=function(h,d,_,T,N,L,Z,ve,Ze,lt){return Ql(h,d,!1,null,_,T,L,null,Z,ve,Ze,lt)},cn.createHasPseudoClassSelector=function(h){return{$$typeof:uh,value:h}},cn.createHydrationContainer=function(h,d,_,T,N,L,Z,ve,Ze,lt,vt,ft,At,tn){var qi;return h=Ql(_,T,!0,h,N,L,ve,tn,Ze,lt,vt,ft),h.context=ip(null),_=h.current,T=yi(),T=H(T),N=ir(T),N.callback=(qi=d)!=null?qi:null,Hs(_,N,T),d=T,h.current.lanes=d,O(h,d),it(h),h},cn.createPortal=function(h,d,_){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qc,key:T==null?null:""+T,children:h,containerInfo:d,implementation:_}},cn.createRoleSelector=function(h){return{$$typeof:hh,value:h}},cn.createTestNameSelector=function(h){return{$$typeof:Nf,value:h}},cn.createTextSelector=function(h){return{$$typeof:lc,value:h}},cn.defaultOnCaughtError=function(h){console.error(h)},cn.defaultOnRecoverableError=function(h){Ap(h)},cn.defaultOnUncaughtError=function(h){Ap(h)},cn.deferredUpdates=function(h){var d=zt.T,_=Ta();try{return xn(32),zt.T=null,h()}finally{xn(_),zt.T=d}},cn.discreteUpdates=function(h,d,_,T,N){var L=zt.T,Z=Ta();try{return xn(2),zt.T=null,h(d,_,T,N)}finally{xn(Z),zt.T=L,yn===0&&(fc=Zs()+500)}},cn.findAllNodes=_r,cn.findBoundingRects=function(h,d){if(!ls)throw Error(s(363));d=_r(h,d),h=[];for(var _=0;_<d.length;_++)h.push(hp(d[_]));for(d=h.length-1;0<d;d--){_=h[d];for(var T=_.x,N=T+_.width,L=_.y,Z=L+_.height,ve=d-1;0<=ve;ve--)if(d!==ve){var Ze=h[ve],lt=Ze.x,vt=lt+Ze.width,ft=Ze.y,At=ft+Ze.height;if(T>=lt&&L>=ft&&N<=vt&&Z<=At){h.splice(d,1);break}else if(T!==lt||_.width!==Ze.width||At<L||ft>Z){if(!(L!==ft||_.height!==Ze.height||vt<T||lt>N)){lt>T&&(Ze.width+=lt-T,Ze.x=T),vt<N&&(Ze.width=N-lt),h.splice(d,1);break}}else{ft>L&&(Ze.height+=ft-L,Ze.y=L),At<Z&&(Ze.height=Z-ft),h.splice(d,1);break}}}return h},cn.findHostInstance=pf,cn.findHostInstanceWithNoPortals=function(h){return h=l(h),h=h!==null?f(h):null,h===null?null:th(h.stateNode)},cn.findHostInstanceWithWarning=function(h){return pf(h)},cn.flushPassiveEffects=Ro,cn.flushSyncFromReconciler=function(h){var d=yn;yn|=1;var _=zt.T,T=Ta();try{if(xn(2),zt.T=null,h)return h()}finally{xn(T),zt.T=_,yn=d,(yn&6)===0&&tt(0)}},cn.flushSyncWork=Qd,cn.focusWithin=function(h,d){if(!ls)throw Error(s(363));for(h=ql(h),d=Yu(h,d),d=Array.from(d),h=0;h<d.length;){var _=d[h++],T=_.tag;if(!ec(_)){if((T===5||T===26||T===27)&&ll(_.stateNode))return!0;for(_=_.child;_!==null;)d.push(_),_=_.sibling}}return!1},cn.getFindAllNodesFailureDescription=function(h,d){if(!ls)throw Error(s(363));var _=0,T=[];h=[ql(h),0];for(var N=0;N<h.length;){var L=h[N++],Z=L.tag,ve=h[N++],Ze=d[ve];if((Z!==5&&Z!==26&&Z!==27||!ec(L))&&(Xl(L,Ze)&&(T.push(Xu(Ze)),ve++,ve>_&&(_=ve)),ve<d.length))for(L=L.child;L!==null;)h.push(L,ve),L=L.sibling}if(_<d.length){for(h=[];_<d.length;_++)h.push(Xu(d[_]));return`findAllNodes was able to match part of the selector:
  `+(T.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},cn.getPublicRootInstance=function(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 27:case 5:return th(h.child.stateNode);default:return h.child.stateNode}},cn.injectIntoDevTools=function(){var h={bundleType:0,version:Rg,rendererPackageName:yf,currentDispatcherRef:zt,reconcilerVersion:"19.2.0"};if(eh!==null&&(h.rendererConfig=eh),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(d.isDisabled||!d.supportsFiber)h=!0;else{try{nu=d.inject(h),Tr=d}catch{}h=!!d.checkDCE}}return h},cn.isAlreadyRendering=function(){return(yn&6)!==0},cn.observeVisibleRects=function(h,d,_,T){if(!ls)throw Error(s(363));h=_r(h,d);var N=fp(h,_,T).disconnect;return{disconnect:function(){N()}}},cn.shouldError=function(){return null},cn.shouldSuspend=function(){return!1},cn.startHostTransition=function(h,d,_,T){if(h.tag!==5)throw Error(s(476));var N=Fc(h).queue;Lc(h,N,d,Qc,_===null?n:function(){var L=Fc(h);return L.next===null&&(L=h.alternate.memoizedState),Vl(h,L.next.queue,{},yi()),_(T)})},cn.updateContainer=function(h,d,_,T){var N=d.current,L=yi();return Eg(N,L,h,d,_,T),L},cn.updateContainerSync=function(h,d,_,T){return Eg(d.current,2,h,d,_,T),2},cn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(nN)),nN.exports}var sN;function ej(){return sN||(sN=1,tN.exports=$7()),tN.exports}var tj=ej();const nj=J7(tj);function ij(i){const e=nj(i);return e.injectIntoDevTools(),e}const IU=0,Lm={},sj=/^three(?=[A-Z])/,uS=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let rj=0;const aj=i=>typeof i=="function";function oj(i){if(aj(i)){const e=`${rj++}`;return Lm[e]=i,e}else Object.assign(Lm,i)}function OU(i,e){const t=uS(i),n=Lm[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function lj(i,e,t){var n;return i=uS(i)in Lm?i:i.replace(sj,""),OU(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,i1(e.object,t,i,e)}function cj(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?r1(i.parent,i):Fa(i.object)&&(i.object.visible=!1),i.isHidden=!0,Km(i)}}function PU(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?s1(i.parent,i):Fa(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Km(i)}}function vE(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var s,r;const o=Lm[uS(e.type)];e.object=(s=e.props.object)!=null?s:new o(...(r=e.props.args)!=null?r:[]),e.object.__r3f=e}if(Oh(e.object,e.props),e.props.attach)s1(i,e);else if(Fa(e.object)&&Fa(i.object)){const o=i.object.children.indexOf(t?.object);if(t&&o!==-1){const l=i.object.children.indexOf(e.object);if(l!==-1){i.object.children.splice(l,1);const u=l<o?o-1:o;i.object.children.splice(u,0,e.object)}else e.object.parent=i.object,i.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const o of e.children)vE(e,o);Km(e)}}function AT(i,e){e&&(e.parent=i,i.children.push(e),vE(i,e))}function rN(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),vE(i,e,t)}function UU(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():Mw.unstable_scheduleCallback(Mw.unstable_IdlePriority,e)}}function ww(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?r1(i,e):Fa(e.object)&&Fa(i.object)&&(i.object.remove(e.object),W7(TU(e),e.object));const s=e.props.dispose!==null&&t!==!1;for(let r=e.children.length-1;r>=0;r--){const o=e.children[r];ww(e,o,s)}e.children.length=0,delete e.object.__r3f,s&&e.type!=="primitive"&&e.object.type!=="Scene"&&UU(e.object),t===void 0&&Km(e)}function uj(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const Jx=[];function hj(){for(const[t]of Jx){const n=t.parent;if(n){t.props.attach?r1(n,t):Fa(t.object)&&Fa(n.object)&&n.object.remove(t.object);for(const s of t.children)s.props.attach?r1(t,s):Fa(s.object)&&Fa(t.object)&&t.object.remove(s.object)}t.isHidden&&PU(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&UU(t.object)}for(const[t,n,s]of Jx){t.props=n;const r=t.parent;if(r){var i,e;const o=Lm[uS(t.type)];t.object=(i=t.props.object)!=null?i:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,uj(s,t.object),Oh(t.object,t.props),t.props.attach?s1(r,t):Fa(t.object)&&Fa(r.object)&&r.object.add(t.object);for(const l of t.children)l.props.attach?s1(t,l):Fa(l.object)&&Fa(t.object)&&t.object.add(l.object);Km(t)}}Jx.length=0}const ET=()=>{},aN={};let Fx=IU;const fj=0,dj=4,Aw=ij({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:lj,removeChild:ww,appendChild:AT,appendInitialChild:AT,insertBefore:rN,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||AT(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||ww(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||rN(n,e,t)},getRootHostContext:()=>aN,getChildHostContext:()=>aN,commitUpdate(i,e,t,n,s){var r,o,l;OU(e,n);let u=!1;if((i.type==="primitive"&&t.object!==n.object||((r=n.args)==null?void 0:r.length)!==((o=t.args)==null?void 0:o.length)||(l=n.args)!=null&&l.some((p,g)=>{var v;return p!==((v=t.args)==null?void 0:v[g])}))&&(u=!0),u)Jx.push([i,{...n},s]);else{const p=z7(i,n);Object.keys(p).length&&(Object.assign(i.props,p),Oh(i.object,p))}(s.sibling===null||(s.flags&dj)===fj)&&hj()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i?.object,prepareForCommit:()=>null,preparePortalMount:i=>i1(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:cj,unhideInstance:PU,createTextInstance:ET,hideTextInstance:ET,unhideTextInstance:ET,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:_e.createContext(null),setCurrentUpdatePriority(i){Fx=i},getCurrentUpdatePriority(){return Fx},resolveUpdatePriority(){var i;if(Fx!==IU)return Fx;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return K7;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Y7;default:return Z7}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:Q7.version,applyViewTransitionName(i,e,t){},restoreViewTransitionName(i,e){},cancelViewTransitionName(i,e,t){},cancelRootViewTransitionName(i){},restoreRootViewTransitionName(i){},InstanceMeasurement:null,measureInstance:i=>null,wasInstanceInViewport:i=>!0,hasInstanceChanged:(i,e)=>!1,hasInstanceAffectedParent:(i,e)=>!1,suspendOnActiveViewTransition(i,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(i){},createViewTransitionInstance:i=>null,getCurrentGestureOffset(i){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(i,e){return i},cloneMutableTextInstance(i){return i},cloneRootViewTransitionContainer(i){throw new Error("Not implemented.")},removeRootViewTransitionClone(i,e){throw new Error("Not implemented.")},createFragmentInstance:i=>null,updateFragmentInstanceFiber(i,e){},commitNewChildToFragmentInstance(i,e){},deleteChildFromFragmentInstance(i,e){},measureClonedInstance:i=>null,maySuspendCommitOnUpdate:(i,e,t)=>!1,maySuspendCommitInSyncRender:(i,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(i,e)=>null}),Ad=new Map,am={objects:"shallow",strict:!1};function pj(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:s,left:r}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:s,left:r}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function mj(i){const e=Ad.get(i),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,r=n||q7(Rw,lN),o=t||Aw.createContainer(r,X7,null,!1,null,"",s,s,s,null);e||Ad.set(i,{fiber:o,store:r});let l,u,f=!1,p=null;return{async configure(g={}){let v;p=new Promise(B=>v=B);let{gl:x,size:b,scene:w,events:M,onCreated:S,shadows:C=!1,linear:R=!1,flat:I=!1,legacy:D=!1,orthographic:O=!1,frameloop:U="always",dpr:k=[1,2],performance:P,raycaster:F,camera:H,onPointerMissed:G}=g,j=r.getState(),K=j.gl;if(!j.gl){const B={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},Q=typeof x=="function"?await x(B):x;eN(Q)?K=Q:K=new xU({...B,...x}),j.set({gl:K})}let te=j.raycaster;te||j.set({raycaster:te=new fU});const{params:W,...X}=F||{};if(Xi.equ(X,te,am)||Oh(te,{...X}),Xi.equ(W,te.params,am)||Oh(te,{params:{...te.params,...W}}),!j.camera||j.camera===u&&!Xi.equ(u,H,am)){u=H;const B=H?.isCamera,Q=B?H:O?new Mu(0,0,0,0,.1,1e3):new ps(75,0,.1,1e3);B||(Q.position.z=5,H&&(Oh(Q,H),Q.manual||("aspect"in H||"left"in H||"right"in H||"bottom"in H||"top"in H)&&(Q.manual=!0,Q.updateProjectionMatrix())),!j.camera&&!(H!=null&&H.rotation)&&Q.lookAt(0,0,0)),j.set({camera:Q}),te.camera=Q}if(!j.scene){let B;w!=null&&w.isScene?(B=w,i1(B,r,"",{})):(B=new WA,i1(B,r,"",{}),w&&Oh(B,w)),j.set({scene:B})}M&&!j.events.handlers&&j.set({events:M(r)});const oe=pj(i,b);if(Xi.equ(oe,j.size,am)||j.setSize(oe.width,oe.height,oe.top,oe.left),k&&j.viewport.dpr!==EU(k)&&j.setDpr(k),j.frameloop!==U&&j.setFrameloop(U),j.onPointerMissed||j.set({onPointerMissed:G}),P&&!Xi.equ(P,j.performance,am)&&j.set(B=>({performance:{...B.performance,...P}})),!j.xr){var ne;const B=(fe,de)=>{const se=r.getState();se.frameloop!=="never"&&lN(fe,!0,se,de)},Q=()=>{const fe=r.getState();fe.gl.xr.enabled=fe.gl.xr.isPresenting,fe.gl.xr.setAnimationLoop(fe.gl.xr.isPresenting?B:null),fe.gl.xr.isPresenting||Rw(fe)},ae={connect(){const fe=r.getState().gl;fe.xr.addEventListener("sessionstart",Q),fe.xr.addEventListener("sessionend",Q)},disconnect(){const fe=r.getState().gl;fe.xr.removeEventListener("sessionstart",Q),fe.xr.removeEventListener("sessionend",Q)}};typeof((ne=K.xr)==null?void 0:ne.addEventListener)=="function"&&ae.connect(),j.set({xr:ae})}if(K.shadowMap){const B=K.shadowMap.enabled,Q=K.shadowMap.type;if(K.shadowMap.enabled=!!C,Xi.boo(C))K.shadowMap.type=K0;else if(Xi.str(C)){var ie;const ae={basic:OO,percentage:Mm,soft:K0,variance:ad};K.shadowMap.type=(ie=ae[C])!=null?ie:K0}else Xi.obj(C)&&Object.assign(K.shadowMap,C);(B!==K.shadowMap.enabled||Q!==K.shadowMap.type)&&(K.shadowMap.needsUpdate=!0)}return On.enabled=!D,f||(K.outputColorSpace=R?Gh:Ir,K.toneMapping=I?Xo:E1),j.legacy!==D&&j.set(()=>({legacy:D})),j.linear!==R&&j.set(()=>({linear:R})),j.flat!==I&&j.set(()=>({flat:I})),x&&!Xi.fun(x)&&!eN(x)&&!Xi.equ(x,K,am)&&Oh(K,x),l=S,f=!0,v(),this},render(g){return!f&&!p&&this.configure(),p.then(()=>{Aw.updateContainer(ee.jsx(gj,{store:r,children:g,onCreated:l,rootElement:i}),o,null,()=>{})}),r},unmount(){LU(i)}}}function gj({store:i,children:e,onCreated:t,rootElement:n}){return Jv(()=>{const s=i.getState();s.set(r=>({internal:{...r.internal,active:!0}})),t&&t(s),i.getState().events.connected||s.events.connect==null||s.events.connect(n)},[]),ee.jsx(DU.Provider,{value:i,children:e})}function LU(i,e){const t=Ad.get(i),n=t?.fiber;if(n){const s=t?.store.getState();s&&(s.internal.active=!1),Aw.updateContainer(null,n,null,()=>{s&&setTimeout(()=>{try{var r,o,l,u;s.events.disconnect==null||s.events.disconnect(),(r=s.gl)==null||(o=r.renderLists)==null||o.dispose==null||o.dispose(),(l=s.gl)==null||l.forceContextLoss==null||l.forceContextLoss(),(u=s.gl)!=null&&u.xr&&s.xr.disconnect(),F7(s.scene),Ad.delete(i)}catch{}},500)})}}const vj=new Set,yj=new Set,_j=new Set;function CT(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function rv(i,e){switch(i){case"before":return CT(vj,e);case"after":return CT(yj,e);case"tail":return CT(_j,e)}}let RT,DT;function Ew(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),RT=e.internal.subscribers;for(let s=0;s<RT.length;s++)DT=RT[s],DT.ref.current(DT.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let a1=!1,Cw=!1,NT,oN,om;function FU(i){oN=requestAnimationFrame(FU),a1=!0,NT=0,rv("before",i),Cw=!0;for(const t of Ad.values()){var e;om=t.store.getState(),om.internal.active&&(om.frameloop==="always"||om.internal.frames>0)&&!((e=om.gl.xr)!=null&&e.isPresenting)&&(NT+=Ew(i,om))}if(Cw=!1,rv("after",i),NT===0)return rv("tail",i),a1=!1,cancelAnimationFrame(oN)}function Rw(i,e=1){var t;if(!i)return Ad.forEach(n=>Rw(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):Cw?i.internal.frames=2:i.internal.frames=1,a1||(a1=!0,requestAnimationFrame(FU)))}function lN(i,e=!0,t,n){if(e&&rv("before",i),t)Ew(i,t,n);else for(const s of Ad.values())Ew(i,s.store.getState());e&&rv("after",i)}const IT={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function xj(i){const{handlePointer:e}=j7(i);return{priority:1,enabled:!0,compute(t,n,s){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(IT).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:s}=i.getState();(t=s.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{const{set:n,events:s}=i.getState();if(s.disconnect==null||s.disconnect(),n(r=>({events:{...r.events,connected:t}})),s.handlers)for(const r in s.handlers){const o=s.handlers[r],[l,u]=IT[r];t.addEventListener(l,o,{passive:u})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const s in n.handlers){const r=n.handlers[s],[o]=IT[s];n.connected.removeEventListener(o,r)}t(s=>({events:{...s.events,connected:void 0}}))}}}}function cN(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function bj({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[r,o]=_e.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=_e.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),u=i?typeof i=="number"?i:i.scroll:null,f=i?typeof i=="number"?i:i.resize:null,p=_e.useRef(!1);_e.useEffect(()=>(p.current=!0,()=>{p.current=!1}));const[g,v,x]=_e.useMemo(()=>{const S=()=>{if(!l.current.element)return;const{left:C,top:R,width:I,height:D,bottom:O,right:U,x:k,y:P}=l.current.element.getBoundingClientRect(),F={left:C,top:R,width:I,height:D,bottom:O,right:U,x:k,y:P};l.current.element instanceof HTMLElement&&n&&(F.height=l.current.element.offsetHeight,F.width=l.current.element.offsetWidth),Object.freeze(F),p.current&&!wj(l.current.lastBounds,F)&&o(l.current.lastBounds=F)};return[S,f?cN(S,f):S,u?cN(S,u):S]},[o,n,u,f]);function b(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(S=>S.removeEventListener("scroll",x,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null),l.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",l.current.orientationHandler))}function w(){l.current.element&&(l.current.resizeObserver=new s(x),l.current.resizeObserver.observe(l.current.element),e&&l.current.scrollContainers&&l.current.scrollContainers.forEach(S=>S.addEventListener("scroll",x,{capture:!0,passive:!0})),l.current.orientationHandler=()=>{x()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",l.current.orientationHandler))}const M=S=>{!S||S===l.current.element||(b(),l.current.element=S,l.current.scrollContainers=kU(S),w())};return Mj(x,!!e),Sj(v),_e.useEffect(()=>{b(),w()},[e,x,v]),_e.useEffect(()=>b,[]),[M,r,g]}function Sj(i){_e.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[i])}function Mj(i,e){_e.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[i,e])}function kU(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:s}=window.getComputedStyle(i);return[t,n,s].some(r=>r==="auto"||r==="scroll")&&e.push(i),[...e,...kU(i.parentElement)]}const Tj=["x","y","top","bottom","left","right","width","height"],wj=(i,e)=>Tj.every(t=>i[t]===e[t]);function Aj({ref:i,children:e,fallback:t,resize:n,style:s,gl:r,events:o=xj,eventSource:l,eventPrefix:u,shadows:f,linear:p,flat:g,legacy:v,orthographic:x,frameloop:b,dpr:w,performance:M,raycaster:S,camera:C,scene:R,onPointerMissed:I,onCreated:D,...O}){_e.useMemo(()=>oj(h7),[]);const U=P7(),[k,P]=bj({scroll:!0,debounce:{scroll:50,resize:0},...n}),F=_e.useRef(null),H=_e.useRef(null);_e.useImperativeHandle(i,()=>F.current);const G=AU(I),[j,K]=_e.useState(!1),[te,W]=_e.useState(!1);if(j)throw j;if(te)throw te;const X=_e.useRef(null);Jv(()=>{const ne=F.current;if(P.width>0&&P.height>0&&ne){X.current||(X.current=mj(ne));async function ie(){await X.current.configure({gl:r,scene:R,events:o,shadows:f,linear:p,flat:g,legacy:v,orthographic:x,frameloop:b,dpr:w,performance:M,raycaster:S,camera:C,size:P,onPointerMissed:(...B)=>G.current==null?void 0:G.current(...B),onCreated:B=>{B.events.connect==null||B.events.connect(l?I7(l)?l.current:l:H.current),u&&B.setEvents({compute:(Q,ae)=>{const fe=Q[u+"X"],de=Q[u+"Y"];ae.pointer.set(fe/ae.size.width*2-1,-(de/ae.size.height)*2+1),ae.raycaster.setFromCamera(ae.pointer,ae.camera)}}),D?.(B)}}),X.current.render(ee.jsx(U,{children:ee.jsx(L7,{set:W,children:ee.jsx(_e.Suspense,{fallback:ee.jsx(U7,{set:K}),children:e??null})})}))}ie()}}),_e.useEffect(()=>{const ne=F.current;if(ne)return()=>LU(ne)},[]);const oe=l?"none":"auto";return ee.jsx("div",{ref:H,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:oe,...s},...O,children:ee.jsx("div",{ref:k,style:{width:"100%",height:"100%"},children:ee.jsx("canvas",{ref:F,style:{display:"block"},children:t})})})}function hS(i){return ee.jsx(SU,{children:ee.jsx(Aj,{...i})})}function Tc(){return Tc=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Tc.apply(null,arguments)}var Ej=Object.defineProperty,Cj=(i,e,t)=>e in i?Ej(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Rj=(i,e,t)=>(Cj(i,e+"",t),t);class Dj{constructor(){Rj(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}}var Nj=Object.defineProperty,Ij=(i,e,t)=>e in i?Nj(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,jt=(i,e,t)=>(Ij(i,typeof e!="symbol"?e+"":e,t),t);const kx=new Nd,uN=new _u,Oj=Math.cos(70*(Math.PI/180)),hN=(i,e)=>(i%e+e)%e;let Pj=class extends Dj{constructor(e,t){super(),jt(this,"object"),jt(this,"domElement"),jt(this,"enabled",!0),jt(this,"target",new re),jt(this,"minDistance",0),jt(this,"maxDistance",1/0),jt(this,"minZoom",0),jt(this,"maxZoom",1/0),jt(this,"minPolarAngle",0),jt(this,"maxPolarAngle",Math.PI),jt(this,"minAzimuthAngle",-1/0),jt(this,"maxAzimuthAngle",1/0),jt(this,"enableDamping",!1),jt(this,"dampingFactor",.05),jt(this,"enableZoom",!0),jt(this,"zoomSpeed",1),jt(this,"enableRotate",!0),jt(this,"rotateSpeed",1),jt(this,"enablePan",!0),jt(this,"panSpeed",1),jt(this,"screenSpacePanning",!0),jt(this,"keyPanSpeed",7),jt(this,"zoomToCursor",!1),jt(this,"autoRotate",!1),jt(this,"autoRotateSpeed",2),jt(this,"reverseOrbit",!1),jt(this,"reverseHorizontalOrbit",!1),jt(this,"reverseVerticalOrbit",!1),jt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),jt(this,"mouseButtons",{LEFT:ed.ROTATE,MIDDLE:ed.DOLLY,RIGHT:ed.PAN}),jt(this,"touches",{ONE:td.ROTATE,TWO:td.DOLLY_PAN}),jt(this,"target0"),jt(this,"position0"),jt(this,"zoom0"),jt(this,"_domElementKeyEvents",null),jt(this,"getPolarAngle"),jt(this,"getAzimuthalAngle"),jt(this,"setPolarAngle"),jt(this,"setAzimuthalAngle"),jt(this,"getDistance"),jt(this,"getZoomScale"),jt(this,"listenToKeyEvents"),jt(this,"stopListenToKeyEvents"),jt(this,"saveState"),jt(this,"reset"),jt(this,"update"),jt(this,"connect"),jt(this,"dispose"),jt(this,"dollyIn"),jt(this,"dollyOut"),jt(this,"getScale"),jt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>p.phi,this.getAzimuthalAngle=()=>p.theta,this.setPolarAngle=le=>{let Te=hN(le,2*Math.PI),ct=p.phi;ct<0&&(ct+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let he=Math.abs(Te-ct);2*Math.PI-he<he&&(Te<ct?Te+=2*Math.PI:ct+=2*Math.PI),g.phi=Te-ct,n.update()},this.setAzimuthalAngle=le=>{let Te=hN(le,2*Math.PI),ct=p.theta;ct<0&&(ct+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let he=Math.abs(Te-ct);2*Math.PI-he<he&&(Te<ct?Te+=2*Math.PI:ct+=2*Math.PI),g.theta=Te-ct,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=le=>{le.addEventListener("keydown",be),this._domElementKeyEvents=le},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",be),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(s),n.update(),u=l.NONE},this.update=(()=>{const le=new re,Te=new re(0,1,0),ct=new Fr().setFromUnitVectors(e.up,Te),he=ct.clone().invert(),We=new re,Je=new Fr,pt=2*Math.PI;return function(){const Le=n.object.position;ct.setFromUnitVectors(e.up,Te),he.copy(ct).invert(),le.copy(Le).sub(n.target),le.applyQuaternion(ct),p.setFromVector3(le),n.autoRotate&&u===l.NONE&&K(G()),n.enableDamping?(p.theta+=g.theta*n.dampingFactor,p.phi+=g.phi*n.dampingFactor):(p.theta+=g.theta,p.phi+=g.phi);let rt=n.minAzimuthAngle,xt=n.maxAzimuthAngle;isFinite(rt)&&isFinite(xt)&&(rt<-Math.PI?rt+=pt:rt>Math.PI&&(rt-=pt),xt<-Math.PI?xt+=pt:xt>Math.PI&&(xt-=pt),rt<=xt?p.theta=Math.max(rt,Math.min(xt,p.theta)):p.theta=p.theta>(rt+xt)/2?Math.max(rt,p.theta):Math.min(xt,p.theta)),p.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,p.phi)),p.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(x,n.dampingFactor):n.target.add(x),n.zoomToCursor&&P||n.object.isOrthographicCamera?p.radius=ae(p.radius):p.radius=ae(p.radius*v),le.setFromSpherical(p),le.applyQuaternion(he),Le.copy(n.target).add(le),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(g.theta*=1-n.dampingFactor,g.phi*=1-n.dampingFactor,x.multiplyScalar(1-n.dampingFactor)):(g.set(0,0,0),x.set(0,0,0));let _t=!1;if(n.zoomToCursor&&P){let Nt=null;if(n.object instanceof ps&&n.object.isPerspectiveCamera){const pn=le.length();Nt=ae(pn*v);const Mn=pn-Nt;n.object.position.addScaledVector(U,Mn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const pn=new re(k.x,k.y,0);pn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix(),_t=!0;const Mn=new re(k.x,k.y,0);Mn.unproject(n.object),n.object.position.sub(Mn).add(pn),n.object.updateMatrixWorld(),Nt=le.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Nt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Nt).add(n.object.position):(kx.origin.copy(n.object.position),kx.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(kx.direction))<Oj?e.lookAt(n.target):(uN.setFromNormalAndCoplanarPoint(n.object.up,n.target),kx.intersectPlane(uN,n.target))))}else n.object instanceof Mu&&n.object.isOrthographicCamera&&(_t=v!==1,_t&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix()));return v=1,P=!1,_t||We.distanceToSquared(n.object.position)>f||8*(1-Je.dot(n.object.quaternion))>f?(n.dispatchEvent(s),We.copy(n.object.position),Je.copy(n.object.quaternion),_t=!1,!0):!1}})(),this.connect=le=>{n.domElement=le,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",ht),n.domElement.addEventListener("pointerdown",Oe),n.domElement.addEventListener("pointercancel",V),n.domElement.addEventListener("wheel",we)},this.dispose=()=>{var le,Te,ct,he,We,Je;n.domElement&&(n.domElement.style.touchAction="auto"),(le=n.domElement)==null||le.removeEventListener("contextmenu",ht),(Te=n.domElement)==null||Te.removeEventListener("pointerdown",Oe),(ct=n.domElement)==null||ct.removeEventListener("pointercancel",V),(he=n.domElement)==null||he.removeEventListener("wheel",we),(We=n.domElement)==null||We.ownerDocument.removeEventListener("pointermove",q),(Je=n.domElement)==null||Je.ownerDocument.removeEventListener("pointerup",V),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",be)};const n=this,s={type:"change"},r={type:"start"},o={type:"end"},l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let u=l.NONE;const f=1e-6,p=new n1,g=new n1;let v=1;const x=new re,b=new st,w=new st,M=new st,S=new st,C=new st,R=new st,I=new st,D=new st,O=new st,U=new re,k=new st;let P=!1;const F=[],H={};function G(){return 2*Math.PI/60/60*n.autoRotateSpeed}function j(){return Math.pow(.95,n.zoomSpeed)}function K(le){n.reverseOrbit||n.reverseHorizontalOrbit?g.theta+=le:g.theta-=le}function te(le){n.reverseOrbit||n.reverseVerticalOrbit?g.phi+=le:g.phi-=le}const W=(()=>{const le=new re;return function(ct,he){le.setFromMatrixColumn(he,0),le.multiplyScalar(-ct),x.add(le)}})(),X=(()=>{const le=new re;return function(ct,he){n.screenSpacePanning===!0?le.setFromMatrixColumn(he,1):(le.setFromMatrixColumn(he,0),le.crossVectors(n.object.up,le)),le.multiplyScalar(ct),x.add(le)}})(),oe=(()=>{const le=new re;return function(ct,he){const We=n.domElement;if(We&&n.object instanceof ps&&n.object.isPerspectiveCamera){const Je=n.object.position;le.copy(Je).sub(n.target);let pt=le.length();pt*=Math.tan(n.object.fov/2*Math.PI/180),W(2*ct*pt/We.clientHeight,n.object.matrix),X(2*he*pt/We.clientHeight,n.object.matrix)}else We&&n.object instanceof Mu&&n.object.isOrthographicCamera?(W(ct*(n.object.right-n.object.left)/n.object.zoom/We.clientWidth,n.object.matrix),X(he*(n.object.top-n.object.bottom)/n.object.zoom/We.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ne(le){n.object instanceof ps&&n.object.isPerspectiveCamera||n.object instanceof Mu&&n.object.isOrthographicCamera?v=le:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ie(le){ne(v/le)}function B(le){ne(v*le)}function Q(le){if(!n.zoomToCursor||!n.domElement)return;P=!0;const Te=n.domElement.getBoundingClientRect(),ct=le.clientX-Te.left,he=le.clientY-Te.top,We=Te.width,Je=Te.height;k.x=ct/We*2-1,k.y=-(he/Je)*2+1,U.set(k.x,k.y,1).unproject(n.object).sub(n.object.position).normalize()}function ae(le){return Math.max(n.minDistance,Math.min(n.maxDistance,le))}function fe(le){b.set(le.clientX,le.clientY)}function de(le){Q(le),I.set(le.clientX,le.clientY)}function se(le){S.set(le.clientX,le.clientY)}function ce(le){w.set(le.clientX,le.clientY),M.subVectors(w,b).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(K(2*Math.PI*M.x/Te.clientHeight),te(2*Math.PI*M.y/Te.clientHeight)),b.copy(w),n.update()}function pe(le){D.set(le.clientX,le.clientY),O.subVectors(D,I),O.y>0?ie(j()):O.y<0&&B(j()),I.copy(D),n.update()}function Ie(le){C.set(le.clientX,le.clientY),R.subVectors(C,S).multiplyScalar(n.panSpeed),oe(R.x,R.y),S.copy(C),n.update()}function Ye(le){Q(le),le.deltaY<0?B(j()):le.deltaY>0&&ie(j()),n.update()}function et(le){let Te=!1;switch(le.code){case n.keys.UP:oe(0,n.keyPanSpeed),Te=!0;break;case n.keys.BOTTOM:oe(0,-n.keyPanSpeed),Te=!0;break;case n.keys.LEFT:oe(n.keyPanSpeed,0),Te=!0;break;case n.keys.RIGHT:oe(-n.keyPanSpeed,0),Te=!0;break}Te&&(le.preventDefault(),n.update())}function qe(){if(F.length==1)b.set(F[0].pageX,F[0].pageY);else{const le=.5*(F[0].pageX+F[1].pageX),Te=.5*(F[0].pageY+F[1].pageY);b.set(le,Te)}}function dt(){if(F.length==1)S.set(F[0].pageX,F[0].pageY);else{const le=.5*(F[0].pageX+F[1].pageX),Te=.5*(F[0].pageY+F[1].pageY);S.set(le,Te)}}function De(){const le=F[0].pageX-F[1].pageX,Te=F[0].pageY-F[1].pageY,ct=Math.sqrt(le*le+Te*Te);I.set(0,ct)}function ge(){n.enableZoom&&De(),n.enablePan&&dt()}function ye(){n.enableZoom&&De(),n.enableRotate&&qe()}function Ge(le){if(F.length==1)w.set(le.pageX,le.pageY);else{const ct=Qe(le),he=.5*(le.pageX+ct.x),We=.5*(le.pageY+ct.y);w.set(he,We)}M.subVectors(w,b).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(K(2*Math.PI*M.x/Te.clientHeight),te(2*Math.PI*M.y/Te.clientHeight)),b.copy(w)}function Y(le){if(F.length==1)C.set(le.pageX,le.pageY);else{const Te=Qe(le),ct=.5*(le.pageX+Te.x),he=.5*(le.pageY+Te.y);C.set(ct,he)}R.subVectors(C,S).multiplyScalar(n.panSpeed),oe(R.x,R.y),S.copy(C)}function Be(le){const Te=Qe(le),ct=le.pageX-Te.x,he=le.pageY-Te.y,We=Math.sqrt(ct*ct+he*he);D.set(0,We),O.set(0,Math.pow(D.y/I.y,n.zoomSpeed)),ie(O.y),I.copy(D)}function Ne(le){n.enableZoom&&Be(le),n.enablePan&&Y(le)}function Me(le){n.enableZoom&&Be(le),n.enableRotate&&Ge(le)}function Oe(le){var Te,ct;n.enabled!==!1&&(F.length===0&&((Te=n.domElement)==null||Te.ownerDocument.addEventListener("pointermove",q),(ct=n.domElement)==null||ct.ownerDocument.addEventListener("pointerup",V)),yt(le),le.pointerType==="touch"?it(le):ue(le))}function q(le){n.enabled!==!1&&(le.pointerType==="touch"?tt(le):Re(le))}function V(le){var Te,ct,he;He(le),F.length===0&&((Te=n.domElement)==null||Te.releasePointerCapture(le.pointerId),(ct=n.domElement)==null||ct.ownerDocument.removeEventListener("pointermove",q),(he=n.domElement)==null||he.ownerDocument.removeEventListener("pointerup",V)),n.dispatchEvent(o),u=l.NONE}function ue(le){let Te;switch(le.button){case 0:Te=n.mouseButtons.LEFT;break;case 1:Te=n.mouseButtons.MIDDLE;break;case 2:Te=n.mouseButtons.RIGHT;break;default:Te=-1}switch(Te){case ed.DOLLY:if(n.enableZoom===!1)return;de(le),u=l.DOLLY;break;case ed.ROTATE:if(le.ctrlKey||le.metaKey||le.shiftKey){if(n.enablePan===!1)return;se(le),u=l.PAN}else{if(n.enableRotate===!1)return;fe(le),u=l.ROTATE}break;case ed.PAN:if(le.ctrlKey||le.metaKey||le.shiftKey){if(n.enableRotate===!1)return;fe(le),u=l.ROTATE}else{if(n.enablePan===!1)return;se(le),u=l.PAN}break;default:u=l.NONE}u!==l.NONE&&n.dispatchEvent(r)}function Re(le){if(n.enabled!==!1)switch(u){case l.ROTATE:if(n.enableRotate===!1)return;ce(le);break;case l.DOLLY:if(n.enableZoom===!1)return;pe(le);break;case l.PAN:if(n.enablePan===!1)return;Ie(le);break}}function we(le){n.enabled===!1||n.enableZoom===!1||u!==l.NONE&&u!==l.ROTATE||(le.preventDefault(),n.dispatchEvent(r),Ye(le),n.dispatchEvent(o))}function be(le){n.enabled===!1||n.enablePan===!1||et(le)}function it(le){switch(Xe(le),F.length){case 1:switch(n.touches.ONE){case td.ROTATE:if(n.enableRotate===!1)return;qe(),u=l.TOUCH_ROTATE;break;case td.PAN:if(n.enablePan===!1)return;dt(),u=l.TOUCH_PAN;break;default:u=l.NONE}break;case 2:switch(n.touches.TWO){case td.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ge(),u=l.TOUCH_DOLLY_PAN;break;case td.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ye(),u=l.TOUCH_DOLLY_ROTATE;break;default:u=l.NONE}break;default:u=l.NONE}u!==l.NONE&&n.dispatchEvent(r)}function tt(le){switch(Xe(le),u){case l.TOUCH_ROTATE:if(n.enableRotate===!1)return;Ge(le),n.update();break;case l.TOUCH_PAN:if(n.enablePan===!1)return;Y(le),n.update();break;case l.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ne(le),n.update();break;case l.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Me(le),n.update();break;default:u=l.NONE}}function ht(le){n.enabled!==!1&&le.preventDefault()}function yt(le){F.push(le)}function He(le){delete H[le.pointerId];for(let Te=0;Te<F.length;Te++)if(F[Te].pointerId==le.pointerId){F.splice(Te,1);return}}function Xe(le){let Te=H[le.pointerId];Te===void 0&&(Te=new st,H[le.pointerId]=Te),Te.set(le.pageX,le.pageY)}function Qe(le){const Te=le.pointerId===F[0].pointerId?F[1]:F[0];return H[Te.pointerId]}this.dollyIn=(le=j())=>{B(le),n.update()},this.dollyOut=(le=j())=>{ie(le),n.update()},this.getScale=()=>v,this.setScale=le=>{ne(le),n.update()},this.getZoomScale=()=>j(),t!==void 0&&this.connect(t),this.update()}};function Uj(){var i=Object.create(null);function e(s,r){var o=s.id,l=s.name,u=s.dependencies;u===void 0&&(u=[]);var f=s.init;f===void 0&&(f=function(){});var p=s.getTransferables;if(p===void 0&&(p=null),!i[o])try{u=u.map(function(v){return v&&v.isWorkerModule&&(e(v,function(x){if(x instanceof Error)throw x}),v=i[v.id].value),v}),f=n("<"+l+">.init",f),p&&(p=n("<"+l+">.getTransferables",p));var g=null;typeof f=="function"?g=f.apply(void 0,u):console.error("worker module init function failed to rehydrate"),i[o]={id:o,value:g,getTransferables:p},r(g)}catch(v){v&&v.noLog||console.error(v),r(v)}}function t(s,r){var o,l=s.id,u=s.args;(!i[l]||typeof i[l].value!="function")&&r(new Error("Worker module "+l+": not found or its 'init' did not return a function"));try{var f=(o=i[l]).value.apply(o,u);f&&typeof f.then=="function"?f.then(p,function(g){return r(g instanceof Error?g:new Error(""+g))}):p(f)}catch(g){r(g)}function p(g){try{var v=i[l].getTransferables&&i[l].getTransferables(g);(!v||!Array.isArray(v)||!v.length)&&(v=void 0),r(g,v)}catch(x){console.error(x),r(x)}}}function n(s,r){var o=void 0;self.troikaDefine=function(u){return o=u};var l=URL.createObjectURL(new Blob(["/** "+s.replace(/\*/g,"")+` **/

troikaDefine(
`+r+`
)`],{type:"application/javascript"}));try{importScripts(l)}catch(u){console.error(u)}return URL.revokeObjectURL(l),delete self.troikaDefine,o}self.addEventListener("message",function(s){var r=s.data,o=r.messageId,l=r.action,u=r.data;try{l==="registerModule"&&e(u,function(f){f instanceof Error?postMessage({messageId:o,success:!1,error:f.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof f=="function"}})}),l==="callModule"&&t(u,function(f,p){f instanceof Error?postMessage({messageId:o,success:!1,error:f.message}):postMessage({messageId:o,success:!0,result:f},p||void 0)})}catch(f){postMessage({messageId:o,success:!1,error:f.stack})}})}function Lj(i){var e=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e._getInitResult().then(function(s){if(typeof s=="function")return s.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=i.dependencies,n=i.init;t=Array.isArray(t)?t.map(function(r){return r&&(r=r.onMainThread||r,r._getInitResult&&(r=r._getInitResult())),r}):[];var s=Promise.all(t).then(function(r){return n.apply(null,r)});return e._getInitResult=function(){return s},s},e}var BU=function(){var i=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),i=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return BU=function(){return i},i},Fj=0,kj=0,OT=!1,av=Object.create(null),ov=Object.create(null),Dw=Object.create(null);function Qm(i){if((!i||typeof i.init!="function")&&!OT)throw new Error("requires `options.init` function");var e=i.dependencies,t=i.init,n=i.getTransferables,s=i.workerId,r=Lj(i);s==null&&(s="#default");var o="workerModule"+ ++Fj,l=i.name||o,u=null;e=e&&e.map(function(p){return typeof p=="function"&&!p.workerModuleData&&(OT=!0,p=Qm({workerId:s,name:"<"+l+"> function dependency: "+p.name,init:`function(){return (
`+$x(p)+`
)}`}),OT=!1),p&&p.workerModuleData&&(p=p.workerModuleData),p});function f(){for(var p=[],g=arguments.length;g--;)p[g]=arguments[g];if(!BU())return r.apply(void 0,p);if(!u){u=fN(s,"registerModule",f.workerModuleData);var v=function(){u=null,ov[s].delete(v)};(ov[s]||(ov[s]=new Set)).add(v)}return u.then(function(x){var b=x.isCallable;if(b)return fN(s,"callModule",{id:o,args:p});throw new Error("Worker module function was called but `init` did not return a callable function")})}return f.workerModuleData={isWorkerModule:!0,id:o,name:l,dependencies:e,init:$x(t),getTransferables:n&&$x(n)},f.onMainThread=r,f}function Bj(i){ov[i]&&ov[i].forEach(function(e){e()}),av[i]&&(av[i].terminate(),delete av[i])}function $x(i){var e=i.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function zj(i){var e=av[i];if(!e){var t=$x(Uj);e=av[i]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+i.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(n){var s=n.data,r=s.messageId,o=Dw[r];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete Dw[r],o(s)}}return e}function fN(i,e,t){return new Promise(function(n,s){var r=++kj;Dw[r]=function(o){o.success?n(o.result):s(new Error("Error in worker "+e+" call: "+o.error))},zj(i).postMessage({messageId:r,action:e,data:t})})}function zU(){var i=(function(e){function t(ne,ie,B,Q,ae,fe,de,se){var ce=1-de;se.x=ce*ce*ne+2*ce*de*B+de*de*ae,se.y=ce*ce*ie+2*ce*de*Q+de*de*fe}function n(ne,ie,B,Q,ae,fe,de,se,ce,pe){var Ie=1-ce;pe.x=Ie*Ie*Ie*ne+3*Ie*Ie*ce*B+3*Ie*ce*ce*ae+ce*ce*ce*de,pe.y=Ie*Ie*Ie*ie+3*Ie*Ie*ce*Q+3*Ie*ce*ce*fe+ce*ce*ce*se}function s(ne,ie){for(var B=/([MLQCZ])([^MLQCZ]*)/g,Q,ae,fe,de,se;Q=B.exec(ne);){var ce=Q[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(pe){return parseFloat(pe)});switch(Q[1]){case"M":de=ae=ce[0],se=fe=ce[1];break;case"L":(ce[0]!==de||ce[1]!==se)&&ie("L",de,se,de=ce[0],se=ce[1]);break;case"Q":{ie("Q",de,se,de=ce[2],se=ce[3],ce[0],ce[1]);break}case"C":{ie("C",de,se,de=ce[4],se=ce[5],ce[0],ce[1],ce[2],ce[3]);break}case"Z":(de!==ae||se!==fe)&&ie("L",de,se,ae,fe);break}}}function r(ne,ie,B){B===void 0&&(B=16);var Q={x:0,y:0};s(ne,function(ae,fe,de,se,ce,pe,Ie,Ye,et){switch(ae){case"L":ie(fe,de,se,ce);break;case"Q":{for(var qe=fe,dt=de,De=1;De<B;De++)t(fe,de,pe,Ie,se,ce,De/(B-1),Q),ie(qe,dt,Q.x,Q.y),qe=Q.x,dt=Q.y;break}case"C":{for(var ge=fe,ye=de,Ge=1;Ge<B;Ge++)n(fe,de,pe,Ie,Ye,et,se,ce,Ge/(B-1),Q),ie(ge,ye,Q.x,Q.y),ge=Q.x,ye=Q.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",l="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",u=new WeakMap,f={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function p(ne,ie){var B=ne.getContext?ne.getContext("webgl",f):ne,Q=u.get(B);if(!Q){let ge=function(Me){var Oe=fe[Me];if(!Oe&&(Oe=fe[Me]=B.getExtension(Me),!Oe))throw new Error(Me+" not supported");return Oe},ye=function(Me,Oe){var q=B.createShader(Oe);return B.shaderSource(q,Me),B.compileShader(q),q},Ge=function(Me,Oe,q,V){if(!de[Me]){var ue={},Re={},we=B.createProgram();B.attachShader(we,ye(Oe,B.VERTEX_SHADER)),B.attachShader(we,ye(q,B.FRAGMENT_SHADER)),B.linkProgram(we),de[Me]={program:we,transaction:function(it){B.useProgram(we),it({setUniform:function(ht,yt){for(var He=[],Xe=arguments.length-2;Xe-- >0;)He[Xe]=arguments[Xe+2];var Qe=Re[yt]||(Re[yt]=B.getUniformLocation(we,yt));B["uniform"+ht].apply(B,[Qe].concat(He))},setAttribute:function(ht,yt,He,Xe,Qe){var le=ue[ht];le||(le=ue[ht]={buf:B.createBuffer(),loc:B.getAttribLocation(we,ht),data:null}),B.bindBuffer(B.ARRAY_BUFFER,le.buf),B.vertexAttribPointer(le.loc,yt,B.FLOAT,!1,0,0),B.enableVertexAttribArray(le.loc),ae?B.vertexAttribDivisor(le.loc,Xe):ge("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(le.loc,Xe),Qe!==le.data&&(B.bufferData(B.ARRAY_BUFFER,Qe,He),le.data=Qe)}})}}}de[Me].transaction(V)},Y=function(Me,Oe){ce++;try{B.activeTexture(B.TEXTURE0+ce);var q=se[Me];q||(q=se[Me]=B.createTexture(),B.bindTexture(B.TEXTURE_2D,q),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MIN_FILTER,B.NEAREST),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MAG_FILTER,B.NEAREST)),B.bindTexture(B.TEXTURE_2D,q),Oe(q,ce)}finally{ce--}},Be=function(Me,Oe,q){var V=B.createFramebuffer();pe.push(V),B.bindFramebuffer(B.FRAMEBUFFER,V),B.activeTexture(B.TEXTURE0+Oe),B.bindTexture(B.TEXTURE_2D,Me),B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_2D,Me,0);try{q(V)}finally{B.deleteFramebuffer(V),B.bindFramebuffer(B.FRAMEBUFFER,pe[--pe.length-1]||null)}},Ne=function(){fe={},de={},se={},ce=-1,pe.length=0};var Ie=ge,Ye=ye,et=Ge,qe=Y,dt=Be,De=Ne,ae=typeof WebGL2RenderingContext<"u"&&B instanceof WebGL2RenderingContext,fe={},de={},se={},ce=-1,pe=[];B.canvas.addEventListener("webglcontextlost",function(Me){Ne(),Me.preventDefault()},!1),u.set(B,Q={gl:B,isWebGL2:ae,getExtension:ge,withProgram:Ge,withTexture:Y,withTextureFramebuffer:Be,handleContextLoss:Ne})}ie(Q)}function g(ne,ie,B,Q,ae,fe,de,se){de===void 0&&(de=15),se===void 0&&(se=null),p(ne,function(ce){var pe=ce.gl,Ie=ce.withProgram,Ye=ce.withTexture;Ye("copy",function(et,qe){pe.texImage2D(pe.TEXTURE_2D,0,pe.RGBA,ae,fe,0,pe.RGBA,pe.UNSIGNED_BYTE,ie),Ie("copy",o,l,function(dt){var De=dt.setUniform,ge=dt.setAttribute;ge("aUV",2,pe.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),De("1i","image",qe),pe.bindFramebuffer(pe.FRAMEBUFFER,se||null),pe.disable(pe.BLEND),pe.colorMask(de&8,de&4,de&2,de&1),pe.viewport(B,Q,ae,fe),pe.scissor(B,Q,ae,fe),pe.drawArrays(pe.TRIANGLES,0,3)})})})}function v(ne,ie,B){var Q=ne.width,ae=ne.height;p(ne,function(fe){var de=fe.gl,se=new Uint8Array(Q*ae*4);de.readPixels(0,0,Q,ae,de.RGBA,de.UNSIGNED_BYTE,se),ne.width=ie,ne.height=B,g(de,se,0,0,Q,ae)})}var x=Object.freeze({__proto__:null,withWebGLContext:p,renderImageData:g,resizeWebGLCanvasWithoutClearing:v});function b(ne,ie,B,Q,ae,fe){fe===void 0&&(fe=1);var de=new Uint8Array(ne*ie),se=Q[2]-Q[0],ce=Q[3]-Q[1],pe=[];r(B,function(ge,ye,Ge,Y){pe.push({x1:ge,y1:ye,x2:Ge,y2:Y,minX:Math.min(ge,Ge),minY:Math.min(ye,Y),maxX:Math.max(ge,Ge),maxY:Math.max(ye,Y)})}),pe.sort(function(ge,ye){return ge.maxX-ye.maxX});for(var Ie=0;Ie<ne;Ie++)for(var Ye=0;Ye<ie;Ye++){var et=dt(Q[0]+se*(Ie+.5)/ne,Q[1]+ce*(Ye+.5)/ie),qe=Math.pow(1-Math.abs(et)/ae,fe)/2;et<0&&(qe=1-qe),qe=Math.max(0,Math.min(255,Math.round(qe*255))),de[Ye*ne+Ie]=qe}return de;function dt(ge,ye){for(var Ge=1/0,Y=1/0,Be=pe.length;Be--;){var Ne=pe[Be];if(Ne.maxX+Y<=ge)break;if(ge+Y>Ne.minX&&ye-Y<Ne.maxY&&ye+Y>Ne.minY){var Me=S(ge,ye,Ne.x1,Ne.y1,Ne.x2,Ne.y2);Me<Ge&&(Ge=Me,Y=Math.sqrt(Ge))}}return De(ge,ye)&&(Y=-Y),Y}function De(ge,ye){for(var Ge=0,Y=pe.length;Y--;){var Be=pe[Y];if(Be.maxX<=ge)break;var Ne=Be.y1>ye!=Be.y2>ye&&ge<(Be.x2-Be.x1)*(ye-Be.y1)/(Be.y2-Be.y1)+Be.x1;Ne&&(Ge+=Be.y1<Be.y2?1:-1)}return Ge!==0}}function w(ne,ie,B,Q,ae,fe,de,se,ce,pe){fe===void 0&&(fe=1),se===void 0&&(se=0),ce===void 0&&(ce=0),pe===void 0&&(pe=0),M(ne,ie,B,Q,ae,fe,de,null,se,ce,pe)}function M(ne,ie,B,Q,ae,fe,de,se,ce,pe,Ie){fe===void 0&&(fe=1),ce===void 0&&(ce=0),pe===void 0&&(pe=0),Ie===void 0&&(Ie=0);for(var Ye=b(ne,ie,B,Q,ae,fe),et=new Uint8Array(Ye.length*4),qe=0;qe<Ye.length;qe++)et[qe*4+Ie]=Ye[qe];g(de,et,ce,pe,ne,ie,1<<3-Ie,se)}function S(ne,ie,B,Q,ae,fe){var de=ae-B,se=fe-Q,ce=de*de+se*se,pe=ce?Math.max(0,Math.min(1,((ne-B)*de+(ie-Q)*se)/ce)):0,Ie=ne-(B+pe*de),Ye=ie-(Q+pe*se);return Ie*Ie+Ye*Ye}var C=Object.freeze({__proto__:null,generate:b,generateIntoCanvas:w,generateIntoFramebuffer:M}),R="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",I="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",D="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",O=new Float32Array([0,0,2,0,0,2]),U=null,k=!1,P={},F=new WeakMap;function H(ne){if(!k&&!te(ne))throw new Error("WebGL generation not supported")}function G(ne,ie,B,Q,ae,fe,de){if(fe===void 0&&(fe=1),de===void 0&&(de=null),!de&&(de=U,!de)){var se=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!se)throw new Error("OffscreenCanvas or DOM canvas not supported");de=U=se.getContext("webgl",{depth:!1})}H(de);var ce=new Uint8Array(ne*ie*4);p(de,function(et){var qe=et.gl,dt=et.withTexture,De=et.withTextureFramebuffer;dt("readable",function(ge,ye){qe.texImage2D(qe.TEXTURE_2D,0,qe.RGBA,ne,ie,0,qe.RGBA,qe.UNSIGNED_BYTE,null),De(ge,ye,function(Ge){K(ne,ie,B,Q,ae,fe,qe,Ge,0,0,0),qe.readPixels(0,0,ne,ie,qe.RGBA,qe.UNSIGNED_BYTE,ce)})})});for(var pe=new Uint8Array(ne*ie),Ie=0,Ye=0;Ie<ce.length;Ie+=4)pe[Ye++]=ce[Ie];return pe}function j(ne,ie,B,Q,ae,fe,de,se,ce,pe){fe===void 0&&(fe=1),se===void 0&&(se=0),ce===void 0&&(ce=0),pe===void 0&&(pe=0),K(ne,ie,B,Q,ae,fe,de,null,se,ce,pe)}function K(ne,ie,B,Q,ae,fe,de,se,ce,pe,Ie){fe===void 0&&(fe=1),ce===void 0&&(ce=0),pe===void 0&&(pe=0),Ie===void 0&&(Ie=0),H(de);var Ye=[];r(B,function(et,qe,dt,De){Ye.push(et,qe,dt,De)}),Ye=new Float32Array(Ye),p(de,function(et){var qe=et.gl,dt=et.isWebGL2,De=et.getExtension,ge=et.withProgram,ye=et.withTexture,Ge=et.withTextureFramebuffer,Y=et.handleContextLoss;if(ye("rawDistances",function(Be,Ne){(ne!==Be._lastWidth||ie!==Be._lastHeight)&&qe.texImage2D(qe.TEXTURE_2D,0,qe.RGBA,Be._lastWidth=ne,Be._lastHeight=ie,0,qe.RGBA,qe.UNSIGNED_BYTE,null),ge("main",R,I,function(Me){var Oe=Me.setAttribute,q=Me.setUniform,V=!dt&&De("ANGLE_instanced_arrays"),ue=!dt&&De("EXT_blend_minmax");Oe("aUV",2,qe.STATIC_DRAW,0,O),Oe("aLineSegment",4,qe.DYNAMIC_DRAW,1,Ye),q.apply(void 0,["4f","uGlyphBounds"].concat(Q)),q("1f","uMaxDistance",ae),q("1f","uExponent",fe),Ge(Be,Ne,function(Re){qe.enable(qe.BLEND),qe.colorMask(!0,!0,!0,!0),qe.viewport(0,0,ne,ie),qe.scissor(0,0,ne,ie),qe.blendFunc(qe.ONE,qe.ONE),qe.blendEquationSeparate(qe.FUNC_ADD,dt?qe.MAX:ue.MAX_EXT),qe.clear(qe.COLOR_BUFFER_BIT),dt?qe.drawArraysInstanced(qe.TRIANGLES,0,3,Ye.length/4):V.drawArraysInstancedANGLE(qe.TRIANGLES,0,3,Ye.length/4)})}),ge("post",o,D,function(Me){Me.setAttribute("aUV",2,qe.STATIC_DRAW,0,O),Me.setUniform("1i","tex",Ne),qe.bindFramebuffer(qe.FRAMEBUFFER,se),qe.disable(qe.BLEND),qe.colorMask(Ie===0,Ie===1,Ie===2,Ie===3),qe.viewport(ce,pe,ne,ie),qe.scissor(ce,pe,ne,ie),qe.drawArrays(qe.TRIANGLES,0,3)})}),qe.isContextLost())throw Y(),new Error("webgl context lost")})}function te(ne){var ie=!ne||ne===U?P:ne.canvas||ne,B=F.get(ie);if(B===void 0){k=!0;var Q=null;try{var ae=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],fe=G(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,ne);B=fe&&ae.length===fe.length&&fe.every(function(de,se){return de===ae[se]}),B||(Q="bad trial run results",console.info(ae,fe))}catch(de){B=!1,Q=de.message}Q&&console.warn("WebGL SDF generation not supported:",Q),k=!1,F.set(ie,B)}return B}var W=Object.freeze({__proto__:null,generate:G,generateIntoCanvas:j,generateIntoFramebuffer:K,isSupported:te});function X(ne,ie,B,Q,ae,fe){ae===void 0&&(ae=Math.max(Q[2]-Q[0],Q[3]-Q[1])/2),fe===void 0&&(fe=1);try{return G.apply(W,arguments)}catch(de){return console.info("WebGL SDF generation failed, falling back to JS",de),b.apply(C,arguments)}}function oe(ne,ie,B,Q,ae,fe,de,se,ce,pe){ae===void 0&&(ae=Math.max(Q[2]-Q[0],Q[3]-Q[1])/2),fe===void 0&&(fe=1),se===void 0&&(se=0),ce===void 0&&(ce=0),pe===void 0&&(pe=0);try{return j.apply(W,arguments)}catch(Ie){return console.info("WebGL SDF generation failed, falling back to JS",Ie),w.apply(C,arguments)}}return e.forEachPathCommand=s,e.generate=X,e.generateIntoCanvas=oe,e.javascript=C,e.pathToLineSegments=r,e.webgl=W,e.webglUtils=x,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return i}function Vj(){var i=(function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},s={};n.L=1,s[1]="L",Object.keys(t).forEach(function(Y,Be){n[Y]=1<<Be+1,s[n[Y]]=Y}),Object.freeze(n);var r=n.LRI|n.RLI|n.FSI,o=n.L|n.R|n.AL,l=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,u=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,f=n.S|n.WS|n.B|r|n.PDI|u,p=null;function g(){if(!p){p=new Map;var Y=function(Ne){if(t.hasOwnProperty(Ne)){var Me=0;t[Ne].split(",").forEach(function(Oe){var q=Oe.split("+"),V=q[0],ue=q[1];V=parseInt(V,36),ue=ue?parseInt(ue,36):0,p.set(Me+=V,n[Ne]);for(var Re=0;Re<ue;Re++)p.set(++Me,n[Ne])})}};for(var Be in t)Y(Be)}}function v(Y){return g(),p.get(Y.codePointAt(0))||n.L}function x(Y){return s[v(Y)]}var b={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function w(Y,Be){var Ne=36,Me=0,Oe=new Map,q=Be&&new Map,V;return Y.split(",").forEach(function ue(Re){if(Re.indexOf("+")!==-1)for(var we=+Re;we--;)ue(V);else{V=Re;var be=Re.split(">"),it=be[0],tt=be[1];it=String.fromCodePoint(Me+=parseInt(it,Ne)),tt=String.fromCodePoint(Me+=parseInt(tt,Ne)),Oe.set(it,tt),Be&&q.set(tt,it)}}),{map:Oe,reverseMap:q}}var M,S,C;function R(){if(!M){var Y=w(b.pairs,!0),Be=Y.map,Ne=Y.reverseMap;M=Be,S=Ne,C=w(b.canonical,!1).map}}function I(Y){return R(),M.get(Y)||null}function D(Y){return R(),S.get(Y)||null}function O(Y){return R(),C.get(Y)||null}var U=n.L,k=n.R,P=n.EN,F=n.ES,H=n.ET,G=n.AN,j=n.CS,K=n.B,te=n.S,W=n.ON,X=n.BN,oe=n.NSM,ne=n.AL,ie=n.LRO,B=n.RLO,Q=n.LRE,ae=n.RLE,fe=n.PDF,de=n.LRI,se=n.RLI,ce=n.FSI,pe=n.PDI;function Ie(Y,Be){for(var Ne=125,Me=new Uint32Array(Y.length),Oe=0;Oe<Y.length;Oe++)Me[Oe]=v(Y[Oe]);var q=new Map;function V(Is,jr){var Xs=Me[Is];Me[Is]=jr,q.set(Xs,q.get(Xs)-1),Xs&l&&q.set(l,q.get(l)-1),q.set(jr,(q.get(jr)||0)+1),jr&l&&q.set(l,(q.get(l)||0)+1)}for(var ue=new Uint8Array(Y.length),Re=new Map,we=[],be=null,it=0;it<Y.length;it++)be||we.push(be={start:it,end:Y.length-1,level:Be==="rtl"?1:Be==="ltr"?0:Fu(it,!1)}),Me[it]&K&&(be.end=it,be=null);for(var tt=ae|Q|B|ie|r|pe|fe|K,ht=function(Is){return Is+(Is&1?1:2)},yt=function(Is){return Is+(Is&1?2:1)},He=0;He<we.length;He++){be=we[He];var Xe=[{_level:be.level,_override:0,_isolate:0}],Qe=void 0,le=0,Te=0,ct=0;q.clear();for(var he=be.start;he<=be.end;he++){var We=Me[he];if(Qe=Xe[Xe.length-1],q.set(We,(q.get(We)||0)+1),We&l&&q.set(l,(q.get(l)||0)+1),We&tt)if(We&(ae|Q)){ue[he]=Qe._level;var Je=(We===ae?yt:ht)(Qe._level);Je<=Ne&&!le&&!Te?Xe.push({_level:Je,_override:0,_isolate:0}):le||Te++}else if(We&(B|ie)){ue[he]=Qe._level;var pt=(We===B?yt:ht)(Qe._level);pt<=Ne&&!le&&!Te?Xe.push({_level:pt,_override:We&B?k:U,_isolate:0}):le||Te++}else if(We&r){We&ce&&(We=Fu(he+1,!0)===1?se:de),ue[he]=Qe._level,Qe._override&&V(he,Qe._override);var $e=(We===se?yt:ht)(Qe._level);$e<=Ne&&le===0&&Te===0?(ct++,Xe.push({_level:$e,_override:0,_isolate:1,_isolInitIndex:he})):le++}else if(We&pe){if(le>0)le--;else if(ct>0){for(Te=0;!Xe[Xe.length-1]._isolate;)Xe.pop();var Le=Xe[Xe.length-1]._isolInitIndex;Le!=null&&(Re.set(Le,he),Re.set(he,Le)),Xe.pop(),ct--}Qe=Xe[Xe.length-1],ue[he]=Qe._level,Qe._override&&V(he,Qe._override)}else We&fe?(le===0&&(Te>0?Te--:!Qe._isolate&&Xe.length>1&&(Xe.pop(),Qe=Xe[Xe.length-1])),ue[he]=Qe._level):We&K&&(ue[he]=be.level);else ue[he]=Qe._level,Qe._override&&We!==X&&V(he,Qe._override)}for(var rt=[],xt=null,_t=be.start;_t<=be.end;_t++){var Nt=Me[_t];if(!(Nt&u)){var pn=ue[_t],Mn=Nt&r,Zn=Nt===pe;xt&&pn===xt._level?(xt._end=_t,xt._endsWithIsolInit=Mn):rt.push(xt={_start:_t,_end:_t,_level:pn,_startsWithPDI:Zn,_endsWithIsolInit:Mn})}}for(var Ji=[],Gs=0;Gs<rt.length;Gs++){var ys=rt[Gs];if(!ys._startsWithPDI||ys._startsWithPDI&&!Re.has(ys._start)){for(var _s=[xt=ys],nr=void 0;xt&&xt._endsWithIsolInit&&(nr=Re.get(xt._end))!=null;)for(var ni=Gs+1;ni<rt.length;ni++)if(rt[ni]._start===nr){_s.push(xt=rt[ni]);break}for(var jn=[],Fn=0;Fn<_s.length;Fn++)for(var Ni=_s[Fn],Ns=Ni._start;Ns<=Ni._end;Ns++)jn.push(Ns);for(var ir=ue[jn[0]],Hs=be.level,zr=jn[0]-1;zr>=0;zr--)if(!(Me[zr]&u)){Hs=ue[zr];break}var Xa=jn[jn.length-1],Vr=ue[Xa],fa=be.level;if(!(Me[Xa]&r)){for(var vr=Xa+1;vr<=be.end;vr++)if(!(Me[vr]&u)){fa=ue[vr];break}}Ji.push({_seqIndices:jn,_sosType:Math.max(Hs,ir)%2?k:U,_eosType:Math.max(fa,Vr)%2?k:U})}}for(var Gr=0;Gr<Ji.length;Gr++){var da=Ji[Gr],Dt=da._seqIndices,J=da._sosType,Se=da._eosType,ze=ue[Dt[0]]&1?k:U;if(q.get(oe))for(var Pe=0;Pe<Dt.length;Pe++){var Ae=Dt[Pe];if(Me[Ae]&oe){for(var mt=J,Mt=Pe-1;Mt>=0;Mt--)if(!(Me[Dt[Mt]]&u)){mt=Me[Dt[Mt]];break}V(Ae,mt&(r|pe)?W:mt)}}if(q.get(P))for(var ut=0;ut<Dt.length;ut++){var Et=Dt[ut];if(Me[Et]&P)for(var Ct=ut-1;Ct>=-1;Ct--){var Ft=Ct===-1?J:Me[Dt[Ct]];if(Ft&o){Ft===ne&&V(Et,G);break}}}if(q.get(ne))for(var Rt=0;Rt<Dt.length;Rt++){var Bt=Dt[Rt];Me[Bt]&ne&&V(Bt,k)}if(q.get(F)||q.get(j))for(var mn=1;mn<Dt.length-1;mn++){var Vn=Dt[mn];if(Me[Vn]&(F|j)){for(var Cn=0,Xt=0,bt=mn-1;bt>=0&&(Cn=Me[Dt[bt]],!!(Cn&u));bt--);for(var vn=mn+1;vn<Dt.length&&(Xt=Me[Dt[vn]],!!(Xt&u));vn++);Cn===Xt&&(Me[Vn]===F?Cn===P:Cn&(P|G))&&V(Vn,Cn)}}if(q.get(P))for(var Pt=0;Pt<Dt.length;Pt++){var Ii=Dt[Pt];if(Me[Ii]&P){for(var Ws=Pt-1;Ws>=0&&Me[Dt[Ws]]&(H|u);Ws--)V(Dt[Ws],P);for(Pt++;Pt<Dt.length&&Me[Dt[Pt]]&(H|u|P);Pt++)Me[Dt[Pt]]!==P&&V(Dt[Pt],P)}}if(q.get(H)||q.get(F)||q.get(j))for(var kn=0;kn<Dt.length;kn++){var xs=Dt[kn];if(Me[xs]&(H|F|j)){V(xs,W);for(var Tn=kn-1;Tn>=0&&Me[Dt[Tn]]&u;Tn--)V(Dt[Tn],W);for(var mi=kn+1;mi<Dt.length&&Me[Dt[mi]]&u;mi++)V(Dt[mi],W)}}if(q.get(P))for(var gi=0,Bi=J;gi<Dt.length;gi++){var zi=Dt[gi],Ya=Me[zi];Ya&P?Bi===U&&V(zi,U):Ya&o&&(Bi=Ya)}if(q.get(l)){var bs=k|P|G,ef=bs|U,Pl=[];{for(var pa=[],js=0;js<Dt.length;js++)if(Me[Dt[js]]&l){var fo=Y[Dt[js]],Ic=void 0;if(I(fo)!==null)if(pa.length<63)pa.push({char:fo,seqIndex:js});else break;else if((Ic=D(fo))!==null)for(var Hr=pa.length-1;Hr>=0;Hr--){var ma=pa[Hr].char;if(ma===Ic||ma===D(O(fo))||I(O(ma))===fo){Pl.push([pa[Hr].seqIndex,js]),pa.length=Hr;break}}}Pl.sort(function(Is,jr){return Is[0]-jr[0]})}for(var Oc=0;Oc<Pl.length;Oc++){for(var Pc=Pl[Oc],Ul=Pc[0],po=Pc[1],Wr=!1,sr=0,mo=Ul+1;mo<po;mo++){var qs=Dt[mo];if(Me[qs]&ef){Wr=!0;var Uc=Me[qs]&bs?k:U;if(Uc===ze){sr=Uc;break}}}if(Wr&&!sr){sr=J;for(var Za=Ul-1;Za>=0;Za--){var Ll=Dt[Za];if(Me[Ll]&ef){var Fl=Me[Ll]&bs?k:U;Fl!==ze?sr=Fl:sr=ze;break}}}if(sr){if(Me[Dt[Ul]]=Me[Dt[po]]=sr,sr!==ze){for(var ga=Ul+1;ga<Dt.length;ga++)if(!(Me[Dt[ga]]&u)){v(Y[Dt[ga]])&oe&&(Me[Dt[ga]]=sr);break}}if(sr!==ze){for(var kl=po+1;kl<Dt.length;kl++)if(!(Me[Dt[kl]]&u)){v(Y[Dt[kl]])&oe&&(Me[Dt[kl]]=sr);break}}}}for(var vi=0;vi<Dt.length;vi++)if(Me[Dt[vi]]&l){for(var Ka=vi,Jo=vi,go=J,Bl=vi-1;Bl>=0;Bl--)if(Me[Dt[Bl]]&u)Ka=Bl;else{go=Me[Dt[Bl]]&bs?k:U;break}for(var zl=Se,vo=vi+1;vo<Dt.length;vo++)if(Me[Dt[vo]]&(l|u))Jo=vo;else{zl=Me[Dt[vo]]&bs?k:U;break}for(var yo=Ka;yo<=Jo;yo++)Me[Dt[yo]]=go===zl?go:ze;vi=Jo}}}for(var $i=be.start;$i<=be.end;$i++){var tf=ue[$i],Lc=Me[$i];if(tf&1?Lc&(U|P|G)&&ue[$i]++:Lc&k?ue[$i]++:Lc&(G|P)&&(ue[$i]+=2),Lc&u&&(ue[$i]=$i===0?be.level:ue[$i-1]),$i===be.end||v(Y[$i])&(te|K))for(var Fc=$i;Fc>=0&&v(Y[Fc])&f;Fc--)ue[Fc]=be.level}}return{levels:ue,paragraphs:we};function Fu(Is,jr){for(var Xs=Is;Xs<Y.length;Xs++){var Qa=Me[Xs];if(Qa&(k|ne))return 1;if(Qa&(K|U)||jr&&Qa===pe)return 0;if(Qa&r){var Vl=ku(Xs);Xs=Vl===-1?Y.length:Vl}}return 0}function ku(Is){for(var jr=1,Xs=Is+1;Xs<Y.length;Xs++){var Qa=Me[Xs];if(Qa&K)break;if(Qa&pe){if(--jr===0)return Xs}else Qa&r&&jr++}return-1}}var Ye="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",et;function qe(){if(!et){var Y=w(Ye,!0),Be=Y.map,Ne=Y.reverseMap;Ne.forEach(function(Me,Oe){Be.set(Oe,Me)}),et=Be}}function dt(Y){return qe(),et.get(Y)||null}function De(Y,Be,Ne,Me){var Oe=Y.length;Ne=Math.max(0,Ne==null?0:+Ne),Me=Math.min(Oe-1,Me==null?Oe-1:+Me);for(var q=new Map,V=Ne;V<=Me;V++)if(Be[V]&1){var ue=dt(Y[V]);ue!==null&&q.set(V,ue)}return q}function ge(Y,Be,Ne,Me){var Oe=Y.length;Ne=Math.max(0,Ne==null?0:+Ne),Me=Math.min(Oe-1,Me==null?Oe-1:+Me);var q=[];return Be.paragraphs.forEach(function(V){var ue=Math.max(Ne,V.start),Re=Math.min(Me,V.end);if(ue<Re){for(var we=Be.levels.slice(ue,Re+1),be=Re;be>=ue&&v(Y[be])&f;be--)we[be]=V.level;for(var it=V.level,tt=1/0,ht=0;ht<we.length;ht++){var yt=we[ht];yt>it&&(it=yt),yt<tt&&(tt=yt|1)}for(var He=it;He>=tt;He--)for(var Xe=0;Xe<we.length;Xe++)if(we[Xe]>=He){for(var Qe=Xe;Xe+1<we.length&&we[Xe+1]>=He;)Xe++;Xe>Qe&&q.push([Qe+ue,Xe+ue])}}}),q}function ye(Y,Be,Ne,Me){var Oe=Ge(Y,Be,Ne,Me),q=[].concat(Y);return Oe.forEach(function(V,ue){q[ue]=(Be.levels[V]&1?dt(Y[V]):null)||Y[V]}),q.join("")}function Ge(Y,Be,Ne,Me){for(var Oe=ge(Y,Be,Ne,Me),q=[],V=0;V<Y.length;V++)q[V]=V;return Oe.forEach(function(ue){for(var Re=ue[0],we=ue[1],be=q.slice(Re,we+1),it=be.length;it--;)q[we-it]=be[it]}),q}return e.closingToOpeningBracket=D,e.getBidiCharType=v,e.getBidiCharTypeName=x,e.getCanonicalBracket=O,e.getEmbeddingLevels=Ie,e.getMirroredCharacter=dt,e.getMirroredCharactersMap=De,e.getReorderSegments=ge,e.getReorderedIndices=Ge,e.getReorderedString=ye,e.openingToClosingBracket=I,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return i}const VU=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Nw(i){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(n,s){let r=fn[s];return r?Nw(r):n}return i.replace(e,t)}const pr=[];for(let i=0;i<256;i++)pr[i]=(i<16?"0":"")+i.toString(16);function Gj(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(pr[i&255]+pr[i>>8&255]+pr[i>>16&255]+pr[i>>24&255]+"-"+pr[e&255]+pr[e>>8&255]+"-"+pr[e>>16&15|64]+pr[e>>24&255]+"-"+pr[t&63|128]+pr[t>>8&255]+"-"+pr[t>>16&255]+pr[t>>24&255]+pr[n&255]+pr[n>>8&255]+pr[n>>16&255]+pr[n>>24&255]).toUpperCase()}const Qf=Object.assign||function(){let i=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let n=arguments[e];if(n)for(let s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])}return i},Hj=Date.now(),dN=new WeakMap,pN=new Map;let Wj=1e10;function Iw(i,e){const t=Yj(e);let n=dN.get(i);if(n||dN.set(i,n=Object.create(null)),n[t])return new n[t];const s=`_onBeforeCompile${t}`,r=function(f,p){i.onBeforeCompile.call(this,f,p);const g=this.customProgramCacheKey()+"|"+f.vertexShader+"|"+f.fragmentShader;let v=pN[g];if(!v){const x=jj(this,f,e,t);v=pN[g]=x}f.vertexShader=v.vertexShader,f.fragmentShader=v.fragmentShader,Qf(f.uniforms,this.uniforms),e.timeUniform&&(f.uniforms[e.timeUniform]={get value(){return Date.now()-Hj}}),this[s]&&this[s](f)},o=function(){return l(e.chained?i:i.clone())},l=function(f){const p=Object.create(f,u);return Object.defineProperty(p,"baseMaterial",{value:i}),Object.defineProperty(p,"id",{value:Wj++}),p.uuid=Gj(),p.uniforms=Qf({},f.uniforms,e.uniforms),p.defines=Qf({},f.defines,e.defines),p.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",p.extensions=Qf({},f.extensions,e.extensions),p._listeners=void 0,p},u={constructor:{value:o},isDerivedMaterial:{value:!0},type:{get:()=>i.type,set:f=>{i.type=f}},isDerivedFrom:{writable:!0,configurable:!0,value:function(f){const p=this.baseMaterial;return f===p||p.isDerivedMaterial&&p.isDerivedFrom(f)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return i.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return r},set(f){this[s]=f}},copy:{writable:!0,configurable:!0,value:function(f){return i.copy.call(this,f),!i.isShaderMaterial&&!i.isDerivedMaterial&&(Qf(this.extensions,f.extensions),Qf(this.defines,f.defines),Qf(this.uniforms,GA.clone(f.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const f=new i.constructor;return l(f).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let f=this._depthMaterial;return f||(f=this._depthMaterial=Iw(i.isDerivedMaterial?i.getDepthMaterial():new rS({depthPacking:rP}),e),f.defines.IS_DEPTH_MATERIAL="",f.uniforms=this.uniforms),f}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let f=this._distanceMaterial;return f||(f=this._distanceMaterial=Iw(i.isDerivedMaterial?i.getDistanceMaterial():new aS,e),f.defines.IS_DISTANCE_MATERIAL="",f.uniforms=this.uniforms),f}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:f,_distanceMaterial:p}=this;f&&f.dispose(),p&&p.dispose(),i.dispose.call(this)}}};return n[t]=o,new o}function jj(i,{vertexShader:e,fragmentShader:t},n,s){let{vertexDefs:r,vertexMainIntro:o,vertexMainOutro:l,vertexTransform:u,fragmentDefs:f,fragmentMainIntro:p,fragmentMainOutro:g,fragmentColorTransform:v,customRewriter:x,timeUniform:b}=n;if(r=r||"",o=o||"",l=l||"",f=f||"",p=p||"",g=g||"",(u||x)&&(e=Nw(e)),(v||x)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=Nw(t)),x){let w=x({vertexShader:e,fragmentShader:t});e=w.vertexShader,t=w.fragmentShader}if(v){let w=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,M=>(w.push(M),"")),g=`${v}
${w.join(`
`)}
${g}`}if(b){const w=`
uniform float ${b};
`;r=w+r,f=w+f}return u&&(e=`vec3 troika_position_${s};
vec3 troika_normal_${s};
vec2 troika_uv_${s};
${e}
`,r=`${r}
void troikaVertexTransform${s}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${u}
}
`,o=`
troika_position_${s} = vec3(position);
troika_normal_${s} = vec3(normal);
troika_uv_${s} = vec2(uv);
troikaVertexTransform${s}(troika_position_${s}, troika_normal_${s}, troika_uv_${s});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(w,M,S,C)=>/\battribute\s+vec[23]\s+$/.test(C.substr(0,S))?M:`troika_${M}_${s}`),i.map&&i.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${s}`))),e=mN(e,s,r,o,l),t=mN(t,s,f,p,g),{vertexShader:e,fragmentShader:t}}function mN(i,e,t,n,s){return(n||s||t)&&(i=i.replace(VU,`
${t}
void troikaOrigMain${e}() {`),i+=`
void main() {
  ${n}
  troikaOrigMain${e}();
  ${s}
}`),i}function qj(i,e){return i==="uniforms"?void 0:typeof e=="function"?e.toString():e}let Xj=0;const gN=new Map;function Yj(i){const e=JSON.stringify(i,qj);let t=gN.get(e);return t==null&&gN.set(e,t=++Xj),t}function Zj(){return typeof window>"u"&&(self.window=self),(function(i){var e={parse:function(s){var r=e._bin,o=new Uint8Array(s);if(r.readASCII(o,0,4)=="ttcf"){var l=4;r.readUshort(o,l),l+=2,r.readUshort(o,l),l+=2;var u=r.readUint(o,l);l+=4;for(var f=[],p=0;p<u;p++){var g=r.readUint(o,l);l+=4,f.push(e._readFont(o,g))}return f}return[e._readFont(o,0)]},_readFont:function(s,r){var o=e._bin,l=r;o.readFixed(s,r),r+=4;var u=o.readUshort(s,r);r+=2,o.readUshort(s,r),r+=2,o.readUshort(s,r),r+=2,o.readUshort(s,r),r+=2;for(var f=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],p={_data:s,_offset:l},g={},v=0;v<u;v++){var x=o.readASCII(s,r,4);r+=4,o.readUint(s,r),r+=4;var b=o.readUint(s,r);r+=4;var w=o.readUint(s,r);r+=4,g[x]={offset:b,length:w}}for(v=0;v<f.length;v++){var M=f[v];g[M]&&(p[M.trim()]=e[M.trim()].parse(s,g[M].offset,g[M].length,p))}return p},_tabOffset:function(s,r,o){for(var l=e._bin,u=l.readUshort(s,o+4),f=o+12,p=0;p<u;p++){var g=l.readASCII(s,f,4);f+=4,l.readUint(s,f),f+=4;var v=l.readUint(s,f);if(f+=4,l.readUint(s,f),f+=4,g==r)return v}return 0}};e._bin={readFixed:function(s,r){return(s[r]<<8|s[r+1])+(s[r+2]<<8|s[r+3])/65540},readF2dot14:function(s,r){return e._bin.readShort(s,r)/16384},readInt:function(s,r){return e._bin._view(s).getInt32(r)},readInt8:function(s,r){return e._bin._view(s).getInt8(r)},readShort:function(s,r){return e._bin._view(s).getInt16(r)},readUshort:function(s,r){return e._bin._view(s).getUint16(r)},readUshorts:function(s,r,o){for(var l=[],u=0;u<o;u++)l.push(e._bin.readUshort(s,r+2*u));return l},readUint:function(s,r){return e._bin._view(s).getUint32(r)},readUint64:function(s,r){return 4294967296*e._bin.readUint(s,r)+e._bin.readUint(s,r+4)},readASCII:function(s,r,o){for(var l="",u=0;u<o;u++)l+=String.fromCharCode(s[r+u]);return l},readUnicode:function(s,r,o){for(var l="",u=0;u<o;u++){var f=s[r++]<<8|s[r++];l+=String.fromCharCode(f)}return l},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(s,r,o){var l=e._bin._tdec;return l&&r==0&&o==s.length?l.decode(s):e._bin.readASCII(s,r,o)},readBytes:function(s,r,o){for(var l=[],u=0;u<o;u++)l.push(s[r+u]);return l},readASCIIArray:function(s,r,o){for(var l=[],u=0;u<o;u++)l.push(String.fromCharCode(s[r+u]));return l},_view:function(s){return s._dataView||(s._dataView=s.buffer?new DataView(s.buffer,s.byteOffset,s.byteLength):new DataView(new Uint8Array(s).buffer))}},e._lctf={},e._lctf.parse=function(s,r,o,l,u){var f=e._bin,p={},g=r;f.readFixed(s,r),r+=4;var v=f.readUshort(s,r);r+=2;var x=f.readUshort(s,r);r+=2;var b=f.readUshort(s,r);return r+=2,p.scriptList=e._lctf.readScriptList(s,g+v),p.featureList=e._lctf.readFeatureList(s,g+x),p.lookupList=e._lctf.readLookupList(s,g+b,u),p},e._lctf.readLookupList=function(s,r,o){var l=e._bin,u=r,f=[],p=l.readUshort(s,r);r+=2;for(var g=0;g<p;g++){var v=l.readUshort(s,r);r+=2;var x=e._lctf.readLookupTable(s,u+v,o);f.push(x)}return f},e._lctf.readLookupTable=function(s,r,o){var l=e._bin,u=r,f={tabs:[]};f.ltype=l.readUshort(s,r),r+=2,f.flag=l.readUshort(s,r),r+=2;var p=l.readUshort(s,r);r+=2;for(var g=f.ltype,v=0;v<p;v++){var x=l.readUshort(s,r);r+=2;var b=o(s,g,u+x,f);f.tabs.push(b)}return f},e._lctf.numOfOnes=function(s){for(var r=0,o=0;o<32;o++)(s>>>o&1)!=0&&r++;return r},e._lctf.readClassDef=function(s,r){var o=e._bin,l=[],u=o.readUshort(s,r);if(r+=2,u==1){var f=o.readUshort(s,r);r+=2;var p=o.readUshort(s,r);r+=2;for(var g=0;g<p;g++)l.push(f+g),l.push(f+g),l.push(o.readUshort(s,r)),r+=2}if(u==2){var v=o.readUshort(s,r);for(r+=2,g=0;g<v;g++)l.push(o.readUshort(s,r)),r+=2,l.push(o.readUshort(s,r)),r+=2,l.push(o.readUshort(s,r)),r+=2}return l},e._lctf.getInterval=function(s,r){for(var o=0;o<s.length;o+=3){var l=s[o],u=s[o+1];if(s[o+2],l<=r&&r<=u)return o}return-1},e._lctf.readCoverage=function(s,r){var o=e._bin,l={};l.fmt=o.readUshort(s,r),r+=2;var u=o.readUshort(s,r);return r+=2,l.fmt==1&&(l.tab=o.readUshorts(s,r,u)),l.fmt==2&&(l.tab=o.readUshorts(s,r,3*u)),l},e._lctf.coverageIndex=function(s,r){var o=s.tab;if(s.fmt==1)return o.indexOf(r);if(s.fmt==2){var l=e._lctf.getInterval(o,r);if(l!=-1)return o[l+2]+(r-o[l])}return-1},e._lctf.readFeatureList=function(s,r){var o=e._bin,l=r,u=[],f=o.readUshort(s,r);r+=2;for(var p=0;p<f;p++){var g=o.readASCII(s,r,4);r+=4;var v=o.readUshort(s,r);r+=2;var x=e._lctf.readFeatureTable(s,l+v);x.tag=g.trim(),u.push(x)}return u},e._lctf.readFeatureTable=function(s,r){var o=e._bin,l=r,u={},f=o.readUshort(s,r);r+=2,f>0&&(u.featureParams=l+f);var p=o.readUshort(s,r);r+=2,u.tab=[];for(var g=0;g<p;g++)u.tab.push(o.readUshort(s,r+2*g));return u},e._lctf.readScriptList=function(s,r){var o=e._bin,l=r,u={},f=o.readUshort(s,r);r+=2;for(var p=0;p<f;p++){var g=o.readASCII(s,r,4);r+=4;var v=o.readUshort(s,r);r+=2,u[g.trim()]=e._lctf.readScriptTable(s,l+v)}return u},e._lctf.readScriptTable=function(s,r){var o=e._bin,l=r,u={},f=o.readUshort(s,r);r+=2,f>0&&(u.default=e._lctf.readLangSysTable(s,l+f));var p=o.readUshort(s,r);r+=2;for(var g=0;g<p;g++){var v=o.readASCII(s,r,4);r+=4;var x=o.readUshort(s,r);r+=2,u[v.trim()]=e._lctf.readLangSysTable(s,l+x)}return u},e._lctf.readLangSysTable=function(s,r){var o=e._bin,l={};o.readUshort(s,r),r+=2,l.reqFeature=o.readUshort(s,r),r+=2;var u=o.readUshort(s,r);return r+=2,l.features=o.readUshorts(s,r,u),l},e.CFF={},e.CFF.parse=function(s,r,o){var l=e._bin;(s=new Uint8Array(s.buffer,r,o))[r=0],s[++r],s[++r],s[++r],r++;var u=[];r=e.CFF.readIndex(s,r,u);for(var f=[],p=0;p<u.length-1;p++)f.push(l.readASCII(s,r+u[p],u[p+1]-u[p]));r+=u[u.length-1];var g=[];r=e.CFF.readIndex(s,r,g);var v=[];for(p=0;p<g.length-1;p++)v.push(e.CFF.readDict(s,r+g[p],r+g[p+1]));r+=g[g.length-1];var x=v[0],b=[];r=e.CFF.readIndex(s,r,b);var w=[];for(p=0;p<b.length-1;p++)w.push(l.readASCII(s,r+b[p],b[p+1]-b[p]));if(r+=b[b.length-1],e.CFF.readSubrs(s,r,x),x.CharStrings){r=x.CharStrings,b=[],r=e.CFF.readIndex(s,r,b);var M=[];for(p=0;p<b.length-1;p++)M.push(l.readBytes(s,r+b[p],b[p+1]-b[p]));x.CharStrings=M}if(x.ROS){r=x.FDArray;var S=[];for(r=e.CFF.readIndex(s,r,S),x.FDArray=[],p=0;p<S.length-1;p++){var C=e.CFF.readDict(s,r+S[p],r+S[p+1]);e.CFF._readFDict(s,C,w),x.FDArray.push(C)}r+=S[S.length-1],r=x.FDSelect,x.FDSelect=[];var R=s[r];if(r++,R!=3)throw R;var I=l.readUshort(s,r);for(r+=2,p=0;p<I+1;p++)x.FDSelect.push(l.readUshort(s,r),s[r+2]),r+=3}return x.Encoding&&(x.Encoding=e.CFF.readEncoding(s,x.Encoding,x.CharStrings.length)),x.charset&&(x.charset=e.CFF.readCharset(s,x.charset,x.CharStrings.length)),e.CFF._readFDict(s,x,w),x},e.CFF._readFDict=function(s,r,o){var l;for(var u in r.Private&&(l=r.Private[1],r.Private=e.CFF.readDict(s,l,l+r.Private[0]),r.Private.Subrs&&e.CFF.readSubrs(s,l+r.Private.Subrs,r.Private)),r)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(u)!=-1&&(r[u]=o[r[u]-426+35])},e.CFF.readSubrs=function(s,r,o){var l=e._bin,u=[];r=e.CFF.readIndex(s,r,u);var f,p=u.length;f=p<1240?107:p<33900?1131:32768,o.Bias=f,o.Subrs=[];for(var g=0;g<u.length-1;g++)o.Subrs.push(l.readBytes(s,r+u[g],u[g+1]-u[g]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(s,r){for(var o=0;o<s.charset.length;o++)if(s.charset[o]==r)return o;return-1},e.CFF.glyphBySE=function(s,r){return r<0||r>255?-1:e.CFF.glyphByUnicode(s,e.CFF.tableSE[r])},e.CFF.readEncoding=function(s,r,o){e._bin;var l=[".notdef"],u=s[r];if(r++,u!=0)throw"error: unknown encoding format: "+u;var f=s[r];r++;for(var p=0;p<f;p++)l.push(s[r+p]);return l},e.CFF.readCharset=function(s,r,o){var l=e._bin,u=[".notdef"],f=s[r];if(r++,f==0)for(var p=0;p<o;p++){var g=l.readUshort(s,r);r+=2,u.push(g)}else{if(f!=1&&f!=2)throw"error: format: "+f;for(;u.length<o;){g=l.readUshort(s,r),r+=2;var v=0;for(f==1?(v=s[r],r++):(v=l.readUshort(s,r),r+=2),p=0;p<=v;p++)u.push(g),g++}}return u},e.CFF.readIndex=function(s,r,o){var l=e._bin,u=l.readUshort(s,r)+1,f=s[r+=2];if(r++,f==1)for(var p=0;p<u;p++)o.push(s[r+p]);else if(f==2)for(p=0;p<u;p++)o.push(l.readUshort(s,r+2*p));else if(f==3)for(p=0;p<u;p++)o.push(16777215&l.readUint(s,r+3*p-1));else if(u!=1)throw"unsupported offset size: "+f+", count: "+u;return(r+=u*f)-1},e.CFF.getCharString=function(s,r,o){var l=e._bin,u=s[r],f=s[r+1];s[r+2],s[r+3],s[r+4];var p=1,g=null,v=null;u<=20&&(g=u,p=1),u==12&&(g=100*u+f,p=2),21<=u&&u<=27&&(g=u,p=1),u==28&&(v=l.readShort(s,r+1),p=3),29<=u&&u<=31&&(g=u,p=1),32<=u&&u<=246&&(v=u-139,p=1),247<=u&&u<=250&&(v=256*(u-247)+f+108,p=2),251<=u&&u<=254&&(v=256*-(u-251)-f-108,p=2),u==255&&(v=l.readInt(s,r+1)/65535,p=5),o.val=v??"o"+g,o.size=p},e.CFF.readCharString=function(s,r,o){for(var l=r+o,u=e._bin,f=[];r<l;){var p=s[r],g=s[r+1];s[r+2],s[r+3],s[r+4];var v=1,x=null,b=null;p<=20&&(x=p,v=1),p==12&&(x=100*p+g,v=2),p!=19&&p!=20||(x=p,v=2),21<=p&&p<=27&&(x=p,v=1),p==28&&(b=u.readShort(s,r+1),v=3),29<=p&&p<=31&&(x=p,v=1),32<=p&&p<=246&&(b=p-139,v=1),247<=p&&p<=250&&(b=256*(p-247)+g+108,v=2),251<=p&&p<=254&&(b=256*-(p-251)-g-108,v=2),p==255&&(b=u.readInt(s,r+1)/65535,v=5),f.push(b??"o"+x),r+=v}return f},e.CFF.readDict=function(s,r,o){for(var l=e._bin,u={},f=[];r<o;){var p=s[r],g=s[r+1];s[r+2],s[r+3],s[r+4];var v=1,x=null,b=null;if(p==28&&(b=l.readShort(s,r+1),v=3),p==29&&(b=l.readInt(s,r+1),v=5),32<=p&&p<=246&&(b=p-139,v=1),247<=p&&p<=250&&(b=256*(p-247)+g+108,v=2),251<=p&&p<=254&&(b=256*-(p-251)-g-108,v=2),p==255)throw b=l.readInt(s,r+1)/65535,v=5,"unknown number";if(p==30){var w=[];for(v=1;;){var M=s[r+v];v++;var S=M>>4,C=15&M;if(S!=15&&w.push(S),C!=15&&w.push(C),C==15)break}for(var R="",I=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],D=0;D<w.length;D++)R+=I[w[D]];b=parseFloat(R)}p<=21&&(x=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][p],v=1,p==12&&(x=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][g],v=2)),x!=null?(u[x]=f.length==1?f[0]:f,f=[]):f.push(b),r+=v}return u},e.cmap={},e.cmap.parse=function(s,r,o){s=new Uint8Array(s.buffer,r,o),r=0;var l=e._bin,u={};l.readUshort(s,r),r+=2;var f=l.readUshort(s,r);r+=2;var p=[];u.tables=[];for(var g=0;g<f;g++){var v=l.readUshort(s,r);r+=2;var x=l.readUshort(s,r);r+=2;var b=l.readUint(s,r);r+=4;var w="p"+v+"e"+x,M=p.indexOf(b);if(M==-1){var S;M=u.tables.length,p.push(b);var C=l.readUshort(s,b);C==0?S=e.cmap.parse0(s,b):C==4?S=e.cmap.parse4(s,b):C==6?S=e.cmap.parse6(s,b):C==12?S=e.cmap.parse12(s,b):console.debug("unknown format: "+C,v,x,b),u.tables.push(S)}if(u[w]!=null)throw"multiple tables for one platform+encoding";u[w]=M}return u},e.cmap.parse0=function(s,r){var o=e._bin,l={};l.format=o.readUshort(s,r),r+=2;var u=o.readUshort(s,r);r+=2,o.readUshort(s,r),r+=2,l.map=[];for(var f=0;f<u-6;f++)l.map.push(s[r+f]);return l},e.cmap.parse4=function(s,r){var o=e._bin,l=r,u={};u.format=o.readUshort(s,r),r+=2;var f=o.readUshort(s,r);r+=2,o.readUshort(s,r),r+=2;var p=o.readUshort(s,r);r+=2;var g=p/2;u.searchRange=o.readUshort(s,r),r+=2,u.entrySelector=o.readUshort(s,r),r+=2,u.rangeShift=o.readUshort(s,r),r+=2,u.endCount=o.readUshorts(s,r,g),r+=2*g,r+=2,u.startCount=o.readUshorts(s,r,g),r+=2*g,u.idDelta=[];for(var v=0;v<g;v++)u.idDelta.push(o.readShort(s,r)),r+=2;for(u.idRangeOffset=o.readUshorts(s,r,g),r+=2*g,u.glyphIdArray=[];r<l+f;)u.glyphIdArray.push(o.readUshort(s,r)),r+=2;return u},e.cmap.parse6=function(s,r){var o=e._bin,l={};l.format=o.readUshort(s,r),r+=2,o.readUshort(s,r),r+=2,o.readUshort(s,r),r+=2,l.firstCode=o.readUshort(s,r),r+=2;var u=o.readUshort(s,r);r+=2,l.glyphIdArray=[];for(var f=0;f<u;f++)l.glyphIdArray.push(o.readUshort(s,r)),r+=2;return l},e.cmap.parse12=function(s,r){var o=e._bin,l={};l.format=o.readUshort(s,r),r+=2,r+=2,o.readUint(s,r),r+=4,o.readUint(s,r),r+=4;var u=o.readUint(s,r);r+=4,l.groups=[];for(var f=0;f<u;f++){var p=r+12*f,g=o.readUint(s,p+0),v=o.readUint(s,p+4),x=o.readUint(s,p+8);l.groups.push([g,v,x])}return l},e.glyf={},e.glyf.parse=function(s,r,o,l){for(var u=[],f=0;f<l.maxp.numGlyphs;f++)u.push(null);return u},e.glyf._parseGlyf=function(s,r){var o=e._bin,l=s._data,u=e._tabOffset(l,"glyf",s._offset)+s.loca[r];if(s.loca[r]==s.loca[r+1])return null;var f={};if(f.noc=o.readShort(l,u),u+=2,f.xMin=o.readShort(l,u),u+=2,f.yMin=o.readShort(l,u),u+=2,f.xMax=o.readShort(l,u),u+=2,f.yMax=o.readShort(l,u),u+=2,f.xMin>=f.xMax||f.yMin>=f.yMax)return null;if(f.noc>0){f.endPts=[];for(var p=0;p<f.noc;p++)f.endPts.push(o.readUshort(l,u)),u+=2;var g=o.readUshort(l,u);if(u+=2,l.length-u<g)return null;f.instructions=o.readBytes(l,u,g),u+=g;var v=f.endPts[f.noc-1]+1;for(f.flags=[],p=0;p<v;p++){var x=l[u];if(u++,f.flags.push(x),(8&x)!=0){var b=l[u];u++;for(var w=0;w<b;w++)f.flags.push(x),p++}}for(f.xs=[],p=0;p<v;p++){var M=(2&f.flags[p])!=0,S=(16&f.flags[p])!=0;M?(f.xs.push(S?l[u]:-l[u]),u++):S?f.xs.push(0):(f.xs.push(o.readShort(l,u)),u+=2)}for(f.ys=[],p=0;p<v;p++)M=(4&f.flags[p])!=0,S=(32&f.flags[p])!=0,M?(f.ys.push(S?l[u]:-l[u]),u++):S?f.ys.push(0):(f.ys.push(o.readShort(l,u)),u+=2);var C=0,R=0;for(p=0;p<v;p++)C+=f.xs[p],R+=f.ys[p],f.xs[p]=C,f.ys[p]=R}else{var I;f.parts=[];do{I=o.readUshort(l,u),u+=2;var D={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(f.parts.push(D),D.glyphIndex=o.readUshort(l,u),u+=2,1&I){var O=o.readShort(l,u);u+=2;var U=o.readShort(l,u);u+=2}else O=o.readInt8(l,u),u++,U=o.readInt8(l,u),u++;2&I?(D.m.tx=O,D.m.ty=U):(D.p1=O,D.p2=U),8&I?(D.m.a=D.m.d=o.readF2dot14(l,u),u+=2):64&I?(D.m.a=o.readF2dot14(l,u),u+=2,D.m.d=o.readF2dot14(l,u),u+=2):128&I&&(D.m.a=o.readF2dot14(l,u),u+=2,D.m.b=o.readF2dot14(l,u),u+=2,D.m.c=o.readF2dot14(l,u),u+=2,D.m.d=o.readF2dot14(l,u),u+=2)}while(32&I);if(256&I){var k=o.readUshort(l,u);for(u+=2,f.instr=[],p=0;p<k;p++)f.instr.push(l[u]),u++}}return f},e.GDEF={},e.GDEF.parse=function(s,r,o,l){var u=r;r+=4;var f=e._bin.readUshort(s,r);return{glyphClassDef:f===0?null:e._lctf.readClassDef(s,u+f)}},e.GPOS={},e.GPOS.parse=function(s,r,o,l){return e._lctf.parse(s,r,o,l,e.GPOS.subt)},e.GPOS.subt=function(s,r,o,l){var u=e._bin,f=o,p={};if(p.fmt=u.readUshort(s,o),o+=2,r==1||r==2||r==3||r==7||r==8&&p.fmt<=2){var g=u.readUshort(s,o);o+=2,p.coverage=e._lctf.readCoverage(s,g+f)}if(r==1&&p.fmt==1){var v=u.readUshort(s,o);o+=2,v!=0&&(p.pos=e.GPOS.readValueRecord(s,o,v))}else if(r==2&&p.fmt>=1&&p.fmt<=2){v=u.readUshort(s,o),o+=2;var x=u.readUshort(s,o);o+=2;var b=e._lctf.numOfOnes(v),w=e._lctf.numOfOnes(x);if(p.fmt==1){p.pairsets=[];var M=u.readUshort(s,o);o+=2;for(var S=0;S<M;S++){var C=f+u.readUshort(s,o);o+=2;var R=u.readUshort(s,C);C+=2;for(var I=[],D=0;D<R;D++){var O=u.readUshort(s,C);C+=2,v!=0&&(G=e.GPOS.readValueRecord(s,C,v),C+=2*b),x!=0&&(j=e.GPOS.readValueRecord(s,C,x),C+=2*w),I.push({gid2:O,val1:G,val2:j})}p.pairsets.push(I)}}if(p.fmt==2){var U=u.readUshort(s,o);o+=2;var k=u.readUshort(s,o);o+=2;var P=u.readUshort(s,o);o+=2;var F=u.readUshort(s,o);for(o+=2,p.classDef1=e._lctf.readClassDef(s,f+U),p.classDef2=e._lctf.readClassDef(s,f+k),p.matrix=[],S=0;S<P;S++){var H=[];for(D=0;D<F;D++){var G=null,j=null;v!=0&&(G=e.GPOS.readValueRecord(s,o,v),o+=2*b),x!=0&&(j=e.GPOS.readValueRecord(s,o,x),o+=2*w),H.push({val1:G,val2:j})}p.matrix.push(H)}}}else if(r==4&&p.fmt==1)p.markCoverage=e._lctf.readCoverage(s,u.readUshort(s,o)+f),p.baseCoverage=e._lctf.readCoverage(s,u.readUshort(s,o+2)+f),p.markClassCount=u.readUshort(s,o+4),p.markArray=e.GPOS.readMarkArray(s,u.readUshort(s,o+6)+f),p.baseArray=e.GPOS.readBaseArray(s,u.readUshort(s,o+8)+f,p.markClassCount);else if(r==6&&p.fmt==1)p.mark1Coverage=e._lctf.readCoverage(s,u.readUshort(s,o)+f),p.mark2Coverage=e._lctf.readCoverage(s,u.readUshort(s,o+2)+f),p.markClassCount=u.readUshort(s,o+4),p.mark1Array=e.GPOS.readMarkArray(s,u.readUshort(s,o+6)+f),p.mark2Array=e.GPOS.readBaseArray(s,u.readUshort(s,o+8)+f,p.markClassCount);else{if(r==9&&p.fmt==1){var K=u.readUshort(s,o);o+=2;var te=u.readUint(s,o);if(o+=4,l.ltype==9)l.ltype=K;else if(l.ltype!=K)throw"invalid extension substitution";return e.GPOS.subt(s,l.ltype,f+te)}console.debug("unsupported GPOS table LookupType",r,"format",p.fmt)}return p},e.GPOS.readValueRecord=function(s,r,o){var l=e._bin,u=[];return u.push(1&o?l.readShort(s,r):0),r+=1&o?2:0,u.push(2&o?l.readShort(s,r):0),r+=2&o?2:0,u.push(4&o?l.readShort(s,r):0),r+=4&o?2:0,u.push(8&o?l.readShort(s,r):0),r+=8&o?2:0,u},e.GPOS.readBaseArray=function(s,r,o){var l=e._bin,u=[],f=r,p=l.readUshort(s,r);r+=2;for(var g=0;g<p;g++){for(var v=[],x=0;x<o;x++)v.push(e.GPOS.readAnchorRecord(s,f+l.readUshort(s,r))),r+=2;u.push(v)}return u},e.GPOS.readMarkArray=function(s,r){var o=e._bin,l=[],u=r,f=o.readUshort(s,r);r+=2;for(var p=0;p<f;p++){var g=e.GPOS.readAnchorRecord(s,o.readUshort(s,r+2)+u);g.markClass=o.readUshort(s,r),l.push(g),r+=4}return l},e.GPOS.readAnchorRecord=function(s,r){var o=e._bin,l={};return l.fmt=o.readUshort(s,r),l.x=o.readShort(s,r+2),l.y=o.readShort(s,r+4),l},e.GSUB={},e.GSUB.parse=function(s,r,o,l){return e._lctf.parse(s,r,o,l,e.GSUB.subt)},e.GSUB.subt=function(s,r,o,l){var u=e._bin,f=o,p={};if(p.fmt=u.readUshort(s,o),o+=2,r!=1&&r!=2&&r!=4&&r!=5&&r!=6)return null;if(r==1||r==2||r==4||r==5&&p.fmt<=2||r==6&&p.fmt<=2){var g=u.readUshort(s,o);o+=2,p.coverage=e._lctf.readCoverage(s,f+g)}if(r==1&&p.fmt>=1&&p.fmt<=2){if(p.fmt==1)p.delta=u.readShort(s,o),o+=2;else if(p.fmt==2){var v=u.readUshort(s,o);o+=2,p.newg=u.readUshorts(s,o,v),o+=2*p.newg.length}}else if(r==2&&p.fmt==1){v=u.readUshort(s,o),o+=2,p.seqs=[];for(var x=0;x<v;x++){var b=u.readUshort(s,o)+f;o+=2;var w=u.readUshort(s,b);p.seqs.push(u.readUshorts(s,b+2,w))}}else if(r==4)for(p.vals=[],v=u.readUshort(s,o),o+=2,x=0;x<v;x++){var M=u.readUshort(s,o);o+=2,p.vals.push(e.GSUB.readLigatureSet(s,f+M))}else if(r==5&&p.fmt==2){if(p.fmt==2){var S=u.readUshort(s,o);o+=2,p.cDef=e._lctf.readClassDef(s,f+S),p.scset=[];var C=u.readUshort(s,o);for(o+=2,x=0;x<C;x++){var R=u.readUshort(s,o);o+=2,p.scset.push(R==0?null:e.GSUB.readSubClassSet(s,f+R))}}}else if(r==6&&p.fmt==3){if(p.fmt==3){for(x=0;x<3;x++){v=u.readUshort(s,o),o+=2;for(var I=[],D=0;D<v;D++)I.push(e._lctf.readCoverage(s,f+u.readUshort(s,o+2*D)));o+=2*v,x==0&&(p.backCvg=I),x==1&&(p.inptCvg=I),x==2&&(p.ahedCvg=I)}v=u.readUshort(s,o),o+=2,p.lookupRec=e.GSUB.readSubstLookupRecords(s,o,v)}}else{if(r==7&&p.fmt==1){var O=u.readUshort(s,o);o+=2;var U=u.readUint(s,o);if(o+=4,l.ltype==9)l.ltype=O;else if(l.ltype!=O)throw"invalid extension substitution";return e.GSUB.subt(s,l.ltype,f+U)}console.debug("unsupported GSUB table LookupType",r,"format",p.fmt)}return p},e.GSUB.readSubClassSet=function(s,r){var o=e._bin.readUshort,l=r,u=[],f=o(s,r);r+=2;for(var p=0;p<f;p++){var g=o(s,r);r+=2,u.push(e.GSUB.readSubClassRule(s,l+g))}return u},e.GSUB.readSubClassRule=function(s,r){var o=e._bin.readUshort,l={},u=o(s,r),f=o(s,r+=2);r+=2,l.input=[];for(var p=0;p<u-1;p++)l.input.push(o(s,r)),r+=2;return l.substLookupRecords=e.GSUB.readSubstLookupRecords(s,r,f),l},e.GSUB.readSubstLookupRecords=function(s,r,o){for(var l=e._bin.readUshort,u=[],f=0;f<o;f++)u.push(l(s,r),l(s,r+2)),r+=4;return u},e.GSUB.readChainSubClassSet=function(s,r){var o=e._bin,l=r,u=[],f=o.readUshort(s,r);r+=2;for(var p=0;p<f;p++){var g=o.readUshort(s,r);r+=2,u.push(e.GSUB.readChainSubClassRule(s,l+g))}return u},e.GSUB.readChainSubClassRule=function(s,r){for(var o=e._bin,l={},u=["backtrack","input","lookahead"],f=0;f<u.length;f++){var p=o.readUshort(s,r);r+=2,f==1&&p--,l[u[f]]=o.readUshorts(s,r,p),r+=2*l[u[f]].length}return p=o.readUshort(s,r),r+=2,l.subst=o.readUshorts(s,r,2*p),r+=2*l.subst.length,l},e.GSUB.readLigatureSet=function(s,r){var o=e._bin,l=r,u=[],f=o.readUshort(s,r);r+=2;for(var p=0;p<f;p++){var g=o.readUshort(s,r);r+=2,u.push(e.GSUB.readLigature(s,l+g))}return u},e.GSUB.readLigature=function(s,r){var o=e._bin,l={chain:[]};l.nglyph=o.readUshort(s,r),r+=2;var u=o.readUshort(s,r);r+=2;for(var f=0;f<u-1;f++)l.chain.push(o.readUshort(s,r)),r+=2;return l},e.head={},e.head.parse=function(s,r,o){var l=e._bin,u={};return l.readFixed(s,r),r+=4,u.fontRevision=l.readFixed(s,r),r+=4,l.readUint(s,r),r+=4,l.readUint(s,r),r+=4,u.flags=l.readUshort(s,r),r+=2,u.unitsPerEm=l.readUshort(s,r),r+=2,u.created=l.readUint64(s,r),r+=8,u.modified=l.readUint64(s,r),r+=8,u.xMin=l.readShort(s,r),r+=2,u.yMin=l.readShort(s,r),r+=2,u.xMax=l.readShort(s,r),r+=2,u.yMax=l.readShort(s,r),r+=2,u.macStyle=l.readUshort(s,r),r+=2,u.lowestRecPPEM=l.readUshort(s,r),r+=2,u.fontDirectionHint=l.readShort(s,r),r+=2,u.indexToLocFormat=l.readShort(s,r),r+=2,u.glyphDataFormat=l.readShort(s,r),r+=2,u},e.hhea={},e.hhea.parse=function(s,r,o){var l=e._bin,u={};return l.readFixed(s,r),r+=4,u.ascender=l.readShort(s,r),r+=2,u.descender=l.readShort(s,r),r+=2,u.lineGap=l.readShort(s,r),r+=2,u.advanceWidthMax=l.readUshort(s,r),r+=2,u.minLeftSideBearing=l.readShort(s,r),r+=2,u.minRightSideBearing=l.readShort(s,r),r+=2,u.xMaxExtent=l.readShort(s,r),r+=2,u.caretSlopeRise=l.readShort(s,r),r+=2,u.caretSlopeRun=l.readShort(s,r),r+=2,u.caretOffset=l.readShort(s,r),r+=2,r+=8,u.metricDataFormat=l.readShort(s,r),r+=2,u.numberOfHMetrics=l.readUshort(s,r),r+=2,u},e.hmtx={},e.hmtx.parse=function(s,r,o,l){for(var u=e._bin,f={aWidth:[],lsBearing:[]},p=0,g=0,v=0;v<l.maxp.numGlyphs;v++)v<l.hhea.numberOfHMetrics&&(p=u.readUshort(s,r),r+=2,g=u.readShort(s,r),r+=2),f.aWidth.push(p),f.lsBearing.push(g);return f},e.kern={},e.kern.parse=function(s,r,o,l){var u=e._bin,f=u.readUshort(s,r);if(r+=2,f==1)return e.kern.parseV1(s,r-2,o,l);var p=u.readUshort(s,r);r+=2;for(var g={glyph1:[],rval:[]},v=0;v<p;v++){r+=2,o=u.readUshort(s,r),r+=2;var x=u.readUshort(s,r);r+=2;var b=x>>>8;if((b&=15)!=0)throw"unknown kern table format: "+b;r=e.kern.readFormat0(s,r,g)}return g},e.kern.parseV1=function(s,r,o,l){var u=e._bin;u.readFixed(s,r),r+=4;var f=u.readUint(s,r);r+=4;for(var p={glyph1:[],rval:[]},g=0;g<f;g++){u.readUint(s,r),r+=4;var v=u.readUshort(s,r);r+=2,u.readUshort(s,r),r+=2;var x=v>>>8;if((x&=15)!=0)throw"unknown kern table format: "+x;r=e.kern.readFormat0(s,r,p)}return p},e.kern.readFormat0=function(s,r,o){var l=e._bin,u=-1,f=l.readUshort(s,r);r+=2,l.readUshort(s,r),r+=2,l.readUshort(s,r),r+=2,l.readUshort(s,r),r+=2;for(var p=0;p<f;p++){var g=l.readUshort(s,r);r+=2;var v=l.readUshort(s,r);r+=2;var x=l.readShort(s,r);r+=2,g!=u&&(o.glyph1.push(g),o.rval.push({glyph2:[],vals:[]}));var b=o.rval[o.rval.length-1];b.glyph2.push(v),b.vals.push(x),u=g}return r},e.loca={},e.loca.parse=function(s,r,o,l){var u=e._bin,f=[],p=l.head.indexToLocFormat,g=l.maxp.numGlyphs+1;if(p==0)for(var v=0;v<g;v++)f.push(u.readUshort(s,r+(v<<1))<<1);if(p==1)for(v=0;v<g;v++)f.push(u.readUint(s,r+(v<<2)));return f},e.maxp={},e.maxp.parse=function(s,r,o){var l=e._bin,u={},f=l.readUint(s,r);return r+=4,u.numGlyphs=l.readUshort(s,r),r+=2,f==65536&&(u.maxPoints=l.readUshort(s,r),r+=2,u.maxContours=l.readUshort(s,r),r+=2,u.maxCompositePoints=l.readUshort(s,r),r+=2,u.maxCompositeContours=l.readUshort(s,r),r+=2,u.maxZones=l.readUshort(s,r),r+=2,u.maxTwilightPoints=l.readUshort(s,r),r+=2,u.maxStorage=l.readUshort(s,r),r+=2,u.maxFunctionDefs=l.readUshort(s,r),r+=2,u.maxInstructionDefs=l.readUshort(s,r),r+=2,u.maxStackElements=l.readUshort(s,r),r+=2,u.maxSizeOfInstructions=l.readUshort(s,r),r+=2,u.maxComponentElements=l.readUshort(s,r),r+=2,u.maxComponentDepth=l.readUshort(s,r),r+=2),u},e.name={},e.name.parse=function(s,r,o){var l=e._bin,u={};l.readUshort(s,r),r+=2;var f=l.readUshort(s,r);r+=2,l.readUshort(s,r);for(var p,g=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],v=r+=2,x=0;x<f;x++){var b=l.readUshort(s,r);r+=2;var w=l.readUshort(s,r);r+=2;var M=l.readUshort(s,r);r+=2;var S=l.readUshort(s,r);r+=2;var C=l.readUshort(s,r);r+=2;var R=l.readUshort(s,r);r+=2;var I,D=g[S],O=v+12*f+R;if(b==0)I=l.readUnicode(s,O,C/2);else if(b==3&&w==0)I=l.readUnicode(s,O,C/2);else if(w==0)I=l.readASCII(s,O,C);else if(w==1)I=l.readUnicode(s,O,C/2);else if(w==3)I=l.readUnicode(s,O,C/2);else{if(b!=1)throw"unknown encoding "+w+", platformID: "+b;I=l.readASCII(s,O,C),console.debug("reading unknown MAC encoding "+w+" as ASCII")}var U="p"+b+","+M.toString(16);u[U]==null&&(u[U]={}),u[U][D!==void 0?D:S]=I,u[U]._lang=M}for(var k in u)if(u[k].postScriptName!=null&&u[k]._lang==1033)return u[k];for(var k in u)if(u[k].postScriptName!=null&&u[k]._lang==0)return u[k];for(var k in u)if(u[k].postScriptName!=null&&u[k]._lang==3084)return u[k];for(var k in u)if(u[k].postScriptName!=null)return u[k];for(var k in u){p=k;break}return console.debug("returning name table with languageID "+u[p]._lang),u[p]},e["OS/2"]={},e["OS/2"].parse=function(s,r,o){var l=e._bin.readUshort(s,r);r+=2;var u={};if(l==0)e["OS/2"].version0(s,r,u);else if(l==1)e["OS/2"].version1(s,r,u);else if(l==2||l==3||l==4)e["OS/2"].version2(s,r,u);else{if(l!=5)throw"unknown OS/2 table version: "+l;e["OS/2"].version5(s,r,u)}return u},e["OS/2"].version0=function(s,r,o){var l=e._bin;return o.xAvgCharWidth=l.readShort(s,r),r+=2,o.usWeightClass=l.readUshort(s,r),r+=2,o.usWidthClass=l.readUshort(s,r),r+=2,o.fsType=l.readUshort(s,r),r+=2,o.ySubscriptXSize=l.readShort(s,r),r+=2,o.ySubscriptYSize=l.readShort(s,r),r+=2,o.ySubscriptXOffset=l.readShort(s,r),r+=2,o.ySubscriptYOffset=l.readShort(s,r),r+=2,o.ySuperscriptXSize=l.readShort(s,r),r+=2,o.ySuperscriptYSize=l.readShort(s,r),r+=2,o.ySuperscriptXOffset=l.readShort(s,r),r+=2,o.ySuperscriptYOffset=l.readShort(s,r),r+=2,o.yStrikeoutSize=l.readShort(s,r),r+=2,o.yStrikeoutPosition=l.readShort(s,r),r+=2,o.sFamilyClass=l.readShort(s,r),r+=2,o.panose=l.readBytes(s,r,10),r+=10,o.ulUnicodeRange1=l.readUint(s,r),r+=4,o.ulUnicodeRange2=l.readUint(s,r),r+=4,o.ulUnicodeRange3=l.readUint(s,r),r+=4,o.ulUnicodeRange4=l.readUint(s,r),r+=4,o.achVendID=[l.readInt8(s,r),l.readInt8(s,r+1),l.readInt8(s,r+2),l.readInt8(s,r+3)],r+=4,o.fsSelection=l.readUshort(s,r),r+=2,o.usFirstCharIndex=l.readUshort(s,r),r+=2,o.usLastCharIndex=l.readUshort(s,r),r+=2,o.sTypoAscender=l.readShort(s,r),r+=2,o.sTypoDescender=l.readShort(s,r),r+=2,o.sTypoLineGap=l.readShort(s,r),r+=2,o.usWinAscent=l.readUshort(s,r),r+=2,o.usWinDescent=l.readUshort(s,r),r+=2},e["OS/2"].version1=function(s,r,o){var l=e._bin;return r=e["OS/2"].version0(s,r,o),o.ulCodePageRange1=l.readUint(s,r),r+=4,o.ulCodePageRange2=l.readUint(s,r),r+=4},e["OS/2"].version2=function(s,r,o){var l=e._bin;return r=e["OS/2"].version1(s,r,o),o.sxHeight=l.readShort(s,r),r+=2,o.sCapHeight=l.readShort(s,r),r+=2,o.usDefault=l.readUshort(s,r),r+=2,o.usBreak=l.readUshort(s,r),r+=2,o.usMaxContext=l.readUshort(s,r),r+=2},e["OS/2"].version5=function(s,r,o){var l=e._bin;return r=e["OS/2"].version2(s,r,o),o.usLowerOpticalPointSize=l.readUshort(s,r),r+=2,o.usUpperOpticalPointSize=l.readUshort(s,r),r+=2},e.post={},e.post.parse=function(s,r,o){var l=e._bin,u={};return u.version=l.readFixed(s,r),r+=4,u.italicAngle=l.readFixed(s,r),r+=4,u.underlinePosition=l.readShort(s,r),r+=2,u.underlineThickness=l.readShort(s,r),r+=2,u},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(s,r){var o=s.cmap,l=-1;if(o.p0e4!=null?l=o.p0e4:o.p3e1!=null?l=o.p3e1:o.p1e0!=null?l=o.p1e0:o.p0e3!=null&&(l=o.p0e3),l==-1)throw"no familiar platform and encoding!";var u=o.tables[l];if(u.format==0)return r>=u.map.length?0:u.map[r];if(u.format==4){for(var f=-1,p=0;p<u.endCount.length;p++)if(r<=u.endCount[p]){f=p;break}return f==-1||u.startCount[f]>r?0:65535&(u.idRangeOffset[f]!=0?u.glyphIdArray[r-u.startCount[f]+(u.idRangeOffset[f]>>1)-(u.idRangeOffset.length-f)]:r+u.idDelta[f])}if(u.format==12){if(r>u.groups[u.groups.length-1][1])return 0;for(p=0;p<u.groups.length;p++){var g=u.groups[p];if(g[0]<=r&&r<=g[1])return g[2]+(r-g[0])}return 0}throw"unknown cmap table format "+u.format},e.U.glyphToPath=function(s,r){var o={cmds:[],crds:[]};if(s.SVG&&s.SVG.entries[r]){var l=s.SVG.entries[r];return l==null?o:(typeof l=="string"&&(l=e.SVG.toPath(l),s.SVG.entries[r]=l),l)}if(s.CFF){var u={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:s.CFF.Private?s.CFF.Private.defaultWidthX:0,open:!1},f=s.CFF,p=s.CFF.Private;if(f.ROS){for(var g=0;f.FDSelect[g+2]<=r;)g+=2;p=f.FDArray[f.FDSelect[g+1]].Private}e.U._drawCFF(s.CFF.CharStrings[r],u,f,p,o)}else s.glyf&&e.U._drawGlyf(r,s,o);return o},e.U._drawGlyf=function(s,r,o){var l=r.glyf[s];l==null&&(l=r.glyf[s]=e.glyf._parseGlyf(r,s)),l!=null&&(l.noc>-1?e.U._simpleGlyph(l,o):e.U._compoGlyph(l,r,o))},e.U._simpleGlyph=function(s,r){for(var o=0;o<s.noc;o++){for(var l=o==0?0:s.endPts[o-1]+1,u=s.endPts[o],f=l;f<=u;f++){var p=f==l?u:f-1,g=f==u?l:f+1,v=1&s.flags[f],x=1&s.flags[p],b=1&s.flags[g],w=s.xs[f],M=s.ys[f];if(f==l)if(v){if(!x){e.U.P.moveTo(r,w,M);continue}e.U.P.moveTo(r,s.xs[p],s.ys[p])}else x?e.U.P.moveTo(r,s.xs[p],s.ys[p]):e.U.P.moveTo(r,(s.xs[p]+w)/2,(s.ys[p]+M)/2);v?x&&e.U.P.lineTo(r,w,M):b?e.U.P.qcurveTo(r,w,M,s.xs[g],s.ys[g]):e.U.P.qcurveTo(r,w,M,(w+s.xs[g])/2,(M+s.ys[g])/2)}e.U.P.closePath(r)}},e.U._compoGlyph=function(s,r,o){for(var l=0;l<s.parts.length;l++){var u={cmds:[],crds:[]},f=s.parts[l];e.U._drawGlyf(f.glyphIndex,r,u);for(var p=f.m,g=0;g<u.crds.length;g+=2){var v=u.crds[g],x=u.crds[g+1];o.crds.push(v*p.a+x*p.b+p.tx),o.crds.push(v*p.c+x*p.d+p.ty)}for(g=0;g<u.cmds.length;g++)o.cmds.push(u.cmds[g])}},e.U._getGlyphClass=function(s,r){var o=e._lctf.getInterval(r,s);return o==-1?0:r[o+2]},e.U._applySubs=function(s,r,o,l){for(var u=s.length-r-1,f=0;f<o.tabs.length;f++)if(o.tabs[f]!=null){var p,g=o.tabs[f];if(!g.coverage||(p=e._lctf.coverageIndex(g.coverage,s[r]))!=-1){if(o.ltype==1)s[r],g.fmt==1?s[r]=s[r]+g.delta:s[r]=g.newg[p];else if(o.ltype==4)for(var v=g.vals[p],x=0;x<v.length;x++){var b=v[x],w=b.chain.length;if(!(w>u)){for(var M=!0,S=0,C=0;C<w;C++){for(;s[r+S+(1+C)]==-1;)S++;b.chain[C]!=s[r+S+(1+C)]&&(M=!1)}if(M){for(s[r]=b.nglyph,C=0;C<w+S;C++)s[r+C+1]=-1;break}}}else if(o.ltype==5&&g.fmt==2)for(var R=e._lctf.getInterval(g.cDef,s[r]),I=g.cDef[R+2],D=g.scset[I],O=0;O<D.length;O++){var U=D[O],k=U.input;if(!(k.length>u)){for(M=!0,C=0;C<k.length;C++){var P=e._lctf.getInterval(g.cDef,s[r+1+C]);if(R==-1&&g.cDef[P+2]!=k[C]){M=!1;break}}if(M){var F=U.substLookupRecords;for(x=0;x<F.length;x+=2)F[x],F[x+1]}}}else if(o.ltype==6&&g.fmt==3){if(!e.U._glsCovered(s,g.backCvg,r-g.backCvg.length)||!e.U._glsCovered(s,g.inptCvg,r)||!e.U._glsCovered(s,g.ahedCvg,r+g.inptCvg.length))continue;var H=g.lookupRec;for(O=0;O<H.length;O+=2){R=H[O];var G=l[H[O+1]];e.U._applySubs(s,r+R,G,l)}}}}},e.U._glsCovered=function(s,r,o){for(var l=0;l<r.length;l++)if(e._lctf.coverageIndex(r[l],s[o+l])==-1)return!1;return!0},e.U.glyphsToPath=function(s,r,o){for(var l={cmds:[],crds:[]},u=0,f=0;f<r.length;f++){var p=r[f];if(p!=-1){for(var g=f<r.length-1&&r[f+1]!=-1?r[f+1]:0,v=e.U.glyphToPath(s,p),x=0;x<v.crds.length;x+=2)l.crds.push(v.crds[x]+u),l.crds.push(v.crds[x+1]);for(o&&l.cmds.push(o),x=0;x<v.cmds.length;x++)l.cmds.push(v.cmds[x]);o&&l.cmds.push("X"),u+=s.hmtx.aWidth[p],f<r.length-1&&(u+=e.U.getPairAdjustment(s,p,g))}}return l},e.U.P={},e.U.P.moveTo=function(s,r,o){s.cmds.push("M"),s.crds.push(r,o)},e.U.P.lineTo=function(s,r,o){s.cmds.push("L"),s.crds.push(r,o)},e.U.P.curveTo=function(s,r,o,l,u,f,p){s.cmds.push("C"),s.crds.push(r,o,l,u,f,p)},e.U.P.qcurveTo=function(s,r,o,l,u){s.cmds.push("Q"),s.crds.push(r,o,l,u)},e.U.P.closePath=function(s){s.cmds.push("Z")},e.U._drawCFF=function(s,r,o,l,u){for(var f=r.stack,p=r.nStems,g=r.haveWidth,v=r.width,x=r.open,b=0,w=r.x,M=r.y,S=0,C=0,R=0,I=0,D=0,O=0,U=0,k=0,P=0,F=0,H={val:0,size:0};b<s.length;){e.CFF.getCharString(s,b,H);var G=H.val;if(b+=H.size,G=="o1"||G=="o18")f.length%2!=0&&!g&&(v=f.shift()+l.nominalWidthX),p+=f.length>>1,f.length=0,g=!0;else if(G=="o3"||G=="o23")f.length%2!=0&&!g&&(v=f.shift()+l.nominalWidthX),p+=f.length>>1,f.length=0,g=!0;else if(G=="o4")f.length>1&&!g&&(v=f.shift()+l.nominalWidthX,g=!0),x&&e.U.P.closePath(u),M+=f.pop(),e.U.P.moveTo(u,w,M),x=!0;else if(G=="o5")for(;f.length>0;)w+=f.shift(),M+=f.shift(),e.U.P.lineTo(u,w,M);else if(G=="o6"||G=="o7")for(var j=f.length,K=G=="o6",te=0;te<j;te++){var W=f.shift();K?w+=W:M+=W,K=!K,e.U.P.lineTo(u,w,M)}else if(G=="o8"||G=="o24"){j=f.length;for(var X=0;X+6<=j;)S=w+f.shift(),C=M+f.shift(),R=S+f.shift(),I=C+f.shift(),w=R+f.shift(),M=I+f.shift(),e.U.P.curveTo(u,S,C,R,I,w,M),X+=6;G=="o24"&&(w+=f.shift(),M+=f.shift(),e.U.P.lineTo(u,w,M))}else{if(G=="o11")break;if(G=="o1234"||G=="o1235"||G=="o1236"||G=="o1237")G=="o1234"&&(C=M,R=(S=w+f.shift())+f.shift(),F=I=C+f.shift(),O=I,k=M,w=(U=(D=(P=R+f.shift())+f.shift())+f.shift())+f.shift(),e.U.P.curveTo(u,S,C,R,I,P,F),e.U.P.curveTo(u,D,O,U,k,w,M)),G=="o1235"&&(S=w+f.shift(),C=M+f.shift(),R=S+f.shift(),I=C+f.shift(),P=R+f.shift(),F=I+f.shift(),D=P+f.shift(),O=F+f.shift(),U=D+f.shift(),k=O+f.shift(),w=U+f.shift(),M=k+f.shift(),f.shift(),e.U.P.curveTo(u,S,C,R,I,P,F),e.U.P.curveTo(u,D,O,U,k,w,M)),G=="o1236"&&(S=w+f.shift(),C=M+f.shift(),R=S+f.shift(),F=I=C+f.shift(),O=I,U=(D=(P=R+f.shift())+f.shift())+f.shift(),k=O+f.shift(),w=U+f.shift(),e.U.P.curveTo(u,S,C,R,I,P,F),e.U.P.curveTo(u,D,O,U,k,w,M)),G=="o1237"&&(S=w+f.shift(),C=M+f.shift(),R=S+f.shift(),I=C+f.shift(),P=R+f.shift(),F=I+f.shift(),D=P+f.shift(),O=F+f.shift(),U=D+f.shift(),k=O+f.shift(),Math.abs(U-w)>Math.abs(k-M)?w=U+f.shift():M=k+f.shift(),e.U.P.curveTo(u,S,C,R,I,P,F),e.U.P.curveTo(u,D,O,U,k,w,M));else if(G=="o14"){if(f.length>0&&!g&&(v=f.shift()+o.nominalWidthX,g=!0),f.length==4){var oe=f.shift(),ne=f.shift(),ie=f.shift(),B=f.shift(),Q=e.CFF.glyphBySE(o,ie),ae=e.CFF.glyphBySE(o,B);e.U._drawCFF(o.CharStrings[Q],r,o,l,u),r.x=oe,r.y=ne,e.U._drawCFF(o.CharStrings[ae],r,o,l,u)}x&&(e.U.P.closePath(u),x=!1)}else if(G=="o19"||G=="o20")f.length%2!=0&&!g&&(v=f.shift()+l.nominalWidthX),p+=f.length>>1,f.length=0,g=!0,b+=p+7>>3;else if(G=="o21")f.length>2&&!g&&(v=f.shift()+l.nominalWidthX,g=!0),M+=f.pop(),w+=f.pop(),x&&e.U.P.closePath(u),e.U.P.moveTo(u,w,M),x=!0;else if(G=="o22")f.length>1&&!g&&(v=f.shift()+l.nominalWidthX,g=!0),w+=f.pop(),x&&e.U.P.closePath(u),e.U.P.moveTo(u,w,M),x=!0;else if(G=="o25"){for(;f.length>6;)w+=f.shift(),M+=f.shift(),e.U.P.lineTo(u,w,M);S=w+f.shift(),C=M+f.shift(),R=S+f.shift(),I=C+f.shift(),w=R+f.shift(),M=I+f.shift(),e.U.P.curveTo(u,S,C,R,I,w,M)}else if(G=="o26")for(f.length%2&&(w+=f.shift());f.length>0;)S=w,C=M+f.shift(),w=R=S+f.shift(),M=(I=C+f.shift())+f.shift(),e.U.P.curveTo(u,S,C,R,I,w,M);else if(G=="o27")for(f.length%2&&(M+=f.shift());f.length>0;)C=M,R=(S=w+f.shift())+f.shift(),I=C+f.shift(),w=R+f.shift(),M=I,e.U.P.curveTo(u,S,C,R,I,w,M);else if(G=="o10"||G=="o29"){var fe=G=="o10"?l:o;if(f.length==0)console.debug("error: empty stack");else{var de=f.pop(),se=fe.Subrs[de+fe.Bias];r.x=w,r.y=M,r.nStems=p,r.haveWidth=g,r.width=v,r.open=x,e.U._drawCFF(se,r,o,l,u),w=r.x,M=r.y,p=r.nStems,g=r.haveWidth,v=r.width,x=r.open}}else if(G=="o30"||G=="o31"){var ce=f.length,pe=(X=0,G=="o31");for(X+=ce-(j=-3&ce);X<j;)pe?(C=M,R=(S=w+f.shift())+f.shift(),M=(I=C+f.shift())+f.shift(),j-X==5?(w=R+f.shift(),X++):w=R,pe=!1):(S=w,C=M+f.shift(),R=S+f.shift(),I=C+f.shift(),w=R+f.shift(),j-X==5?(M=I+f.shift(),X++):M=I,pe=!0),e.U.P.curveTo(u,S,C,R,I,w,M),X+=4}else{if((G+"").charAt(0)=="o")throw console.debug("Unknown operation: "+G,s),G;f.push(G)}}}r.x=w,r.y=M,r.nStems=p,r.haveWidth=g,r.width=v,r.open=x};var t=e,n={Typr:t};return i.Typr=t,i.default=n,Object.defineProperty(i,"__esModule",{value:!0}),i})({}).Typr}function Kj(){return(function(i){var e=Uint8Array,t=Uint16Array,n=Uint32Array,s=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),r=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=function(G,j){for(var K=new t(31),te=0;te<31;++te)K[te]=j+=1<<G[te-1];var W=new n(K[30]);for(te=1;te<30;++te)for(var X=K[te];X<K[te+1];++X)W[X]=X-K[te]<<5|te;return[K,W]},u=l(s,2),f=u[0],p=u[1];f[28]=258,p[258]=28;for(var g=l(r,0)[0],v=new t(32768),x=0;x<32768;++x){var b=(43690&x)>>>1|(21845&x)<<1;b=(61680&(b=(52428&b)>>>2|(13107&b)<<2))>>>4|(3855&b)<<4,v[x]=((65280&b)>>>8|(255&b)<<8)>>>1}var w=function(G,j,K){for(var te=G.length,W=0,X=new t(j);W<te;++W)++X[G[W]-1];var oe,ne=new t(j);for(W=0;W<j;++W)ne[W]=ne[W-1]+X[W-1]<<1;{oe=new t(1<<j);var ie=15-j;for(W=0;W<te;++W)if(G[W])for(var B=W<<4|G[W],Q=j-G[W],ae=ne[G[W]-1]++<<Q,fe=ae|(1<<Q)-1;ae<=fe;++ae)oe[v[ae]>>>ie]=B}return oe},M=new e(288);for(x=0;x<144;++x)M[x]=8;for(x=144;x<256;++x)M[x]=9;for(x=256;x<280;++x)M[x]=7;for(x=280;x<288;++x)M[x]=8;var S=new e(32);for(x=0;x<32;++x)S[x]=5;var C=w(M,9),R=w(S,5),I=function(G){for(var j=G[0],K=1;K<G.length;++K)G[K]>j&&(j=G[K]);return j},D=function(G,j,K){var te=j/8|0;return(G[te]|G[te+1]<<8)>>(7&j)&K},O=function(G,j){var K=j/8|0;return(G[K]|G[K+1]<<8|G[K+2]<<16)>>(7&j)},U=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],k=function(G,j,K){var te=new Error(j||U[G]);if(te.code=G,Error.captureStackTrace&&Error.captureStackTrace(te,k),!K)throw te;return te},P=function(G,j,K){var te=G.length;if(!te||K&&!K.l&&te<5)return j||new e(0);var W=!j||K,X=!K||K.i;K||(K={}),j||(j=new e(3*te));var oe,ne=function(Qe){var le=j.length;if(Qe>le){var Te=new e(Math.max(2*le,Qe));Te.set(j),j=Te}},ie=K.f||0,B=K.p||0,Q=K.b||0,ae=K.l,fe=K.d,de=K.m,se=K.n,ce=8*te;do{if(!ae){K.f=ie=D(G,B,1);var pe=D(G,B+1,3);if(B+=3,!pe){var Ie=G[(Ne=((oe=B)/8|0)+(7&oe&&1)+4)-4]|G[Ne-3]<<8,Ye=Ne+Ie;if(Ye>te){X&&k(0);break}W&&ne(Q+Ie),j.set(G.subarray(Ne,Ye),Q),K.b=Q+=Ie,K.p=B=8*Ye;continue}if(pe==1)ae=C,fe=R,de=9,se=5;else if(pe==2){var et=D(G,B,31)+257,qe=D(G,B+10,15)+4,dt=et+D(G,B+5,31)+1;B+=14;for(var De=new e(dt),ge=new e(19),ye=0;ye<qe;++ye)ge[o[ye]]=D(G,B+3*ye,7);B+=3*qe;var Ge=I(ge),Y=(1<<Ge)-1,Be=w(ge,Ge);for(ye=0;ye<dt;){var Ne,Me=Be[D(G,B,Y)];if(B+=15&Me,(Ne=Me>>>4)<16)De[ye++]=Ne;else{var Oe=0,q=0;for(Ne==16?(q=3+D(G,B,3),B+=2,Oe=De[ye-1]):Ne==17?(q=3+D(G,B,7),B+=3):Ne==18&&(q=11+D(G,B,127),B+=7);q--;)De[ye++]=Oe}}var V=De.subarray(0,et),ue=De.subarray(et);de=I(V),se=I(ue),ae=w(V,de),fe=w(ue,se)}else k(1);if(B>ce){X&&k(0);break}}W&&ne(Q+131072);for(var Re=(1<<de)-1,we=(1<<se)-1,be=B;;be=B){var it=(Oe=ae[O(G,B)&Re])>>>4;if((B+=15&Oe)>ce){X&&k(0);break}if(Oe||k(2),it<256)j[Q++]=it;else{if(it==256){be=B,ae=null;break}var tt=it-254;if(it>264){var ht=s[ye=it-257];tt=D(G,B,(1<<ht)-1)+f[ye],B+=ht}var yt=fe[O(G,B)&we],He=yt>>>4;if(yt||k(3),B+=15&yt,ue=g[He],He>3&&(ht=r[He],ue+=O(G,B)&(1<<ht)-1,B+=ht),B>ce){X&&k(0);break}W&&ne(Q+131072);for(var Xe=Q+tt;Q<Xe;Q+=4)j[Q]=j[Q-ue],j[Q+1]=j[Q+1-ue],j[Q+2]=j[Q+2-ue],j[Q+3]=j[Q+3-ue];Q=Xe}}K.l=ae,K.p=be,K.b=Q,ae&&(ie=1,K.m=de,K.d=fe,K.n=se)}while(!ie);return Q==j.length?j:(function(Qe,le,Te){(Te==null||Te>Qe.length)&&(Te=Qe.length);var ct=new(Qe instanceof t?t:Qe instanceof n?n:e)(Te-le);return ct.set(Qe.subarray(le,Te)),ct})(j,0,Q)},F=new e(0),H=typeof TextDecoder<"u"&&new TextDecoder;try{H.decode(F,{stream:!0})}catch{}return i.convert_streams=function(G){var j=new DataView(G),K=0;function te(){var et=j.getUint16(K);return K+=2,et}function W(){var et=j.getUint32(K);return K+=4,et}function X(et){Ie.setUint16(Ye,et),Ye+=2}function oe(et){Ie.setUint32(Ye,et),Ye+=4}for(var ne={signature:W(),flavor:W(),length:W(),numTables:te(),reserved:te(),totalSfntSize:W(),majorVersion:te(),minorVersion:te(),metaOffset:W(),metaLength:W(),metaOrigLength:W(),privOffset:W(),privLength:W()},ie=0;Math.pow(2,ie)<=ne.numTables;)ie++;ie--;for(var B=16*Math.pow(2,ie),Q=16*ne.numTables-B,ae=12,fe=[],de=0;de<ne.numTables;de++)fe.push({tag:W(),offset:W(),compLength:W(),origLength:W(),origChecksum:W()}),ae+=16;var se,ce=new Uint8Array(12+16*fe.length+fe.reduce((function(et,qe){return et+qe.origLength+4}),0)),pe=ce.buffer,Ie=new DataView(pe),Ye=0;return oe(ne.flavor),X(ne.numTables),X(B),X(ie),X(Q),fe.forEach((function(et){oe(et.tag),oe(et.origChecksum),oe(ae),oe(et.origLength),et.outOffset=ae,(ae+=et.origLength)%4!=0&&(ae+=4-ae%4)})),fe.forEach((function(et){var qe,dt=G.slice(et.offset,et.offset+et.compLength);if(et.compLength!=et.origLength){var De=new Uint8Array(et.origLength);qe=new Uint8Array(dt,2),P(qe,De)}else De=new Uint8Array(dt);ce.set(De,et.outOffset);var ge=0;(ae=et.outOffset+et.origLength)%4!=0&&(ge=4-ae%4),ce.set(new Uint8Array(ge).buffer,et.outOffset+et.origLength),se=ae+ge})),pe.slice(0,se)},Object.defineProperty(i,"__esModule",{value:!0}),i})({}).convert_streams}function Qj(i,e){const t={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},s=1,r=2,o=4,l=8,u=16,f=32;let p;function g(U){if(!p){const k={R:r,L:s,D:o,C:u,U:f,T:l};p=new Map;for(let P in n){let F=0;n[P].split(",").forEach(H=>{let[G,j]=H.split("+");G=parseInt(G,36),j=j?parseInt(j,36):0,p.set(F+=G,k[P]);for(let K=j;K--;)p.set(++F,k[P])})}}return p.get(U)||f}const v=1,x=2,b=3,w=4,M=[null,"isol","init","fina","medi"];function S(U){const k=new Uint8Array(U.length);let P=f,F=v,H=-1;for(let G=0;G<U.length;G++){const j=U.codePointAt(G);let K=g(j)|0,te=v;K&l||(P&(s|o|u)?K&(r|o|u)?(te=b,(F===v||F===b)&&k[H]++):K&(s|f)&&(F===x||F===w)&&k[H]--:P&(r|f)&&(F===x||F===w)&&k[H]--,F=k[G]=te,P=K,H=G,j>65535&&G++)}return k}function C(U,k){const P=[];for(let H=0;H<k.length;H++){const G=k.codePointAt(H);G>65535&&H++,P.push(i.U.codeToGlyph(U,G))}const F=U.GSUB;if(F){const{lookupList:H,featureList:G}=F;let j;const K=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,te=[];G.forEach(W=>{if(K.test(W.tag))for(let X=0;X<W.tab.length;X++){if(te[W.tab[X]])continue;te[W.tab[X]]=!0;const oe=H[W.tab[X]],ne=/^(isol|init|fina|medi)$/.test(W.tag);ne&&!j&&(j=S(k));for(let ie=0;ie<P.length;ie++)(!j||!ne||M[j[ie]]===W.tag)&&i.U._applySubs(P,ie,oe,H)}})}return P}function R(U,k){const P=new Int16Array(k.length*3);let F=0;for(;F<k.length;F++){const K=k[F];if(K===-1)continue;P[F*3+2]=U.hmtx.aWidth[K];const te=U.GPOS;if(te){const W=te.lookupList;for(let X=0;X<W.length;X++){const oe=W[X];for(let ne=0;ne<oe.tabs.length;ne++){const ie=oe.tabs[ne];if(oe.ltype===1){if(i._lctf.coverageIndex(ie.coverage,K)!==-1&&ie.pos){j(ie.pos,F);break}}else if(oe.ltype===2){let B=null,Q=H();if(Q!==-1){const ae=i._lctf.coverageIndex(ie.coverage,k[Q]);if(ae!==-1){if(ie.fmt===1){const fe=ie.pairsets[ae];for(let de=0;de<fe.length;de++)fe[de].gid2===K&&(B=fe[de])}else if(ie.fmt===2){const fe=i.U._getGlyphClass(k[Q],ie.classDef1),de=i.U._getGlyphClass(K,ie.classDef2);B=ie.matrix[fe][de]}if(B){B.val1&&j(B.val1,Q),B.val2&&j(B.val2,F);break}}}}else if(oe.ltype===4){const B=i._lctf.coverageIndex(ie.markCoverage,K);if(B!==-1){const Q=H(G),ae=Q===-1?-1:i._lctf.coverageIndex(ie.baseCoverage,k[Q]);if(ae!==-1){const fe=ie.markArray[B],de=ie.baseArray[ae][fe.markClass];P[F*3]=de.x-fe.x+P[Q*3]-P[Q*3+2],P[F*3+1]=de.y-fe.y+P[Q*3+1];break}}}else if(oe.ltype===6){const B=i._lctf.coverageIndex(ie.mark1Coverage,K);if(B!==-1){const Q=H();if(Q!==-1){const ae=k[Q];if(I(U,ae)===3){const fe=i._lctf.coverageIndex(ie.mark2Coverage,ae);if(fe!==-1){const de=ie.mark1Array[B],se=ie.mark2Array[fe][de.markClass];P[F*3]=se.x-de.x+P[Q*3]-P[Q*3+2],P[F*3+1]=se.y-de.y+P[Q*3+1];break}}}}}}}}else if(U.kern&&!U.cff){const W=H();if(W!==-1){const X=U.kern.glyph1.indexOf(k[W]);if(X!==-1){const oe=U.kern.rval[X].glyph2.indexOf(K);oe!==-1&&(P[W*3+2]+=U.kern.rval[X].vals[oe])}}}}return P;function H(K){for(let te=F-1;te>=0;te--)if(k[te]!==-1&&(!K||K(k[te])))return te;return-1}function G(K){return I(U,K)===1}function j(K,te){for(let W=0;W<3;W++)P[te*3+W]+=K[W]||0}}function I(U,k){const P=U.GDEF&&U.GDEF.glyphClassDef;return P?i.U._getGlyphClass(k,P):0}function D(...U){for(let k=0;k<U.length;k++)if(typeof U[k]=="number")return U[k]}function O(U){const k=Object.create(null),P=U["OS/2"],F=U.hhea,H=U.head.unitsPerEm,G=D(P&&P.sTypoAscender,F&&F.ascender,H),j={unitsPerEm:H,ascender:G,descender:D(P&&P.sTypoDescender,F&&F.descender,0),capHeight:D(P&&P.sCapHeight,G),xHeight:D(P&&P.sxHeight,G),lineGap:D(P&&P.sTypoLineGap,F&&F.lineGap),supportsCodePoint(K){return i.U.codeToGlyph(U,K)>0},forEachGlyph(K,te,W,X){let oe=0;const ne=1/j.unitsPerEm*te,ie=C(U,K);let B=0;const Q=R(U,ie);return ie.forEach((ae,fe)=>{if(ae!==-1){let de=k[ae];if(!de){const{cmds:se,crds:ce}=i.U.glyphToPath(U,ae);let pe="",Ie=0;for(let De=0,ge=se.length;De<ge;De++){const ye=t[se[De]];pe+=se[De];for(let Ge=1;Ge<=ye;Ge++)pe+=(Ge>1?",":"")+ce[Ie++]}let Ye,et,qe,dt;if(ce.length){Ye=et=1/0,qe=dt=-1/0;for(let De=0,ge=ce.length;De<ge;De+=2){let ye=ce[De],Ge=ce[De+1];ye<Ye&&(Ye=ye),Ge<et&&(et=Ge),ye>qe&&(qe=ye),Ge>dt&&(dt=Ge)}}else Ye=qe=et=dt=0;de=k[ae]={index:ae,advanceWidth:U.hmtx.aWidth[ae],xMin:Ye,yMin:et,xMax:qe,yMax:dt,path:pe}}X.call(null,de,oe+Q[fe*3]*ne,Q[fe*3+1]*ne,B),oe+=Q[fe*3+2]*ne,W&&(oe+=W*te)}B+=K.codePointAt(B)>65535?2:1}),oe}};return j}return function(k){const P=new Uint8Array(k,0,4),F=i._bin.readASCII(P,0,4);if(F==="wOFF")k=e(k);else if(F==="wOF2")throw new Error("woff2 fonts not supported");return O(i.parse(k)[0])}}const Jj=Qm({name:"Typr Font Parser",dependencies:[Zj,Kj,Qj],init(i,e,t){const n=i(),s=e();return t(n,s)}});function $j(){return(function(i){var e=function(){this.buckets=new Map};e.prototype.add=function(R){var I=R>>5;this.buckets.set(I,(this.buckets.get(I)||0)|1<<(31&R))},e.prototype.has=function(R){var I=this.buckets.get(R>>5);return I!==void 0&&(I&1<<(31&R))!=0},e.prototype.serialize=function(){var R=[];return this.buckets.forEach((function(I,D){R.push((+D).toString(36)+":"+I.toString(36))})),R.join(",")},e.prototype.deserialize=function(R){var I=this;this.buckets.clear(),R.split(",").forEach((function(D){var O=D.split(":");I.buckets.set(parseInt(O[0],36),parseInt(O[1],36))}))};var t=Math.pow(2,8),n=t-1,s=~n;function r(R){var I=(function(O){return O&s})(R).toString(16),D=(function(O){return(O&s)+t-1})(R).toString(16);return"codepoint-index/plane"+(R>>16)+"/"+I+"-"+D+".json"}function o(R,I){var D=R&n,O=I.codePointAt(D/6|0);return((O=(O||48)-48)&1<<D%6)!=0}function l(R,I){var D;(D=R,D.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(O){return O.split("-").map((function(U){return parseInt(U.trim(),16)}))}))).forEach((function(O){var U=O[0],k=O[1];k===void 0&&(k=U),I(U,k)}))}function u(R,I){l(R,(function(D,O){for(var U=D;U<=O;U++)I(U)}))}var f={},p={},g=new WeakMap,v="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function x(R){var I=g.get(R);return I||(I=new e,u(R.ranges,(function(D){return I.add(D)})),g.set(R,I)),I}var b,w=new Map;function M(R,I,D){return R[I]?I:R[D]?D:(function(O){for(var U in O)return U})(R)}function S(R,I){var D=I;if(!R.includes(D)){D=1/0;for(var O=0;O<R.length;O++)Math.abs(R[O]-I)<Math.abs(D-I)&&(D=R[O])}return D}function C(R){return b||(b=new Set,u("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(I){b.add(I)}))),b.has(R)}return i.CodePointSet=e,i.clearCache=function(){f={},p={}},i.getFontsForString=function(R,I){I===void 0&&(I={});var D,O=I.lang;O===void 0&&(O=new RegExp("\\p{Script=Hangul}","u").test(D=R)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(D)?"ja":"en");var U=I.category;U===void 0&&(U="sans-serif");var k=I.style;k===void 0&&(k="normal");var P=I.weight;P===void 0&&(P=400);var F=(I.dataUrl||v).replace(/\/$/g,""),H=new Map,G=new Uint8Array(R.length),j={},K={},te=new Array(R.length),W=new Map,X=!1;function oe(B){var Q=w.get(B);return Q||(Q=fetch(F+"/"+B).then((function(ae){if(!ae.ok)throw new Error(ae.statusText);return ae.json().then((function(fe){if(!Array.isArray(fe)||fe[0]!==1)throw new Error("Incorrect schema version; need 1, got "+fe[0]);return fe[1]}))})).catch((function(ae){if(F!==v)return X||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+F+'", trying default CDN. '+ae.message),X=!0),F=v,w.delete(B),oe(B);throw ae})),w.set(B,Q)),Q}for(var ne=function(B){var Q=R.codePointAt(B),ae=r(Q);te[B]=ae,f[ae]||W.has(ae)||W.set(ae,oe(ae).then((function(fe){f[ae]=fe}))),Q>65535&&(B++,ie=B)},ie=0;ie<R.length;ie++)ne(ie);return Promise.all(W.values()).then((function(){W.clear();for(var B=function(ae){var fe=R.codePointAt(ae),de=null,se=f[te[ae]],ce=void 0;for(var pe in se){var Ie=K[pe];if(Ie===void 0&&(Ie=K[pe]=new RegExp(pe).test(O||"en")),Ie){for(var Ye in ce=pe,se[pe])if(o(fe,se[pe][Ye])){de=Ye;break}break}}if(!de){e:for(var et in se)if(et!==ce){for(var qe in se[et])if(o(fe,se[et][qe])){de=qe;break e}}}de||(console.debug("No font coverage for U+"+fe.toString(16)),de="latin"),te[ae]=de,p[de]||W.has(de)||W.set(de,oe("font-meta/"+de+".json").then((function(dt){p[de]=dt}))),fe>65535&&(ae++,Q=ae)},Q=0;Q<R.length;Q++)B(Q);return Promise.all(W.values())})).then((function(){for(var B,Q=null,ae=0;ae<R.length;ae++){var fe=R.codePointAt(ae);if(Q&&(C(fe)||x(Q).has(fe)))G[ae]=G[ae-1];else{Q=p[te[ae]];var de=j[Q.id];if(!de){var se=Q.typeforms,ce=M(se,U,"sans-serif"),pe=M(se[ce],k,"normal"),Ie=S((B=se[ce])===null||B===void 0?void 0:B[pe],P);de=j[Q.id]=F+"/font-files/"+Q.id+"/"+ce+"."+pe+"."+Ie+".woff"}var Ye=H.get(de);Ye==null&&(Ye=H.size,H.set(de,Ye)),G[ae]=Ye}fe>65535&&(ae++,G[ae]=G[ae-1])}return{fontUrls:Array.from(H.keys()),chars:G}}))},Object.defineProperty(i,"__esModule",{value:!0}),i})({})}function eq(i,e){const t=Object.create(null),n=Object.create(null);function s(o,l){const u=f=>{console.error(`Failure loading font ${o}`,f)};try{const f=new XMLHttpRequest;f.open("get",o,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status>=400)u(new Error(f.statusText));else if(f.status>0)try{const p=i(f.response);p.src=o,l(p)}catch(p){u(p)}},f.onerror=u,f.send()}catch(f){u(f)}}function r(o,l){let u=t[o];u?l(u):n[o]?n[o].push(l):(n[o]=[l],s(o,f=>{f.src=o,t[o]=f,n[o].forEach(p=>p(f)),delete n[o]}))}return function(o,l,{lang:u,fonts:f=[],style:p="normal",weight:g="normal",unicodeFontsURL:v}={}){const x=new Uint8Array(o.length),b=[];o.length||C();const w=new Map,M=[];if(p!=="italic"&&(p="normal"),typeof g!="number"&&(g=g==="bold"?700:400),f&&!Array.isArray(f)&&(f=[f]),f=f.slice().filter(I=>!I.lang||I.lang.test(u)).reverse(),f.length){let U=0;(function k(P=0){for(let F=P,H=o.length;F<H;F++){const G=o.codePointAt(F);if(U===1&&b[x[F-1]].supportsCodePoint(G)||F>0&&/\s/.test(o[F]))x[F]=x[F-1],U===2&&(M[M.length-1][1]=F);else for(let j=x[F],K=f.length;j<=K;j++)if(j===K){const te=U===2?M[M.length-1]:M[M.length]=[F,F];te[1]=F,U=2}else{x[F]=j;const{src:te,unicodeRange:W}=f[j];if(!W||R(G,W)){const X=t[te];if(!X){r(te,()=>{k(F)});return}if(X.supportsCodePoint(G)){let oe=w.get(X);typeof oe!="number"&&(oe=b.length,b.push(X),w.set(X,oe)),x[F]=oe,U=1;break}}}G>65535&&F+1<H&&(x[F+1]=x[F],F++,U===2&&(M[M.length-1][1]=F))}S()})()}else M.push([0,o.length-1]),S();function S(){if(M.length){const I=M.map(D=>o.substring(D[0],D[1]+1)).join(`
`);e.getFontsForString(I,{lang:u||void 0,style:p,weight:g,dataUrl:v}).then(({fontUrls:D,chars:O})=>{const U=b.length;let k=0;M.forEach(F=>{for(let H=0,G=F[1]-F[0];H<=G;H++)x[F[0]+H]=O[k++]+U;k++});let P=0;D.forEach((F,H)=>{r(F,G=>{b[H+U]=G,++P===D.length&&C()})})})}else C()}function C(){l({chars:x,fonts:b})}function R(I,D){for(let O=0;O<D.length;O++){const[U,k=U]=D[O];if(U<=I&&I<=k)return!0}return!1}}}const tq=Qm({name:"FontResolver",dependencies:[eq,Jj,$j],init(i,e,t){return i(e,t())}});function nq(i,e){const n=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,s="[^\\S\\u00A0]",r=new RegExp(`${s}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:b,lang:w,fonts:M,style:S,weight:C,preResolvedFonts:R,unicodeFontsURL:I},D){const O=({chars:U,fonts:k})=>{let P,F;const H=[];for(let G=0;G<U.length;G++)U[G]!==F?(F=U[G],H.push(P={start:G,end:G,fontObj:k[U[G]]})):P.end=G;D(H)};R?O(R):i(b,O,{lang:w,fonts:M,style:S,weight:C,unicodeFontsURL:I})}function l({text:b="",font:w,lang:M,sdfGlyphSize:S=64,fontSize:C=400,fontWeight:R=1,fontStyle:I="normal",letterSpacing:D=0,lineHeight:O="normal",maxWidth:U=1/0,direction:k,textAlign:P="left",textIndent:F=0,whiteSpace:H="normal",overflowWrap:G="normal",anchorX:j=0,anchorY:K=0,metricsOnly:te=!1,unicodeFontsURL:W,preResolvedFonts:X=null,includeCaretPositions:oe=!1,chunkedBoundsSize:ne=8192,colorRanges:ie=null},B){const Q=g(),ae={fontLoad:0,typesetting:0};b.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),b=b.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),C=+C,D=+D,U=+U,O=O||"normal",F=+F,o({text:b,lang:M,style:I,weight:R,fonts:typeof w=="string"?[{src:w}]:w,unicodeFontsURL:W,preResolvedFonts:X},fe=>{ae.fontLoad=g()-Q;const de=isFinite(U);let se=null,ce=null,pe=null,Ie=null,Ye=null,et=null,qe=null,dt=null,De=0,ge=0,ye=H!=="nowrap";const Ge=new Map,Y=g();let Be=F,Ne=0,Me=new v;const Oe=[Me];fe.forEach(we=>{const{fontObj:be}=we,{ascender:it,descender:tt,unitsPerEm:ht,lineGap:yt,capHeight:He,xHeight:Xe}=be;let Qe=Ge.get(be);if(!Qe){const We=C/ht,Je=O==="normal"?(it-tt+yt)*We:O*C,pt=(Je-(it-tt)*We)/2,$e=Math.min(Je,(it-tt)*We),Le=(it+tt)/2*We+$e/2;Qe={index:Ge.size,src:be.src,fontObj:be,fontSizeMult:We,unitsPerEm:ht,ascender:it*We,descender:tt*We,capHeight:He*We,xHeight:Xe*We,lineHeight:Je,baseline:-pt-it*We,caretTop:Le,caretBottom:Le-$e},Ge.set(be,Qe)}const{fontSizeMult:le}=Qe,Te=b.slice(we.start,we.end+1);let ct,he;be.forEachGlyph(Te,C,D,(We,Je,pt,$e)=>{Je+=Ne,$e+=we.start,ct=Je,he=We;const Le=b.charAt($e),rt=We.advanceWidth*le,xt=Me.count;let _t;if("isEmpty"in We||(We.isWhitespace=!!Le&&new RegExp(s).test(Le),We.canBreakAfter=!!Le&&r.test(Le),We.isEmpty=We.xMin===We.xMax||We.yMin===We.yMax||n.test(Le)),!We.isWhitespace&&!We.isEmpty&&ge++,ye&&de&&!We.isWhitespace&&Je+rt+Be>U&&xt){if(Me.glyphAt(xt-1).glyphObj.canBreakAfter)_t=new v,Be=-Je;else for(let pn=xt;pn--;)if(pn===0&&G==="break-word"){_t=new v,Be=-Je;break}else if(Me.glyphAt(pn).glyphObj.canBreakAfter){_t=Me.splitAt(pn+1);const Mn=_t.glyphAt(0).x;Be-=Mn;for(let Zn=_t.count;Zn--;)_t.glyphAt(Zn).x-=Mn;break}_t&&(Me.isSoftWrapped=!0,Me=_t,Oe.push(Me),De=U)}let Nt=Me.glyphAt(Me.count);Nt.glyphObj=We,Nt.x=Je+Be,Nt.y=pt,Nt.width=rt,Nt.charIndex=$e,Nt.fontData=Qe,Le===`
`&&(Me=new v,Oe.push(Me),Be=-(Je+rt+D*C)+F)}),Ne=ct+he.advanceWidth*le+D*C});let q=0;Oe.forEach(we=>{let be=!0;for(let it=we.count;it--;){const tt=we.glyphAt(it);be&&!tt.glyphObj.isWhitespace&&(we.width=tt.x+tt.width,we.width>De&&(De=we.width),be=!1);let{lineHeight:ht,capHeight:yt,xHeight:He,baseline:Xe}=tt.fontData;ht>we.lineHeight&&(we.lineHeight=ht);const Qe=Xe-we.baseline;Qe<0&&(we.baseline+=Qe,we.cap+=Qe,we.ex+=Qe),we.cap=Math.max(we.cap,we.baseline+yt),we.ex=Math.max(we.ex,we.baseline+He)}we.baseline-=q,we.cap-=q,we.ex-=q,q+=we.lineHeight});let V=0,ue=0;if(j&&(typeof j=="number"?V=-j:typeof j=="string"&&(V=-De*(j==="left"?0:j==="center"?.5:j==="right"?1:f(j)))),K&&(typeof K=="number"?ue=-K:typeof K=="string"&&(ue=K==="top"?0:K==="top-baseline"?-Oe[0].baseline:K==="top-cap"?-Oe[0].cap:K==="top-ex"?-Oe[0].ex:K==="middle"?q/2:K==="bottom"?q:K==="bottom-baseline"?-Oe[Oe.length-1].baseline:f(K)*q)),!te){const we=e.getEmbeddingLevels(b,k);se=new Uint16Array(ge),ce=new Uint8Array(ge),pe=new Float32Array(ge*2),Ie={},qe=[1/0,1/0,-1/0,-1/0],dt=[],oe&&(et=new Float32Array(b.length*4)),ie&&(Ye=new Uint8Array(ge*3));let be=0,it=-1,tt=-1,ht,yt;if(Oe.forEach((He,Xe)=>{let{count:Qe,width:le}=He;if(Qe>0){let Te=0;for(let $e=Qe;$e--&&He.glyphAt($e).glyphObj.isWhitespace;)Te++;let ct=0,he=0;if(P==="center")ct=(De-le)/2;else if(P==="right")ct=De-le;else if(P==="justify"&&He.isSoftWrapped){let $e=0;for(let Le=Qe-Te;Le--;)He.glyphAt(Le).glyphObj.isWhitespace&&$e++;he=(De-le)/$e}if(he||ct){let $e=0;for(let Le=0;Le<Qe;Le++){let rt=He.glyphAt(Le);const xt=rt.glyphObj;rt.x+=ct+$e,he!==0&&xt.isWhitespace&&Le<Qe-Te&&($e+=he,rt.width+=he)}}const We=e.getReorderSegments(b,we,He.glyphAt(0).charIndex,He.glyphAt(He.count-1).charIndex);for(let $e=0;$e<We.length;$e++){const[Le,rt]=We[$e];let xt=1/0,_t=-1/0;for(let Nt=0;Nt<Qe;Nt++)if(He.glyphAt(Nt).charIndex>=Le){let pn=Nt,Mn=Nt;for(;Mn<Qe;Mn++){let Zn=He.glyphAt(Mn);if(Zn.charIndex>rt)break;Mn<Qe-Te&&(xt=Math.min(xt,Zn.x),_t=Math.max(_t,Zn.x+Zn.width))}for(let Zn=pn;Zn<Mn;Zn++){const Ji=He.glyphAt(Zn);Ji.x=_t-(Ji.x+Ji.width-xt)}break}}let Je;const pt=$e=>Je=$e;for(let $e=0;$e<Qe;$e++){const Le=He.glyphAt($e);Je=Le.glyphObj;const rt=Je.index,xt=we.levels[Le.charIndex]&1;if(xt){const _t=e.getMirroredCharacter(b[Le.charIndex]);_t&&Le.fontData.fontObj.forEachGlyph(_t,0,0,pt)}if(oe){const{charIndex:_t,fontData:Nt}=Le,pn=Le.x+V,Mn=Le.x+Le.width+V;et[_t*4]=xt?Mn:pn,et[_t*4+1]=xt?pn:Mn,et[_t*4+2]=He.baseline+Nt.caretBottom+ue,et[_t*4+3]=He.baseline+Nt.caretTop+ue;const Zn=_t-it;Zn>1&&p(et,it,Zn),it=_t}if(ie){const{charIndex:_t}=Le;for(;_t>tt;)tt++,ie.hasOwnProperty(tt)&&(yt=ie[tt])}if(!Je.isWhitespace&&!Je.isEmpty){const _t=be++,{fontSizeMult:Nt,src:pn,index:Mn}=Le.fontData,Zn=Ie[pn]||(Ie[pn]={});Zn[rt]||(Zn[rt]={path:Je.path,pathBounds:[Je.xMin,Je.yMin,Je.xMax,Je.yMax]});const Ji=Le.x+V,Gs=Le.y+He.baseline+ue;pe[_t*2]=Ji,pe[_t*2+1]=Gs;const ys=Ji+Je.xMin*Nt,_s=Gs+Je.yMin*Nt,nr=Ji+Je.xMax*Nt,ni=Gs+Je.yMax*Nt;ys<qe[0]&&(qe[0]=ys),_s<qe[1]&&(qe[1]=_s),nr>qe[2]&&(qe[2]=nr),ni>qe[3]&&(qe[3]=ni),_t%ne===0&&(ht={start:_t,end:_t,rect:[1/0,1/0,-1/0,-1/0]},dt.push(ht)),ht.end++;const jn=ht.rect;if(ys<jn[0]&&(jn[0]=ys),_s<jn[1]&&(jn[1]=_s),nr>jn[2]&&(jn[2]=nr),ni>jn[3]&&(jn[3]=ni),se[_t]=rt,ce[_t]=Mn,ie){const Fn=_t*3;Ye[Fn]=yt>>16&255,Ye[Fn+1]=yt>>8&255,Ye[Fn+2]=yt&255}}}}}),et){const He=b.length-it;He>1&&p(et,it,He)}}const Re=[];Ge.forEach(({index:we,src:be,unitsPerEm:it,ascender:tt,descender:ht,lineHeight:yt,capHeight:He,xHeight:Xe})=>{Re[we]={src:be,unitsPerEm:it,ascender:tt,descender:ht,lineHeight:yt,capHeight:He,xHeight:Xe}}),ae.typesetting=g()-Y,B({glyphIds:se,glyphFontIndices:ce,glyphPositions:pe,glyphData:Ie,fontData:Re,caretPositions:et,glyphColors:Ye,chunkedBounds:dt,fontSize:C,topBaseline:ue+Oe[0].baseline,blockBounds:[V,ue-q,V+De,ue],visibleBounds:qe,timings:ae})})}function u(b,w){l({...b,metricsOnly:!0},M=>{const[S,C,R,I]=M.blockBounds;w({width:R-S,height:I-C})})}function f(b){let w=b.match(/^([\d.]+)%$/),M=w?parseFloat(w[1]):NaN;return isNaN(M)?0:M/100}function p(b,w,M){const S=b[w*4],C=b[w*4+1],R=b[w*4+2],I=b[w*4+3],D=(C-S)/M;for(let O=0;O<M;O++){const U=(w+O)*4;b[U]=S+D*O,b[U+1]=S+D*(O+1),b[U+2]=R,b[U+3]=I}}function g(){return(self.performance||Date).now()}function v(){this.data=[]}const x=["glyphObj","x","y","width","charIndex","fontData"];return v.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/x.length)},glyphAt(b){let w=v.flyweight;return w.data=this.data,w.index=b,w},splitAt(b){let w=new v;return w.data=this.data.splice(b*x.length),w}},v.flyweight=x.reduce((b,w,M,S)=>(Object.defineProperty(b,w,{get(){return this.data[this.index*x.length+M]},set(C){this.data[this.index*x.length+M]=C}}),b),{data:null,index:0}),{typeset:l,measure:u}}const vd=()=>(self.performance||Date).now(),fS=zU();let vN;function iq(i,e,t,n,s,r,o,l,u,f,p=!0){return p?rq(i,e,t,n,s,r,o,l,u,f).then(null,g=>(vN||(console.warn("WebGL SDF generation failed, falling back to JS",g),vN=!0),_N(i,e,t,n,s,r,o,l,u,f))):_N(i,e,t,n,s,r,o,l,u,f)}const eb=[],sq=5;let Ow=0;function GU(){const i=vd();for(;eb.length&&vd()-i<sq;)eb.shift()();Ow=eb.length?setTimeout(GU,0):0}const rq=(...i)=>new Promise((e,t)=>{eb.push(()=>{const n=vd();try{fS.webgl.generateIntoCanvas(...i),e({timing:vd()-n})}catch(s){t(s)}}),Ow||(Ow=setTimeout(GU,0))}),aq=4,oq=2e3,yN={};let lq=0;function _N(i,e,t,n,s,r,o,l,u,f){const p="TroikaTextSDFGenerator_JS_"+lq++%aq;let g=yN[p];return g||(g=yN[p]={workerModule:Qm({name:p,workerId:p,dependencies:[zU,vd],init(v,x){const b=v().javascript.generate;return function(...w){const M=x();return{textureData:b(...w),timing:x()-M}}},getTransferables(v){return[v.textureData.buffer]}}),requests:0,idleTimer:null}),g.requests++,clearTimeout(g.idleTimer),g.workerModule(i,e,t,n,s,r).then(({textureData:v,timing:x})=>{const b=vd(),w=new Uint8Array(v.length*4);for(let M=0;M<v.length;M++)w[M*4+f]=v[M];return fS.webglUtils.renderImageData(o,w,l,u,i,e,1<<3-f),x+=vd()-b,--g.requests===0&&(g.idleTimer=setTimeout(()=>{Bj(p)},oq)),{timing:x}})}function cq(i){i._warm||(fS.webgl.isSupported(i),i._warm=!0)}const uq=fS.webglUtils.resizeWebGLCanvasWithoutClearing,j0={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},hq=new St;function lm(){return(self.performance||Date).now()}const xN=Object.create(null);function HU(i,e){i=pq({},i);const t=lm(),n=[];if(i.font&&n.push({label:"user",src:mq(i.font)}),i.font=n,i.text=""+i.text,i.sdfGlyphSize=i.sdfGlyphSize||j0.sdfGlyphSize,i.unicodeFontsURL=i.unicodeFontsURL||j0.unicodeFontsURL,i.colorRanges!=null){let v={};for(let x in i.colorRanges)if(i.colorRanges.hasOwnProperty(x)){let b=i.colorRanges[x];typeof b!="number"&&(b=hq.set(b).getHex()),v[x]=b}i.colorRanges=v}Object.freeze(i);const{textureWidth:s,sdfExponent:r}=j0,{sdfGlyphSize:o}=i,l=s/o*4;let u=xN[o];if(!u){const v=document.createElement("canvas");v.width=s,v.height=o*256/l,u=xN[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:v,sdfTexture:new Ki(v,void 0,void 0,void 0,ti,ti),contextLost:!1,glyphsByFont:new Map},u.sdfTexture.generateMipmaps=!1,fq(u)}const{sdfTexture:f,sdfCanvas:p}=u;qU(i).then(v=>{const{glyphIds:x,glyphFontIndices:b,fontData:w,glyphPositions:M,fontSize:S,timings:C}=v,R=[],I=new Float32Array(x.length*4);let D=0,O=0;const U=lm(),k=w.map(j=>{let K=u.glyphsByFont.get(j.src);return K||u.glyphsByFont.set(j.src,K=new Map),K});x.forEach((j,K)=>{const te=b[K],{src:W,unitsPerEm:X}=w[te];let oe=k[te].get(j);if(!oe){const{path:ae,pathBounds:fe}=v.glyphData[W][j],de=Math.max(fe[2]-fe[0],fe[3]-fe[1])/o*(j0.sdfMargin*o+.5),se=u.glyphCount++,ce=[fe[0]-de,fe[1]-de,fe[2]+de,fe[3]+de];k[te].set(j,oe={path:ae,atlasIndex:se,sdfViewBox:ce}),R.push(oe)}const{sdfViewBox:ne}=oe,ie=M[O++],B=M[O++],Q=S/X;I[D++]=ie+ne[0]*Q,I[D++]=B+ne[1]*Q,I[D++]=ie+ne[2]*Q,I[D++]=B+ne[3]*Q,x[K]=oe.atlasIndex}),C.quads=(C.quads||0)+(lm()-U);const P=lm();C.sdf={};const F=p.height,H=Math.ceil(u.glyphCount/l),G=Math.pow(2,Math.ceil(Math.log2(H*o)));G>F&&(console.info(`Increasing SDF texture size ${F}->${G}`),uq(p,s,G),f.dispose()),Promise.all(R.map(j=>WU(j,u,i.gpuAccelerateSDF).then(({timing:K})=>{C.sdf[j.atlasIndex]=K}))).then(()=>{R.length&&!u.contextLost&&(jU(u),f.needsUpdate=!0),C.sdfTotal=lm()-P,C.total=lm()-t,e(Object.freeze({parameters:i,sdfTexture:f,sdfGlyphSize:o,sdfExponent:r,glyphBounds:I,glyphAtlasIndices:x,glyphColors:v.glyphColors,caretPositions:v.caretPositions,chunkedBounds:v.chunkedBounds,ascender:v.ascender,descender:v.descender,lineHeight:v.lineHeight,capHeight:v.capHeight,xHeight:v.xHeight,topBaseline:v.topBaseline,blockBounds:v.blockBounds,visibleBounds:v.visibleBounds,timings:v.timings}))})}),Promise.resolve().then(()=>{u.contextLost||cq(p)})}function WU({path:i,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:n,sdfCanvas:s,contextLost:r},o){if(r)return Promise.resolve({timing:-1});const{textureWidth:l,sdfExponent:u}=j0,f=Math.max(t[2]-t[0],t[3]-t[1]),p=Math.floor(e/4),g=p%(l/n)*n,v=Math.floor(p/(l/n))*n,x=e%4;return iq(n,n,i,t,f,u,s,g,v,x,o)}function fq(i){const e=i.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),i.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),i.contextLost=!1;const n=[];i.glyphsByFont.forEach(s=>{s.forEach(r=>{n.push(WU(r,i,!0))})}),Promise.all(n).then(()=>{jU(i),i.sdfTexture.needsUpdate=!0})})}function dq({font:i,characters:e,sdfGlyphSize:t},n){let s=Array.isArray(e)?e.join(`
`):""+e;HU({font:i,sdfGlyphSize:t,text:s},n)}function pq(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}let Bx;function mq(i){return Bx||(Bx=typeof document>"u"?{}:document.createElement("a")),Bx.href=i,Bx.href}function jU(i){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=i,{width:n,height:s}=e,r=i.sdfCanvas.getContext("webgl");let o=t.image.data;(!o||o.length!==n*s*4)&&(o=new Uint8Array(n*s*4),t.image={width:n,height:s,data:o},t.flipY=!1,t.isDataTexture=!0),r.readPixels(0,0,n,s,r.RGBA,r.UNSIGNED_BYTE,o)}}const gq=Qm({name:"Typesetter",dependencies:[nq,tq,Vj],init(i,e,t){return i(e,t())}}),qU=Qm({name:"Typesetter",dependencies:[gq],init(i){return function(e){return new Promise(t=>{i.typeset(e,t)})}},getTransferables(i){const e=[];for(let t in i)i[t]&&i[t].buffer&&e.push(i[t].buffer);return e}});qU.onMainThread;const bN={};function vq(i){let e=bN[i];return e||(e=bN[i]=new Ou(1,1,i,i).translate(.5,.5,0)),e}const yq="aTroikaGlyphBounds",SN="aTroikaGlyphIndex",_q="aTroikaGlyphColor";class xq extends lE{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new er,this.boundingBox=new $s}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=vq(e);["position","normal","uv"].forEach(n=>{this.attributes[n]=t.attributes[n].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,s,r){this.updateAttributeData(yq,e,4),this.updateAttributeData(SN,t,1),this.updateAttributeData(_q,r,3),this._blockBounds=n,this._chunkedBounds=s,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:s,floor:r,min:o,max:l,sin:u,cos:f}=Math,p=s/2,g=s*2,v=Math.abs(t),x=e[0]/v,b=e[2]/v,w=r((x+p)/g)!==r((b+p)/g)?-v:o(u(x)*v,u(b)*v),M=r((x-p)/g)!==r((b-p)/g)?v:l(u(x)*v,u(b)*v),S=r((x+s)/g)!==r((b+s)/g)?v*2:l(v-f(x)*v,v-f(b)*v);n.min.set(w,e[1],t<0?-S:0),n.max.set(M,e[3],t<0?0:S)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(SN).count,n=this._chunkedBounds;if(n)for(let s=n.length;s--;){t=n[s].end;let r=n[s].rect;if(r[1]<e.w&&r[3]>e.y&&r[0]<e.z&&r[2]>e.x)break}this.instanceCount=t}updateAttributeData(e,t,n){const s=this.getAttribute(e);t?s&&s.array.length===t.length?(s.array.set(t),s.needsUpdate=!0):(this.setAttribute(e,new Md(t,n)),delete this._maxInstanceCount,this.dispose()):s&&this.deleteAttribute(e)}}const bq=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Sq=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Mq=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Tq=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function wq(i){const e=Iw(i,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new st},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new $n(0,0,0,0)},uTroikaClipRect:{value:new $n(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new st},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new St},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new on},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:bq,vertexTransform:Sq,fragmentDefs:Mq,fragmentColorTransform:Tq,customRewriter({vertexShader:t,fragmentShader:n}){let s=/\buniform\s+vec3\s+diffuse\b/;return s.test(n)&&(n=n.replace(s,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),s.test(t)||(t=t.replace(VU,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:n}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const yE=new Iu({color:16777215,side:sa,transparent:!0}),MN=8421504,TN=new Kt,zx=new re,PT=new re,B0=[],Aq=new re,UT="+x+y";function wN(i){return Array.isArray(i)?i[0]:i}let XU=()=>{const i=new Qi(new Ou(1,1),yE);return XU=()=>i,i},YU=()=>{const i=new Qi(new Ou(1,1,32,1),yE);return YU=()=>i,i};const Eq={type:"syncstart"},Cq={type:"synccomplete"},ZU=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Rq=ZU.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let KU=class extends Qi{constructor(){const e=new xq;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=MN,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=UT,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(Eq),HU({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{n.forEach(s=>s&&s())})),this.dispatchEvent(Cq),e&&e()})))}onBeforeRender(e,t,n,s,r,o){this.sync(),r.isTroikaTextMaterial&&this._prepareForRender(r)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return wq(e)}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=yE.clone());if((!e||!e.isDerivedFrom(t))&&(e=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function n(){t.removeEventListener("dispose",n),e.dispose()})),this.hasOutline()){let n=e._outlineMtl;return n||(n=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),n.isTextOutlineMaterial=!0,n.depthWrite=!1,n.map=null,e.addEventListener("dispose",function s(){e.removeEventListener("dispose",s),n.dispose()})),[n,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return wN(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return wN(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,s=this.textRenderInfo;if(s){const{sdfTexture:l,blockBounds:u}=s;n.uTroikaSDFTexture.value=l,n.uTroikaSDFTextureSize.value.set(l.image.width,l.image.height),n.uTroikaSDFGlyphSize.value=s.sdfGlyphSize,n.uTroikaSDFExponent.value=s.sdfExponent,n.uTroikaTotalBounds.value.fromArray(u),n.uTroikaUseGlyphColors.value=!t&&!!s.glyphColors;let f=0,p=0,g=0,v,x,b,w=0,M=0;if(t){let{outlineWidth:C,outlineOffsetX:R,outlineOffsetY:I,outlineBlur:D,outlineOpacity:O}=this;f=this._parsePercent(C)||0,p=Math.max(0,this._parsePercent(D)||0),v=O,w=this._parsePercent(R)||0,M=this._parsePercent(I)||0}else g=Math.max(0,this._parsePercent(this.strokeWidth)||0),g&&(b=this.strokeColor,n.uTroikaStrokeColor.value.set(b??MN),x=this.strokeOpacity,x==null&&(x=1)),v=this.fillOpacity;n.uTroikaEdgeOffset.value=f,n.uTroikaPositionOffset.value.set(w,M),n.uTroikaBlurRadius.value=p,n.uTroikaStrokeWidth.value=g,n.uTroikaStrokeOpacity.value=x,n.uTroikaFillOpacity.value=v??1,n.uTroikaCurveRadius.value=this.curveRadius||0;let S=this.clipRect;if(S&&Array.isArray(S)&&S.length===4)n.uTroikaClipRect.value.fromArray(S);else{const C=(this.fontSize||.1)*100;n.uTroikaClipRect.value.set(u[0]-C,u[1]-C,u[2]+C,u[3]+C)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const r=t?this.outlineColor||0:this.color;if(r==null)delete e.color;else{const l=e.hasOwnProperty("color")?e.color:e.color=new St;(r!==l._input||typeof r=="object")&&l.set(l._input=r)}let o=this.orientation||UT;if(o!==e._orientation){let l=n.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let u=o!==UT&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(u){let[,f,p,g,v]=u;zx.set(0,0,0)[p]=f==="-"?1:-1,PT.set(0,0,0)[v]=g==="-"?-1:1,TN.lookAt(Aq,zx.cross(PT),PT),l.setFromMatrix4(TN)}else l.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new st){t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e,t=new st){return zx.copy(e),this.localPositionToTextCoords(this.worldToLocal(zx),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:s}=this;if(n){const r=n.blockBounds,o=s?YU():XU(),l=o.geometry,{position:u,uv:f}=l.attributes;for(let p=0;p<f.count;p++){let g=r[0]+f.getX(p)*(r[2]-r[0]);const v=r[1]+f.getY(p)*(r[3]-r[1]);let x=0;s&&(x=s-Math.cos(g/s)*s,g=Math.sin(g/s)*s),u.setXYZ(p,g,v,x)}l.boundingSphere=this.geometry.boundingSphere,l.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,B0.length=0,o.raycast(e,B0);for(let p=0;p<B0.length;p++)B0[p].object=this,t.push(B0[p])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,Rq.forEach(n=>{this[n]=e[n]}),this}clone(){return new this.constructor().copy(this)}};ZU.forEach(i=>{const e="_private_"+i;Object.defineProperty(KU.prototype,i,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});new $s;new St;const o1=_e.forwardRef(({sdfGlyphSize:i=64,anchorX:e="center",anchorY:t="middle",font:n,fontSize:s=1,children:r,characters:o,onSync:l,...u},f)=>{const p=ka(({invalidate:b})=>b),[g]=_e.useState(()=>new KU),[v,x]=_e.useMemo(()=>{const b=[];let w="";return _e.Children.forEach(r,M=>{typeof M=="string"||typeof M=="number"?w+=M:b.push(M)}),[b,w]},[r]);return A7(()=>new Promise(b=>dq({font:n,characters:o},b)),["troika-text",n,o]),_e.useLayoutEffect(()=>{g.sync(()=>{p(),l&&l(g)})}),_e.useEffect(()=>()=>g.dispose(),[g]),_e.createElement("primitive",Tc({object:g,ref:f,font:n,text:x,anchorX:e,anchorY:t,fontSize:s,sdfGlyphSize:i},u),v)}),Dq=()=>parseInt(Vv.replace(/\D+/g,"")),_E=Dq();function Nq(i,e,t){const n=ka(x=>x.size),s=ka(x=>x.viewport),r=typeof i=="number"?i:n.width*s.dpr,o=n.height*s.dpr,l=(typeof i=="number"?t:i)||{},{samples:u=0,depth:f,...p}=l,g=f??l.depthBuffer,v=_e.useMemo(()=>{const x=new Ha(r,o,{minFilter:ti,magFilter:ti,type:El,...p});return g&&(x.depthTexture=new Td(r,o,Pr)),x.samples=u,x},[]);return _e.useLayoutEffect(()=>{v.setSize(r,o),u&&(v.samples=u)},[u,v,r,o]),_e.useEffect(()=>()=>v.dispose(),[]),v}const Iq=i=>typeof i=="function",Oq=_e.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,makeDefault:n,children:s,...r},o)=>{const l=ka(({set:M})=>M),u=ka(({camera:M})=>M),f=ka(({size:M})=>M),p=_e.useRef(null);_e.useImperativeHandle(o,()=>p.current,[]);const g=_e.useRef(null),v=Nq(e);_e.useLayoutEffect(()=>{r.manual||(p.current.aspect=f.width/f.height)},[f,r]),_e.useLayoutEffect(()=>{p.current.updateProjectionMatrix()});let x=0,b=null;const w=Iq(s);return Dl(M=>{w&&(t===1/0||x<t)&&(g.current.visible=!1,M.gl.setRenderTarget(v),b=M.scene.background,i&&(M.scene.background=i),M.gl.render(M.scene,p.current),M.scene.background=b,M.gl.setRenderTarget(null),g.current.visible=!0,x++)}),_e.useLayoutEffect(()=>{if(n){const M=u;return l(()=>({camera:p.current})),()=>l(()=>({camera:M}))}},[p,n,l]),_e.createElement(_e.Fragment,null,_e.createElement("perspectiveCamera",Tc({ref:p},r),!w&&s),_e.createElement("group",{ref:g},w&&s(v.texture)))}),xE=_e.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:s=!0,keyEvents:r=!1,onChange:o,onStart:l,onEnd:u,...f},p)=>{const g=ka(O=>O.invalidate),v=ka(O=>O.camera),x=ka(O=>O.gl),b=ka(O=>O.events),w=ka(O=>O.setEvents),M=ka(O=>O.set),S=ka(O=>O.get),C=ka(O=>O.performance),R=e||v,I=n||b.connected||x.domElement,D=_e.useMemo(()=>new Pj(R),[R]);return Dl(()=>{D.enabled&&D.update()},-1),_e.useEffect(()=>(r&&D.connect(r===!0?I:r),D.connect(I),()=>{D.dispose()}),[r,I,t,D,g]),_e.useEffect(()=>{const O=P=>{g(),t&&C.regress(),o&&o(P)},U=P=>{l&&l(P)},k=P=>{u&&u(P)};return D.addEventListener("change",O),D.addEventListener("start",U),D.addEventListener("end",k),()=>{D.removeEventListener("start",U),D.removeEventListener("end",k),D.removeEventListener("change",O)}},[o,l,u,D,g,w]),_e.useEffect(()=>{if(i){const O=S().controls;return M({controls:D}),()=>M({controls:O})}},[i,D]),_e.createElement("primitive",Tc({ref:p,object:D,enableDamping:s},f))}),LT=_E>=154?"opaque_fragment":"output_fragment";class Pq extends q1{constructor(e){super(e),this.onBeforeCompile=(t,n)=>{const{isWebGL2:s}=n.capabilities;t.fragmentShader=t.fragmentShader.replace(`#include <${LT}>`,`
        ${s?`#include <${LT}>`:`#extension GL_OES_standard_derivatives : enable
#include <${LT}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${_E>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const Uq=_e.forwardRef((i,e)=>{const[t]=_e.useState(()=>new Pq(null));return _e.createElement("primitive",Tc({},i,{object:t,ref:e,attach:"material"}))});class Lq extends ho{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${_E>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}const Fq=i=>new re().setFromSpherical(new n1(i,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),QU=_e.forwardRef(({radius:i=100,depth:e=50,count:t=5e3,saturation:n=0,factor:s=4,fade:r=!1,speed:o=1},l)=>{const u=_e.useRef(null),[f,p,g]=_e.useMemo(()=>{const x=[],b=[],w=Array.from({length:t},()=>(.5+.5*Math.random())*s),M=new St;let S=i+e;const C=e/t;for(let R=0;R<t;R++)S-=C*Math.random(),x.push(...Fq(S).toArray()),M.setHSL(R/t,n,.9),b.push(M.r,M.g,M.b);return[new Float32Array(x),new Float32Array(b),new Float32Array(w)]},[t,e,s,i,n]);Dl(x=>u.current&&(u.current.uniforms.time.value=x.clock.elapsedTime*o));const[v]=_e.useState(()=>new Lq);return _e.createElement("points",{ref:l},_e.createElement("bufferGeometry",null,_e.createElement("bufferAttribute",{attach:"attributes-position",args:[f,3]}),_e.createElement("bufferAttribute",{attach:"attributes-color",args:[p,3]}),_e.createElement("bufferAttribute",{attach:"attributes-size",args:[g,1]})),_e.createElement("primitive",{ref:u,object:v,attach:"material",blending:cb,"uniforms-fade-value":r,depthWrite:!1,transparent:!0,vertexColors:!0}))});let Jf,z0;const kq=_e.createContext(null),AN=new Kt,EN=new re,Bq=_e.forwardRef(({children:i,range:e,limit:t=1e3,...n},s)=>{const r=_e.useRef(null);_e.useImperativeHandle(s,()=>r.current,[]);const[o,l]=_e.useState([]),[[u,f,p]]=_e.useState(()=>[new Float32Array(t*3),Float32Array.from({length:t*3},()=>1),Float32Array.from({length:t},()=>1)]);_e.useEffect(()=>{r.current.geometry.attributes.position.needsUpdate=!0}),Dl(()=>{for(r.current.updateMatrix(),r.current.updateMatrixWorld(),AN.copy(r.current.matrixWorld).invert(),r.current.geometry.drawRange.count=Math.min(t,e!==void 0?e:t,o.length),Jf=0;Jf<o.length;Jf++)z0=o[Jf].current,z0.getWorldPosition(EN).applyMatrix4(AN),EN.toArray(u,Jf*3),r.current.geometry.attributes.position.needsUpdate=!0,z0.matrixWorldNeedsUpdate=!0,z0.color.toArray(f,Jf*3),r.current.geometry.attributes.color.needsUpdate=!0,p.set([z0.size],Jf),r.current.geometry.attributes.size.needsUpdate=!0});const g=_e.useMemo(()=>({getParent:()=>r,subscribe:v=>(l(x=>[...x,v]),()=>l(x=>x.filter(b=>b.current!==v.current)))}),[]);return _e.createElement("points",Tc({userData:{instances:o},matrixAutoUpdate:!1,ref:r,raycast:()=>null},n),_e.createElement("bufferGeometry",null,_e.createElement("bufferAttribute",{attach:"attributes-position",args:[u,3],usage:md}),_e.createElement("bufferAttribute",{attach:"attributes-color",args:[f,3],usage:md}),_e.createElement("bufferAttribute",{attach:"attributes-size",args:[p,1],usage:md})),_e.createElement(kq.Provider,{value:g},i))}),zq=_e.forwardRef(({children:i,positions:e,colors:t,sizes:n,stride:s=3,...r},o)=>{const l=_e.useRef(null);return _e.useImperativeHandle(o,()=>l.current,[]),Dl(()=>{const u=l.current.geometry.attributes;u.position.needsUpdate=!0,t&&(u.color.needsUpdate=!0),n&&(u.size.needsUpdate=!0)}),_e.createElement("points",Tc({ref:l},r),_e.createElement("bufferGeometry",null,_e.createElement("bufferAttribute",{attach:"attributes-position",args:[e,s],usage:md}),t&&_e.createElement("bufferAttribute",{attach:"attributes-color",args:[t,s],count:t.length/s,usage:md}),n&&_e.createElement("bufferAttribute",{attach:"attributes-size",args:[n,1],count:n.length/s,usage:md})),i)}),Vq=_e.forwardRef((i,e)=>i.positions instanceof Float32Array?_e.createElement(zq,Tc({},i,{ref:e})):_e.createElement(Bq,Tc({},i,{ref:e})));function Gq({showResult:i=!1}){const e=_e.useRef(),[t,n]=_e.useState([]);return _e.useEffect(()=>{const s=[];for(let o=0;o<15;o++){const l=(Math.random()*10+1).toFixed(2),u=o/15*Math.PI*2,f=2+Math.random()*1.5;s.push({id:o*2,value:`+${l}`,position:[Math.cos(u)*f,Math.sin(u)*f,Math.random()*.5-.25],color:"#06ffa5",cancelsWith:o*2+1}),s.push({id:o*2+1,value:`-${l}`,position:[Math.cos(u+.2)*(f+.5),Math.sin(u+.2)*(f+.5),Math.random()*.5-.25],color:"#ff006e",cancelsWith:o*2})}n(s)},[]),Dl(s=>{e.current&&!i&&(e.current.rotation.z=Math.sin(s.clock.elapsedTime*.2)*.1)}),ee.jsxs("group",{ref:e,children:[t.map((s,r)=>ee.jsxs("group",{position:i?[0,0,0]:s.position,children:[ee.jsx(o1,{fontSize:.3,color:s.color,anchorX:"center",anchorY:"middle",visible:!i,children:s.value}),ee.jsxs("mesh",{visible:!i,children:[ee.jsx("sphereGeometry",{args:[.3,16,16]}),ee.jsx("meshBasicMaterial",{color:s.color,transparent:!0,opacity:.2})]})]},s.id)),i&&ee.jsxs("group",{children:[ee.jsx(o1,{position:[0,0,0],fontSize:1,color:"#4a9eff",anchorX:"center",anchorY:"middle",children:"= 42"}),ee.jsxs("mesh",{children:[ee.jsx("sphereGeometry",{args:[1.5,32,32]}),ee.jsx("meshBasicMaterial",{color:"#4a9eff",transparent:!0,opacity:.1})]})]})]})}function Hq({onNext:i,onPrevious:e}){const[t,n]=_e.useState(0),[s,r]=_e.useState(!1),o=["When physicists finally computed all those Feynman diagrams...","Something shocking happened. Watch closely.","Thousands of complex terms... most of them cancelled each other out!","The final answer was absurdly simple compared to the calculation.","It's like the universe was hiding an elegant truth behind a complex facade."],l=()=>{t<o.length-1&&(n(t+1),t===1&&setTimeout(()=>r(!0),1e3))};return ee.jsx(En.div,{className:"chapter chapter2",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:ee.jsxs("div",{className:"chapter-content",children:[ee.jsx(En.h2,{className:"chapter-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:"Chapter 2: A Strange Hint"}),ee.jsx(jm,{mode:"wait",children:ee.jsx(En.p,{className:"chapter-text",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:o[t]},t)}),ee.jsx("div",{className:"cancellation-container",children:ee.jsxs(hS,{camera:{position:[0,0,8],fov:45},children:[ee.jsx("ambientLight",{intensity:.3}),ee.jsx("pointLight",{position:[10,10,10],intensity:.5}),ee.jsx(Gq,{showResult:s}),ee.jsx(xE,{enablePan:!1,enableZoom:!1,autoRotate:!s,autoRotateSpeed:.3})]})}),ee.jsx("div",{className:"explanation-panel glass",children:ee.jsxs("div",{className:"math-explanation",children:[ee.jsx("h3",{children:"Understanding the Mathematics"}),ee.jsx("p",{children:"Above, you see floating numbers in 3D space. Each number represents one mathematical term in a huge equation."}),s?ee.jsxs(ee.Fragment,{children:[ee.jsxs("div",{className:"cancellation-explanation",children:[ee.jsxs("p",{children:[ee.jsx("strong",{children:"Watch what happened:"})," Almost everything cancelled out!"]}),ee.jsx("p",{children:"+7.23 - 7.23 = 0 âœ—"}),ee.jsx("p",{children:"+4.91 - 4.95 â‰ˆ 0 âœ—"}),ee.jsx("p",{children:"Hundreds of terms â†’ Nearly zero"})]}),ee.jsxs("div",{className:"simple-result",children:[ee.jsx("p",{className:"equation-label",children:"Final answer after all cancellations:"}),ee.jsx("p",{className:"equation-text holographic",children:"= 42 (beautifully simple!)"})]})]}):ee.jsxs(ee.Fragment,{children:[ee.jsxs("div",{className:"equation-breakdown",children:[ee.jsxs("p",{children:[ee.jsx("strong",{children:"Green numbers (+)"})," = Positive contributions"]}),ee.jsxs("p",{children:[ee.jsx("strong",{children:"Red numbers (-)"})," = Negative contributions"]}),ee.jsxs("p",{children:[ee.jsx("strong",{children:"The goal:"})," Add them ALL up to get the final answer"]})]}),ee.jsxs("div",{className:"complex-equation",children:[ee.jsx("p",{className:"equation-label",children:"What physicists calculated:"}),ee.jsx("p",{className:"equation-text",children:"+7.23 - 7.18 + 4.91 - 4.95 + 2.87 - 2.84 + ... (hundreds more terms)"}),ee.jsx("p",{className:"small-note",children:"Each Feynman diagram contributes multiple terms like this!"})]})]})]})}),t<o.length-1&&ee.jsx(En.button,{className:"insight-button",onClick:l,whileHover:{scale:1.05},whileTap:{scale:.95},children:t===1?"Watch the Magic":"Continue"}),t===o.length-1&&ee.jsxs(En.div,{className:"revelation glass",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[ee.jsx("h3",{children:"The Mystery Deepens"}),ee.jsx("p",{children:"Why would nature hide simplicity behind such complexity?"}),ee.jsx("p",{children:"What if we've been looking at it backwards all along?"})]}),ee.jsxs("div",{className:"chapter-nav",children:[ee.jsx("button",{onClick:e,children:"â† Back"}),t===o.length-1&&ee.jsx("button",{onClick:i,className:"next-button",children:"Discover the Secret â†’"})]})]})})}function Wq({vertices:i,showVolume:e,color:t="#4a9eff"}){const n=_e.useRef();Dl(o=>{n.current&&!e&&(n.current.rotation.z=Math.sin(o.clock.elapsedTime*.5)*.1)});const s=()=>{let o=0;for(let l=0;l<i.length;l++){const u=(l+1)%i.length;o+=i[l][0]*i[u][1],o-=i[u][0]*i[l][1]}return Math.abs(o/2).toFixed(2)},r=new Fh;r.moveTo(i[0][0],i[0][1]);for(let o=1;o<i.length;o++)r.lineTo(i[o][0],i[o][1]);return r.closePath(),ee.jsxs("group",{ref:n,children:[ee.jsxs("mesh",{children:[ee.jsx("shapeGeometry",{args:[r]}),ee.jsx("meshBasicMaterial",{color:t,transparent:!0,opacity:e?.6:.3,side:sa})]}),ee.jsxs("lineSegments",{children:[ee.jsx("edgesGeometry",{args:[new Xv(r)]}),ee.jsx("lineBasicMaterial",{color:"#06ffa5",linewidth:2})]}),i.map((o,l)=>ee.jsxs("mesh",{position:[o[0],o[1],.01],children:[ee.jsx("circleGeometry",{args:[.1,16]}),ee.jsx("meshBasicMaterial",{color:"#ffbe0b"})]},l)),e&&ee.jsxs(o1,{position:[0,-2,0],fontSize:.5,color:"#fff",anchorX:"center",anchorY:"middle",children:["Area = ",s()]})]})}function jq({type:i,showFacets:e}){const t=_e.useRef();Dl(s=>{t.current&&(t.current.rotation.y=s.clock.elapsedTime*.3,t.current.rotation.x=Math.sin(s.clock.elapsedTime*.2)*.2)});const n=i==="tetrahedron"?new Zv(1.5):new Ym(1.5);return ee.jsxs("group",{children:[ee.jsxs("mesh",{ref:t,children:[ee.jsx("primitive",{object:n}),ee.jsx("meshPhongMaterial",{color:"#4a9eff",transparent:!0,opacity:.4,wireframe:!1,side:sa})]}),ee.jsxs("mesh",{children:[ee.jsx("primitive",{object:n}),ee.jsx("meshBasicMaterial",{color:"#06ffa5",wireframe:!0,transparent:!0,opacity:.8})]}),e&&ee.jsxs("group",{children:[ee.jsx(o1,{position:[0,2.5,0],fontSize:.3,color:"#ffbe0b",anchorX:"center",anchorY:"middle",children:"Each face encodes information"}),ee.jsxs("mesh",{scale:1.02,children:[ee.jsx("primitive",{object:n}),ee.jsx("meshBasicMaterial",{color:"#ffbe0b",transparent:!0,opacity:.2})]})]})]})}function qq({onNext:i,onPrevious:e}){const[t,n]=_e.useState(0),[s,r]=_e.useState("2d"),[o,l]=_e.useState(!1),[u,f]=_e.useState(!1),[p,g]=_e.useState(0),v=[{name:"Triangle",vertices:[[-1,-.8],[1,-.8],[0,1.2]]},{name:"Square",vertices:[[-1,-1],[1,-1],[1,1],[-1,1]]},{name:"Pentagon",vertices:[[0,1.2],[1.1,.4],[.7,-1],[-.7,-1],[-1.1,.4]]}],x=["What if geometry itself could store information?","Look at this simple shape. Its area is a number - that's information!","Try different shapes. Each has a different area = different information.","Now in 3D: a polytope has volume AND faces.","Each facet is like a window into a simpler polytope.","This recursive structure is the key to everything."],b=()=>{t<x.length-1&&(n(t+1),t===0&&l(!0),t===2&&(r("3d"),l(!1)),t===3&&f(!0))},w=M=>{g(M)};return ee.jsx(En.div,{className:"chapter chapter3",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:ee.jsxs("div",{className:"chapter-content",children:[ee.jsx(En.h2,{className:"chapter-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:"Chapter 3: Enter the Jewel"}),ee.jsx(jm,{mode:"wait",children:ee.jsx(En.p,{className:"chapter-text",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:x[t]},t)}),ee.jsx("div",{className:"polytope-container",children:ee.jsxs(hS,{camera:{position:[0,0,6],fov:45},children:[ee.jsx("ambientLight",{intensity:.5}),ee.jsx("pointLight",{position:[10,10,10],intensity:.5}),ee.jsx("pointLight",{position:[-10,-10,-10],intensity:.3,color:"#4a9eff"}),s==="2d"?ee.jsx(Wq,{vertices:v[p].vertices,showVolume:o}):ee.jsx(jq,{type:t>3?"octahedron":"tetrahedron",showFacets:u}),ee.jsx(xE,{enablePan:!1,enableZoom:!0,minDistance:3,maxDistance:10})]})}),s==="2d"&&t===2&&ee.jsxs("div",{className:"shape-selector",children:[ee.jsx("p",{children:"Try different shapes:"}),ee.jsx("div",{className:"shape-buttons",children:v.map((M,S)=>ee.jsx("button",{className:p===S?"active":"",onClick:()=>w(S),children:M.name},S))})]}),ee.jsx("div",{className:"insight-panel glass",children:t<3?ee.jsxs(ee.Fragment,{children:[ee.jsx("h3",{children:"Key Insight #1"}),ee.jsx("p",{children:"Geometry = Information"}),ee.jsx("p",{className:"detail",children:"The shape's properties (area, edges) encode data"})]}):ee.jsxs(ee.Fragment,{children:[ee.jsx("h3",{children:"Key Insight #2"}),ee.jsx("p",{children:"Higher dimensions = More structure"}),ee.jsx("p",{className:"detail",children:"Volume tells us one thing, facets tell us many things"})]})}),t<x.length-1&&ee.jsx(En.button,{className:"proceed-button",onClick:b,whileHover:{scale:1.05},whileTap:{scale:.95},children:t===2?"Enter 3D":"Continue"}),t===x.length-1&&ee.jsxs(En.div,{className:"ready-panel glass",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[ee.jsx("h3",{children:"You're ready."}),ee.jsx("p",{children:"Now imagine a polytope that encodes ALL possible particle collisions..."})]}),ee.jsxs("div",{className:"chapter-nav",children:[ee.jsx("button",{onClick:e,children:"â† Back"}),t===x.length-1&&ee.jsx("button",{onClick:i,className:"next-button",children:"Meet the Amplituhedron â†’"})]})]})})}const Xq=`
  varying vec3 vPosition;
  varying vec3 vNormal;
  varying vec2 vUv;
  varying vec3 vViewPosition;
  
  void main() {
    vPosition = position;
    vNormal = normalize(normalMatrix * normal);
    vUv = uv;
    
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;
    
    gl_Position = projectionMatrix * mvPosition;
  }
`,Yq=`
  uniform float time;
  uniform vec3 color1;
  uniform vec3 color2;
  uniform vec3 color3;
  uniform vec3 color4;
  uniform vec3 color5;
  uniform float fresnelPower;
  uniform float glowIntensity;
  
  varying vec3 vPosition;
  varying vec3 vNormal;
  varying vec2 vUv;
  varying vec3 vViewPosition;
  
  void main() {
    // Calculate fresnel effect
    vec3 viewDirection = normalize(vViewPosition);
    float fresnel = pow(1.0 - dot(vNormal, viewDirection), fresnelPower);
    
    // Create holographic color shift based on view angle and time
    float angle = atan(vNormal.y, vNormal.x) + time * 0.1;
    float colorShift = sin(angle * 3.0) * 0.5 + 0.5;
    
    // Mix multiple colors for holographic effect
    vec3 color = mix(color1, color2, colorShift);
    color = mix(color, color3, sin(colorShift * 3.14159 + time * 0.2));
    color = mix(color, color4, cos(angle * 2.0 + time * 0.15));
    color = mix(color, color5, fresnel * 0.5);
    
    // Add prismatic dispersion
    float dispersion = sin(vPosition.x * 10.0 + time) * 0.1;
    color.r += dispersion * 0.2;
    color.g -= dispersion * 0.1;
    color.b += dispersion * 0.15;
    
    // Add inner glow
    float glow = fresnel * glowIntensity;
    color += vec3(glow * 0.5, glow * 0.8, glow);
    
    // Output with transparency based on fresnel
    gl_FragColor = vec4(color, 0.7 + fresnel * 0.3);
  }
`;function JU({particleCount:i=4,helicity:e=2,scale:t=1}){const n=_e.useRef(),s=_e.useRef(),r=_e.useMemo(()=>{const l=[],u=[],p=12+(i-4)*8,g=1+(i-4)*.5;for(let x=0;x<p;x++){const b=x/p*Math.PI*2,w=1+g*.5,M=3+g,S=2+g*.3,C=5+g*.7,R=Math.cos(b*w)+.3*Math.cos(M*b)*g,I=Math.sin(b*w)+.3*Math.sin(M*b)*g,D=.5*Math.sin(S*b)+.2*Math.sin(C*b)*g;l.push(R*t,I*t,D*t)}for(let x=0;x<p;x++)for(let b=x+1;b<p;b++)for(let w=b+1;w<p;w++)w-b+(b-x)<p/2&&u.push(x,b,w);const v=new nn;return v.setAttribute("position",new It(l,3)),v.setIndex(u),v.computeVertexNormals(),v},[i,e,t]),o=_e.useMemo(()=>({time:{value:0},color1:{value:new St("#ff006e")},color2:{value:new St("#8338ec")},color3:{value:new St("#3a86ff")},color4:{value:new St("#06ffa5")},color5:{value:new St("#ffbe0b")},fresnelPower:{value:2.5},glowIntensity:{value:1.2}}),[]);return Dl((l,u)=>{n.current&&(n.current.rotation.y+=u*.2,n.current.rotation.x=Math.sin(l.clock.elapsedTime*.3)*.1),s.current&&(s.current.uniforms.time.value=l.clock.elapsedTime)}),ee.jsxs("group",{children:[ee.jsx("mesh",{ref:n,geometry:r,children:ee.jsx("shaderMaterial",{ref:s,vertexShader:Xq,fragmentShader:Yq,uniforms:o,transparent:!0,side:sa,depthWrite:!1})}),ee.jsx("mesh",{geometry:r,scale:1.1,children:ee.jsx("meshBasicMaterial",{color:"#4a9eff",transparent:!0,opacity:.1,side:Lr})})]})}function Zq({onNext:i,onPrevious:e}){const[t,n]=_e.useState(4),[s,r]=_e.useState(null),o=["This is the amplituhedronâ€”a holographic jewel that contains ALL possible particle interactions.","Every surface you see represents one of those Feynman diagrams from Chapter 1.","Instead of calculating hundreds of diagrams, we just measure this shape's volume!","Watch: as you increase particles, the shape becomes more complexâ€”but stays elegant.","This single object replaces thousands of calculations with pure geometry."],[l,u]=_e.useState(0),f=p=>{n(parseInt(p.target.value))};return ee.jsx(En.div,{className:"chapter chapter4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:ee.jsxs("div",{className:"chapter-content",children:[ee.jsx(En.h2,{className:"chapter-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:"Chapter 4: The Amplituhedron Itself"}),ee.jsx(jm,{mode:"wait",children:ee.jsx(En.p,{className:"chapter-text",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:o[l]},l)}),ee.jsx("div",{className:"amplituhedron-container",children:ee.jsxs(hS,{children:[ee.jsx(Oq,{makeDefault:!0,position:[0,0,5]}),ee.jsx("ambientLight",{intensity:.1}),ee.jsx("pointLight",{position:[10,10,10],intensity:.5}),ee.jsx("pointLight",{position:[-10,-10,-10],intensity:.3,color:"#4a9eff"}),ee.jsx(JU,{particleCount:t,helicity:2,scale:1.5}),ee.jsx(QU,{radius:50,depth:50,count:1e3,factor:2,saturation:0,fade:!0,speed:.5}),ee.jsx(xE,{enablePan:!1,enableZoom:!0,minDistance:3,maxDistance:10,autoRotate:!0,autoRotateSpeed:.5})]})}),ee.jsxs("div",{className:"controls glass",children:[ee.jsxs("div",{className:"slider-container",children:[ee.jsxs("label",{children:["Number of particles: ",t,ee.jsx("input",{type:"range",min:"4",max:"8",value:t,onChange:f,className:"particle-slider"})]}),ee.jsxs("div",{className:"complexity-explanation",children:[ee.jsxs("p",{children:[ee.jsx("strong",{children:"4 particles:"})," ~200 Feynman diagrams â†’ Simple amplituhedron"]}),ee.jsxs("p",{children:[ee.jsx("strong",{children:"8 particles:"})," ~16,000 diagrams â†’ Complex amplituhedron"]}),ee.jsx("p",{className:"slider-hint",children:"Watch how the shape becomes more intricate as particles increase!"})]})]}),ee.jsxs("div",{className:"facet-info",children:[ee.jsx("h3",{children:"What You're Seeing:"}),ee.jsxs("ul",{children:[ee.jsxs("li",{children:[ee.jsx("span",{className:"holographic",children:"Holographic surfaces"})," = Each Feynman diagram"]}),ee.jsxs("li",{children:[ee.jsx("span",{style:{color:"#4a9eff"},children:"Blue glow"})," = Quantum probability field"]}),ee.jsxs("li",{children:[ee.jsx("span",{style:{color:"#ffbe0b"},children:"Volume"})," = Final answer physicists want"]}),ee.jsxs("li",{children:[ee.jsx("strong",{children:"No spacetime!"})," Pure mathematical relationships"]})]}),ee.jsx("div",{className:"interaction-guide",children:ee.jsxs("p",{children:[ee.jsx("strong",{children:"Try this:"})," Rotate with mouse, zoom with scroll wheel"]})})]})]}),ee.jsx("div",{className:"insight-buttons",children:l<o.length-1&&ee.jsx("button",{className:"insight-button",onClick:()=>u(p=>Math.min(p+1,o.length-1)),children:"Next Insight â†’"})}),ee.jsxs("div",{className:"chapter-nav",children:[ee.jsx("button",{onClick:e,children:"â† Back"}),ee.jsx("button",{onClick:i,className:"next-button",children:"Discover What This Means â†’"})]})]})})}function Kq({visible:i=!0,opacity:e=1}){const t=_e.useRef();return Dl(r=>{t.current&&i&&(t.current.material.uniforms.time.value=r.clock.elapsedTime)}),ee.jsxs("mesh",{ref:t,rotation:[-Math.PI/2,0,0],position:[0,-2,0],visible:i,children:[ee.jsx("planeGeometry",{args:[20,20,50,50]}),ee.jsx("shaderMaterial",{uniforms:{time:{value:0},opacity:{value:e}},vertexShader:`
    uniform float time;
    varying vec2 vUv;
    
    void main() {
      vUv = uv;
      vec3 pos = position;
      
      // Wave effect
      float wave = sin(position.x * 0.5 + time) * 0.1;
      wave += sin(position.z * 0.5 + time * 0.8) * 0.1;
      pos.y += wave;
      
      gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
    }
  `,fragmentShader:`
    uniform float opacity;
    varying vec2 vUv;
    
    void main() {
      // Grid pattern
      float grid = 0.0;
      grid += step(0.98, fract(vUv.x * 20.0)) + step(0.98, fract(vUv.y * 20.0));
      grid = clamp(grid, 0.0, 1.0);
      
      vec3 color = vec3(0.3, 0.6, 1.0);
      gl_FragColor = vec4(color, grid * opacity * 0.5);
    }
  `,transparent:!0,side:sa})]})}function Qq({active:i}){const e=_e.useRef(),[t,n]=_e.useState([]);return _e.useEffect(()=>{const s=[];for(let r=0;r<500;r++)s.push((Math.random()-.5)*10,Math.random()*5-2.5,(Math.random()-.5)*10);n(new Float32Array(s))},[]),Dl(s=>{if(e.current&&i){e.current.rotation.y=s.clock.elapsedTime*.05;const r=s.clock.elapsedTime,o=Math.sin(r*.5)*.5+1;e.current.scale.setScalar(o)}}),t.length===0?null:ee.jsx(Vq,{ref:e,positions:t,stride:3,frustumCulled:!0,children:ee.jsx(Uq,{transparent:!0,color:"#4a9eff",size:.05,sizeAttenuation:!0,depthWrite:!1,opacity:i?.8:0})})}function Jq({onNext:i,onPrevious:e}){const[t,n]=_e.useState(0),[s,r]=_e.useState(!1),[o,l]=_e.useState(1),[u,f]=_e.useState(!1),[p,g]=_e.useState(!1),v=["The amplituhedron exists in a mathematical space where spacetime doesn't exist.","Yet from its geometry, spacetime emerges.","Watch as the fabric of reality crystallizes from pure mathematics...","Particles, forces, the very stage of physics - all emerge from the jewel.","Locality - the idea that things only affect nearby things - is not fundamental.","It's a consequence of the amplituhedron's structure.","This suggests our universe might be a hologram of something deeper."],x=()=>{if(t<v.length-1){if(n(t+1),t===1)r(!0);else if(t===2)f(!0);else if(t===5){const b=setInterval(()=>{l(w=>w<=.1?(clearInterval(b),0):w-.02)},50)}}else g(!0)};return ee.jsx(En.div,{className:"chapter chapter5",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:ee.jsxs("div",{className:"chapter-content",children:[ee.jsx(En.h2,{className:"chapter-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:"Chapter 5: Why This Changes Everything"}),ee.jsx(jm,{mode:"wait",children:ee.jsx(En.p,{className:"chapter-text",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:v[t]},t)}),ee.jsx("div",{className:"emergence-container",children:ee.jsxs(hS,{camera:{position:[0,2,8],fov:50},children:[ee.jsx("ambientLight",{intensity:.2}),ee.jsx("pointLight",{position:[10,10,10],intensity:.5}),ee.jsx("group",{position:[0,0,0],children:ee.jsx(JU,{particleCount:6,helicity:3,scale:1.2})}),ee.jsx(Kq,{visible:s,opacity:o}),ee.jsx(Qq,{active:u}),ee.jsx(QU,{radius:100,depth:50,count:2e3,factor:3,saturation:0,fade:!0,speed:.5})]})}),t>=3&&t<6&&ee.jsxs(En.div,{className:"emergence-labels",initial:{opacity:0},animate:{opacity:1},children:[ee.jsxs("div",{className:"label-item",children:[ee.jsx("div",{className:"label-dot spacetime"}),ee.jsx("span",{children:"Spacetime Grid"})]}),ee.jsxs("div",{className:"label-item",children:[ee.jsx("div",{className:"label-dot particles"}),ee.jsx("span",{children:"Quantum Particles"})]}),ee.jsxs("div",{className:"label-item",children:[ee.jsx("div",{className:"label-dot jewel"}),ee.jsx("span",{children:"The Amplituhedron"})]})]}),t<v.length-1&&ee.jsx(En.button,{className:"revelation-button",onClick:x,whileHover:{scale:1.05},whileTap:{scale:.95},children:t===2?"Watch Reality Emerge":"Continue"}),t===v.length-1&&!p&&ee.jsx(En.button,{className:"final-revelation-button",onClick:x,initial:{opacity:0},animate:{opacity:1},transition:{delay:2},whileHover:{scale:1.05},whileTap:{scale:.95},children:"The Final Truth"}),p&&ee.jsxs(En.div,{className:"final-message glass",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.8},children:[ee.jsx("h3",{className:"holographic",children:"You've Glimpsed the Truth"}),ee.jsx("p",{children:"The amplituhedron suggests that space and time are not the starting point of physics."}),ee.jsx("p",{children:"They emerge from something deeperâ€”a realm of pure mathematical relationships."}),ee.jsx("p",{children:"What we call reality might be a shadow cast by this higher-dimensional jewel."}),ee.jsxs("div",{className:"final-thought",children:[ee.jsxs("p",{className:"quote",children:['"The Universe is not only queerer than we suppose,',ee.jsx("br",{}),'but queerer than we CAN suppose."']}),ee.jsx("p",{className:"attribution",children:"- J.B.S. Haldane"})]}),ee.jsx("button",{className:"complete-button",onClick:()=>window.location.reload(),children:"Begin Again"})]}),ee.jsx("div",{className:"chapter-nav",children:ee.jsx("button",{onClick:e,children:"â† Back"})})]})})}function $q({onNext:i}){const[e,t]=_e.useState(!1);_e.useEffect(()=>{const s=setTimeout(()=>t(!0),3e3);return()=>clearTimeout(s)},[]);const n=["You're","about","to","see","something","that","took","physicists","60","years","to","find"];return ee.jsx(En.div,{className:"intro-screen",exit:{opacity:0},transition:{duration:.8},children:ee.jsxs("div",{className:"intro-content",children:[ee.jsx(En.h1,{className:"intro-title",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:1,ease:"easeOut"},children:ee.jsx("span",{className:"holographic",children:"The Amplituhedron"})}),ee.jsx(En.p,{className:"intro-subtitle",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:1},children:"An Interactive Journey from Zero to Enlightenment"}),ee.jsx("div",{className:"intro-description",children:n.map((s,r)=>ee.jsx(En.span,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.5+r*.1,duration:.5,ease:"easeOut"},className:"intro-word",style:{marginRight:"0.5rem"},children:s},r))}),e&&ee.jsx(En.button,{className:"start-button glass",onClick:i,initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},children:"Begin the Journey"}),ee.jsx(En.div,{className:"particle-field",initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:2},children:[...Array(50)].map((s,r)=>ee.jsx(En.div,{className:"particle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*10}s`,animationDuration:`${10+Math.random()*20}s`}},r))})]})})}const $U="15.1.22",CN=(i,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:i}),RN=(i,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:i}),Pw=(i,e)=>({startTime:e,type:"setValue",value:i}),eL=(i,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:i}),tL=(i,e,{startTime:t,target:n,timeConstant:s})=>n+(e-n)*Math.exp((t-i)/s),_m=i=>i.type==="exponentialRampToValue",l1=i=>i.type==="linearRampToValue",Nh=i=>_m(i)||l1(i),bE=i=>i.type==="setValue",yu=i=>i.type==="setValueCurve",c1=(i,e,t,n)=>{const s=i[e];return s===void 0?n:Nh(s)||bE(s)?s.value:yu(s)?s.values[s.values.length-1]:tL(t,c1(i,e-1,s.startTime,n),s)},DN=(i,e,t,n,s)=>t===void 0?[n.insertTime,s]:Nh(t)?[t.endTime,t.value]:bE(t)?[t.startTime,t.value]:yu(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,c1(i,e-1,t.startTime,s)],Uw=i=>i.type==="cancelAndHold",Lw=i=>i.type==="cancelScheduledValues",Rh=i=>Uw(i)||Lw(i)?i.cancelTime:_m(i)||l1(i)?i.endTime:i.startTime,NN=(i,e,t,{endTime:n,value:s})=>t===s?s:0<t&&0<s||t<0&&s<0?t*(s/t)**((i-e)/(n-e)):0,IN=(i,e,t,{endTime:n,value:s})=>t+(i-e)/(n-e)*(s-t),eX=(i,e)=>{const t=Math.floor(e),n=Math.ceil(e);return t===n?i[t]:(1-(e-t))*i[t]+(1-(n-e))*i[n]},tX=(i,{duration:e,startTime:t,values:n})=>{const s=(i-t)/e*(n.length-1);return eX(n,s)},Vx=i=>i.type==="setTarget";class nX{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Rh(e);if(Uw(e)||Lw(e)){const n=this._automationEvents.findIndex(r=>Lw(e)&&yu(r)?r.startTime+r.duration>=t:Rh(r)>=t),s=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),Uw(e)){const r=this._automationEvents[this._automationEvents.length-1];if(s!==void 0&&Nh(s)){if(r!==void 0&&Vx(r))throw new Error("The internal list is malformed.");const o=r===void 0?s.insertTime:yu(r)?r.startTime+r.duration:Rh(r),l=r===void 0?this._defaultValue:yu(r)?r.values[r.values.length-1]:r.value,u=_m(s)?NN(t,o,l,s):IN(t,o,l,s),f=_m(s)?CN(u,t,this._currenTime):RN(u,t,this._currenTime);this._automationEvents.push(f)}if(r!==void 0&&Vx(r)&&this._automationEvents.push(Pw(this.getValue(t),t)),r!==void 0&&yu(r)&&r.startTime+r.duration>t){const o=t-r.startTime,l=(r.values.length-1)/r.duration,u=Math.max(2,1+Math.ceil(o*l)),f=o/(u-1)*l,p=r.values.slice(0,u);if(f<1)for(let g=1;g<u;g+=1){const v=f*g%1;p[g]=r.values[g-1]*(1-v)+r.values[g]*v}this._automationEvents[this._automationEvents.length-1]=eL(p,r.startTime,o)}}}else{const n=this._automationEvents.findIndex(o=>Rh(o)>t),s=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(s!==void 0&&yu(s)&&Rh(s)+s.duration>t)return!1;const r=_m(e)?CN(e.value,e.endTime,this._currenTime):l1(e)?RN(e.value,t,this._currenTime):e;if(n===-1)this._automationEvents.push(r);else{if(yu(e)&&t+e.duration>Rh(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,r)}}return!0}flush(e){const t=this._automationEvents.findIndex(n=>Rh(n)>e);if(t>1){const n=this._automationEvents.slice(t-1),s=n[0];Vx(s)&&n.unshift(Pw(c1(this._automationEvents,t-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(o=>Rh(o)>e),n=this._automationEvents[t],s=(t===-1?this._automationEvents.length:t)-1,r=this._automationEvents[s];if(r!==void 0&&Vx(r)&&(n===void 0||!Nh(n)||n.insertTime>e))return tL(e,c1(this._automationEvents,s-1,r.startTime,this._defaultValue),r);if(r!==void 0&&bE(r)&&(n===void 0||!Nh(n)))return r.value;if(r!==void 0&&yu(r)&&(n===void 0||!Nh(n)||r.startTime+r.duration>e))return e<r.startTime+r.duration?tX(e,r):r.values[r.values.length-1];if(r!==void 0&&Nh(r)&&(n===void 0||!Nh(n)))return r.value;if(n!==void 0&&_m(n)){const[o,l]=DN(this._automationEvents,s,r,n,this._defaultValue);return NN(e,o,l,n)}if(n!==void 0&&l1(n)){const[o,l]=DN(this._automationEvents,s,r,n,this._defaultValue);return IN(e,o,l,n)}return this._defaultValue}}const iX=i=>({cancelTime:i,type:"cancelAndHold"}),sX=i=>({cancelTime:i,type:"cancelScheduledValues"}),rX=(i,e)=>({endTime:e,type:"exponentialRampToValue",value:i}),aX=(i,e)=>({endTime:e,type:"linearRampToValue",value:i}),oX=(i,e,t)=>({startTime:e,target:i,timeConstant:t,type:"setTarget"}),lX=()=>new DOMException("","AbortError"),cX=i=>(e,t,[n,s,r],o)=>{i(e[s],[t,n,r],l=>l[0]===t&&l[1]===n,o)},uX=i=>(e,t,n)=>{const s=[];for(let r=0;r<n.numberOfInputs;r+=1)s.push(new Set);i.set(e,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},hX=i=>(e,t)=>{i.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Fm=new WeakSet,nL=new WeakMap,SE=new WeakMap,iL=new WeakMap,ME=new WeakMap,dS=new WeakMap,sL=new WeakMap,Fw=new WeakMap,kw=new WeakMap,Bw=new WeakMap,rL={construct(){return rL}},fX=i=>{try{const e=new Proxy(i,rL);new e}catch{return!1}return!0},ON=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,PN=(i,e)=>{const t=[];let n=i.replace(/^[\s]+/,""),s=n.match(ON);for(;s!==null;){const r=s[1].slice(1,-1),o=s[0].replace(/([\s]+)?;?$/,"").replace(r,new URL(r,e).toString());t.push(o),n=n.slice(s[0].length).replace(/^[\s]+/,""),s=n.match(ON)}return[t.join(";"),n]},UN=i=>{if(i!==void 0&&!Array.isArray(i))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},LN=i=>{if(!fX(i))throw new TypeError("The given value for processorCtor should be a constructor.");if(i.prototype===null||typeof i.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},dX=(i,e,t,n,s,r,o,l,u,f,p,g,v)=>{let x=0;return(b,w,M={credentials:"omit"})=>{const S=p.get(b);if(S!==void 0&&S.has(w))return Promise.resolve();const C=f.get(b);if(C!==void 0){const D=C.get(w);if(D!==void 0)return D}const R=r(b),I=R.audioWorklet===void 0?s(w).then(([D,O])=>{const[U,k]=PN(D,O),P=`${U};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return t(P)}).then(()=>{const D=v._AWGS.pop();if(D===void 0)throw new SyntaxError;n(R.currentTime,R.sampleRate,()=>D(class{},void 0,(O,U)=>{if(O.trim()==="")throw e();const k=kw.get(R);if(k!==void 0){if(k.has(O))throw e();LN(U),UN(U.parameterDescriptors),k.set(O,U)}else LN(U),UN(U.parameterDescriptors),kw.set(R,new Map([[O,U]]))},R.sampleRate,void 0,void 0))}):Promise.all([s(w),Promise.resolve(i(g,g))]).then(([[D,O],U])=>{const k=x+1;x=k;const[P,F]=PN(D,O),K=`${P};((AudioWorkletProcessor,registerProcessor)=>{${F}
})(${U?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${U?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${U?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,te=new Blob([K],{type:"application/javascript; charset=utf-8"}),W=URL.createObjectURL(te);return R.audioWorklet.addModule(W,M).then(()=>{if(l(R))return R;const X=o(R);return X.audioWorklet.addModule(W,M).then(()=>X)}).then(X=>{if(u===null)throw new SyntaxError;try{new u(X,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(W))});return C===void 0?f.set(b,new Map([[w,I]])):C.set(w,I),I.then(()=>{const D=p.get(b);D===void 0?p.set(b,new Set([w])):D.add(w)}).finally(()=>{const D=f.get(b);D!==void 0&&D.delete(w)}),I}},Cl=(i,e)=>{const t=i.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},pS=(i,e)=>{const t=Array.from(i).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[n]=t;return i.delete(n),n},aL=(i,e,t,n)=>{const s=Cl(i,e),r=pS(s,o=>o[0]===t&&o[1]===n);return s.size===0&&i.delete(e),r},$v=i=>Cl(sL,i),km=i=>{if(Fm.has(i))throw new Error("The AudioNode is already stored.");Fm.add(i),$v(i).forEach(e=>e(!0))},oL=i=>"port"in i,ey=i=>{if(!Fm.has(i))throw new Error("The AudioNode is not stored.");Fm.delete(i),$v(i).forEach(e=>e(!1))},zw=(i,e)=>{!oL(i)&&e.every(t=>t.size===0)&&ey(i)},pX=(i,e,t,n,s,r,o,l,u,f,p,g,v)=>{const x=new WeakMap;return(b,w,M,S,C)=>{const{activeInputs:R,passiveInputs:I}=r(w),{outputs:D}=r(b),O=l(b),U=k=>{const P=u(w),F=u(b);if(k){const H=aL(I,b,M,S);i(R,b,H,!1),!C&&!g(b)&&t(F,P,M,S),v(w)&&km(w)}else{const H=n(R,b,M,S);e(I,S,H,!1),!C&&!g(b)&&s(F,P,M,S);const G=o(w);if(G===0)p(w)&&zw(w,R);else{const j=x.get(w);j!==void 0&&clearTimeout(j),x.set(w,setTimeout(()=>{p(w)&&zw(w,R)},G*1e3))}}};return f(D,[w,M,S],k=>k[0]===w&&k[1]===M&&k[2]===S,!0)?(O.add(U),p(b)?i(R,b,[M,S,U],!0):e(I,S,[b,M,U],!0),!0):!1}},mX=i=>(e,t,[n,s,r],o)=>{const l=e.get(n);l===void 0?e.set(n,new Set([[s,t,r]])):i(l,[s,t,r],u=>u[0]===s&&u[1]===t,o)},gX=i=>(e,t)=>{const n=i(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const s=()=>{t.removeEventListener("ended",s),t.disconnect(n),n.disconnect()};t.addEventListener("ended",s)},vX=i=>(e,t)=>{i(e).add(t)},yX={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},_X=(i,e,t,n,s,r)=>class extends i{constructor(l,u){const f=s(l),p={...yX,...u},g=n(f,p),v=r(f)?e():null;super(l,!1,g,v),this._nativeAnalyserNode=g}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(l){this._nativeAnalyserNode.fftSize=l}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(l){const u=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=l,!(l>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=u,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(l){const u=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=l,!(this._nativeAnalyserNode.maxDecibels>l))throw this._nativeAnalyserNode.minDecibels=u,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(l){this._nativeAnalyserNode.smoothingTimeConstant=l}getByteFrequencyData(l){this._nativeAnalyserNode.getByteFrequencyData(l)}getByteTimeDomainData(l){this._nativeAnalyserNode.getByteTimeDomainData(l)}getFloatFrequencyData(l){this._nativeAnalyserNode.getFloatFrequencyData(l)}getFloatTimeDomainData(l){this._nativeAnalyserNode.getFloatTimeDomainData(l)}},Br=(i,e)=>i.context===e,xX=(i,e,t)=>()=>{const n=new WeakMap,s=async(r,o)=>{let l=e(r);if(!Br(l,o)){const f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,fftSize:l.fftSize,maxDecibels:l.maxDecibels,minDecibels:l.minDecibels,smoothingTimeConstant:l.smoothingTimeConstant};l=i(o,f)}return n.set(o,l),await t(r,o,l),l};return{render(r,o){const l=n.get(o);return l!==void 0?Promise.resolve(l):s(r,o)}}},u1=i=>{try{i.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Rc=()=>new DOMException("","IndexSizeError"),TE=i=>{i.getChannelData=(e=>t=>{try{return e.call(i,t)}catch(n){throw n.code===12?Rc():n}})(i.getChannelData)},bX={numberOfChannels:1},SX=(i,e,t,n,s,r,o,l)=>{let u=null;return class lL{constructor(p){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:g,numberOfChannels:v,sampleRate:x}={...bX,...p};u===null&&(u=new s(1,1,44100));const b=n!==null&&e(r,r)?new n({length:g,numberOfChannels:v,sampleRate:x}):u.createBuffer(v,g,x);if(b.numberOfChannels===0)throw t();return typeof b.copyFromChannel!="function"?(o(b),TE(b)):e(u1,()=>u1(b))||l(b),i.add(b),b}static[Symbol.hasInstance](p){return p!==null&&typeof p=="object"&&Object.getPrototypeOf(p)===lL.prototype||i.has(p)}}},Ba=-34028234663852886e22,ia=-Ba,Tu=i=>Fm.has(i),MX={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},TX=(i,e,t,n,s,r,o,l)=>class extends i{constructor(f,p){const g=r(f),v={...MX,...p},x=s(g,v),b=o(g),w=b?e():null;super(f,!1,x,w),this._audioBufferSourceNodeRenderer=w,this._isBufferNullified=!1,this._isBufferSet=v.buffer!==null,this._nativeAudioBufferSourceNode=x,this._onended=null,this._playbackRate=t(this,b,x.playbackRate,ia,Ba)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(f){if(this._nativeAudioBufferSourceNode.buffer=f,f!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(f){this._nativeAudioBufferSourceNode.loop=f}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(f){this._nativeAudioBufferSourceNode.loopEnd=f}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(f){this._nativeAudioBufferSourceNode.loopStart=f}get onended(){return this._onended}set onended(f){const p=typeof f=="function"?l(this,f):null;this._nativeAudioBufferSourceNode.onended=p;const g=this._nativeAudioBufferSourceNode.onended;this._onended=g!==null&&g===p?f:g}get playbackRate(){return this._playbackRate}start(f=0,p=0,g){if(this._nativeAudioBufferSourceNode.start(f,p,g),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=g===void 0?[f,p]:[f,p,g]),this.context.state!=="closed"){km(this);const v=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",v),Tu(this)&&ey(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",v)}}stop(f=0){this._nativeAudioBufferSourceNode.stop(f),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=f)}},wX=(i,e,t,n,s)=>()=>{const r=new WeakMap;let o=null,l=null;const u=async(f,p)=>{let g=t(f);const v=Br(g,p);if(!v){const x={buffer:g.buffer,channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,loop:g.loop,loopEnd:g.loopEnd,loopStart:g.loopStart,playbackRate:g.playbackRate.value};g=e(p,x),o!==null&&g.start(...o),l!==null&&g.stop(l)}return r.set(p,g),v?await i(p,f.playbackRate,g.playbackRate):await n(p,f.playbackRate,g.playbackRate),await s(f,p,g),g};return{set start(f){o=f},set stop(f){l=f},render(f,p){const g=r.get(p);return g!==void 0?Promise.resolve(g):u(f,p)}}},AX=i=>"playbackRate"in i,EX=i=>"frequency"in i&&"gain"in i,CX=i=>"offset"in i,RX=i=>!("frequency"in i)&&"gain"in i,DX=i=>"detune"in i&&"frequency"in i&&!("gain"in i),NX=i=>"pan"in i,la=i=>Cl(nL,i),ty=i=>Cl(iL,i),Vw=(i,e)=>{const{activeInputs:t}=la(i);t.forEach(s=>s.forEach(([r])=>{e.includes(i)||Vw(r,[...e,i])}));const n=AX(i)?[i.playbackRate]:oL(i)?Array.from(i.parameters.values()):EX(i)?[i.Q,i.detune,i.frequency,i.gain]:CX(i)?[i.offset]:RX(i)?[i.gain]:DX(i)?[i.detune,i.frequency]:NX(i)?[i.pan]:[];for(const s of n){const r=ty(s);r!==void 0&&r.activeInputs.forEach(([o])=>Vw(o,e))}Tu(i)&&ey(i)},cL=i=>{Vw(i.destination,[])},IX=i=>i===void 0||typeof i=="number"||typeof i=="string"&&(i==="balanced"||i==="interactive"||i==="playback"),OX=(i,e,t,n,s,r,o,l,u)=>class extends i{constructor(p={}){if(u===null)throw new Error("Missing the native AudioContext constructor.");let g;try{g=new u(p)}catch(b){throw b.code===12&&b.message==="sampleRate is not in range"?t():b}if(g===null)throw n();if(!IX(p.latencyHint))throw new TypeError(`The provided value '${p.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(p.sampleRate!==void 0&&g.sampleRate!==p.sampleRate)throw t();super(g,2);const{latencyHint:v}=p,{sampleRate:x}=g;if(this._baseLatency=typeof g.baseLatency=="number"?g.baseLatency:v==="balanced"?512/x:v==="interactive"||v===void 0?256/x:v==="playback"?1024/x:Math.max(2,Math.min(128,Math.round(v*x/128)))*128/x,this._nativeAudioContext=g,u.name==="webkitAudioContext"?(this._nativeGainNode=g.createGain(),this._nativeOscillatorNode=g.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(g.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,g.state==="running"){this._state="suspended";const b=()=>{this._state==="suspended"&&(this._state=null),g.removeEventListener("statechange",b)};g.addEventListener("statechange",b)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),cL(this)}))}createMediaElementSource(p){return new s(this,{mediaElement:p})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(p){return new o(this,{mediaStream:p})}createMediaStreamTrackSource(p){return new l(this,{mediaStreamTrack:p})}resume(){return this._state==="suspended"?new Promise((p,g)=>{const v=()=>{this._nativeAudioContext.removeEventListener("statechange",v),this._nativeAudioContext.state==="running"?p():this.resume().then(p,g)};this._nativeAudioContext.addEventListener("statechange",v)}):this._nativeAudioContext.resume().catch(p=>{throw p===void 0||p.code===15?e():p})}suspend(){return this._nativeAudioContext.suspend().catch(p=>{throw p===void 0?e():p})}},PX=(i,e,t,n,s,r,o,l)=>class extends i{constructor(f,p){const g=r(f),v=o(g),x=s(g,p,v),b=v?e(l):null;super(f,!1,x,b),this._isNodeOfNativeOfflineAudioContext=v,this._nativeAudioDestinationNode=x}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(f){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(f>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=f}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(f){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=f}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},UX=i=>{const e=new WeakMap,t=async(n,s)=>{const r=s.destination;return e.set(s,r),await i(n,s,r),r};return{render(n,s){const r=e.get(s);return r!==void 0?Promise.resolve(r):t(n,s)}}},LX=(i,e,t,n,s,r,o,l)=>(u,f)=>{const p=f.listener,g=()=>{const D=new Float32Array(1),O=e(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),U=o(f);let k=!1,P=[0,0,-1,0,1,0],F=[0,0,0];const H=()=>{if(k)return;k=!0;const te=n(f,256,9,0);te.onaudioprocess=({inputBuffer:W})=>{const X=[r(W,D,0),r(W,D,1),r(W,D,2),r(W,D,3),r(W,D,4),r(W,D,5)];X.some((ne,ie)=>ne!==P[ie])&&(p.setOrientation(...X),P=X);const oe=[r(W,D,6),r(W,D,7),r(W,D,8)];oe.some((ne,ie)=>ne!==F[ie])&&(p.setPosition(...oe),F=oe)},O.connect(te)},G=te=>W=>{W!==P[te]&&(P[te]=W,p.setOrientation(...P))},j=te=>W=>{W!==F[te]&&(F[te]=W,p.setPosition(...F))},K=(te,W,X)=>{const oe=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:W});oe.connect(O,0,te),oe.start(),Object.defineProperty(oe.offset,"defaultValue",{get(){return W}});const ne=i({context:u},U,oe.offset,ia,Ba);return l(ne,"value",ie=>()=>ie.call(ne),ie=>B=>{try{ie.call(ne,B)}catch(Q){if(Q.code!==9)throw Q}H(),U&&X(B)}),ne.cancelAndHoldAtTime=(ie=>U?()=>{throw s()}:(...B)=>{const Q=ie.apply(ne,B);return H(),Q})(ne.cancelAndHoldAtTime),ne.cancelScheduledValues=(ie=>U?()=>{throw s()}:(...B)=>{const Q=ie.apply(ne,B);return H(),Q})(ne.cancelScheduledValues),ne.exponentialRampToValueAtTime=(ie=>U?()=>{throw s()}:(...B)=>{const Q=ie.apply(ne,B);return H(),Q})(ne.exponentialRampToValueAtTime),ne.linearRampToValueAtTime=(ie=>U?()=>{throw s()}:(...B)=>{const Q=ie.apply(ne,B);return H(),Q})(ne.linearRampToValueAtTime),ne.setTargetAtTime=(ie=>U?()=>{throw s()}:(...B)=>{const Q=ie.apply(ne,B);return H(),Q})(ne.setTargetAtTime),ne.setValueAtTime=(ie=>U?()=>{throw s()}:(...B)=>{const Q=ie.apply(ne,B);return H(),Q})(ne.setValueAtTime),ne.setValueCurveAtTime=(ie=>U?()=>{throw s()}:(...B)=>{const Q=ie.apply(ne,B);return H(),Q})(ne.setValueCurveAtTime),ne};return{forwardX:K(0,0,G(0)),forwardY:K(1,0,G(1)),forwardZ:K(2,-1,G(2)),positionX:K(6,0,j(0)),positionY:K(7,0,j(1)),positionZ:K(8,0,j(2)),upX:K(3,0,G(3)),upY:K(4,1,G(4)),upZ:K(5,0,G(5))}},{forwardX:v,forwardY:x,forwardZ:b,positionX:w,positionY:M,positionZ:S,upX:C,upY:R,upZ:I}=p.forwardX===void 0?g():p;return{get forwardX(){return v},get forwardY(){return x},get forwardZ(){return b},get positionX(){return w},get positionY(){return M},get positionZ(){return S},get upX(){return C},get upY(){return R},get upZ(){return I}}},h1=i=>"context"in i,ny=i=>h1(i[0]),Ud=(i,e,t,n)=>{for(const s of i)if(t(s)){if(n)return!1;throw Error("The set contains at least one similar element.")}return i.add(e),!0},FN=(i,e,[t,n],s)=>{Ud(i,[e,t,n],r=>r[0]===e&&r[1]===t,s)},kN=(i,[e,t,n],s)=>{const r=i.get(e);r===void 0?i.set(e,new Set([[t,n]])):Ud(r,[t,n],o=>o[0]===t,s)},Jm=i=>"inputs"in i,f1=(i,e,t,n)=>{if(Jm(e)){const s=e.inputs[n];return i.connect(s,t,0),[s,t,0]}return i.connect(e,t,n),[e,t,n]},uL=(i,e,t)=>{for(const n of i)if(n[0]===e&&n[1]===t)return i.delete(n),n;return null},FX=(i,e,t)=>pS(i,n=>n[0]===e&&n[1]===t),hL=(i,e)=>{if(!$v(i).delete(e))throw new Error("Missing the expected event listener.")},fL=(i,e,t)=>{const n=Cl(i,e),s=pS(n,r=>r[0]===t);return n.size===0&&i.delete(e),s},d1=(i,e,t,n)=>{Jm(e)?i.disconnect(e.inputs[n],t,0):i.disconnect(e,t,n)},Di=i=>Cl(SE,i),Iv=i=>Cl(ME,i),Ed=i=>Fw.has(i),tb=i=>!Fm.has(i),BN=(i,e)=>new Promise(t=>{if(e!==null)t(!0);else{const n=i.createScriptProcessor(256,1,1),s=i.createGain(),r=i.createBuffer(1,2,44100),o=r.getChannelData(0);o[0]=1,o[1]=1;const l=i.createBufferSource();l.buffer=r,l.loop=!0,l.connect(n).connect(i.destination),l.connect(s),l.disconnect(s),n.onaudioprocess=u=>{const f=u.inputBuffer.getChannelData(0);Array.prototype.some.call(f,p=>p===1)?t(!0):t(!1),l.stop(),n.onaudioprocess=null,l.disconnect(n),n.disconnect(i.destination)},l.start()}}),FT=(i,e)=>{const t=new Map;for(const n of i)for(const s of n){const r=t.get(s);t.set(s,r===void 0?1:r+1)}t.forEach((n,s)=>e(s,n))},p1=i=>"context"in i,kX=i=>{const e=new Map;i.connect=(t=>(n,s=0,r=0)=>{const o=p1(n)?t(n,s,r):t(n,s),l=e.get(n);return l===void 0?e.set(n,[{input:r,output:s}]):l.every(u=>u.input!==r||u.output!==s)&&l.push({input:r,output:s}),o})(i.connect.bind(i)),i.disconnect=(t=>(n,s,r)=>{if(t.apply(i),n===void 0)e.clear();else if(typeof n=="number")for(const[o,l]of e){const u=l.filter(f=>f.output!==n);u.length===0?e.delete(o):e.set(o,u)}else if(e.has(n))if(s===void 0)e.delete(n);else{const o=e.get(n);if(o!==void 0){const l=o.filter(u=>u.output!==s&&(u.input!==r||r===void 0));l.length===0?e.delete(n):e.set(n,l)}}for(const[o,l]of e)l.forEach(u=>{p1(o)?i.connect(o,u.output,u.input):i.connect(o,u.output)})})(i.disconnect)},BX=(i,e,t,n)=>{const{activeInputs:s,passiveInputs:r}=ty(e),{outputs:o}=la(i),l=$v(i),u=f=>{const p=Di(i),g=Iv(e);if(f){const v=fL(r,i,t);FN(s,i,v,!1),!n&&!Ed(i)&&p.connect(g,t)}else{const v=FX(s,i,t);kN(r,v,!1),!n&&!Ed(i)&&p.disconnect(g,t)}};return Ud(o,[e,t],f=>f[0]===e&&f[1]===t,!0)?(l.add(u),Tu(i)?FN(s,i,[t,u],!0):kN(r,[i,t,u],!0),!0):!1},zX=(i,e,t,n)=>{const{activeInputs:s,passiveInputs:r}=la(e),o=uL(s[n],i,t);return o===null?[aL(r,i,t,n)[2],!1]:[o[2],!0]},VX=(i,e,t)=>{const{activeInputs:n,passiveInputs:s}=ty(e),r=uL(n,i,t);return r===null?[fL(s,i,t)[1],!1]:[r[2],!0]},wE=(i,e,t,n,s)=>{const[r,o]=zX(i,t,n,s);if(r!==null&&(hL(i,r),o&&!e&&!Ed(i)&&d1(Di(i),Di(t),n,s)),Tu(t)){const{activeInputs:l}=la(t);zw(t,l)}},AE=(i,e,t,n)=>{const[s,r]=VX(i,t,n);s!==null&&(hL(i,s),r&&!e&&!Ed(i)&&Di(i).disconnect(Iv(t),n))},GX=(i,e)=>{const t=la(i),n=[];for(const s of t.outputs)ny(s)?wE(i,e,...s):AE(i,e,...s),n.push(s[0]);return t.outputs.clear(),n},HX=(i,e,t)=>{const n=la(i),s=[];for(const r of n.outputs)r[1]===t&&(ny(r)?wE(i,e,...r):AE(i,e,...r),s.push(r[0]),n.outputs.delete(r));return s},WX=(i,e,t,n,s)=>{const r=la(i);return Array.from(r.outputs).filter(o=>o[0]===t&&(n===void 0||o[1]===n)&&(s===void 0||o[2]===s)).map(o=>(ny(o)?wE(i,e,...o):AE(i,e,...o),r.outputs.delete(o),o[0]))},jX=(i,e,t,n,s,r,o,l,u,f,p,g,v,x,b,w)=>class extends f{constructor(S,C,R,I){super(R),this._context=S,this._nativeAudioNode=R;const D=p(S);g(D)&&t(BN,()=>BN(D,w))!==!0&&kX(R),SE.set(this,R),sL.set(this,new Set),S.state!=="closed"&&C&&km(this),i(this,I,R)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(S){this._nativeAudioNode.channelCount=S}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(S){this._nativeAudioNode.channelCountMode=S}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(S){this._nativeAudioNode.channelInterpretation=S}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(S,C=0,R=0){if(C<0||C>=this._nativeAudioNode.numberOfOutputs)throw s();const I=p(this._context),D=b(I);if(v(S)||x(S))throw r();if(h1(S)){const k=Di(S);try{const F=f1(this._nativeAudioNode,k,C,R),H=tb(this);(D||H)&&this._nativeAudioNode.disconnect(...F),this.context.state!=="closed"&&!H&&tb(S)&&km(S)}catch(F){throw F.code===12?r():F}if(e(this,S,C,R,D)){const F=u([this],S);FT(F,n(D))}return S}const O=Iv(S);if(O.name==="playbackRate"&&O.maxValue===1024)throw o();try{this._nativeAudioNode.connect(O,C),(D||tb(this))&&this._nativeAudioNode.disconnect(O,C)}catch(k){throw k.code===12?r():k}if(BX(this,S,C,D)){const k=u([this],S);FT(k,n(D))}}disconnect(S,C,R){let I;const D=p(this._context),O=b(D);if(S===void 0)I=GX(this,O);else if(typeof S=="number"){if(S<0||S>=this.numberOfOutputs)throw s();I=HX(this,O,S)}else{if(C!==void 0&&(C<0||C>=this.numberOfOutputs)||h1(S)&&R!==void 0&&(R<0||R>=S.numberOfInputs))throw s();if(I=WX(this,O,S,C,R),I.length===0)throw r()}for(const U of I){const k=u([this],U);FT(k,l)}}},qX=(i,e,t,n,s,r,o,l,u,f,p,g,v)=>(x,b,w,M=null,S=null)=>{const C=w.value,R=new nX(C),I=b?n(R):null,D={get defaultValue(){return C},get maxValue(){return M===null?w.maxValue:M},get minValue(){return S===null?w.minValue:S},get value(){return w.value},set value(O){w.value=O,D.setValueAtTime(O,x.context.currentTime)},cancelAndHoldAtTime(O){if(typeof w.cancelAndHoldAtTime=="function")I===null&&R.flush(x.context.currentTime),R.add(s(O)),w.cancelAndHoldAtTime(O);else{const U=Array.from(R).pop();I===null&&R.flush(x.context.currentTime),R.add(s(O));const k=Array.from(R).pop();w.cancelScheduledValues(O),U!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?w.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?w.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?w.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&w.setValueCurveAtTime(k.values,k.startTime,k.duration))}return D},cancelScheduledValues(O){return I===null&&R.flush(x.context.currentTime),R.add(r(O)),w.cancelScheduledValues(O),D},exponentialRampToValueAtTime(O,U){if(O===0)throw new RangeError;if(!Number.isFinite(U)||U<0)throw new RangeError;const k=x.context.currentTime;return I===null&&R.flush(k),Array.from(R).length===0&&(R.add(f(C,k)),w.setValueAtTime(C,k)),R.add(o(O,U)),w.exponentialRampToValueAtTime(O,U),D},linearRampToValueAtTime(O,U){const k=x.context.currentTime;return I===null&&R.flush(k),Array.from(R).length===0&&(R.add(f(C,k)),w.setValueAtTime(C,k)),R.add(l(O,U)),w.linearRampToValueAtTime(O,U),D},setTargetAtTime(O,U,k){return I===null&&R.flush(x.context.currentTime),R.add(u(O,U,k)),w.setTargetAtTime(O,U,k),D},setValueAtTime(O,U){return I===null&&R.flush(x.context.currentTime),R.add(f(O,U)),w.setValueAtTime(O,U),D},setValueCurveAtTime(O,U,k){const P=O instanceof Float32Array?O:new Float32Array(O);if(g!==null&&g.name==="webkitAudioContext"){const F=U+k,H=x.context.sampleRate,G=Math.ceil(U*H),j=Math.floor(F*H),K=j-G,te=new Float32Array(K);for(let X=0;X<K;X+=1){const oe=(P.length-1)/k*((G+X)/H-U),ne=Math.floor(oe),ie=Math.ceil(oe);te[X]=ne===ie?P[ne]:(1-(oe-ne))*P[ne]+(1-(ie-oe))*P[ie]}I===null&&R.flush(x.context.currentTime),R.add(p(te,U,k)),w.setValueCurveAtTime(te,U,k);const W=j/H;W<F&&v(D,te[te.length-1],W),v(D,P[P.length-1],F)}else I===null&&R.flush(x.context.currentTime),R.add(p(P,U,k)),w.setValueCurveAtTime(P,U,k);return D}};return t.set(D,w),e.set(D,x),i(D,I),D},XX=i=>({replay(e){for(const t of i)if(t.type==="exponentialRampToValue"){const{endTime:n,value:s}=t;e.exponentialRampToValueAtTime(s,n)}else if(t.type==="linearRampToValue"){const{endTime:n,value:s}=t;e.linearRampToValueAtTime(s,n)}else if(t.type==="setTarget"){const{startTime:n,target:s,timeConstant:r}=t;e.setTargetAtTime(s,n,r)}else if(t.type==="setValue"){const{startTime:n,value:s}=t;e.setValueAtTime(s,n)}else if(t.type==="setValueCurve"){const{duration:n,startTime:s,values:r}=t;e.setValueCurveAtTime(r,s,n)}else throw new Error("Can't apply an unknown automation.")}});class dL{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((n,s)=>e.call(t,n,s,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const YX={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},ZX=(i,e,t,n,s,r,o,l,u,f,p,g,v,x)=>class extends e{constructor(w,M,S){var C;const R=l(w),I=u(R),D=p({...YX,...S});v(D);const O=kw.get(R),U=O?.get(M),k=I||R.state!=="closed"?R:(C=o(R))!==null&&C!==void 0?C:R,P=s(k,I?null:w.baseLatency,f,M,U,D),F=I?n(M,D,U):null;super(w,!0,P,F);const H=[];P.parameters.forEach((j,K)=>{const te=t(this,I,j);H.push([K,te])}),this._nativeAudioWorkletNode=P,this._onprocessorerror=null,this._parameters=new dL(H),I&&i(R,this);const{activeInputs:G}=r(this);g(P,G)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(w){const M=typeof w=="function"?x(this,w):null;this._nativeAudioWorkletNode.onprocessorerror=M;const S=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=S!==null&&S===M?w:S}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function m1(i,e,t,n,s){if(typeof i.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),i.copyFromChannel(e[t],n,s);else{const r=i.getChannelData(n);if(e[t].byteLength===0)e[t]=r.slice(s,s+128);else{const o=new Float32Array(r.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(o)}}}const pL=(i,e,t,n,s)=>{typeof i.copyToChannel=="function"?e[t].byteLength!==0&&i.copyToChannel(e[t],n,s):e[t].byteLength!==0&&i.getChannelData(n).set(e[t],s)},g1=(i,e)=>{const t=[];for(let n=0;n<i;n+=1){const s=[],r=typeof e=="number"?e:e[n];for(let o=0;o<r;o+=1)s.push(new Float32Array(128));t.push(s)}return t},KX=(i,e)=>{const t=Cl(Bw,i),n=Di(e);return Cl(t,n)},QX=async(i,e,t,n,s,r,o)=>{const l=e===null?Math.ceil(i.context.length/128)*128:e.length,u=n.channelCount*n.numberOfInputs,f=s.reduce((M,S)=>M+S,0),p=f===0?null:t.createBuffer(f,l,t.sampleRate);if(r===void 0)throw new Error("Missing the processor constructor.");const g=la(i),v=await KX(t,i),x=g1(n.numberOfInputs,n.channelCount),b=g1(n.numberOfOutputs,s),w=Array.from(i.parameters.keys()).reduce((M,S)=>({...M,[S]:new Float32Array(128)}),{});for(let M=0;M<l;M+=128){if(n.numberOfInputs>0&&e!==null)for(let S=0;S<n.numberOfInputs;S+=1)for(let C=0;C<n.channelCount;C+=1)m1(e,x[S],C,C,M);r.parameterDescriptors!==void 0&&e!==null&&r.parameterDescriptors.forEach(({name:S},C)=>{m1(e,w,S,u+C,M)});for(let S=0;S<n.numberOfInputs;S+=1)for(let C=0;C<s[S];C+=1)b[S][C].byteLength===0&&(b[S][C]=new Float32Array(128));try{const S=x.map((R,I)=>g.activeInputs[I].size===0?[]:R),C=o(M/t.sampleRate,t.sampleRate,()=>v.process(S,b,w));if(p!==null)for(let R=0,I=0;R<n.numberOfOutputs;R+=1){for(let D=0;D<s[R];D+=1)pL(p,b[R],D,I+D,M);I+=s[R]}if(!C)break}catch(S){i.dispatchEvent(new ErrorEvent("processorerror",{colno:S.colno,filename:S.filename,lineno:S.lineno,message:S.message}));break}}return p},JX=(i,e,t,n,s,r,o,l,u,f,p,g,v,x,b,w)=>(M,S,C)=>{const R=new WeakMap;let I=null;const D=async(O,U)=>{let k=p(O),P=null;const F=Br(k,U),H=Array.isArray(S.outputChannelCount)?S.outputChannelCount:Array.from(S.outputChannelCount);if(g===null){const G=H.reduce((W,X)=>W+X,0),j=s(U,{channelCount:Math.max(1,G),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,G)}),K=[];for(let W=0;W<O.numberOfOutputs;W+=1)K.push(n(U,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:H[W]}));const te=o(U,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1});te.connect=e.bind(null,K),te.disconnect=u.bind(null,K),P=[j,K,te]}else F||(k=new g(U,M));if(R.set(U,P===null?k:P[2]),P!==null){if(I===null){if(C===void 0)throw new Error("Missing the processor constructor.");if(v===null)throw new Error("Missing the native OfflineAudioContext constructor.");const X=O.channelCount*O.numberOfInputs,oe=C.parameterDescriptors===void 0?0:C.parameterDescriptors.length,ne=X+oe;I=QX(O,ne===0?null:await(async()=>{const B=new v(ne,Math.ceil(O.context.length/128)*128,U.sampleRate),Q=[],ae=[];for(let se=0;se<S.numberOfInputs;se+=1)Q.push(o(B,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1})),ae.push(s(B,{channelCount:S.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:S.channelCount}));const fe=await Promise.all(Array.from(O.parameters.values()).map(async se=>{const ce=r(B,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:se.value});return await x(B,se,ce.offset),ce})),de=n(B,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,X+oe)});for(let se=0;se<S.numberOfInputs;se+=1){Q[se].connect(ae[se]);for(let ce=0;ce<S.channelCount;ce+=1)ae[se].connect(de,ce,se*S.channelCount+ce)}for(const[se,ce]of fe.entries())ce.connect(de,0,X+se),ce.start(0);return de.connect(B.destination),await Promise.all(Q.map(se=>b(O,B,se))),w(B)})(),U,S,H,C,f)}const G=await I,j=t(U,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[K,te,W]=P;G!==null&&(j.buffer=G,j.start(0)),j.connect(K);for(let X=0,oe=0;X<O.numberOfOutputs;X+=1){const ne=te[X];for(let ie=0;ie<H[X];ie+=1)K.connect(ne,oe+ie,ie);oe+=H[X]}return W}if(F)for(const[G,j]of O.parameters.entries())await i(U,j,k.parameters.get(G));else for(const[G,j]of O.parameters.entries())await x(U,j,k.parameters.get(G));return await b(O,U,k),k};return{render(O,U){l(U,O);const k=R.get(U);return k!==void 0?Promise.resolve(k):D(O,U)}}},$X=(i,e,t,n,s,r,o,l,u,f,p,g,v,x,b,w,M,S,C,R)=>class extends b{constructor(D,O){super(D,O),this._nativeContext=D,this._audioWorklet=i===void 0?void 0:{addModule:(U,k)=>i(this,U,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(D,O,U){return new t({length:O,numberOfChannels:D,sampleRate:U})}createBufferSource(){return new n(this)}createChannelMerger(D=6){return new r(this,{numberOfInputs:D})}createChannelSplitter(D=6){return new o(this,{numberOfOutputs:D})}createConstantSource(){return new l(this)}createConvolver(){return new u(this)}createDelay(D=1){return new p(this,{maxDelayTime:D})}createDynamicsCompressor(){return new g(this)}createGain(){return new v(this)}createIIRFilter(D,O){return new x(this,{feedback:O,feedforward:D})}createOscillator(){return new w(this)}createPanner(){return new M(this)}createPeriodicWave(D,O,U={disableNormalization:!1}){return new S(this,{...U,imag:O,real:D})}createStereoPanner(){return new C(this)}createWaveShaper(){return new R(this)}decodeAudioData(D,O,U){return f(this._nativeContext,D).then(k=>(typeof O=="function"&&O(k),k),k=>{throw typeof U=="function"&&U(k),k})}},eY={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},tY=(i,e,t,n,s,r,o,l)=>class extends i{constructor(f,p){const g=r(f),v={...eY,...p},x=s(g,v),b=o(g),w=b?t():null;super(f,!1,x,w),this._Q=e(this,b,x.Q,ia,Ba),this._detune=e(this,b,x.detune,1200*Math.log2(ia),-1200*Math.log2(ia)),this._frequency=e(this,b,x.frequency,f.sampleRate/2,0),this._gain=e(this,b,x.gain,40*Math.log10(ia),Ba),this._nativeBiquadFilterNode=x,l(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(f){this._nativeBiquadFilterNode.type=f}getFrequencyResponse(f,p,g){try{this._nativeBiquadFilterNode.getFrequencyResponse(f,p,g)}catch(v){throw v.code===11?n():v}if(f.length!==p.length||p.length!==g.length)throw n()}},nY=(i,e,t,n,s)=>()=>{const r=new WeakMap,o=async(l,u)=>{let f=t(l);const p=Br(f,u);if(!p){const g={Q:f.Q.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,gain:f.gain.value,type:f.type};f=e(u,g)}return r.set(u,f),p?(await i(u,l.Q,f.Q),await i(u,l.detune,f.detune),await i(u,l.frequency,f.frequency),await i(u,l.gain,f.gain)):(await n(u,l.Q,f.Q),await n(u,l.detune,f.detune),await n(u,l.frequency,f.frequency),await n(u,l.gain,f.gain)),await s(l,u,f),f};return{render(l,u){const f=r.get(u);return f!==void 0?Promise.resolve(f):o(l,u)}}},iY=(i,e)=>(t,n)=>{const s=e.get(t);if(s!==void 0)return s;const r=i.get(t);if(r!==void 0)return r;try{const o=n();return o instanceof Promise?(i.set(t,o),o.catch(()=>!1).then(l=>(i.delete(t),e.set(t,l),l))):(e.set(t,o),o)}catch{return e.set(t,!1),!1}},sY={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},rY=(i,e,t,n,s)=>class extends i{constructor(o,l){const u=n(o),f={...sY,...l},p=t(u,f),g=s(u)?e():null;super(o,!1,p,g)}},aY=(i,e,t)=>()=>{const n=new WeakMap,s=async(r,o)=>{let l=e(r);if(!Br(l,o)){const f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,numberOfInputs:l.numberOfInputs};l=i(o,f)}return n.set(o,l),await t(r,o,l),l};return{render(r,o){const l=n.get(o);return l!==void 0?Promise.resolve(l):s(r,o)}}},oY={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},lY=(i,e,t,n,s,r)=>class extends i{constructor(l,u){const f=n(l),p=r({...oY,...u}),g=t(f,p),v=s(f)?e():null;super(l,!1,g,v)}},cY=(i,e,t)=>()=>{const n=new WeakMap,s=async(r,o)=>{let l=e(r);if(!Br(l,o)){const f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,numberOfOutputs:l.numberOfOutputs};l=i(o,f)}return n.set(o,l),await t(r,o,l),l};return{render(r,o){const l=n.get(o);return l!==void 0?Promise.resolve(l):s(r,o)}}},uY=i=>(e,t,n)=>i(t,e,n),hY=i=>(e,t,n=0,s=0)=>{const r=e[n];if(r===void 0)throw i();return p1(t)?r.connect(t,0,s):r.connect(t,0)},fY=i=>(e,t)=>{const n=i(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return n.buffer=s,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},dY={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},pY=(i,e,t,n,s,r,o)=>class extends i{constructor(u,f){const p=s(u),g={...dY,...f},v=n(p,g),x=r(p),b=x?t():null;super(u,!1,v,b),this._constantSourceNodeRenderer=b,this._nativeConstantSourceNode=v,this._offset=e(this,x,v.offset,ia,Ba),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(u){const f=typeof u=="function"?o(this,u):null;this._nativeConstantSourceNode.onended=f;const p=this._nativeConstantSourceNode.onended;this._onended=p!==null&&p===f?u:p}start(u=0){if(this._nativeConstantSourceNode.start(u),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=u),this.context.state!=="closed"){km(this);const f=()=>{this._nativeConstantSourceNode.removeEventListener("ended",f),Tu(this)&&ey(this)};this._nativeConstantSourceNode.addEventListener("ended",f)}}stop(u=0){this._nativeConstantSourceNode.stop(u),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=u)}},mY=(i,e,t,n,s)=>()=>{const r=new WeakMap;let o=null,l=null;const u=async(f,p)=>{let g=t(f);const v=Br(g,p);if(!v){const x={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,offset:g.offset.value};g=e(p,x),o!==null&&g.start(o),l!==null&&g.stop(l)}return r.set(p,g),v?await i(p,f.offset,g.offset):await n(p,f.offset,g.offset),await s(f,p,g),g};return{set start(f){o=f},set stop(f){l=f},render(f,p){const g=r.get(p);return g!==void 0?Promise.resolve(g):u(f,p)}}},gY=i=>e=>(i[0]=e,i[0]),vY={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},yY=(i,e,t,n,s,r)=>class extends i{constructor(l,u){const f=n(l),p={...vY,...u},g=t(f,p),x=s(f)?e():null;super(l,!1,g,x),this._isBufferNullified=!1,this._nativeConvolverNode=g,p.buffer!==null&&r(this,p.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(l){if(this._nativeConvolverNode.buffer=l,l===null&&this._nativeConvolverNode.buffer!==null){const u=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=u.createBuffer(1,1,u.sampleRate),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(l){this._nativeConvolverNode.normalize=l}},_Y=(i,e,t)=>()=>{const n=new WeakMap,s=async(r,o)=>{let l=e(r);if(!Br(l,o)){const f={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,disableNormalization:!l.normalize};l=i(o,f)}return n.set(o,l),Jm(l)?await t(r,o,l.inputs[0]):await t(r,o,l),l};return{render(r,o){const l=n.get(o);return l!==void 0?Promise.resolve(l):s(r,o)}}},xY=(i,e)=>(t,n,s)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,s)}catch(r){throw r.name==="SyntaxError"?i():r}},bY=()=>new DOMException("","DataCloneError"),zN=i=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const s=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>s();try{e.postMessage(i,[i])}catch{}finally{s()}})},SY=(i,e,t,n,s,r,o,l,u,f,p)=>(g,v)=>{const x=o(g)?g:r(g);if(s.has(v)){const b=t();return Promise.reject(b)}try{s.add(v)}catch{}return e(u,()=>u(x))?x.decodeAudioData(v).then(b=>(zN(v).catch(()=>{}),e(l,()=>l(b))||p(b),i.add(b),b)):new Promise((b,w)=>{const M=async()=>{try{await zN(v)}catch{}},S=C=>{w(C),M()};try{x.decodeAudioData(v,C=>{typeof C.copyFromChannel!="function"&&(f(C),TE(C)),i.add(C),M().then(()=>b(C))},C=>{S(C===null?n():C)})}catch(C){S(C)}})},MY=(i,e,t,n,s,r,o,l)=>(u,f)=>{const p=e.get(u);if(p===void 0)throw new Error("Missing the expected cycle count.");const g=r(u.context),v=l(g);if(p===f){if(e.delete(u),!v&&o(u)){const x=n(u),{outputs:b}=t(u);for(const w of b)if(ny(w)){const M=n(w[0]);i(x,M,w[1],w[2])}else{const M=s(w[0]);x.connect(M,w[1])}}}else e.set(u,p-f)},TY={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},wY=(i,e,t,n,s,r,o)=>class extends i{constructor(u,f){const p=s(u),g={...TY,...f},v=n(p,g),x=r(p),b=x?t(g.maxDelayTime):null;super(u,!1,v,b),this._delayTime=e(this,x,v.delayTime),o(this,g.maxDelayTime)}get delayTime(){return this._delayTime}},AY=(i,e,t,n,s)=>r=>{const o=new WeakMap,l=async(u,f)=>{let p=t(u);const g=Br(p,f);if(!g){const v={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,delayTime:p.delayTime.value,maxDelayTime:r};p=e(f,v)}return o.set(f,p),g?await i(f,u.delayTime,p.delayTime):await n(f,u.delayTime,p.delayTime),await s(u,f,p),p};return{render(u,f){const p=o.get(f);return p!==void 0?Promise.resolve(p):l(u,f)}}},EY=i=>(e,t,n,s)=>i(e[s],r=>r[0]===t&&r[1]===n),CY=i=>(e,t)=>{i(e).delete(t)},RY=i=>"delayTime"in i,DY=(i,e,t)=>function n(s,r){const o=h1(r)?r:t(i,r);if(RY(o))return[];if(s[0]===o)return[s];if(s.includes(o))return[];const{outputs:l}=e(o);return Array.from(l).map(u=>n([...s,o],u[0])).reduce((u,f)=>u.concat(f),[])},Gx=(i,e,t)=>{const n=e[t];if(n===void 0)throw i();return n},NY=i=>(e,t=void 0,n=void 0,s=0)=>t===void 0?e.forEach(r=>r.disconnect()):typeof t=="number"?Gx(i,e,t).disconnect():p1(t)?n===void 0?e.forEach(r=>r.disconnect(t)):s===void 0?Gx(i,e,n).disconnect(t,0):Gx(i,e,n).disconnect(t,0,s):n===void 0?e.forEach(r=>r.disconnect(t)):Gx(i,e,n).disconnect(t,0),IY={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},OY=(i,e,t,n,s,r,o,l)=>class extends i{constructor(f,p){const g=r(f),v={...IY,...p},x=n(g,v),b=o(g),w=b?t():null;super(f,!1,x,w),this._attack=e(this,b,x.attack),this._knee=e(this,b,x.knee),this._nativeDynamicsCompressorNode=x,this._ratio=e(this,b,x.ratio),this._release=e(this,b,x.release),this._threshold=e(this,b,x.threshold),l(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(f){const p=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=f,f>2)throw this._nativeDynamicsCompressorNode.channelCount=p,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(f){const p=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=f,f==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=p,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},PY=(i,e,t,n,s)=>()=>{const r=new WeakMap,o=async(l,u)=>{let f=t(l);const p=Br(f,u);if(!p){const g={attack:f.attack.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,knee:f.knee.value,ratio:f.ratio.value,release:f.release.value,threshold:f.threshold.value};f=e(u,g)}return r.set(u,f),p?(await i(u,l.attack,f.attack),await i(u,l.knee,f.knee),await i(u,l.ratio,f.ratio),await i(u,l.release,f.release),await i(u,l.threshold,f.threshold)):(await n(u,l.attack,f.attack),await n(u,l.knee,f.knee),await n(u,l.ratio,f.ratio),await n(u,l.release,f.release),await n(u,l.threshold,f.threshold)),await s(l,u,f),f};return{render(l,u){const f=r.get(u);return f!==void 0?Promise.resolve(f):o(l,u)}}},UY=()=>new DOMException("","EncodingError"),LY=i=>e=>new Promise((t,n)=>{if(i===null){n(new SyntaxError);return}const s=i.document.head;if(s===null)n(new SyntaxError);else{const r=i.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),l=URL.createObjectURL(o),u=i.onerror,f=()=>{i.onerror=u,URL.revokeObjectURL(l)};i.onerror=(p,g,v,x,b)=>{if(g===l||g===i.location.href&&v===1&&x===1)return f(),n(b),!1;if(u!==null)return u(p,g,v,x,b)},r.onerror=()=>{f(),n(new SyntaxError)},r.onload=()=>{f(),t()},r.src=l,r.type="module",s.appendChild(r)}}),FY=i=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,s){if(n!==null){let r=this._listeners.get(n);r===void 0&&(r=i(this,n),typeof n=="function"&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(t,r,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,s){const r=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,r===void 0?null:r,s)}},kY=i=>(e,t,n)=>{Object.defineProperties(i,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return n()}finally{i!==null&&(delete i.currentFrame,delete i.currentTime)}},BY=i=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw i()},zY={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},VY=(i,e,t,n,s,r)=>class extends i{constructor(l,u){const f=s(l),p={...zY,...u},g=n(f,p),v=r(f),x=v?t():null;super(l,!1,g,x),this._gain=e(this,v,g.gain,ia,Ba)}get gain(){return this._gain}},GY=(i,e,t,n,s)=>()=>{const r=new WeakMap,o=async(l,u)=>{let f=t(l);const p=Br(f,u);if(!p){const g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:f.gain.value};f=e(u,g)}return r.set(u,f),p?await i(u,l.gain,f.gain):await n(u,l.gain,f.gain),await s(l,u,f),f};return{render(l,u){const f=r.get(u);return f!==void 0?Promise.resolve(f):o(l,u)}}},HY=(i,e)=>t=>e(i,t),WY=i=>e=>{const t=i(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},jY=i=>e=>{var t;return(t=i.get(e))!==null&&t!==void 0?t:0},qY=i=>e=>{const t=i(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},XY=i=>e=>i.get(e),tr=()=>new DOMException("","InvalidStateError"),YY=i=>e=>{const t=i.get(e);if(t===void 0)throw tr();return t},ZY=(i,e)=>t=>{let n=i.get(t);if(n!==void 0)return n;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),i.set(t,n),n},KY=i=>e=>{const t=i.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},mS=()=>new DOMException("","InvalidAccessError"),QY=i=>{i.getFrequencyResponse=(e=>(t,n,s)=>{if(t.length!==n.length||n.length!==s.length)throw mS();return e.call(i,t,n,s)})(i.getFrequencyResponse)},JY={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},$Y=(i,e,t,n,s,r)=>class extends i{constructor(l,u){const f=n(l),p=s(f),g={...JY,...u},v=e(f,p?null:l.baseLatency,g),x=p?t(g.feedback,g.feedforward):null;super(l,!1,v,x),QY(v),this._nativeIIRFilterNode=v,r(this,1)}getFrequencyResponse(l,u,f){return this._nativeIIRFilterNode.getFrequencyResponse(l,u,f)}},mL=(i,e,t,n,s,r,o,l,u,f,p)=>{const g=f.length;let v=l;for(let x=0;x<g;x+=1){let b=t[0]*f[x];for(let w=1;w<s;w+=1){const M=v-w&u-1;b+=t[w]*r[M],b-=i[w]*o[M]}for(let w=s;w<n;w+=1)b+=t[w]*r[v-w&u-1];for(let w=s;w<e;w+=1)b-=i[w]*o[v-w&u-1];r[v]=f[x],o[v]=b,v=v+1&u-1,p[x]=b}return v},eZ=(i,e,t,n)=>{const s=t instanceof Float64Array?t:new Float64Array(t),r=n instanceof Float64Array?n:new Float64Array(n),o=s.length,l=r.length,u=Math.min(o,l);if(s[0]!==1){for(let b=0;b<o;b+=1)r[b]/=s[0];for(let b=1;b<l;b+=1)s[b]/=s[0]}const f=32,p=new Float32Array(f),g=new Float32Array(f),v=e.createBuffer(i.numberOfChannels,i.length,i.sampleRate),x=i.numberOfChannels;for(let b=0;b<x;b+=1){const w=i.getChannelData(b),M=v.getChannelData(b);p.fill(0),g.fill(0),mL(s,o,r,l,u,p,g,0,f,w,M)}return v},tZ=(i,e,t,n,s)=>(r,o)=>{const l=new WeakMap;let u=null;const f=async(p,g)=>{let v=null,x=e(p);const b=Br(x,g);if(g.createIIRFilter===void 0?v=i(g,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):b||(x=g.createIIRFilter(o,r)),l.set(g,v===null?x:v),v!==null){if(u===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const M=new t(p.context.destination.channelCount,p.context.length,g.sampleRate);u=(async()=>{await n(p,M,M.destination);const S=await s(M);return eZ(S,g,r,o)})()}const w=await u;return v.buffer=w,v.start(0),v}return await n(p,g,x),x};return{render(p,g){const v=l.get(g);return v!==void 0?Promise.resolve(v):f(p,g)}}},nZ=(i,e,t,n,s,r)=>o=>(l,u)=>{const f=i.get(l);if(f===void 0){if(!o&&r(l)){const p=n(l),{outputs:g}=t(l);for(const v of g)if(ny(v)){const x=n(v[0]);e(p,x,v[1],v[2])}else{const x=s(v[0]);p.disconnect(x,v[1])}}i.set(l,u)}else i.set(l,f+u)},iZ=(i,e)=>t=>{const n=i.get(t);return e(n)||e(t)},sZ=(i,e)=>t=>i.has(t)||e(t),rZ=(i,e)=>t=>i.has(t)||e(t),aZ=(i,e)=>t=>{const n=i.get(t);return e(n)||e(t)},oZ=i=>e=>i!==null&&e instanceof i,lZ=i=>e=>i!==null&&typeof i.AudioNode=="function"&&e instanceof i.AudioNode,cZ=i=>e=>i!==null&&typeof i.AudioParam=="function"&&e instanceof i.AudioParam,uZ=(i,e)=>t=>i(t)||e(t),hZ=i=>e=>i!==null&&e instanceof i,fZ=i=>i!==null&&i.isSecureContext,dZ=(i,e,t,n)=>class extends i{constructor(r,o){const l=t(r),u=e(l,o);if(n(l))throw TypeError();super(r,!0,u,null),this._nativeMediaElementAudioSourceNode=u}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},pZ={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},mZ=(i,e,t,n)=>class extends i{constructor(r,o){const l=t(r);if(n(l))throw new TypeError;const u={...pZ,...o},f=e(l,u);super(r,!1,f,null),this._nativeMediaStreamAudioDestinationNode=f}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},gZ=(i,e,t,n)=>class extends i{constructor(r,o){const l=t(r),u=e(l,o);if(n(l))throw new TypeError;super(r,!0,u,null),this._nativeMediaStreamAudioSourceNode=u}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},vZ=(i,e,t)=>class extends i{constructor(s,r){const o=t(s),l=e(o,r);super(s,!0,l,null)}},yZ=(i,e,t,n,s,r)=>class extends t{constructor(l,u){super(l),this._nativeContext=l,dS.set(this,l),n(l)&&s.set(l,new Set),this._destination=new i(this,u),this._listener=e(this,l),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(l){const u=typeof l=="function"?r(this,l):null;this._nativeContext.onstatechange=u;const f=this._nativeContext.onstatechange;this._onstatechange=f!==null&&f===u?l:f}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Ov=i=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=i.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},_Z=(i,e)=>(t,n,s)=>{const r=new Set;return t.connect=(o=>(l,u=0,f=0)=>{const p=r.size===0;if(e(l))return o.call(t,l,u,f),i(r,[l,u,f],g=>g[0]===l&&g[1]===u&&g[2]===f,!0),p&&n(),l;o.call(t,l,u),i(r,[l,u],g=>g[0]===l&&g[1]===u,!0),p&&n()})(t.connect),t.disconnect=(o=>(l,u,f)=>{const p=r.size>0;if(l===void 0)o.apply(t),r.clear();else if(typeof l=="number"){o.call(t,l);for(const v of r)v[1]===l&&r.delete(v)}else{e(l)?o.call(t,l,u,f):o.call(t,l,u);for(const v of r)v[0]===l&&(u===void 0||v[1]===u)&&(f===void 0||v[2]===f)&&r.delete(v)}const g=r.size===0;p&&g&&s()})(t.disconnect),t},Fi=(i,e,t)=>{const n=e[t];n!==void 0&&n!==i[t]&&(i[t]=n)},Vs=(i,e)=>{Fi(i,e,"channelCount"),Fi(i,e,"channelCountMode"),Fi(i,e,"channelInterpretation")},VN=i=>typeof i.getFloatTimeDomainData=="function",xZ=i=>{i.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);i.getByteTimeDomainData(t);const n=Math.max(t.length,i.fftSize);for(let s=0;s<n;s+=1)e[s]=(t[s]-128)*.0078125;return e}},bZ=(i,e)=>(t,n)=>{const s=t.createAnalyser();if(Vs(s,n),!(n.maxDecibels>n.minDecibels))throw e();return Fi(s,n,"fftSize"),Fi(s,n,"maxDecibels"),Fi(s,n,"minDecibels"),Fi(s,n,"smoothingTimeConstant"),i(VN,()=>VN(s))||xZ(s),s},SZ=i=>i===null?null:i.hasOwnProperty("AudioBuffer")?i.AudioBuffer:null,as=(i,e,t)=>{const n=e[t];n!==void 0&&n!==i[t].value&&(i[t].value=n)},MZ=i=>{i.start=(e=>{let t=!1;return(n=0,s=0,r)=>{if(t)throw tr();e.call(i,n,s,r),t=!0}})(i.start)},EE=i=>{i.start=(e=>(t=0,n=0,s)=>{if(typeof s=="number"&&s<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(i,t,n,s)})(i.start)},CE=i=>{i.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(i,t)})(i.stop)},TZ=(i,e,t,n,s,r,o,l,u,f,p)=>(g,v)=>{const x=g.createBufferSource();return Vs(x,v),as(x,v,"playbackRate"),Fi(x,v,"buffer"),Fi(x,v,"loop"),Fi(x,v,"loopEnd"),Fi(x,v,"loopStart"),e(t,()=>t(g))||MZ(x),e(n,()=>n(g))||u(x),e(s,()=>s(g))||f(x,g),e(r,()=>r(g))||EE(x),e(o,()=>o(g))||p(x,g),e(l,()=>l(g))||CE(x),i(g,x),x},wZ=i=>i===null?null:i.hasOwnProperty("AudioContext")?i.AudioContext:i.hasOwnProperty("webkitAudioContext")?i.webkitAudioContext:null,AZ=(i,e)=>(t,n,s)=>{const r=t.destination;if(r.channelCount!==n)try{r.channelCount=n}catch{}s&&r.channelCountMode!=="explicit"&&(r.channelCountMode="explicit"),r.maxChannelCount===0&&Object.defineProperty(r,"maxChannelCount",{value:n});const o=i(t,{channelCount:n,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return e(o,"channelCount",l=>()=>l.call(o),l=>u=>{l.call(o,u);try{r.channelCount=u}catch(f){if(u>r.maxChannelCount)throw f}}),e(o,"channelCountMode",l=>()=>l.call(o),l=>u=>{l.call(o,u),r.channelCountMode=u}),e(o,"channelInterpretation",l=>()=>l.call(o),l=>u=>{l.call(o,u),r.channelInterpretation=u}),Object.defineProperty(o,"maxChannelCount",{get:()=>r.maxChannelCount}),o.connect(r),o},EZ=i=>i===null?null:i.hasOwnProperty("AudioWorkletNode")?i.AudioWorkletNode:null,CZ=i=>{const{port1:e}=new MessageChannel;try{e.postMessage(i)}finally{e.close()}},RZ=(i,e,t,n,s)=>(r,o,l,u,f,p)=>{if(l!==null)try{const g=new l(r,u,p),v=new Map;let x=null;if(Object.defineProperties(g,{channelCount:{get:()=>p.channelCount,set:()=>{throw i()}},channelCountMode:{get:()=>"explicit",set:()=>{throw i()}},onprocessorerror:{get:()=>x,set:b=>{typeof x=="function"&&g.removeEventListener("processorerror",x),x=typeof b=="function"?b:null,typeof x=="function"&&g.addEventListener("processorerror",x)}}}),g.addEventListener=(b=>(...w)=>{if(w[0]==="processorerror"){const M=typeof w[1]=="function"?w[1]:typeof w[1]=="object"&&w[1]!==null&&typeof w[1].handleEvent=="function"?w[1].handleEvent:null;if(M!==null){const S=v.get(w[1]);S!==void 0?w[1]=S:(w[1]=C=>{C.type==="error"?(Object.defineProperties(C,{type:{value:"processorerror"}}),M(C)):M(new ErrorEvent(w[0],{...C}))},v.set(M,w[1]))}}return b.call(g,"error",w[1],w[2]),b.call(g,...w)})(g.addEventListener),g.removeEventListener=(b=>(...w)=>{if(w[0]==="processorerror"){const M=v.get(w[1]);M!==void 0&&(v.delete(w[1]),w[1]=M)}return b.call(g,"error",w[1],w[2]),b.call(g,w[0],w[1],w[2])})(g.removeEventListener),p.numberOfOutputs!==0){const b=t(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return g.connect(b).connect(r.destination),s(g,()=>b.disconnect(),()=>b.connect(r.destination))}return g}catch(g){throw g.code===11?n():g}if(f===void 0)throw n();return CZ(p),e(r,o,f,p)},gL=(i,e)=>i===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(i*e))))),DZ=i=>new Promise((e,t)=>{const{port1:n,port2:s}=new MessageChannel;n.onmessage=({data:r})=>{n.close(),s.close(),e(r)},n.onmessageerror=({data:r})=>{n.close(),s.close(),t(r)},s.postMessage(i)}),NZ=async(i,e)=>{const t=await DZ(e);return new i(t)},IZ=(i,e,t,n)=>{let s=Bw.get(i);s===void 0&&(s=new WeakMap,Bw.set(i,s));const r=NZ(t,n);return s.set(e,r),r},OZ=(i,e,t,n,s,r,o,l,u,f,p,g,v)=>(x,b,w,M)=>{if(M.numberOfInputs===0&&M.numberOfOutputs===0)throw u();const S=Array.isArray(M.outputChannelCount)?M.outputChannelCount:Array.from(M.outputChannelCount);if(S.some(ge=>ge<1))throw u();if(S.length!==M.numberOfOutputs)throw e();if(M.channelCountMode!=="explicit")throw u();const C=M.channelCount*M.numberOfInputs,R=S.reduce((ge,ye)=>ge+ye,0),I=w.parameterDescriptors===void 0?0:w.parameterDescriptors.length;if(C+I>6||R>6)throw u();const D=new MessageChannel,O=[],U=[];for(let ge=0;ge<M.numberOfInputs;ge+=1)O.push(o(x,{channelCount:M.channelCount,channelCountMode:M.channelCountMode,channelInterpretation:M.channelInterpretation,gain:1})),U.push(s(x,{channelCount:M.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:M.channelCount}));const k=[];if(w.parameterDescriptors!==void 0)for(const{defaultValue:ge,maxValue:ye,minValue:Ge,name:Y}of w.parameterDescriptors){const Be=r(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:M.parameterData[Y]!==void 0?M.parameterData[Y]:ge===void 0?0:ge});Object.defineProperties(Be.offset,{defaultValue:{get:()=>ge===void 0?0:ge},maxValue:{get:()=>ye===void 0?ia:ye},minValue:{get:()=>Ge===void 0?Ba:Ge}}),k.push(Be)}const P=n(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,C+I)}),F=gL(b,x.sampleRate),H=l(x,F,C+I,Math.max(1,R)),G=s(x,{channelCount:Math.max(1,R),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,R)}),j=[];for(let ge=0;ge<M.numberOfOutputs;ge+=1)j.push(n(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[ge]}));for(let ge=0;ge<M.numberOfInputs;ge+=1){O[ge].connect(U[ge]);for(let ye=0;ye<M.channelCount;ye+=1)U[ge].connect(P,ye,ge*M.channelCount+ye)}const K=new dL(w.parameterDescriptors===void 0?[]:w.parameterDescriptors.map(({name:ge},ye)=>{const Ge=k[ye];return Ge.connect(P,0,C+ye),Ge.start(0),[ge,Ge.offset]}));P.connect(H);let te=M.channelInterpretation,W=null;const X=M.numberOfOutputs===0?[H]:j,oe={get bufferSize(){return F},get channelCount(){return M.channelCount},set channelCount(ge){throw t()},get channelCountMode(){return M.channelCountMode},set channelCountMode(ge){throw t()},get channelInterpretation(){return te},set channelInterpretation(ge){for(const ye of O)ye.channelInterpretation=ge;te=ge},get context(){return H.context},get inputs(){return O},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get onprocessorerror(){return W},set onprocessorerror(ge){typeof W=="function"&&oe.removeEventListener("processorerror",W),W=typeof ge=="function"?ge:null,typeof W=="function"&&oe.addEventListener("processorerror",W)},get parameters(){return K},get port(){return D.port2},addEventListener(...ge){return H.addEventListener(ge[0],ge[1],ge[2])},connect:i.bind(null,X),disconnect:f.bind(null,X),dispatchEvent(...ge){return H.dispatchEvent(ge[0])},removeEventListener(...ge){return H.removeEventListener(ge[0],ge[1],ge[2])}},ne=new Map;D.port1.addEventListener=(ge=>(...ye)=>{if(ye[0]==="message"){const Ge=typeof ye[1]=="function"?ye[1]:typeof ye[1]=="object"&&ye[1]!==null&&typeof ye[1].handleEvent=="function"?ye[1].handleEvent:null;if(Ge!==null){const Y=ne.get(ye[1]);Y!==void 0?ye[1]=Y:(ye[1]=Be=>{p(x.currentTime,x.sampleRate,()=>Ge(Be))},ne.set(Ge,ye[1]))}}return ge.call(D.port1,ye[0],ye[1],ye[2])})(D.port1.addEventListener),D.port1.removeEventListener=(ge=>(...ye)=>{if(ye[0]==="message"){const Ge=ne.get(ye[1]);Ge!==void 0&&(ne.delete(ye[1]),ye[1]=Ge)}return ge.call(D.port1,ye[0],ye[1],ye[2])})(D.port1.removeEventListener);let ie=null;Object.defineProperty(D.port1,"onmessage",{get:()=>ie,set:ge=>{typeof ie=="function"&&D.port1.removeEventListener("message",ie),ie=typeof ge=="function"?ge:null,typeof ie=="function"&&(D.port1.addEventListener("message",ie),D.port1.start())}}),w.prototype.port=D.port1;let B=null;IZ(x,oe,w,M).then(ge=>B=ge);const ae=g1(M.numberOfInputs,M.channelCount),fe=g1(M.numberOfOutputs,S),de=w.parameterDescriptors===void 0?[]:w.parameterDescriptors.reduce((ge,{name:ye})=>({...ge,[ye]:new Float32Array(128)}),{});let se=!0;const ce=()=>{M.numberOfOutputs>0&&H.disconnect(G);for(let ge=0,ye=0;ge<M.numberOfOutputs;ge+=1){const Ge=j[ge];for(let Y=0;Y<S[ge];Y+=1)G.disconnect(Ge,ye+Y,Y);ye+=S[ge]}},pe=new Map;H.onaudioprocess=({inputBuffer:ge,outputBuffer:ye})=>{if(B!==null){const Ge=g(oe);for(let Y=0;Y<F;Y+=128){for(let Be=0;Be<M.numberOfInputs;Be+=1)for(let Ne=0;Ne<M.channelCount;Ne+=1)m1(ge,ae[Be],Ne,Ne,Y);w.parameterDescriptors!==void 0&&w.parameterDescriptors.forEach(({name:Be},Ne)=>{m1(ge,de,Be,C+Ne,Y)});for(let Be=0;Be<M.numberOfInputs;Be+=1)for(let Ne=0;Ne<S[Be];Ne+=1)fe[Be][Ne].byteLength===0&&(fe[Be][Ne]=new Float32Array(128));try{const Be=ae.map((Me,Oe)=>{if(Ge[Oe].size>0)return pe.set(Oe,F/128),Me;const V=pe.get(Oe);return V===void 0?[]:(Me.every(ue=>ue.every(Re=>Re===0))&&(V===1?pe.delete(Oe):pe.set(Oe,V-1)),Me)});se=p(x.currentTime+Y/x.sampleRate,x.sampleRate,()=>B.process(Be,fe,de));for(let Me=0,Oe=0;Me<M.numberOfOutputs;Me+=1){for(let q=0;q<S[Me];q+=1)pL(ye,fe[Me],q,Oe+q,Y);Oe+=S[Me]}}catch(Be){se=!1,oe.dispatchEvent(new ErrorEvent("processorerror",{colno:Be.colno,filename:Be.filename,lineno:Be.lineno,message:Be.message}))}if(!se){for(let Be=0;Be<M.numberOfInputs;Be+=1){O[Be].disconnect(U[Be]);for(let Ne=0;Ne<M.channelCount;Ne+=1)U[Y].disconnect(P,Ne,Be*M.channelCount+Ne)}if(w.parameterDescriptors!==void 0){const Be=w.parameterDescriptors.length;for(let Ne=0;Ne<Be;Ne+=1){const Me=k[Ne];Me.disconnect(P,0,C+Ne),Me.stop()}}P.disconnect(H),H.onaudioprocess=null,Ie?ce():qe();break}}}};let Ie=!1;const Ye=o(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),et=()=>H.connect(Ye).connect(x.destination),qe=()=>{H.disconnect(Ye),Ye.disconnect()},dt=()=>{if(se){qe(),M.numberOfOutputs>0&&H.connect(G);for(let ge=0,ye=0;ge<M.numberOfOutputs;ge+=1){const Ge=j[ge];for(let Y=0;Y<S[ge];Y+=1)G.connect(Ge,ye+Y,Y);ye+=S[ge]}}Ie=!0},De=()=>{se&&(et(),ce()),Ie=!1};return et(),v(oe,dt,De)},vL=(i,e)=>{const t=i.createBiquadFilter();return Vs(t,e),as(t,e,"Q"),as(t,e,"detune"),as(t,e,"frequency"),as(t,e,"gain"),Fi(t,e,"type"),t},PZ=(i,e)=>(t,n)=>{const s=t.createChannelMerger(n.numberOfInputs);return i!==null&&i.name==="webkitAudioContext"&&e(t,s),Vs(s,n),s},UZ=i=>{const e=i.numberOfOutputs;Object.defineProperty(i,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw tr()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw tr()}}),Object.defineProperty(i,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw tr()}})},iy=(i,e)=>{const t=i.createChannelSplitter(e.numberOfOutputs);return Vs(t,e),UZ(t),t},LZ=(i,e,t,n,s)=>(r,o)=>{if(r.createConstantSource===void 0)return t(r,o);const l=r.createConstantSource();return Vs(l,o),as(l,o,"offset"),e(n,()=>n(r))||EE(l),e(s,()=>s(r))||CE(l),i(r,l),l},$m=(i,e)=>(i.connect=e.connect.bind(e),i.disconnect=e.disconnect.bind(e),i),FZ=(i,e,t,n)=>(s,{offset:r,...o})=>{const l=s.createBuffer(1,2,44100),u=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),f=t(s,{...o,gain:r}),p=l.getChannelData(0);p[0]=1,p[1]=1,u.buffer=l,u.loop=!0;const g={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(b){f.channelCount=b},get channelCountMode(){return f.channelCountMode},set channelCountMode(b){f.channelCountMode=b},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(b){f.channelInterpretation=b},get context(){return f.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get offset(){return f.gain},get onended(){return u.onended},set onended(b){u.onended=b},addEventListener(...b){return u.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return u.dispatchEvent(b[0])},removeEventListener(...b){return u.removeEventListener(b[0],b[1],b[2])},start(b=0){u.start.call(u,b)},stop(b=0){u.stop.call(u,b)}},v=()=>u.connect(f),x=()=>u.disconnect(f);return i(s,u),n($m(g,f),v,x)},kZ=(i,e)=>(t,n)=>{const s=t.createConvolver();if(Vs(s,n),n.disableNormalization===s.normalize&&(s.normalize=!n.disableNormalization),Fi(s,n,"buffer"),n.channelCount>2||(e(s,"channelCount",r=>()=>r.call(s),r=>o=>{if(o>2)throw i();return r.call(s,o)}),n.channelCountMode==="max"))throw i();return e(s,"channelCountMode",r=>()=>r.call(s),r=>o=>{if(o==="max")throw i();return r.call(s,o)}),s},yL=(i,e)=>{const t=i.createDelay(e.maxDelayTime);return Vs(t,e),as(t,e,"delayTime"),t},BZ=i=>(e,t)=>{const n=e.createDynamicsCompressor();if(Vs(n,t),t.channelCount>2||t.channelCountMode==="max")throw i();return as(n,t,"attack"),as(n,t,"knee"),as(n,t,"ratio"),as(n,t,"release"),as(n,t,"threshold"),n},ja=(i,e)=>{const t=i.createGain();return Vs(t,e),as(t,e,"gain"),t},zZ=i=>(e,t,n)=>{if(e.createIIRFilter===void 0)return i(e,t,n);const s=e.createIIRFilter(n.feedforward,n.feedback);return Vs(s,n),s};function VZ(i,e){const t=e[0]*e[0]+e[1]*e[1];return[(i[0]*e[0]+i[1]*e[1])/t,(i[1]*e[0]-i[0]*e[1])/t]}function GZ(i,e){return[i[0]*e[0]-i[1]*e[1],i[0]*e[1]+i[1]*e[0]]}function GN(i,e){let t=[0,0];for(let n=i.length-1;n>=0;n-=1)t=GZ(t,e),t[0]+=i[n];return t}const HZ=(i,e,t,n)=>(s,r,{channelCount:o,channelCountMode:l,channelInterpretation:u,feedback:f,feedforward:p})=>{const g=gL(r,s.sampleRate),v=f instanceof Float64Array?f:new Float64Array(f),x=p instanceof Float64Array?p:new Float64Array(p),b=v.length,w=x.length,M=Math.min(b,w);if(b===0||b>20)throw n();if(v[0]===0)throw e();if(w===0||w>20)throw n();if(x[0]===0)throw e();if(v[0]!==1){for(let k=0;k<w;k+=1)x[k]/=v[0];for(let k=1;k<b;k+=1)v[k]/=v[0]}const S=t(s,g,o,o);S.channelCount=o,S.channelCountMode=l,S.channelInterpretation=u;const C=32,R=[],I=[],D=[];for(let k=0;k<o;k+=1){R.push(0);const P=new Float32Array(C),F=new Float32Array(C);P.fill(0),F.fill(0),I.push(P),D.push(F)}S.onaudioprocess=k=>{const P=k.inputBuffer,F=k.outputBuffer,H=P.numberOfChannels;for(let G=0;G<H;G+=1){const j=P.getChannelData(G),K=F.getChannelData(G);R[G]=mL(v,b,x,w,M,I[G],D[G],R[G],C,j,K)}};const O=s.sampleRate/2;return $m({get bufferSize(){return g},get channelCount(){return S.channelCount},set channelCount(k){S.channelCount=k},get channelCountMode(){return S.channelCountMode},set channelCountMode(k){S.channelCountMode=k},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(k){S.channelInterpretation=k},get context(){return S.context},get inputs(){return[S]},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},addEventListener(...k){return S.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return S.dispatchEvent(k[0])},getFrequencyResponse(k,P,F){if(k.length!==P.length||P.length!==F.length)throw i();const H=k.length;for(let G=0;G<H;G+=1){const j=-Math.PI*(k[G]/O),K=[Math.cos(j),Math.sin(j)],te=GN(x,K),W=GN(v,K),X=VZ(te,W);P[G]=Math.sqrt(X[0]*X[0]+X[1]*X[1]),F[G]=Math.atan2(X[1],X[0])}},removeEventListener(...k){return S.removeEventListener(k[0],k[1],k[2])}},S)},WZ=(i,e)=>i.createMediaElementSource(e.mediaElement),jZ=(i,e)=>{const t=i.createMediaStreamDestination();return Vs(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},qZ=(i,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((r,o)=>r.id<o.id?-1:r.id>o.id?1:0);const n=t.slice(0,1),s=i.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(s,"mediaStream",{value:e}),s},XZ=(i,e)=>(t,{mediaStreamTrack:n})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(n);const s=new MediaStream([n]),r=t.createMediaStreamSource(s);if(n.kind!=="audio")throw i();if(e(t))throw new TypeError;return r},YZ=i=>i===null?null:i.hasOwnProperty("OfflineAudioContext")?i.OfflineAudioContext:i.hasOwnProperty("webkitOfflineAudioContext")?i.webkitOfflineAudioContext:null,ZZ=(i,e,t,n,s,r)=>(o,l)=>{const u=o.createOscillator();return Vs(u,l),as(u,l,"detune"),as(u,l,"frequency"),l.periodicWave!==void 0?u.setPeriodicWave(l.periodicWave):Fi(u,l,"type"),e(t,()=>t(o))||EE(u),e(n,()=>n(o))||r(u,o),e(s,()=>s(o))||CE(u),i(o,u),u},KZ=i=>(e,t)=>{const n=e.createPanner();return n.orientationX===void 0?i(e,t):(Vs(n,t),as(n,t,"orientationX"),as(n,t,"orientationY"),as(n,t,"orientationZ"),as(n,t,"positionX"),as(n,t,"positionY"),as(n,t,"positionZ"),Fi(n,t,"coneInnerAngle"),Fi(n,t,"coneOuterAngle"),Fi(n,t,"coneOuterGain"),Fi(n,t,"distanceModel"),Fi(n,t,"maxDistance"),Fi(n,t,"panningModel"),Fi(n,t,"refDistance"),Fi(n,t,"rolloffFactor"),n)},QZ=(i,e,t,n,s,r,o,l,u,f)=>(p,{coneInnerAngle:g,coneOuterAngle:v,coneOuterGain:x,distanceModel:b,maxDistance:w,orientationX:M,orientationY:S,orientationZ:C,panningModel:R,positionX:I,positionY:D,positionZ:O,refDistance:U,rolloffFactor:k,...P})=>{const F=p.createPanner();if(P.channelCount>2||P.channelCountMode==="max")throw o();Vs(F,P);const H={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},G=t(p,{...H,channelInterpretation:"speakers",numberOfInputs:6}),j=n(p,{...P,gain:1}),K=n(p,{...H,gain:1}),te=n(p,{...H,gain:0}),W=n(p,{...H,gain:0}),X=n(p,{...H,gain:0}),oe=n(p,{...H,gain:0}),ne=n(p,{...H,gain:0}),ie=s(p,256,6,1),B=r(p,{...H,curve:new Float32Array([1,1]),oversample:"none"});let Q=[M,S,C],ae=[I,D,O];const fe=new Float32Array(1);ie.onaudioprocess=({inputBuffer:pe})=>{const Ie=[u(pe,fe,0),u(pe,fe,1),u(pe,fe,2)];Ie.some((et,qe)=>et!==Q[qe])&&(F.setOrientation(...Ie),Q=Ie);const Ye=[u(pe,fe,3),u(pe,fe,4),u(pe,fe,5)];Ye.some((et,qe)=>et!==ae[qe])&&(F.setPosition(...Ye),ae=Ye)},Object.defineProperty(te.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0}),Object.defineProperty(oe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ne.gain,"defaultValue",{get:()=>0});const de={get bufferSize(){},get channelCount(){return F.channelCount},set channelCount(pe){if(pe>2)throw o();j.channelCount=pe,F.channelCount=pe},get channelCountMode(){return F.channelCountMode},set channelCountMode(pe){if(pe==="max")throw o();j.channelCountMode=pe,F.channelCountMode=pe},get channelInterpretation(){return F.channelInterpretation},set channelInterpretation(pe){j.channelInterpretation=pe,F.channelInterpretation=pe},get coneInnerAngle(){return F.coneInnerAngle},set coneInnerAngle(pe){F.coneInnerAngle=pe},get coneOuterAngle(){return F.coneOuterAngle},set coneOuterAngle(pe){F.coneOuterAngle=pe},get coneOuterGain(){return F.coneOuterGain},set coneOuterGain(pe){if(pe<0||pe>1)throw e();F.coneOuterGain=pe},get context(){return F.context},get distanceModel(){return F.distanceModel},set distanceModel(pe){F.distanceModel=pe},get inputs(){return[j]},get maxDistance(){return F.maxDistance},set maxDistance(pe){if(pe<0)throw new RangeError;F.maxDistance=pe},get numberOfInputs(){return F.numberOfInputs},get numberOfOutputs(){return F.numberOfOutputs},get orientationX(){return K.gain},get orientationY(){return te.gain},get orientationZ(){return W.gain},get panningModel(){return F.panningModel},set panningModel(pe){F.panningModel=pe},get positionX(){return X.gain},get positionY(){return oe.gain},get positionZ(){return ne.gain},get refDistance(){return F.refDistance},set refDistance(pe){if(pe<0)throw new RangeError;F.refDistance=pe},get rolloffFactor(){return F.rolloffFactor},set rolloffFactor(pe){if(pe<0)throw new RangeError;F.rolloffFactor=pe},addEventListener(...pe){return j.addEventListener(pe[0],pe[1],pe[2])},dispatchEvent(...pe){return j.dispatchEvent(pe[0])},removeEventListener(...pe){return j.removeEventListener(pe[0],pe[1],pe[2])}};g!==de.coneInnerAngle&&(de.coneInnerAngle=g),v!==de.coneOuterAngle&&(de.coneOuterAngle=v),x!==de.coneOuterGain&&(de.coneOuterGain=x),b!==de.distanceModel&&(de.distanceModel=b),w!==de.maxDistance&&(de.maxDistance=w),M!==de.orientationX.value&&(de.orientationX.value=M),S!==de.orientationY.value&&(de.orientationY.value=S),C!==de.orientationZ.value&&(de.orientationZ.value=C),R!==de.panningModel&&(de.panningModel=R),I!==de.positionX.value&&(de.positionX.value=I),D!==de.positionY.value&&(de.positionY.value=D),O!==de.positionZ.value&&(de.positionZ.value=O),U!==de.refDistance&&(de.refDistance=U),k!==de.rolloffFactor&&(de.rolloffFactor=k),(Q[0]!==1||Q[1]!==0||Q[2]!==0)&&F.setOrientation(...Q),(ae[0]!==0||ae[1]!==0||ae[2]!==0)&&F.setPosition(...ae);const se=()=>{j.connect(F),i(j,B,0,0),B.connect(K).connect(G,0,0),B.connect(te).connect(G,0,1),B.connect(W).connect(G,0,2),B.connect(X).connect(G,0,3),B.connect(oe).connect(G,0,4),B.connect(ne).connect(G,0,5),G.connect(ie).connect(p.destination)},ce=()=>{j.disconnect(F),l(j,B,0,0),B.disconnect(K),K.disconnect(G),B.disconnect(te),te.disconnect(G),B.disconnect(W),W.disconnect(G),B.disconnect(X),X.disconnect(G),B.disconnect(oe),oe.disconnect(G),B.disconnect(ne),ne.disconnect(G),G.disconnect(ie),ie.disconnect(p.destination)};return f($m(de,F),se,ce)},JZ=i=>(e,{disableNormalization:t,imag:n,real:s})=>{const r=n instanceof Float32Array?n:new Float32Array(n),o=s instanceof Float32Array?s:new Float32Array(s),l=e.createPeriodicWave(o,r,{disableNormalization:t});if(Array.from(n).length<2)throw i();return l},sy=(i,e,t,n)=>i.createScriptProcessor(e,t,n),$Z=(i,e)=>(t,n)=>{const s=n.channelCountMode;if(s==="clamped-max")throw e();if(t.createStereoPanner===void 0)return i(t,n);const r=t.createStereoPanner();return Vs(r,n),as(r,n,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>s,set:o=>{if(o!==s)throw e()}}),r},eK=(i,e,t,n,s,r)=>{const l=new Float32Array([1,1]),u=Math.PI/2,f={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},p={...f,oversample:"none"},g=(b,w,M,S)=>{const C=new Float32Array(16385),R=new Float32Array(16385);for(let P=0;P<16385;P+=1){const F=P/16384*u;C[P]=Math.cos(F),R[P]=Math.sin(F)}const I=t(b,{...f,gain:0}),D=n(b,{...p,curve:C}),O=n(b,{...p,curve:l}),U=t(b,{...f,gain:0}),k=n(b,{...p,curve:R});return{connectGraph(){w.connect(I),w.connect(O.inputs===void 0?O:O.inputs[0]),w.connect(U),O.connect(M),M.connect(D.inputs===void 0?D:D.inputs[0]),M.connect(k.inputs===void 0?k:k.inputs[0]),D.connect(I.gain),k.connect(U.gain),I.connect(S,0,0),U.connect(S,0,1)},disconnectGraph(){w.disconnect(I),w.disconnect(O.inputs===void 0?O:O.inputs[0]),w.disconnect(U),O.disconnect(M),M.disconnect(D.inputs===void 0?D:D.inputs[0]),M.disconnect(k.inputs===void 0?k:k.inputs[0]),D.disconnect(I.gain),k.disconnect(U.gain),I.disconnect(S,0,0),U.disconnect(S,0,1)}}},v=(b,w,M,S)=>{const C=new Float32Array(16385),R=new Float32Array(16385),I=new Float32Array(16385),D=new Float32Array(16385),O=Math.floor(16385/2);for(let X=0;X<16385;X+=1)if(X>O){const oe=(X-O)/(16384-O)*u;C[X]=Math.cos(oe),R[X]=Math.sin(oe),I[X]=0,D[X]=1}else{const oe=X/(16384-O)*u;C[X]=1,R[X]=0,I[X]=Math.cos(oe),D[X]=Math.sin(oe)}const U=e(b,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=t(b,{...f,gain:0}),P=n(b,{...p,curve:C}),F=t(b,{...f,gain:0}),H=n(b,{...p,curve:R}),G=n(b,{...p,curve:l}),j=t(b,{...f,gain:0}),K=n(b,{...p,curve:I}),te=t(b,{...f,gain:0}),W=n(b,{...p,curve:D});return{connectGraph(){w.connect(U),w.connect(G.inputs===void 0?G:G.inputs[0]),U.connect(k,0),U.connect(F,0),U.connect(j,1),U.connect(te,1),G.connect(M),M.connect(P.inputs===void 0?P:P.inputs[0]),M.connect(H.inputs===void 0?H:H.inputs[0]),M.connect(K.inputs===void 0?K:K.inputs[0]),M.connect(W.inputs===void 0?W:W.inputs[0]),P.connect(k.gain),H.connect(F.gain),K.connect(j.gain),W.connect(te.gain),k.connect(S,0,0),j.connect(S,0,0),F.connect(S,0,1),te.connect(S,0,1)},disconnectGraph(){w.disconnect(U),w.disconnect(G.inputs===void 0?G:G.inputs[0]),U.disconnect(k,0),U.disconnect(F,0),U.disconnect(j,1),U.disconnect(te,1),G.disconnect(M),M.disconnect(P.inputs===void 0?P:P.inputs[0]),M.disconnect(H.inputs===void 0?H:H.inputs[0]),M.disconnect(K.inputs===void 0?K:K.inputs[0]),M.disconnect(W.inputs===void 0?W:W.inputs[0]),P.disconnect(k.gain),H.disconnect(F.gain),K.disconnect(j.gain),W.disconnect(te.gain),k.disconnect(S,0,0),j.disconnect(S,0,0),F.disconnect(S,0,1),te.disconnect(S,0,1)}}},x=(b,w,M,S,C)=>{if(w===1)return g(b,M,S,C);if(w===2)return v(b,M,S,C);throw s()};return(b,{channelCount:w,channelCountMode:M,pan:S,...C})=>{if(M==="max")throw s();const R=i(b,{...C,channelCount:1,channelCountMode:M,numberOfInputs:2}),I=t(b,{...C,channelCount:w,channelCountMode:M,gain:1}),D=t(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:S});let{connectGraph:O,disconnectGraph:U}=x(b,w,I,D,R);Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"maxValue",{get:()=>1}),Object.defineProperty(D.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return I.channelCount},set channelCount(G){I.channelCount!==G&&(P&&U(),{connectGraph:O,disconnectGraph:U}=x(b,G,I,D,R),P&&O()),I.channelCount=G},get channelCountMode(){return I.channelCountMode},set channelCountMode(G){if(G==="clamped-max"||G==="max")throw s();I.channelCountMode=G},get channelInterpretation(){return I.channelInterpretation},set channelInterpretation(G){I.channelInterpretation=G},get context(){return I.context},get inputs(){return[I]},get numberOfInputs(){return I.numberOfInputs},get numberOfOutputs(){return I.numberOfOutputs},get pan(){return D.gain},addEventListener(...G){return I.addEventListener(G[0],G[1],G[2])},dispatchEvent(...G){return I.dispatchEvent(G[0])},removeEventListener(...G){return I.removeEventListener(G[0],G[1],G[2])}};let P=!1;const F=()=>{O(),P=!0},H=()=>{U(),P=!1};return r($m(k,R),F,H)}},tK=(i,e,t,n,s,r,o)=>(l,u)=>{const f=l.createWaveShaper();if(r!==null&&r.name==="webkitAudioContext"&&l.createGain().gain.automationRate===void 0)return t(l,u);Vs(f,u);const p=u.curve===null||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(p!==null&&p.length<2)throw e();Fi(f,{curve:p},"curve"),Fi(f,u,"oversample");let g=null,v=!1;return o(f,"curve",w=>()=>w.call(f),w=>M=>(w.call(f,M),v&&(n(M)&&g===null?g=i(l,f):!n(M)&&g!==null&&(g(),g=null)),M)),s(f,()=>{v=!0,n(f.curve)&&(g=i(l,f))},()=>{v=!1,g!==null&&(g(),g=null)})},nK=(i,e,t,n,s)=>(r,{curve:o,oversample:l,...u})=>{const f=r.createWaveShaper(),p=r.createWaveShaper();Vs(f,u),Vs(p,u);const g=t(r,{...u,gain:1}),v=t(r,{...u,gain:-1}),x=t(r,{...u,gain:1}),b=t(r,{...u,gain:-1});let w=null,M=!1,S=null;const C={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(D){g.channelCount=D,v.channelCount=D,f.channelCount=D,x.channelCount=D,p.channelCount=D,b.channelCount=D},get channelCountMode(){return f.channelCountMode},set channelCountMode(D){g.channelCountMode=D,v.channelCountMode=D,f.channelCountMode=D,x.channelCountMode=D,p.channelCountMode=D,b.channelCountMode=D},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(D){g.channelInterpretation=D,v.channelInterpretation=D,f.channelInterpretation=D,x.channelInterpretation=D,p.channelInterpretation=D,b.channelInterpretation=D},get context(){return f.context},get curve(){return S},set curve(D){if(D!==null&&D.length<2)throw e();if(D===null)f.curve=D,p.curve=D;else{const O=D.length,U=new Float32Array(O+2-O%2),k=new Float32Array(O+2-O%2);U[0]=D[0],k[0]=-D[O-1];const P=Math.ceil((O+1)/2),F=(O+1)/2-1;for(let H=1;H<P;H+=1){const G=H/P*F,j=Math.floor(G),K=Math.ceil(G);U[H]=j===K?D[j]:(1-(G-j))*D[j]+(1-(K-G))*D[K],k[H]=j===K?-D[O-1-j]:-((1-(G-j))*D[O-1-j])-(1-(K-G))*D[O-1-K]}U[P]=O%2===1?D[P-1]:(D[P-2]+D[P-1])/2,f.curve=U,p.curve=k}S=D,M&&(n(S)&&w===null?w=i(r,g):w!==null&&(w(),w=null))},get inputs(){return[g]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get oversample(){return f.oversample},set oversample(D){f.oversample=D,p.oversample=D},addEventListener(...D){return g.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return g.dispatchEvent(D[0])},removeEventListener(...D){return g.removeEventListener(D[0],D[1],D[2])}};o!==null&&(C.curve=o instanceof Float32Array?o:new Float32Array(o)),l!==C.oversample&&(C.oversample=l);const R=()=>{g.connect(f).connect(x),g.connect(v).connect(p).connect(b).connect(x),M=!0,n(S)&&(w=i(r,g))},I=()=>{g.disconnect(f),f.disconnect(x),g.disconnect(v),v.disconnect(p),p.disconnect(b),b.disconnect(x),M=!1,w!==null&&(w(),w=null)};return s($m(C,x),R,I)},ha=()=>new DOMException("","NotSupportedError"),iK={numberOfChannels:1},sK=(i,e,t,n,s)=>class extends i{constructor(o,l,u){let f;if(typeof o=="number"&&l!==void 0&&u!==void 0)f={length:l,numberOfChannels:o,sampleRate:u};else if(typeof o=="object")f=o;else throw new Error("The given parameters are not valid.");const{length:p,numberOfChannels:g,sampleRate:v}={...iK,...f},x=n(g,p,v);e(Ov,()=>Ov(x))||x.addEventListener("statechange",(()=>{let b=0;const w=M=>{this._state==="running"&&(b>0?(x.removeEventListener("statechange",w),M.stopImmediatePropagation(),this._waitForThePromiseToSettle(M)):b+=1)};return w})()),super(x,g),this._length=p,this._nativeOfflineAudioContext=x,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,cL(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},rK={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},aK=(i,e,t,n,s,r,o)=>class extends i{constructor(u,f){const p=s(u),g={...rK,...f},v=t(p,g),x=r(p),b=x?n():null,w=u.sampleRate/2;super(u,!1,v,b),this._detune=e(this,x,v.detune,153600,-153600),this._frequency=e(this,x,v.frequency,w,-w),this._nativeOscillatorNode=v,this._onended=null,this._oscillatorNodeRenderer=b,this._oscillatorNodeRenderer!==null&&g.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=g.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(u){const f=typeof u=="function"?o(this,u):null;this._nativeOscillatorNode.onended=f;const p=this._nativeOscillatorNode.onended;this._onended=p!==null&&p===f?u:p}get type(){return this._nativeOscillatorNode.type}set type(u){this._nativeOscillatorNode.type=u,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(u){this._nativeOscillatorNode.setPeriodicWave(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=u)}start(u=0){if(this._nativeOscillatorNode.start(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=u),this.context.state!=="closed"){km(this);const f=()=>{this._nativeOscillatorNode.removeEventListener("ended",f),Tu(this)&&ey(this)};this._nativeOscillatorNode.addEventListener("ended",f)}}stop(u=0){this._nativeOscillatorNode.stop(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=u)}},oK=(i,e,t,n,s)=>()=>{const r=new WeakMap;let o=null,l=null,u=null;const f=async(p,g)=>{let v=t(p);const x=Br(v,g);if(!x){const b={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,detune:v.detune.value,frequency:v.frequency.value,periodicWave:o===null?void 0:o,type:v.type};v=e(g,b),l!==null&&v.start(l),u!==null&&v.stop(u)}return r.set(g,v),x?(await i(g,p.detune,v.detune),await i(g,p.frequency,v.frequency)):(await n(g,p.detune,v.detune),await n(g,p.frequency,v.frequency)),await s(p,g,v),v};return{set periodicWave(p){o=p},set start(p){l=p},set stop(p){u=p},render(p,g){const v=r.get(g);return v!==void 0?Promise.resolve(v):f(p,g)}}},lK={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},cK=(i,e,t,n,s,r,o)=>class extends i{constructor(u,f){const p=s(u),g={...lK,...f},v=t(p,g),x=r(p),b=x?n():null;super(u,!1,v,b),this._nativePannerNode=v,this._orientationX=e(this,x,v.orientationX,ia,Ba),this._orientationY=e(this,x,v.orientationY,ia,Ba),this._orientationZ=e(this,x,v.orientationZ,ia,Ba),this._positionX=e(this,x,v.positionX,ia,Ba),this._positionY=e(this,x,v.positionY,ia,Ba),this._positionZ=e(this,x,v.positionZ,ia,Ba),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(u){this._nativePannerNode.coneInnerAngle=u}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(u){this._nativePannerNode.coneOuterAngle=u}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(u){this._nativePannerNode.coneOuterGain=u}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(u){this._nativePannerNode.distanceModel=u}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(u){this._nativePannerNode.maxDistance=u}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(u){this._nativePannerNode.panningModel=u}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(u){this._nativePannerNode.refDistance=u}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(u){this._nativePannerNode.rolloffFactor=u}},uK=(i,e,t,n,s,r,o,l,u,f)=>()=>{const p=new WeakMap;let g=null;const v=async(x,b)=>{let w=null,M=r(x);const S={channelCount:M.channelCount,channelCountMode:M.channelCountMode,channelInterpretation:M.channelInterpretation},C={...S,coneInnerAngle:M.coneInnerAngle,coneOuterAngle:M.coneOuterAngle,coneOuterGain:M.coneOuterGain,distanceModel:M.distanceModel,maxDistance:M.maxDistance,panningModel:M.panningModel,refDistance:M.refDistance,rolloffFactor:M.rolloffFactor},R=Br(M,b);if("bufferSize"in M)w=n(b,{...S,gain:1});else if(!R){const I={...C,orientationX:M.orientationX.value,orientationY:M.orientationY.value,orientationZ:M.orientationZ.value,positionX:M.positionX.value,positionY:M.positionY.value,positionZ:M.positionZ.value};M=s(b,I)}if(p.set(b,w===null?M:w),w!==null){if(g===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const H=new o(6,x.context.length,b.sampleRate),G=e(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});G.connect(H.destination),g=(async()=>{const j=await Promise.all([x.orientationX,x.orientationY,x.orientationZ,x.positionX,x.positionY,x.positionZ].map(async(K,te)=>{const W=t(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:te===0?1:0});return await l(H,K,W.offset),W}));for(let K=0;K<6;K+=1)j[K].connect(G,0,K),j[K].start(0);return f(H)})()}const I=await g,D=n(b,{...S,gain:1});await u(x,b,D);const O=[];for(let H=0;H<I.numberOfChannels;H+=1)O.push(I.getChannelData(H));let U=[O[0][0],O[1][0],O[2][0]],k=[O[3][0],O[4][0],O[5][0]],P=n(b,{...S,gain:1}),F=s(b,{...C,orientationX:U[0],orientationY:U[1],orientationZ:U[2],positionX:k[0],positionY:k[1],positionZ:k[2]});D.connect(P).connect(F.inputs[0]),F.connect(w);for(let H=128;H<I.length;H+=128){const G=[O[0][H],O[1][H],O[2][H]],j=[O[3][H],O[4][H],O[5][H]];if(G.some((K,te)=>K!==U[te])||j.some((K,te)=>K!==k[te])){U=G,k=j;const K=H/b.sampleRate;P.gain.setValueAtTime(0,K),P=n(b,{...S,gain:0}),F=s(b,{...C,orientationX:U[0],orientationY:U[1],orientationZ:U[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),P.gain.setValueAtTime(1,K),D.connect(P).connect(F.inputs[0]),F.connect(w)}}return w}return R?(await i(b,x.orientationX,M.orientationX),await i(b,x.orientationY,M.orientationY),await i(b,x.orientationZ,M.orientationZ),await i(b,x.positionX,M.positionX),await i(b,x.positionY,M.positionY),await i(b,x.positionZ,M.positionZ)):(await l(b,x.orientationX,M.orientationX),await l(b,x.orientationY,M.orientationY),await l(b,x.orientationZ,M.orientationZ),await l(b,x.positionX,M.positionX),await l(b,x.positionY,M.positionY),await l(b,x.positionZ,M.positionZ)),Jm(M)?await u(x,b,M.inputs[0]):await u(x,b,M),M};return{render(x,b){const w=p.get(b);return w!==void 0?Promise.resolve(w):v(x,b)}}},hK={disableNormalization:!1},fK=(i,e,t,n)=>class _L{constructor(r,o){const l=e(r),u=n({...hK,...o}),f=i(l,u);return t.add(f),f}static[Symbol.hasInstance](r){return r!==null&&typeof r=="object"&&Object.getPrototypeOf(r)===_L.prototype||t.has(r)}},dK=(i,e)=>(t,n,s)=>(i(n).replay(s),e(n,t,s)),pK=(i,e,t)=>async(n,s,r)=>{const o=i(n);await Promise.all(o.activeInputs.map((l,u)=>Array.from(l).map(async([f,p])=>{const v=await e(f).render(f,s),x=n.context.destination;!t(f)&&(n!==x||!t(n))&&v.connect(r,p,u)})).reduce((l,u)=>[...l,...u],[]))},mK=(i,e,t)=>async(n,s,r)=>{const o=e(n);await Promise.all(Array.from(o.activeInputs).map(async([l,u])=>{const p=await i(l).render(l,s);t(l)||p.connect(r,u)}))},gK=(i,e,t,n)=>s=>i(Ov,()=>Ov(s))?Promise.resolve(i(n,n)).then(r=>{if(!r){const o=t(s,512,0,1);s.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>s.currentTime,o.connect(s.destination)}return s.startRendering()}):new Promise(r=>{const o=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=l=>{o.disconnect(),r(l.renderedBuffer)},o.connect(s.destination),s.startRendering()}),vK=i=>(e,t)=>{i.set(e,t)},yK=i=>(e,t)=>i.set(e,t),_K=(i,e,t,n,s,r,o,l)=>(u,f)=>t(u).render(u,f).then(()=>Promise.all(Array.from(n(f)).map(p=>t(p).render(p,f)))).then(()=>s(f)).then(p=>(typeof p.copyFromChannel!="function"?(o(p),TE(p)):e(r,()=>r(p))||l(p),i.add(p),p)),xK={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},bK=(i,e,t,n,s,r)=>class extends i{constructor(l,u){const f=s(l),p={...xK,...u},g=t(f,p),v=r(f),x=v?n():null;super(l,!1,g,x),this._pan=e(this,v,g.pan)}get pan(){return this._pan}},SK=(i,e,t,n,s)=>()=>{const r=new WeakMap,o=async(l,u)=>{let f=t(l);const p=Br(f,u);if(!p){const g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,pan:f.pan.value};f=e(u,g)}return r.set(u,f),p?await i(u,l.pan,f.pan):await n(u,l.pan,f.pan),Jm(f)?await s(l,u,f.inputs[0]):await s(l,u,f),f};return{render(l,u){const f=r.get(u);return f!==void 0?Promise.resolve(f):o(l,u)}}},MK=i=>()=>{if(i===null)return!1;try{new i({length:1,sampleRate:44100})}catch{return!1}return!0},TK=(i,e)=>async()=>{if(i===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),s=URL.createObjectURL(t);let r=!1,o=!1;try{await n.audioWorklet.addModule(s);const l=new i(n,"a",{numberOfOutputs:0}),u=n.createOscillator();l.port.onmessage=()=>r=!0,l.onprocessorerror=()=>o=!0,u.connect(l),u.start(0),await n.startRendering(),await new Promise(f=>setTimeout(f))}catch{}finally{URL.revokeObjectURL(s)}return r&&!o},wK=(i,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),n=i(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{t.oncomplete=()=>{n.disconnect(),s(t.currentTime!==0)},t.startRendering()})},AK=()=>new DOMException("","UnknownError"),EK={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},CK=(i,e,t,n,s,r,o)=>class extends i{constructor(u,f){const p=s(u),g={...EK,...f},v=t(p,g),b=r(p)?n():null;super(u,!0,v,b),this._isCurveNullified=!1,this._nativeWaveShaperNode=v,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(u){if(u===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(u.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=u}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(u){this._nativeWaveShaperNode.oversample=u}},RK=(i,e,t)=>()=>{const n=new WeakMap,s=async(r,o)=>{let l=e(r);if(!Br(l,o)){const f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,curve:l.curve,oversample:l.oversample};l=i(o,f)}return n.set(o,l),Jm(l)?await t(r,o,l.inputs[0]):await t(r,o,l),l};return{render(r,o){const l=n.get(o);return l!==void 0?Promise.resolve(l):s(r,o)}}},DK=()=>typeof window>"u"?null:window,NK=(i,e)=>t=>{t.copyFromChannel=(n,s,r=0)=>{const o=i(r),l=i(s);if(l>=t.numberOfChannels)throw e();const u=t.length,f=t.getChannelData(l),p=n.length;for(let g=o<0?-o:0;g+o<u&&g<p;g+=1)n[g]=f[g+o]},t.copyToChannel=(n,s,r=0)=>{const o=i(r),l=i(s);if(l>=t.numberOfChannels)throw e();const u=t.length,f=t.getChannelData(l),p=n.length;for(let g=o<0?-o:0;g+o<u&&g<p;g+=1)f[g+o]=n[g]}},IK=i=>e=>{e.copyFromChannel=(t=>(n,s,r=0)=>{const o=i(r),l=i(s);if(o<e.length)return t.call(e,n,l,o)})(e.copyFromChannel),e.copyToChannel=(t=>(n,s,r=0)=>{const o=i(r),l=i(s);if(o<e.length)return t.call(e,n,l,o)})(e.copyToChannel)},OK=i=>(e,t)=>{const n=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=n),i(e,"buffer",s=>()=>{const r=s.call(e);return r===n?null:r},s=>r=>s.call(e,r===null?n:r))},PK=(i,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw i()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw i()}});const s=t.createBufferSource();e(n,()=>{const l=n.numberOfInputs;for(let u=0;u<l;u+=1)s.connect(n,0,u)},()=>s.disconnect(n))},xL=(i,e,t)=>i.copyFromChannel===void 0?i.getChannelData(t)[0]:(i.copyFromChannel(e,t),e[0]),bL=i=>{if(i===null)return!1;const e=i.length;return e%2!==0?i[Math.floor(e/2)]!==0:i[e/2-1]+i[e/2]!==0},ry=(i,e,t,n)=>{let s=i;for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:r,set:o}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(i,e,{get:t(r),set:n(o)})},UK=i=>({...i,outputChannelCount:i.outputChannelCount!==void 0?i.outputChannelCount:i.numberOfInputs===1&&i.numberOfOutputs===1?[i.channelCount]:Array.from({length:i.numberOfOutputs},()=>1)}),LK=i=>({...i,channelCount:i.numberOfOutputs}),FK=i=>{const{imag:e,real:t}=i;return e===void 0?t===void 0?{...i,imag:[0,0],real:[0,0]}:{...i,imag:Array.from(t,()=>0),real:t}:t===void 0?{...i,imag:e,real:Array.from(e,()=>0)}:{...i,imag:e,real:t}},SL=(i,e,t)=>{try{i.setValueAtTime(e,t)}catch(n){if(n.code!==9)throw n;SL(i,e,t+1e-7)}},kK=i=>{const e=i.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},BK=i=>{const e=i.createBufferSource(),t=i.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},zK=i=>{const e=i.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},RE=i=>{const e=i.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ML=i=>{const e=i.createBuffer(1,1,44100),t=i.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},DE=i=>{const e=i.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},VK=i=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(i)}finally{e.close(),t.close()}},GK=i=>{i.start=(e=>(t=0,n=0,s)=>{const r=i.buffer,o=r===null?n:Math.min(r.duration,n);r!==null&&o>r.duration-.5/i.context.sampleRate?e.call(i,t,0,0):e.call(i,t,o,s)})(i.start)},TL=(i,e)=>{const t=e.createGain();i.connect(t);const n=(s=>()=>{s.call(i,t),i.removeEventListener("ended",n)})(i.disconnect);i.addEventListener("ended",n),$m(i,t),i.stop=(s=>{let r=!1;return(o=0)=>{if(r)try{s.call(i,o)}catch{t.gain.setValueAtTime(0,o)}else s.call(i,o),r=!0}})(i.stop)},eg=(i,e)=>t=>{const n={value:i};return Object.defineProperties(t,{currentTarget:n,target:n}),typeof e=="function"?e.call(i,t):e.handleEvent.call(i,t)},HK=cX(Ud),WK=mX(Ud),jK=EY(pS),wL=new WeakMap,qK=jY(wL),Nl=iY(new Map,new WeakMap),wc=DK(),AL=bZ(Nl,Rc),NE=WY(la),gr=pK(la,NE,Ed),XK=xX(AL,Di,gr),Si=YY(dS),Pu=YZ(wc),ui=hZ(Pu),EL=new WeakMap,CL=FY(eg),ay=wZ(wc),IE=oZ(ay),OE=lZ(wc),RL=cZ(wc),Pv=EZ(wc),vs=jX(uX(nL),pX(HK,WK,f1,jK,d1,la,qK,$v,Di,Ud,Tu,Ed,tb),Nl,nZ(Fw,d1,la,Di,Iv,Tu),Rc,mS,ha,MY(f1,Fw,la,Di,Iv,Si,Tu,ui),DY(EL,la,Cl),CL,Si,IE,OE,RL,ui,Pv),YK=_X(vs,XK,Rc,AL,Si,ui),PE=new WeakSet,HN=SZ(wc),DL=gY(new Uint32Array(1)),UE=NK(DL,Rc),LE=IK(DL),NL=SX(PE,Nl,ha,HN,Pu,MK(HN),UE,LE),gS=gX(ja),IL=mK(NE,ty,Ed),Dc=uY(IL),tg=TZ(gS,Nl,kK,BK,zK,RE,ML,DE,GK,OK(ry),TL),Nc=dK(qY(ty),IL),ZK=wX(Dc,tg,Di,Nc,gr),Il=qX(hX(iL),EL,ME,XX,iX,sX,rX,aX,oX,Pw,eL,ay,SL),KK=TX(vs,ZK,Il,tr,tg,Si,ui,eg),QK=PX(vs,UX,Rc,tr,AZ(ja,ry),Si,ui,gr),JK=nY(Dc,vL,Di,Nc,gr),Ld=yK(wL),$K=tY(vs,Il,JK,mS,vL,Si,ui,Ld),Qh=_Z(Ud,OE),eQ=PK(tr,Qh),Jh=PZ(ay,eQ),tQ=aY(Jh,Di,gr),nQ=rY(vs,tQ,Jh,Si,ui),iQ=cY(iy,Di,gr),sQ=lY(vs,iQ,iy,Si,ui,LK),rQ=FZ(gS,tg,ja,Qh),ng=LZ(gS,Nl,rQ,RE,DE),aQ=mY(Dc,ng,Di,Nc,gr),oQ=pY(vs,Il,aQ,ng,Si,ui,eg),OL=kZ(ha,ry),lQ=_Y(OL,Di,gr),cQ=yY(vs,lQ,OL,Si,ui,Ld),uQ=AY(Dc,yL,Di,Nc,gr),hQ=wY(vs,Il,uQ,yL,Si,ui,Ld),PL=BZ(ha),fQ=PY(Dc,PL,Di,Nc,gr),dQ=OY(vs,Il,fQ,PL,ha,Si,ui,Ld),pQ=GY(Dc,ja,Di,Nc,gr),mQ=VY(vs,Il,pQ,ja,Si,ui),gQ=HZ(mS,tr,sy,ha),vS=gK(Nl,ja,sy,wK(ja,Pu)),vQ=tZ(tg,Di,Pu,gr,vS),yQ=zZ(gQ),_Q=$Y(vs,yQ,vQ,Si,ui,Ld),xQ=LX(Il,Jh,ng,sy,ha,xL,ui,ry),UL=new WeakMap,bQ=yZ(QK,xQ,CL,ui,UL,eg),LL=ZZ(gS,Nl,RE,ML,DE,TL),SQ=oK(Dc,LL,Di,Nc,gr),MQ=aK(vs,Il,LL,SQ,Si,ui,eg),FL=fY(tg),TQ=nK(FL,tr,ja,bL,Qh),yS=tK(FL,tr,TQ,bL,Qh,ay,ry),wQ=QZ(f1,tr,Jh,ja,sy,yS,ha,d1,xL,Qh),kL=KZ(wQ),AQ=uK(Dc,Jh,ng,ja,kL,Di,Pu,Nc,gr,vS),EQ=cK(vs,Il,kL,AQ,Si,ui,Ld),CQ=JZ(Rc),RQ=fK(CQ,Si,new WeakSet,FK),DQ=eK(Jh,iy,ja,yS,ha,Qh),BL=$Z(DQ,ha),NQ=SK(Dc,BL,Di,Nc,gr),IQ=bK(vs,Il,BL,NQ,Si,ui),OQ=RK(yS,Di,gr),PQ=CK(vs,tr,yS,OQ,Si,ui,Ld),zL=fZ(wc),FE=kY(wc),VL=new WeakMap,UQ=ZY(VL,Pu),LQ=zL?dX(Nl,ha,LY(wc),FE,BY(lX),Si,UQ,ui,Pv,new WeakMap,new WeakMap,TK(Pv,Pu),wc):void 0,FQ=uZ(IE,ui),kQ=SY(PE,Nl,bY,UY,new WeakSet,Si,FQ,u1,Ov,UE,LE),GL=$X(LQ,YK,NL,KK,$K,nQ,sQ,oQ,cQ,kQ,hQ,dQ,mQ,_Q,bQ,MQ,EQ,RQ,IQ,PQ),BQ=dZ(vs,WZ,Si,ui),zQ=mZ(vs,jZ,Si,ui),VQ=gZ(vs,qZ,Si,ui),GQ=XZ(tr,ui),HQ=vZ(vs,GQ,Si),WQ=OX(GL,tr,ha,AK,BQ,zQ,VQ,HQ,ay),kE=KY(UL),jQ=vX(kE),HL=hY(Rc),qQ=CY(kE),WL=NY(Rc),jL=new WeakMap,XQ=HY(jL,Cl),YQ=OZ(HL,Rc,tr,Jh,iy,ng,ja,sy,ha,WL,FE,XQ,Qh),ZQ=RZ(tr,YQ,ja,ha,Qh),KQ=JX(Dc,HL,tg,Jh,iy,ng,ja,qQ,WL,FE,Di,Pv,Pu,Nc,gr,vS),QQ=XY(VL),JQ=vK(jL),WN=zL?ZX(jQ,vs,Il,KQ,ZQ,la,QQ,Si,ui,Pv,UK,JQ,VK,eg):void 0,$Q=xY(ha,Pu),eJ=_K(PE,Nl,NE,kE,vS,u1,UE,LE),tJ=sK(GL,Nl,tr,$Q,eJ),nJ=iZ(dS,IE),iJ=sZ(SE,OE),sJ=rZ(ME,RL),rJ=aZ(dS,ui);function Yo(i){return i===void 0}function Pn(i){return i!==void 0}function aJ(i){return typeof i=="function"}function Ru(i){return typeof i=="number"}function yd(i){return Object.prototype.toString.call(i)==="[object Object]"&&i.constructor===Object}function oJ(i){return typeof i=="boolean"}function co(i){return Array.isArray(i)}function Du(i){return typeof i=="string"}function Hx(i){return Du(i)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(i)}function Zt(i,e){if(!i)throw new Error(e)}function jo(i,e,t=1/0){if(!(e<=i&&i<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${i}`)}function qL(i){!i.isOffline&&i.state!=="running"&&_S('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let XL=!1,jN=!1;function qN(i){XL=i}function lJ(i){Yo(i)&&XL&&!jN&&(jN=!0,_S("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let YL=console;function cJ(...i){YL.log(...i)}function _S(...i){YL.warn(...i)}function uJ(i){return new WQ(i)}function hJ(i,e,t){return new tJ(i,e,t)}const ro=typeof self=="object"?self:null,fJ=ro&&(ro.hasOwnProperty("AudioContext")||ro.hasOwnProperty("webkitAudioContext"));function dJ(i,e,t){return Zt(Pn(WN),"AudioWorkletNode only works in a secure context (https or localhost)"),new(i instanceof ro?.BaseAudioContext?ro?.AudioWorkletNode:WN)(i,e,t)}function Ol(i,e,t,n){var s=arguments.length,r=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,e,t,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r}function gs(i,e,t,n){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function l(p){try{f(n.next(p))}catch(g){o(g)}}function u(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?r(p.value):s(p.value).then(l,u)}f((n=n.apply(i,e||[])).next())})}class pJ{constructor(e,t,n,s){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(s||44100),.001),this.updateInterval=n,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function Cd(i){return sJ(i)}function kh(i){return iJ(i)}function nb(i){return rJ(i)}function um(i){return nJ(i)}function mJ(i){return i instanceof NL}function gJ(i,e){return i==="value"||Cd(e)||kh(e)||mJ(e)}function _d(i,...e){if(!e.length)return i;const t=e.shift();if(yd(i)&&yd(t))for(const n in t)gJ(n,t[n])?i[n]=t[n]:yd(t[n])?(i[n]||Object.assign(i,{[n]:{}}),_d(i[n],t[n])):Object.assign(i,{[n]:t[n]});return _d(i,...e)}function vJ(i,e){return i.length===e.length&&i.every((t,n)=>e[n]===t)}function Ht(i,e,t=[],n){const s={},r=Array.from(e);if(yd(r[0])&&n&&!Reflect.has(r[0],n)&&(Object.keys(r[0]).some(l=>Reflect.has(i,l))||(_d(s,{[n]:r[0]}),t.splice(t.indexOf(n),1),r.shift())),r.length===1&&yd(r[0]))_d(s,r[0]);else for(let o=0;o<t.length;o++)Pn(r[o])&&(s[t[o]]=r[o]);return _d(i,s)}function yJ(i){return i.constructor.getDefaults()}function wm(i,e){return Yo(i)?e:i}function Gw(i,e){return e.forEach(t=>{Reflect.has(i,t)&&delete i[t]}),i}class Uu{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||ro&&this.toString()===ro.TONE_DEBUG_CLASS)&&cJ(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Uu.version=$U;const BE=1e-6;function Bm(i,e){return i>e+BE}function Hw(i,e){return Bm(i,e)||Sl(i,e)}function v1(i,e){return i+BE<e}function Sl(i,e){return Math.abs(i-e)<BE}function _J(i,e,t){return Math.max(Math.min(i,t),e)}class Zo extends Uu{constructor(){super(),this.name="Timeline",this._timeline=[];const e=Ht(Zo.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(Zt(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];Zt(Hw(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const n=this._search(e,t);return n!==-1?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(Sl(this._timeline[t].time,e)){for(let n=t;n>=0&&Sl(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&Hw(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let n=0;const s=this._timeline.length;let r=s;if(s>0&&this._timeline[s-1][t]<=e)return s-1;for(;n<r;){let o=Math.floor(n+(r-n)/2);const l=this._timeline[o],u=this._timeline[o+1];if(Sl(l[t],e)){for(let f=o;f<this._timeline.length;f++){const p=this._timeline[f];if(Sl(p[t],e))o=f;else break}return o}else{if(v1(l[t],e)&&Bm(u[t],e))return o;Bm(l[t],e)?r=o:n=o+1}}return-1}_iterate(e,t=0,n=this._timeline.length-1){this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const n=this._search(e);return n!==-1&&this._iterate(t,0,n),this}forEachAfter(e,t){const n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let s=this._search(e),r=this._search(t);return s!==-1&&r!==-1?(this._timeline[s].time!==e&&(s+=1),this._timeline[r].time===t&&(r-=1),this._iterate(n,s,r)):s===-1&&this._iterate(n,0,r),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){const n=this._search(e);if(n!==-1&&Sl(this._timeline[n].time,e)){let s=n;for(let r=n;r>=0&&Sl(this._timeline[r].time,e);r--)s=r;this._iterate(r=>{t(r)},s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const ZL=[];function xS(i){ZL.push(i)}function xJ(i){ZL.forEach(e=>e(i))}const KL=[];function bS(i){KL.push(i)}function bJ(i){KL.forEach(e=>e(i))}class oy extends Uu{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(s=>{Yo(this._events)&&(this._events={}),this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(t)}),this}once(e,t){const n=(...s)=>{t(...s),this.off(e,n)};return this.on(e,n),this}off(e,t){return e.split(/\W+/).forEach(s=>{if(Yo(this._events)&&(this._events={}),this._events.hasOwnProperty(s))if(Yo(t))this._events[s]=[];else{const r=this._events[s];for(let o=r.length-1;o>=0;o--)r[o]===t&&r.splice(o,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const n=this._events[e].slice(0);for(let s=0,r=n.length;s<r;s++)n[s].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const n=Object.getOwnPropertyDescriptor(oy.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class QL extends oy{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class ly extends QL{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new Zo,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const n=Ht(ly.getDefaults(),arguments,["context"]);n.context?(this._context=n.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=uJ({latencyHint:n.latencyHint}),this._latencyHint=n.latencyHint),this._ticker=new pJ(this.emit.bind(this,"tick"),n.clockSource,n.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=n.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(xJ(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return Zt(um(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return Zt(um(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return Zt(um(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){Zt(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){Zt(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){Zt(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){Zt(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return dJ(this.rawContext,e,t)}addAudioWorkletModule(e){return gs(this,void 0,void 0,function*(){Zt(Pn(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return gs(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return um(this._context)?this._context.resume():Promise.resolve()}close(){return gs(this,void 0,void 0,function*(){um(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&bJ(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let r=0;r<n.length;r++)n[r]=e;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=t,s.loop=!0,s.start(0),this._constants.set(e,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,t=>{t.callback(),this._timeouts.remove(t)})}setTimeout(e,t){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const n=++this._timeoutIds,s=()=>{const r=this.now();this._timeouts.add({callback:()=>{e(),s()},id:n,time:r+t})};return s(),n}}class SJ extends QL{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return gs(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function pi(i,e){co(e)?e.forEach(t=>pi(i,t)):Object.defineProperty(i,e,{enumerable:!0,writable:!1})}function zE(i,e){co(e)?e.forEach(t=>zE(i,t)):Object.defineProperty(i,e,{writable:!0})}const ei=()=>{};class fi extends Uu{constructor(){super(),this.name="ToneAudioBuffer",this.onload=ei;const e=Ht(fi.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,Du(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:ei,onload:ei,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Tl().sampleRate}set(e){return e instanceof fi?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return gs(this,void 0,void 0,function*(){const t=fi.load(e).then(n=>{this.set(n),this.onload(this)});fi.downloads.push(t);try{yield t}finally{const n=fi.downloads.indexOf(t);fi.downloads.splice(n,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=co(e)&&e[0].length>0,n=t?e.length:1,s=t?e[0].length:e.length,r=Tl(),o=r.createBuffer(n,s,r.sampleRate),l=!t&&n===1?[e]:e;for(let u=0;u<n;u++)o.copyToChannel(l[u],u);return this._buffer=o,this}toMono(e){if(Ru(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const n=this.numberOfChannels;for(let s=0;s<n;s++){const r=this.toArray(s);for(let o=0;o<r.length;o++)t[o]+=r[o]}t=t.map(s=>s/n),this.fromArray(t)}return this}toArray(e){if(Ru(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let n=0;n<this.numberOfChannels;n++)t[n]=this.getChannelData(n);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){Zt(this.loaded,"Buffer is not loaded");const n=Math.floor(e*this.sampleRate),s=Math.floor(t*this.sampleRate);Zt(n<s,"The start time must be less than the end time");const r=s-n,o=Tl().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let l=0;l<this.numberOfChannels;l++)o.copyToChannel(this.getChannelData(l).subarray(n,s),l);return new fi(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new fi().fromArray(e)}static fromUrl(e){return gs(this,void 0,void 0,function*(){return yield new fi().load(e)})}static load(e){return gs(this,void 0,void 0,function*(){const t=fi.baseUrl===""||fi.baseUrl.endsWith("/")?fi.baseUrl:fi.baseUrl+"/",n=yield fetch(t+e);if(!n.ok)throw new Error(`could not load url: ${e}`);const s=yield n.arrayBuffer();return yield Tl().decodeAudioData(s)})}static supportsType(e){const t=e.split("."),n=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+n)!==""}static loaded(){return gs(this,void 0,void 0,function*(){for(yield Promise.resolve();fi.downloads.length;)yield fi.downloads[0]})}}fi.baseUrl="";fi.downloads=[];class SS extends ly{constructor(){super({clockSource:"offline",context:nb(arguments[0])?arguments[0]:hJ(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:nb(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=nb(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return gs(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const n=Math.floor(this.sampleRate/128);e&&t%n===0&&(yield new Promise(s=>setTimeout(s,1)))}})}render(){return gs(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new fi(t)})}close(){return Promise.resolve()}}const JL=new SJ;let ud=JL;function Tl(){return ud===JL&&fJ&&MJ(new ly),ud}function MJ(i,e=!1){e&&ud.dispose(),um(i)?ud=new ly(i):nb(i)?ud=new SS(i):ud=i}function TJ(){return ud.resume()}if(ro&&!ro.TONE_SILENCE_LOGGING){const e=` * Tone.js v${$U} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function wJ(i){return Math.pow(10,i/20)}function AJ(i){return 20*(Math.log(i)/Math.LN10)}function $L(i){return Math.pow(2,i/12)}let MS=440;function EJ(){return MS}function CJ(i){MS=i}function hd(i){return Math.round(eF(i))}function eF(i){return 69+12*Math.log2(i/MS)}function tF(i){return MS*Math.pow(2,(i-69)/12)}class VE extends Uu{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const n=parseInt(e,10),s=t==="."?1.5:1;return n===1?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let s=0;return e&&e!=="0"&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s+=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof VE&&this.fromType(this._val),Yo(this._val))return this._noArg();if(Du(this._val)&&Yo(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(yd(this._val)){let e=0;for(const t in this._val)if(Pn(this._val[t])){const n=this._val[t],s=new this.constructor(this.context,t).valueOf()*n;e+=s}return e}if(Pn(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return Du(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class wl extends VE{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new wl(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const n=new this.constructor(this.context,e).valueOf(),s=this.valueOf(),l=Math.round(s/n)*n-s;return s+l*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let r=1;r<9;r++){const o=Math.pow(2,r);t.push(o+"n."),t.push(o+"n"),t.push(o+"t")}t.push("0");let n=t[0],s=new wl(this.context,t[0]).toSeconds();return t.forEach(r=>{const o=new wl(this.context,r).toSeconds();Math.abs(o-e)<Math.abs(s-e)&&(n=r,s=o)}),n}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const n=Math.floor(t/this._getTimeSignature());let s=t%1*4;t=Math.floor(t)%this._getTimeSignature();const r=s.toString();return r.length>3&&(s=parseFloat(parseFloat(r).toFixed(3))),[n,t,s].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return hd(this.toFrequency())}_now(){return this.context.now()}}class oo extends wl{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return EJ()}static set A4(e){CJ(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:oo.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const s=RJ[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?s:oo.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let s=1;return e&&e!=="0"&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s*=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(e){return new oo(this.context,this.valueOf()*$L(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return hd(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/oo.A4);let n=Math.round(12*t)+57;const s=Math.floor(n/12);return s<0&&(n+=-12*s),DJ[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return tF(e)}static ftom(e){return hd(e)}}const RJ={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},DJ=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class lv extends wl{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Wa extends Uu{constructor(){super();const e=Ht(Wa.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Tl()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return lJ(e),new wl(this.context,e).toSeconds()}toFrequency(e){return new oo(this.context,e).toFrequency()}toTicks(e){return new lv(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(n=>{Yo(e[n])&&delete t[n]}),t}get(){const e=yJ(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const n=this[t];Pn(n)&&Pn(n.value)&&Pn(n.setValueAtTime)?e[t]=n.value:n instanceof Wa?e[t]=n._getPartialProperties(e[t]):co(n)||Ru(n)||Du(n)||oJ(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Pn(this[t])&&(this[t]&&Pn(this[t].value)&&Pn(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof Wa?this[t].set(e[t]):this[t]=e[t])}),this}}class GE extends Zo{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,n){return jo(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){const n=this._search(t);for(let s=n;s>=0;s--){const r=this._timeline[s];if(r.state===e)return r}}getNextState(e,t){const n=this._search(t);if(n!==-1)for(let s=n;s<this._timeline.length;s++){const r=this._timeline[s];if(r.state===e)return r}}}class Wn extends Wa{constructor(){const e=Ht(Wn.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,Zt(Pn(e.param)&&(Cd(e.param)||e.param instanceof Wn),"param must be an AudioParam");!Cd(e.param);)e.param=e.param._param;this._swappable=Pn(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Zo(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Pn(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Wa.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Pn(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Pn(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Pn(this.maxValue)&&Pn(this.minValue)&&jo(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?wJ(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?AJ(e):e}setValueAtTime(e,t){const n=this.toSeconds(t),s=this._fromType(e);return Zt(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),s=this._events.get(t);let r=this._initialValue;if(s===null)r=this._initialValue;else if(s.type==="setTargetAtTime"&&(n===null||n.type==="setValueAtTime")){const o=this._events.getBefore(s.time);let l;o===null?l=this._initialValue:l=o.value,s.type==="setTargetAtTime"&&(r=this._exponentialApproach(s.time,l,s.value,s.constant,t))}else if(n===null)r=s.value;else if(n.type==="linearRampToValueAtTime"||n.type==="exponentialRampToValueAtTime"){let o=s.value;if(s.type==="setTargetAtTime"){const l=this._events.getBefore(s.time);l===null?o=this._initialValue:o=l.value}n.type==="linearRampToValueAtTime"?r=this._linearInterpolate(s.time,o,n.time,n.value,t):r=this._exponentialInterpolate(s.time,o,n.time,n.value,t)}else r=s.value;return this._toType(r)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const n=this._fromType(e),s=this.toSeconds(t);return Zt(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=Sl(n,0)?this._minOutput:n,this._assertRange(n);const s=this.toSeconds(t);return Zt(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,s),this.cancelAndHoldAtTime(t+n*.9),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){const s=this._fromType(e);Zt(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(t);return this._assertRange(s),Zt(isFinite(s)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",e,r,n),this._param.setTargetAtTime(s,r,n),this}setValueCurveAtTime(e,t,n,s=1){n=this.toSeconds(n),t=this.toSeconds(t);const r=this._fromType(e[0])*s;this.setValueAtTime(this._toType(r),t);const o=n/(e.length-1);for(let l=1;l<e.length;l++){const u=this._fromType(e[l])*s;this.linearRampToValueAtTime(this._toType(u),t+l*o)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return Zt(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));Zt(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);const s=this._events.get(t),r=this._events.getAfter(t);return s&&Sl(s.time,t)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),r.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(n),t):r.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e,t=.1,n){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const n=this._events.get(t);if(n&&n.type==="setTargetAtTime"){const s=this._events.getAfter(n.time),r=s?s.time:t+2,o=(r-t)/10;for(let l=t;l<r;l+=o)e.linearRampToValueAtTime(this.getValueAtTime(l),l)}return this._events.forEachAfter(this.context.currentTime,s=>{s.type==="cancelScheduledValues"?e.cancelScheduledValues(s.time):s.type==="setTargetAtTime"?e.setTargetAtTime(s.value,s.time,s.constant):e[s.type](s.value,s.time)}),this}setParam(e){Zt(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,s,r){return n+(t-n)*Math.exp(-(r-e)/s)}_linearInterpolate(e,t,n,s,r){return t+(s-t)*((r-e)/(n-e))}_exponentialInterpolate(e,t,n,s,r){return t*Math.pow(s/t,(r-e)/(n-e))}}class en extends Wa{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Pn(this.input)?Cd(this.input)||this.input instanceof Wn?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Pn(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Pn(e)&&(e instanceof en||kh(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(n=>{n.channelCount=e.channelCount,n.channelCountMode=e.channelCountMode,n.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();Zt(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,n=0){return Nu(this,e,t,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return _S("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,n=0){return nF(this,e,t,n),this}chain(...e){return Uv(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),Pn(this.input)&&(this.input instanceof en?this.input.dispose():kh(this.input)&&this.input.disconnect()),Pn(this.output)&&(this.output instanceof en?this.output.dispose():kh(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Uv(...i){const e=i.shift();i.reduce((t,n)=>(t instanceof en?t.connect(n):kh(t)&&Nu(t,n),n),e)}function Nu(i,e,t=0,n=0){for(Zt(Pn(i),"Cannot connect from undefined node"),Zt(Pn(e),"Cannot connect to undefined node"),(e instanceof en||kh(e))&&Zt(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Zt(i.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof en||e instanceof Wn;)Pn(e.input)&&(e=e.input);for(;i instanceof en;)Pn(i.output)&&(i=i.output);Cd(e)?i.connect(e,t):i.connect(e,t,n)}function nF(i,e,t=0,n=0){if(Pn(e))for(;e instanceof en;)e=e.input;for(;!kh(i);)Pn(i.output)&&(i=i.output);Cd(e)?i.disconnect(e,t):kh(e)?i.disconnect(e,t,n):i.disconnect()}class ci extends en{constructor(){const e=Ht(ci.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new Wn({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),pi(this,"gain")}static getDefaults(){return Object.assign(en.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class zm extends en{constructor(e){super(e),this.onended=ei,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new ci({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const n=this.toSeconds(t);return this._startTime!==-1&&n>=this._startTime&&(this._stopTime===-1||n<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(en.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:ei})}_startGain(e,t=1){Zt(this._startTime===-1,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){Zt(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const n=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==ei&&(this.onended(this),this.onended=ei,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Zt(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=ei,this}}class HE extends zm{constructor(){const e=Ht(HE.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),Nu(this._source,this._gainNode),this.offset=new Wn({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(zm.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class di extends en{constructor(){const e=Ht(di.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new HE({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(en.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,n=0){return TS(this,e,t,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,s){return this._param.setValueCurveAtTime(e,t,n,s),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function TS(i,e,t,n){(e instanceof Wn||Cd(e)||e instanceof di&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof di&&(e.overridden=!0)),Nu(i,e,t,n)}class WE extends Wn{constructor(){const e=Ht(WE.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new Zo(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Wn.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);const s=this._fromType(e),r=this._events.get(t),o=Math.round(Math.max(1/n,1));for(let l=0;l<=o;l++){const u=n*l+t,f=this._exponentialApproach(r.time,r.value,s,n,u);this.linearRampToValueAtTime(this._toType(f),u)}return this}setValueAtTime(e,t){const n=this.toSeconds(t);super.setValueAtTime(e,t);const s=this._events.get(n),r=this._events.previousEvent(s),o=this._getTicksUntilEvent(r,n);return s.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,t){const n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const s=this._events.get(n),r=this._events.previousEvent(s),o=this._getTicksUntilEvent(r,n);return s.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const n=this._fromType(e),s=this._events.get(t),r=Math.round(Math.max((t-s.time)*10,1)),o=(t-s.time)/r;for(let l=0;l<=r;l++){const u=o*l+s.time,f=this._exponentialInterpolate(s.time,s.value,t,n,u);this.linearRampToValueAtTime(this._toType(f),u)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Yo(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const n=this._fromType(this.getValueAtTime(e.time));let s=this._fromType(this.getValueAtTime(t));const r=this._events.get(t);return r&&r.time===t&&r.type==="setValueAtTime"&&(s=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+s)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(t);return this.getTimeOfTick(s+e)-n}getTimeOfTick(e){const t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&n.type==="linearRampToValueAtTime"&&t.value!==n.value){const s=this._fromType(this.getValueAtTime(t.time)),o=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-t.time),l=Math.sqrt(Math.pow(s,2)-2*o*(t.ticks-e)),u=(-s+l)/o,f=(-s-l)/o;return(u>0?u:f)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const n=this.toSeconds(t),s=this.toSeconds(e),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-r}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class jE extends di{constructor(){const e=Ht(jE.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new WE({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(di.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class qE extends Wa{constructor(){const e=Ht(qE.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new GE,this._tickOffset=new Zo,this._ticksAtTime=new Zo,this._secondsAtTime=new Zo,this.frequency=new jE({context:this.context,units:e.units,value:e.frequency}),pi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Wa.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const n=this.toSeconds(e);return this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),Pn(t)&&this.setTicksAtTime(t,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const n=this._state.get(t);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),n=this._state.getLastState("stopped",t),s=this._ticksAtTime.get(t),r={state:"paused",time:t};this._state.add(r);let o=s||n,l=s?s.ticks:0,u=null;return this._state.forEachBetween(o.time,t+this.sampleTime,f=>{let p=o.time;const g=this._tickOffset.get(f.time);g&&g.time>=o.time&&(l=g.ticks,p=g.time),o.state==="started"&&f.state!=="started"&&(l+=this.frequency.getTicksAtTime(f.time)-this.frequency.getTicksAtTime(p),f.time!==r.time&&(u={state:f.state,time:f.time,ticks:l})),o=f}),this._state.remove(r),u&&this._ticksAtTime.add(u),l}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);const s=this._secondsAtTime.get(e);let r=s||t,o=s?s.seconds:0,l=null;return this._state.forEachBetween(r.time,e+this.sampleTime,u=>{let f=r.time;const p=this._tickOffset.get(u.time);p&&p.time>=r.time&&(o=p.seconds,f=p.time),r.state==="started"&&u.state!=="started"&&(o+=u.time-f,u.time!==n.time&&(l={state:u.state,time:u.time,seconds:o})),r=u}),this._state.remove(n),l&&this._secondsAtTime.add(l),o}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const n=this._tickOffset.get(t),s=this._state.get(t),r=Math.max(n.time,s.time),o=this.frequency.getTicksAtTime(r)+e-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,t,n){let s=this._state.get(e);this._state.forEachBetween(e,t,o=>{s&&s.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(s.time,e),o.time-this.sampleTime,n),s=o});let r=null;if(s&&s.state==="started"){const o=Math.max(s.time,e),l=this.frequency.getTicksAtTime(o),u=this.frequency.getTicksAtTime(s.time),f=l-u;let p=Math.ceil(f)-f;p=Sl(p,1)?0:p;let g=this.frequency.getTimeOfTick(l+p);for(;g<t;){try{n(g,Math.round(this.getTicksAtTime(g)))}catch(v){r=v;break}g+=this.frequency.getDurationOfTicks(1,g)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class wS extends Wa{constructor(){const e=Ht(wS.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=ei,this._lastUpdate=0,this._state=new GE("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new qE({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,pi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Wa.getDefaults(),{callback:ei,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){qL(this.context);const n=this.toSeconds(e);return this.log("start",n),this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+e,n)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,n=>{switch(n.state){case"started":const s=this._tickSource.getTicksAtTime(n.time);this.emit("start",n.time,s);break;case"stopped":n.time!==0&&this.emit("stop",n.time);break;case"paused":this.emit("pause",n.time);break}}),this._tickSource.forEachTickBetween(e,t,(n,s)=>{this.callback(n,s)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}oy.mixin(wS);class ig extends en{constructor(){const e=Ht(ig.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new ci({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,pi(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(en.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class XE extends en{constructor(){const e=Ht(XE.getDefaults(),arguments);super(e),this.name="Destination",this.input=new ig({context:this.context}),this.output=new ci({context:this.context}),this.volume=this.input.volume,Uv(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(en.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Uv(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}xS(i=>{i.destination=new XE({context:i})});bS(i=>{i.destination.dispose()});class NJ extends en{constructor(){super(...arguments),this.name="Listener",this.positionX=new Wn({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Wn({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Wn({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Wn({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Wn({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Wn({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Wn({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Wn({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Wn({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(en.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}xS(i=>{i.listener=new NJ({context:i})});bS(i=>{i.listener.dispose()});class YE extends Uu{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=Ht(YE.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const n=e.urls[t];this.add(t,n,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:ei,onload:ei,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return Zt(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,n=ei,s=ei){return Du(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new fi(this.baseUrl+t,n,s))):this._buffers.set(e.toString(),new fi(t,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class y1 extends oo{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return hd(super._frequencyToUnits(e))}_ticksToUnits(e){return hd(super._ticksToUnits(e))}_beatsToUnits(e){return hd(super._beatsToUnits(e))}_secondsToUnits(e){return hd(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return tF(this.toMidi())}transpose(e){return new y1(this.context,this.toMidi()+e)}}class xm extends lv{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class IJ extends Wa{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Zo,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,t=>{e-t.time<=this.expiration&&t.callback(),this._events.remove(t)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}xS(i=>{i.draw=new IJ({context:i})});bS(i=>{i.draw.dispose()});class OJ extends Uu{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){Zt(Pn(e.time),"Events must have a time property"),Zt(Pn(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new PJ(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const n of t)if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let n,s=null;if(t>0)if(e.left.right===null)n=e.left,n.right=e.right,s=n;else{for(n=e.left.right;n.right!==null;)n=n.right;n.parent&&(n.parent.right=n.left,s=n.parent,n.left=e.left,n.right=e.right)}else if(e.right.left===null)n=e.right,n.left=e.left,s=n;else{for(n=e.right.left;n.left!==null;)n=n.left;n.parent&&(n.parent.left=n.right,s=n.parent,n.left=e.left,n.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=n:e.parent.right=n:this._setRoot(n),s&&this._rebalance(s)}e.dispose()}_rotateLeft(e){const t=e.parent,n=e.isLeftChild(),s=e.right;s&&(e.right=s.left,s.left=e),t!==null?n?t.left=s:t.right=s:this._setRoot(s)}_rotateRight(e){const t=e.parent,n=e.isLeftChild(),s=e.left;s&&(e.left=s.right,s.right=e),t!==null?n?t.left=s:t.right=s:this._setRoot(s)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let n=t[0];for(let s=1;s<t.length;s++)t[s].low>n.low&&(n=t[s]);return n.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(n=>t.push(n)),t.forEach(n=>{n.event&&e(n.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const n=[];this._root.search(e,n),n.forEach(s=>{s.event&&t(s.event)})}return this}forEachFrom(e,t){if(this._root!==null){const n=[];this._root.searchAfter(e,n),n.forEach(s=>{s.event&&t(s.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class PJ{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class UJ extends Uu{constructor(e){super(),this.name="TimelineValue",this._timeline=new Zo({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class Ac extends en{constructor(){super(Ht(Ac.getDefaults(),arguments,["context"]))}connect(e,t=0,n=0){return TS(this,e,t,n),this}}class sg extends Ac{constructor(){const e=Ht(sg.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,co(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):aJ(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(di.getDefaults(),{length:1024})}setMap(e,t=1024){const n=new Float32Array(t);for(let s=0,r=t;s<r;s++){const o=s/(r-1)*2-1;n[s]=e(o,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(n=>n.includes(e));Zt(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class ZE extends Ac{constructor(){const e=Ht(ZE.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new sg({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(Ac.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class jh{constructor(e,t){this.id=jh._eventId++,this._remainderTime=0;const n=Object.assign(jh.getDefaults(),t);this.transport=e,this.callback=n.callback,this._once=n.once,this.time=Math.floor(n.time),this._remainderTime=n.time-this.time}static getDefaults(){return{callback:ei,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}jh._eventId=0;class KE extends jh{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(KE.getDefaults(),t);this.duration=n.duration,this._interval=n.interval,this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},jh.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return v1(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new xm(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){v1(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new xm(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);Bm(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class AS extends Wa{constructor(){const e=Ht(AS.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new UJ(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Zo,this._repeatedEvents=new OJ,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new wS({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),pi(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Wa.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const n=t%(this._swingTicks*2)/(this._swingTicks*2),s=Math.sin(n*Math.PI)*this._swingAmount;e+=new xm(this.context,this._swingTicks*2/3).toSeconds()*s}qN(!0),this._timeline.forEachAtTime(t,n=>n.invoke(e)),qN(!1)}schedule(e,t){const n=new jh(this,{callback:e,time:new lv(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n,s=1/0){const r=new KE(this,{callback:e,duration:new wl(this.context,s).toTicks(),interval:new wl(this.context,t).toTicks(),time:new lv(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(e,t){const n=new jh(this,{callback:e,once:!0,time:new lv(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,n=>this.clear(n.id)),this._repeatedEvents.forEachFrom(t,n=>this.clear(n.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new xm(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let n;return Pn(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){co(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new wl(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new wl(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new xm(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new xm(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const n=this._clock.getTicksAtTime(t),s=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t),r=t+s;this.emit("stop",r),this._clock.setTicksAtTime(e,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),n=this.getTicksAtTime(t),s=e-n%e;return this._clock.nextTickTime(s,t)}}syncSignal(e,t){const n=this.now();let s=this.bpm,r=1/(60/s.getValueAtTime(n)/this.PPQ),o=[];if(e.units==="time"){const u=.015625/r,f=new ci(u),p=new ZE(-1),g=new ci(u);s.chain(f,p,g),s=g,r=1/r,o=[f,p,g]}t||(e.getValueAtTime(n)!==0?t=e.getValueAtTime(n)/r:t=0);const l=new ci(t);return s.connect(l),l.connect(e._param),o.push(l),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const n=this._syncedSignals[t];n.signal===e&&(n.nodes.forEach(s=>s.dispose()),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),zE(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}oy.mixin(AS);xS(i=>{i.transport=new AS({context:i})});bS(i=>{i.transport.dispose()});class ca extends en{constructor(e){super(e),this.input=void 0,this._state=new GE("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=ei,this._syncedStop=ei,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new ig({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,pi(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(en.getDefaults(),{mute:!1,onstop:ei,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let s=Yo(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(s=this._clampToCurrentTime(s),!this._synced&&this._state.getValueAtTime(s)==="started")Zt(Bm(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,t,n);else if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const r=this._state.get(s);r&&(r.offset=this.toSeconds(wm(t,0)),r.duration=n?this.toSeconds(n):void 0);const o=this.context.transport.schedule(l=>{this._start(l,t,n)},s);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else qL(this.context),this._start(s,t,n);return this}stop(e){let t=Yo(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||Pn(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const n=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(n)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(Bm(t,0)){const n=this._state.get(t);if(n&&n.state==="started"&&n.time!==t){const s=t-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-s),this._start(e,this.toSeconds(n.offset)+s,r)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=ei,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class cy extends zm{constructor(){const e=Ht(cy.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,Nu(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Wn({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new fi(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(zm.getDefaults(),{url:new fi,loop:!1,loopEnd:0,loopStart:0,onload:ei,onerror:ei,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n,s=1){Zt(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(e);this._startGain(r,s),this.loop?t=wm(t,this.loopStart):t=wm(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const l=this.toSeconds(this.loopEnd)||this.buffer.duration,u=this.toSeconds(this.loopStart),f=l-u;Hw(o,l)&&(o=(o-u)%f+u),Sl(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,v1(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,o)),Pn(n)){let l=this.toSeconds(n);l=Math.max(l,0),this.stop(r+l)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class _1 extends ca{constructor(){const e=Ht(_1.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(ca.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(Zt(e in XN,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const t=XN[this._type];this._source=new cy({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const cm=44100*5,kT=2,vu={brown:null,pink:null,white:null},XN={get brown(){if(!vu.brown){const i=[];for(let e=0;e<kT;e++){const t=new Float32Array(cm);i[e]=t;let n=0;for(let s=0;s<cm;s++){const r=Math.random()*2-1;t[s]=(n+.02*r)/1.02,n=t[s],t[s]*=3.5}}vu.brown=new fi().fromArray(i)}return vu.brown},get pink(){if(!vu.pink){const i=[];for(let e=0;e<kT;e++){const t=new Float32Array(cm);i[e]=t;let n,s,r,o,l,u,f;n=s=r=o=l=u=f=0;for(let p=0;p<cm;p++){const g=Math.random()*2-1;n=.99886*n+g*.0555179,s=.99332*s+g*.0750759,r=.969*r+g*.153852,o=.8665*o+g*.3104856,l=.55*l+g*.5329522,u=-.7616*u-g*.016898,t[p]=n+s+r+o+l+u+f+g*.5362,t[p]*=.11,f=g*.115926}}vu.pink=new fi().fromArray(i)}return vu.pink},get white(){if(!vu.white){const i=[];for(let e=0;e<kT;e++){const t=new Float32Array(cm);i[e]=t;for(let n=0;n<cm;n++)t[n]=Math.random()*2-1}vu.white=new fi().fromArray(i)}return vu.white}};function Fd(i,e){return gs(this,void 0,void 0,function*(){const t=e/i.context.sampleRate,n=new SS(1,t,i.context.sampleRate);return new i.constructor(Object.assign(i.get(),{frequency:2/t,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class QE extends zm{constructor(){const e=Ht(QE.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],Nu(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Wn({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Wn({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),pi(this,["frequency","detune"])}static getDefaults(){return Object.assign(zm.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class os extends ca{constructor(){const e=Ht(os.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new di({context:this.context,units:"frequency",value:e.frequency}),pi(this,"frequency"),this.detune=new di({context:this.context,units:"cents",value:e.detune}),pi(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(ca.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),n=new QE({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return os._periodicWaveCache.find(t=>t.phase===this._phase&&vJ(t.partials,this._partials));{const e=os._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const n=this._getCachedPeriodicWave();if(Pn(n)){const{partials:s,wave:r}=n;this._wave=r,this._partials=s,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[s,r]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(s,r);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),os._periodicWaveCache.push({imag:r,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),os._periodicWaveCache.length>100&&os._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){jo(e,0);let t=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const s=new Float32Array(e);this._partials.forEach((r,o)=>s[o]=r),this._partials=Array.from(s),this.type=this._type}}_getRealImaginary(e,t){let s=2048;const r=new Float32Array(s),o=new Float32Array(s);let l=1;if(e==="custom"){if(l=this._partials.length+1,this._partialCount=this._partials.length,s=l,this._partials.length===0)return[r,o]}else{const u=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);u?(l=parseInt(u[2],10)+1,this._partialCount=parseInt(u[2],10),e=u[1],l=Math.max(l,2),s=l):this._partialCount=0,this._partials=[]}for(let u=1;u<s;++u){const f=2/(u*Math.PI);let p;switch(e){case"sine":p=u<=l?1:0,this._partials[u-1]=p;break;case"square":p=u&1?2*f:0,this._partials[u-1]=p;break;case"sawtooth":p=f*(u&1?1:-1),this._partials[u-1]=p;break;case"triangle":u&1?p=2*(f*f)*(u-1>>1&1?-1:1):p=0,this._partials[u-1]=p;break;case"custom":p=this._partials[u-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}p!==0?(r[u]=-p*Math.sin(t*u),o[u]=p*Math.cos(t*u)):(r[u]=0,o[u]=0)}return[r,o]}_inverseFFT(e,t,n){let s=0;const r=e.length;for(let o=0;o<r;o++)s+=e[o]*Math.cos(o*n)+t[o]*Math.sin(o*n);return s}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let n=0;const s=Math.PI*2,r=32;for(let o=0;o<r;o++)n=Math.max(this._inverseFFT(e,t,o/r*s),n);return _J(-this._inverseFFT(e,t,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return gs(this,arguments,void 0,function*(e=1024){return Fd(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}os._periodicWaveCache=[];class iF extends Ac{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new sg({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Rd extends di{constructor(){const e=Ht(Rd.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new ci({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(di.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class ES extends ca{constructor(){const e=Ht(ES.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new iF({context:this.context}),this._modulationNode=new ci({context:this.context}),this._carrier=new os({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new os({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Rd({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),pi(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(os.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return gs(this,arguments,void 0,function*(e=1024){return Fd(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class CS extends ca{constructor(){const e=Ht(CS.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new ci({context:this.context,gain:0}),this._carrier=new os({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new di({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new os({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Rd({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Rd({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),pi(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(os.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return gs(this,arguments,void 0,function*(e=1024){return Fd(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class uy extends ca{constructor(){const e=Ht(uy.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new ci({context:this.context,gain:0}),this._thresh=new sg({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new di({context:this.context,units:"audioRange",value:e.width}),this._triangle=new os({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),pi(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ca.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return gs(this,arguments,void 0,function*(e=1024){return Fd(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class RS extends ca{constructor(){const e=Ht(RS.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new di({context:this.context,units:"frequency",value:e.frequency}),this.detune=new di({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,pi(this,["frequency","detune"])}static getDefaults(){return Object.assign(os.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,n=e/(this._oscillators.length-1);this._forEach((s,r)=>s.detune.value=t+n*r)}}get count(){return this._oscillators.length}set count(e){if(jo(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const n=new os({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):ei});this.type==="custom"&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,n)=>t.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(){return gs(this,arguments,void 0,function*(e=1024){return Fd(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class DS extends ca{constructor(){const e=Ht(DS.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Rd({context:this.context,value:2}),this._pulse=new uy({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new os({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),pi(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ca.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return gs(this,arguments,void 0,function*(e=1024){return Fd(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const YN={am:ES,fat:RS,fm:CS,oscillator:os,pulse:uy,pwm:DS};class x1 extends ca{constructor(){const e=Ht(x1.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new di({context:this.context,units:"frequency",value:e.frequency}),this.detune=new di({context:this.context,units:"cents",value:e.detune}),pi(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(os.getDefaults(),CS.getDefaults(),ES.getDefaults(),RS.getDefaults(),uy.getDefaults(),DS.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=YN[e],n=this.now();if(this._oscillator){const s=this._oscillator;s.stop(n),this.context.setTimeout(()=>s.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof YN[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&Ru(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&Ru(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Du(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return gs(this,arguments,void 0,function*(e=1024){return Fd(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class JE extends di{constructor(){super(Ht(JE.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new ci({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Uv(this._constantSource,this._sum)}static getDefaults(){return Object.assign(di.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class $E extends Ac{constructor(){const e=Ht($E.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new Rd({context:this.context,value:e.max-e.min}),this._add=this.output=new JE({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Ac.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class eC extends Ac{constructor(){super(Ht(eC.getDefaults(),arguments)),this.name="Zero",this._gain=new ci({context:this.context}),this.output=this._gain,this.input=void 0,Nu(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),nF(this.context.getConstant(0),this._gain),this}}class tC extends en{constructor(){const e=Ht(tC.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Wn.prototype._fromType,this._toType=Wn.prototype._toType,this._is=Wn.prototype._is,this._clampValue=Wn.prototype._clampValue,this._oscillator=new os(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new ci({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new di({context:this.context,units:"audioRange",value:0}),this._zeros=new eC({context:this.context}),this._a2g=new iF({context:this.context}),this._scaler=this.output=new $E({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),pi(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(os.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){const t=this.min,n=this.max;this._units=e,this.min=t,this.max=n}get state(){return this._oscillator.state}connect(e,t,n){return(e instanceof Wn||e instanceof di)&&(this.convert=e.convert,this.units=e.units),TS(this,e,t,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function sF(i,e=1/0){const t=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(r){jo(r,i,e),t.set(this,r)}})}}function Lu(i,e=1/0){const t=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(r){jo(this.toSeconds(r),i,e),t.set(this,r)}})}}class NS extends ca{constructor(){const e=Ht(NS.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new fi({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(ca.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:ei,onerror:ei,playbackRate:1,reverse:!1})}load(e){return gs(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=ei){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){this._loop?t=wm(t,this._loopStart):t=wm(t,0);const s=this.toSeconds(t),r=n;n=wm(n,Math.max(this._buffer.duration-s,0));let o=this.toSeconds(n);o=o/this._playbackRate,e=this.toSeconds(e);const l=new cy({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(l),this._loop&&Yo(r)?l.start(e,s):l.start(e,s,o-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(n=>n.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){var s;(s=[...this._activeSources].pop())===null||s===void 0||s.stop(e),this._start(e,t,n)}seek(e,t){const n=this.toSeconds(t);if(this._state.getValueAtTime(n)==="started"){const s=this.toSeconds(e);this._stop(n),this._start(n,s)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&jo(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&jo(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(s=>s.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}Ol([Lu(0)],NS.prototype,"fadeIn",void 0);Ol([Lu(0)],NS.prototype,"fadeOut",void 0);class LJ extends Ac{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new sg({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class $h extends en{constructor(){const e=Ht($h.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new di({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(en.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(Du(e))return e;{let n;for(n in Wx)if(Wx[n][t]===e)return n;return e}}_setCurve(e,t,n){if(Du(n)&&Reflect.has(Wx,n)){const s=Wx[n];yd(s)?e!=="_decayCurve"&&(this[e]=s[t]):this[e]=s}else if(co(n)&&e!=="_decayCurve")this[e]=n;else throw new Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let s=this.toSeconds(this.attack);const r=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const l=1/s;s=(1-o)/l}if(s<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,s,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,s,e);else{this._sig.cancelAndHoldAtTime(e);let l=this._attackCurve;for(let u=1;u<l.length;u++)if(l[u-1]<=o&&o<=l[u]){l=this._attackCurve.slice(u),l[0]=o;break}this._sig.setValueCurveAtTime(l,e,s,t)}if(r&&this.sustain<1){const l=t*this.sustain,u=e+s;this.log("decay",u),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(l,r+u):this._sig.exponentialApproachValueAtTime(l,u,r)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,n,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,n,e):(Zt(co(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,n=1){return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,n=0){return TS(this,e,t,n),this}asArray(){return gs(this,arguments,void 0,function*(e=1024){const t=e/this.context.sampleRate,n=new SS(1,t,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=s+this.toSeconds(this.release),o=r*.1,l=r+o,u=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/l,decay:t*this.toSeconds(this.decay)/l,release:t*this.toSeconds(this.release)/l,context:n}));return u._sig.toDestination(),u.triggerAttackRelease(t*(s+o)/l,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}Ol([Lu(0)],$h.prototype,"attack",void 0);Ol([Lu(0)],$h.prototype,"decay",void 0);Ol([sF(0,1)],$h.prototype,"sustain",void 0);Ol([Lu(0)],$h.prototype,"release",void 0);const Wx=(()=>{let e,t;const n=[];for(e=0;e<128;e++)n[e]=Math.sin(e/127*(Math.PI/2));const s=[],r=6.4;for(e=0;e<127;e++){t=e/127;const v=Math.sin(t*(Math.PI*2)*r-Math.PI/2)+1;s[e]=v/10+t*.83}s[127]=1;const o=[],l=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/127*l)/l;const u=[];for(e=0;e<128;e++)t=e/127,u[e]=.5*(1-Math.cos(Math.PI*t));const f=[];for(e=0;e<128;e++){t=e/127;const v=Math.pow(t,3)*4+.2,x=Math.cos(v*Math.PI*2*t);f[e]=Math.abs(x*(1-t))}function p(v){const x=new Array(v.length);for(let b=0;b<v.length;b++)x[b]=1-v[b];return x}function g(v){return v.slice(0).reverse()}return{bounce:{In:p(f),Out:f},cosine:{In:n,Out:g(n)},exponential:"exponential",linear:"linear",ripple:{In:s,Out:p(s)},sine:{In:u,Out:p(u)},step:{In:o,Out:p(o)}}})();class qh extends en{constructor(){const e=Ht(qh.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new ig({context:this.context,volume:e.volume}),this.volume=this._volume.volume,pi(this,"volume")}static getDefaults(){return Object.assign(en.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const n=this["_original_"+e]=this[e];this[e]=(...s)=>{const r=s[t],o=this.context.transport.schedule(l=>{s[t]=l,n.apply(this,s)},r);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,n,s){const r=this.toSeconds(n),o=this.toSeconds(t);return this.triggerAttack(e,r,s),this.triggerRelease(r+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Dd extends qh{constructor(){const e=Ht(Dd.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(qh.getDefaults(),{detune:0,onsilence:ei,portamento:0})}triggerAttack(e,t,n=1){this.log("triggerAttack",e,t,n);const s=this.toSeconds(t);return this._triggerEnvelopeAttack(s,n),this.setNote(e,s),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const n=this.toSeconds(t),s=e instanceof oo?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,r,n)}else this.frequency.setValueAtTime(s,n);return this}}Ol([Lu(0)],Dd.prototype,"portamento",void 0);class nC extends $h{constructor(){super(Ht(nC.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new ci({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Vm extends Dd{constructor(){const e=Ht(Vm.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new x1(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new nC(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),pi(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Dd.getDefaults(),{envelope:Object.assign(Gw($h.getDefaults(),Object.keys(en.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Gw(x1.getDefaults(),[...Object.keys(ca.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+s)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class b1 extends en{constructor(){const e=Ht(b1.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Wn({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new Wn({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new Wn({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new Wn({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(en.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){Zt(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const t=new Float32Array(e);for(let o=0;o<e;o++){const u=Math.pow(o/e,2)*19980+20;t[o]=u}const n=new Float32Array(e),s=new Float32Array(e),r=this.context.createBiquadFilter();return r.type=this.type,r.Q.value=this.Q.value,r.frequency.value=this.frequency.value,r.gain.value=this.gain.value,r.getFrequencyResponse(t,n,s),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class iC extends en{constructor(){const e=Ht(iC.getDefaults(),arguments,["frequency","type","rolloff"]);super(e),this.name="Filter",this.input=new ci({context:this.context}),this.output=new ci({context:this.context}),this._filters=[],this._filters=[],this.Q=new di({context:this.context,units:"positive",value:e.Q}),this.frequency=new di({context:this.context,units:"frequency",value:e.frequency}),this.detune=new di({context:this.context,units:"cents",value:e.detune}),this.gain=new di({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,pi(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(en.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){Zt(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(n=>n.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const t=Ru(e)?e:parseInt(e,10),n=[-12,-24,-48,-96];let s=n.indexOf(t);Zt(s!==-1,`rolloff can only be ${n.join(", ")}`),s+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach(r=>r.disconnect()),this._filters=new Array(s);for(let r=0;r<s;r++){const o=new b1({context:this.context});o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[r]=o}this._internalChannels=this._filters,Uv(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const t=new b1({context:this.context,frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{t.getFrequencyResponse(e).forEach((r,o)=>n[o]*=r)}),t.dispose(),n}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),zE(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class IS extends Vm{constructor(){const e=Ht(IS.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,pi(this,["oscillator","envelope"])}static getDefaults(){return _d(Dd.getDefaults(),Vm.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const n=this.toSeconds(t),s=this.toFrequency(e instanceof oo?e.toFrequency():e),r=s*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Ol([sF(0)],IS.prototype,"octaves",void 0);Ol([Lu(0)],IS.prototype,"pitchDecay",void 0);const rF=new Set;function sC(i){rF.add(i)}function aF(i,e){const t=`registerProcessor("${i}", ${e})`;rF.add(t)}const FJ=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;sC(FJ);const kJ=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;sC(kJ);const BJ=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;sC(BJ);const zJ="feedback-comb-filter",VJ=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;aF(zJ,VJ);class rC extends qh{constructor(){const e=Ht(rC.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=s=>this.releaseAll(s),Zt(!Ru(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const t=e.voice.getDefaults();this.options=Object.assign(t,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(qh.getDefaults(),{maxPolyphony:32,options:{},voice:Vm})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const t=this._activeVoices.findIndex(n=>n.voice===e);this._activeVoices.splice(t,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Zt(e instanceof Dd,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}else _S("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),t=this._voices.indexOf(e);this._voices.splice(t,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,t,n){e.forEach(s=>{const r=new y1(this.context,s).toMidi(),o=this._getNextAvailableVoice();o&&(o.triggerAttack(s,t,n),this._activeVoices.push({midi:r,voice:o,released:!1}),this.log("triggerAttack",s,t))})}_triggerRelease(e,t){e.forEach(n=>{const s=new y1(this.context,n).toMidi(),r=this._activeVoices.find(({midi:o,released:l})=>o===s&&!l);r&&(r.voice.triggerRelease(t),r.released=!0,this.log("triggerRelease",n,t))})}_scheduleEvent(e,t,n,s){Zt(!this.disposed,"Synth was already disposed"),n<=this.now()?e==="attack"?this._triggerAttack(t,n,s):this._triggerRelease(t,n):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,t,n,s)},n-this.now())}triggerAttack(e,t,n){Array.isArray(e)||(e=[e]);const s=this.toSeconds(t);return this._scheduleEvent("attack",e,s,n),this}triggerRelease(e,t){Array.isArray(e)||(e=[e]);const n=this.toSeconds(t);return this._scheduleEvent("release",e,n),this}triggerAttackRelease(e,t,n,s){const r=this.toSeconds(n);if(this.triggerAttack(e,r,s),co(t)){Zt(co(e),"If the duration is an array, the notes must also be an array"),e=e;for(let o=0;o<e.length;o++){const l=t[Math.min(o,t.length-1)],u=this.toSeconds(l);Zt(u>0,"The duration must be greater than 0"),this.triggerRelease(e[o],r+u)}}else{const o=this.toSeconds(t);Zt(o>0,"The duration must be greater than 0"),this.triggerRelease(e,r+o)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const t=Gw(e,["onsilence","context"]);return this.options=_d(this.options,t),this._voices.forEach(n=>n.set(t)),this._dummyVoice.set(t),this}get(){return this._dummyVoice.get()}releaseAll(e){const t=this.toSeconds(e);return this._activeVoices.forEach(({voice:n})=>{n.triggerRelease(t)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class OS extends qh{constructor(){const e=Ht(OS.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const t={};Object.keys(e.urls).forEach(n=>{const s=parseInt(n,10);if(Zt(Hx(n)||Ru(s)&&isFinite(s),`url key is neither a note or midi pitch: ${n}`),Hx(n)){const r=new oo(this.context,n).toMidi();t[r]=e.urls[n]}else Ru(s)&&isFinite(s)&&(t[s]=e.urls[s])}),this._buffers=new YE({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(qh.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:ei,onerror:ei,release:.1,urls:{}})}_findClosest(e){let n=0;for(;n<96;){if(this._buffers.has(e+n))return-n;if(this._buffers.has(e-n))return n;n++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,n=1){return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(s=>{const r=eF(new oo(this.context,s).toFrequency()),o=Math.round(r),l=r-o,u=this._findClosest(o),f=o-u,p=this._buffers.get(f),g=$L(u+l),v=new cy({url:p,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:g}).connect(this.output);v.start(t,0,p.duration/g,n),co(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(v),v.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const x=this._activeSources.get(o),b=x.indexOf(v);b!==-1&&x.splice(b,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(n=>{const s=new oo(this.context,n).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const r=this._activeSources.get(s);t=this.toSeconds(t),r.forEach(o=>{o.stop(t)}),this._activeSources.set(s,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(n=>{for(;n.length;)n.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,n,s=1){const r=this.toSeconds(n);return this.triggerAttack(e,r,s),co(t)?(Zt(co(e),"notes must be an array when duration is array"),e.forEach((o,l)=>{const u=t[Math.min(l,t.length-1)];this.triggerRelease(o,r+this.toSeconds(u))})):this.triggerRelease(e,r+this.toSeconds(t)),this}add(e,t,n){if(Zt(Hx(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Hx(e)){const s=new oo(this.context,e).toMidi();this._buffers.add(s,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}Ol([Lu(0)],OS.prototype,"attack",void 0);Ol([Lu(0)],OS.prototype,"release",void 0);class aC extends en{constructor(){const e=Ht(aC.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new LJ({context:this.context}),this.a=new ci({context:this.context,gain:0}),this.b=new ci({context:this.context,gain:0}),this.output=new ci({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new di({context:this.context,units:"normalRange",value:e.fade}),pi(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Nu(this._split,this.a.gain,0),Nu(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(en.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class S1 extends en{constructor(e){super(e),this.name="Effect",this._dryWet=new aC({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new ci({context:this.context}),this.effectReturn=new ci({context:this.context}),this.input=new ci({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],pi(this,"wet")}static getDefaults(){return Object.assign(en.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class ZN extends S1{constructor(e){super(e),this.name="LFOEffect",this._lfo=new tC({context:this.context,frequency:e.frequency,amplitude:e.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=e.type,pi(this,["frequency","depth"])}static getDefaults(){return Object.assign(S1.getDefaults(),{frequency:1,type:"sine",depth:1})}start(e){return this._lfo.start(e),this}stop(e){return this._lfo.stop(e),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class oC extends ZN{constructor(){const e=Ht(oC.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);super(e),this.name="AutoFilter",this.filter=new iC(Object.assign(e.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=e.octaves,this.baseFrequency=e.baseFrequency}static getDefaults(){return Object.assign(ZN.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(e){this._lfo.min=this.toFrequency(e),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._lfo.max=this._lfo.min*Math.pow(2,e)}dispose(){return super.dispose(),this.filter.dispose(),this}}class lC extends en{constructor(){const e=Ht(lC.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new Wn({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",pi(this,"pan")}static getDefaults(){return Object.assign(en.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const GJ="bit-crusher",HJ=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;aF(GJ,HJ);class cC extends en{constructor(){const e=Ht(cC.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(en.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class uC extends S1{constructor(){const e=Ht(uC.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=this.toSeconds(e.decay);jo(t,.001),this._decay=t;const n=this.toSeconds(e.preDelay);jo(n,0),this._preDelay=n,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(S1.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),jo(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),jo(e,0),this._preDelay=e,this.generate()}generate(){return gs(this,void 0,void 0,function*(){const e=this.ready,t=new SS(2,this._decay+this._preDelay,this.context.sampleRate),n=new _1({context:t}),s=new _1({context:t}),r=new cC({context:t});n.connect(r,0,0),s.connect(r,0,1);const o=new ci({context:t}).toDestination();r.connect(o),n.start(0),s.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const l=t.render();return this.ready=l.then(ei),yield e,this._convolver.buffer=(yield l).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Rs extends en{constructor(){const e=Ht(Rs.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new ci({context:this.context}),Rs._allSolos.has(this.context)||Rs._allSolos.set(this.context,new Set),Rs._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(en.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Rs._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Rs._soloed.has(this.context)||Rs._soloed.set(this.context,new Set),Rs._soloed.get(this.context).add(this)}_removeSolo(){Rs._soloed.has(this.context)&&Rs._soloed.get(this.context).delete(this)}_isSoloed(){return Rs._soloed.has(this.context)&&Rs._soloed.get(this.context).has(this)}_noSolos(){return!Rs._soloed.has(this.context)||Rs._soloed.has(this.context)&&Rs._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Rs._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Rs._allSolos=new Map;Rs._soloed=new Map;class hC extends en{constructor(){const e=Ht(hC.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new lC({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new ig({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,pi(this,["pan","volume"])}static getDefaults(){return Object.assign(en.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class bm extends en{constructor(){const e=Ht(bm.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new Rs({solo:e.solo,context:this.context}),this._panVol=this.output=new hC({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),pi(this,["pan","volume"])}static getDefaults(){return Object.assign(en.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return bm.buses.has(e)||bm.buses.set(e,new ci({context:this.context})),bm.buses.get(e)}send(e,t=0){const n=this._getBus(e),s=new ci({context:this.context,units:"decibels",gain:t});return this.connect(s),s.connect(n),s}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}bm.buses=new Map;Tl().transport;Tl().destination;Tl().destination;Tl().listener;Tl().draw;Tl();function WJ({enabled:i,currentChapter:e}){const t=_e.useRef(null),n=_e.useRef(null),s=_e.useRef(null);return _e.useEffect(()=>{if(!i){t.current&&(t.current.dispose(),t.current=null),n.current&&(n.current.dispose(),n.current=null);return}TJ();const r=new oC({frequency:"8n",baseFrequency:200,octaves:2.5}).toDestination().start(),o=new uC({decay:10,wet:.5}).connect(r),l=new rC(Vm,{oscillator:{type:"sine"},envelope:{attack:2,decay:1,sustain:.5,release:4}}).connect(o),u={0:["C2","G2","C3"],1:["D2","A2","D3"],2:["E2","B2","E3"],3:["F2","C3","F3"],4:["G2","D3","G3"],5:["A2","E3","A3"]},f=u[e]||u[0];return l.set({volume:-20}),l.triggerAttack(f),t.current=l,s.current=r,()=>{t.current&&(t.current.releaseAll(),t.current.dispose()),s.current&&s.current.dispose(),o.dispose()}},[i,e]),null}function jJ(){const[i,e]=_e.useState(0),[t,n]=_e.useState(!1),s=[{id:1,title:"The Problem",component:DV},{id:2,title:"A Strange Hint",component:Hq},{id:3,title:"Enter the Jewel",component:qq},{id:4,title:"The Amplituhedron Itself",component:Zq},{id:5,title:"Why This Changes Everything",component:Jq}],r=i>0?s[i-1].component:$q;return ee.jsxs("div",{className:"app",children:[ee.jsx(WJ,{enabled:t,currentChapter:i}),ee.jsx(CV,{currentChapter:i,chapters:s,onChapterSelect:e}),ee.jsx(jm,{mode:"wait",children:ee.jsx(r,{onNext:()=>e(o=>Math.min(o+1,s.length)),onPrevious:()=>e(o=>Math.max(o-1,0)),onSoundToggle:()=>n(o=>!o),soundEnabled:t},i)})]})}ZF.createRoot(document.getElementById("root")).render(ee.jsx(_e.StrictMode,{children:ee.jsx(jJ,{})}));
    </script>
  </body>
</html>
